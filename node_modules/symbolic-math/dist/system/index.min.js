System.register([],(function(t){"use strict";return{execute:function(){function e(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}function r(t,e,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(t,r):s?s.value=r:e.set(t,r),r}var n,s,i;function o(t,e){return t&~e}t({car:d,cdr:m,cons:u,create_boo:H,create_flt:J,create_hyp:function(t){return new at(t)},create_int:Ft,create_rat:function(t,e,r,n){return new Lt(mt(t),mt(e),r,n)},create_script_context:function(t){let e=1;const r=function(t){const e=function(t){if(t){return{assumes:t.assumes?t.assumes:{},dependencies:Array.isArray(t.dependencies)?t.dependencies:[],disable:Array.isArray(t.disable)?t.disable:[],noOptimize:"boolean"==typeof t.noOptimize&&t.noOptimize,useCaretForExponentiation:"boolean"==typeof t.useCaretForExponentiation&&t.useCaretForExponentiation,useDefinitions:"boolean"==typeof t.useDefinitions&&t.useDefinitions}}return{assumes:{},dependencies:[],disable:[],noOptimize:!1,useCaretForExponentiation:!1,useDefinitions:!1}}(t),r=function(){const t=new Map,e=new Map,r=new Map;return{clear(){t.clear(),e.clear(),r.clear()},getProps(e){if("string"==typeof e){const r=t.get(e);return r||QU}return this.getProps(e.key())},setProps(e,n){const s=e.key();if(n){const i=Object.freeze(Object.assign({...this.getProps(e)},n));t.set(s,i),r.set(s,e)}else t.delete(s)},getValue(t){if("string"==typeof t){const r=e.get(t);return r||l}return this.getValue(t.key())},setValue(t,n){const s=t.key();p(n)?e.delete(s):(e.set(s,n),r.set(s,t))},entries(){const t=[];return e.forEach((function(e,n){const s=r.get(n);if(!s)throw new Error;p(e)||t.push({sym:s,value:e})})),t},delete(n){const s=n.key();t.delete(s),e.delete(s),r.delete(s)}}}(),n=[],s=[];for(const t of R)s[t]={};let i=new rC;const o=new tC,a={},f={},d={};function m(){if(o.get($.expand)){const t=s[L];if(void 0===t)throw new Error(`currentOps(${L})`);return t}if(o.get($.factor)){const t=s[k];if(void 0===t)throw new Error(`currentOps(${k})`);return t}return{}}function g(t,e){const r=m()[t];if(Array.isArray(r)&&r.length>0){for(const t of r)if(t.isKind(e))return t;throw new Ai(`No matching operator for key ${t}`)}throw console.warn("expand",o.get($.expand)),console.warn("factor",o.get($.factor)),new Ai(`No operators for key ${t} in current mode}`)}const w={getPrintHandler:()=>i,setPrintHandler(t){i=t||new rC},add:(...t)=>w.evaluate(F.add,...t),arctan:t=>w.evaluate(F.arctan,t),arg:t=>w.evaluate(F.arg,t),clearOperators(){n.length=0;for(const t of R){const e=s[t];for(const t in e)e[t]=[]}},defineLegacyTransformer(t,e){w.defineOperator(function(t,e){const r=_i(t);return new iC(t,r,e)}(t,e))},defineFunction(t,e){const r=function(t){if(h(t)){const e=t.head;if(ie(e))return e;throw new Error}throw new Error}(t),n=function(t){if(h(t)){const e=t.head;if(ie(e))return _i(e);throw new Error}throw new Error}(t);w.setSymbolValue(r,new zU(e,n))},defineKeyword(t,e){w.defineOperator(function(t,e){return new nC(t,e)}(t,e))},defineOperator(t){n.push(t)},defineAssociative(t,e){},divide:(t,e)=>w.multiply(t,w.power(e,jt)),clearBindings(){r.clear()},compareFn(t){const e=d[t.key()];return e?function(t,r){return e.compare(t,r,w)}:function(e,r){return new pC(t).compare(e,r,w)}},conj:t=>w.evaluate(F.conj,t),cos:t=>w.evaluate(F.cos,t),evaluate(t,...e){const r=c(...e),n=u(Q(t),r);return w.valueOf(n)},exp:t=>w.evaluate(F.exp,t),getSymbolProps:t=>r.getProps(t),getSymbolValue:t=>r.getValue(t),getSymbolsInfo:()=>r.entries(),buildOperators(){for(const t of n){const r=t.create(w,e);if(!dC(r.dependencies,e.dependencies))continue;const n="number"==typeof r.phases?r.phases:I;for(const t of R)if(n&t){const e=s[t];if(r.hash)Array.isArray(e[r.hash])?e[r.hash].push(r):e[r.hash]=[r];else{if(!r.key)throw new Ai(`${r.name} has no key and nohash`);Array.isArray(e[r.key])?e[r.key].push(r):e[r.key]=[r]}}}},isExpanding:()=>o.get($.expand),isFactoring:()=>o.get($.factor),is_imag:t=>w.operatorFor(t).isImag(t),isMinusOne:t=>w.operatorFor(t).isMinusOne(t),isOne:t=>w.operatorFor(t).isOne(t),is(t,e){const r=c(t,e),n=w.valueOf(r);if(W(n))return n.isTrue();throw new Error(`Unable to determine ${w.toInfixString(t)}(${w.toInfixString(e)})`)},is_complex:t=>w.is(fC,t),is_real:t=>w.is(hC,t),isScalar:t=>w.operatorFor(t).isScalar(t),is_zero:t=>w.operatorFor(t).isZero(t),equals:(t,e)=>t.equals(e),factorize:(t,e)=>t.contains(e)&&ip(t,e)&&ie(e)?function(t,e,r){Ep(t)&&er("floating point numbers in polynomial");const n=Pp(t,e,r);n.forEach((function(t){}));let s=function(t,e){let r=Ut;for(const n of t)r=XA(dm(n,e),r,e);for(let n=0;n<t.length;n++)t[n]=e.multiply(r,t[n]);const n=Ap(r,e);return n}(n,r);n.forEach((function(t){}));let i,o,a,u="real",c=null,l=n.length-1;for(;l>0;){let t=!1,f=!1;if(r.is_zero(n[0])?(i=Ut,o=Jt):"real"===u?[f,i,o]=FU(n,l,e,i,o,r):"complex"===u&&([t,i]=UU(c,n,l,r)),"real"===u){if(!1===f){u="complex";continue}{for(a=r.add(r.multiply(i,e),o),s=Cd(s,a,r),CU(i,o,n,l,r);l&&r.is_zero(n[l]);)l--;let t=Jt;for(let s=0;s<=l;s++)t=r.add(t,r.multiply(n[s],r.power(e,Ft(s))));c=t}}else if("complex"===u){if(!1===t)break;{const t=r.subtract(i,e),o=r.subtract(Cp(i,r),e);a=r.multiply(t,o);const u=s;if(s=Cd(s,a,r),null==c){let t=Jt;for(let s=0;s<=l;s++)t=r.add(t,r.multiply(n[s],r.power(e,Ft(s))));c=t}const f=c;c=tS(f,a,e,r);const h=r.multiply(c,a);if(!r.equals(h,f)){bf(u);const t=sr(jd,f,r);return Cd(Of(),t,r)}for(let t=0;t<=l;t++)n.pop();n.push(...Pp(c,e,r)),l-=2}}}let f=Jt;for(let t=0;t<=l;t++)f=r.add(f,r.multiply(n[t],r.power(e,Ft(t))));const h=sr(jd,f,r);return l>0&&qd(n[l])?Cd(function(t,e){const r=function(t,e){return e.negate(t)};return sr(r,t,e)}(s,r),r.negate(h),r):Cd(s,h,r)}(t,e,w):t,getCustomDirective:t=>!!a[t],getNativeDirective:t=>o.get(t),getSymbolPrintName(t){const e=f[t.key()];return"string"==typeof e?e:t.key()},imag:t=>w.evaluate(F.imag,t),inner(t,e){const r=w.valueOf(t),n=w.valueOf(e),s=c(Q(F.inner),r,n);return w.valueOf(s)},multiply:(t,e)=>w.evaluate(F.multiply,t,e),negate:t=>w.multiply(jt,t),operatorFor(t){if(h(t)){const e=xi(t);for(const r of e){const e=m()[r];if(Array.isArray(e))for(const r of e)if(r.isKind(t))return r}return new aC(t,w)}return g(t.name,t)},outer:(t,e)=>w.evaluate(F.outer,t,e),power:(t,e)=>w.evaluate(F.pow,t,e),real:t=>w.evaluate(F.real,t),remove(t){r.delete(t)},setCustomDirective(t,e){a[t]=e},pushNativeDirective(t,e){o.push(t,e)},popNativeDirective(){o.pop()},setSymbolOrder(t,e){d[t.key()]=e},setSymbolProps(t,e){r.setProps(t,e)},setSymbolPrintName(t,e){f[t.key()]=e},setSymbolValue(t,e){r.setValue(t,e)},sin:t=>w.evaluate(F.sin,t),subtract:(t,e)=>w.add(t,w.negate(e)),toInfixString:t=>w.operatorFor(t).toInfixString(t),toLatexString:t=>w.operatorFor(t).toLatexString(t),toSExprString:t=>w.operatorFor(t).toListString(t),transform(t){if(t.meta===A)return[A,t];if(h(t)){const e=t.head;if(ie(e)){const r=w.getSymbolValue(e);if(function(t){return t instanceof zU}(r))return Zw(r.evaluate(t.argList,w),t)}else if(te(e)){const r=m().Rat,n=mC(t.argList,r);if(n)return n.evaluate(e,t.argList);console.warn(`No unique operators found for Rat from ${r.length} choice(s).`)}const r=m(),n=xi(t);for(const e of n){const n=r[e];if(Array.isArray(n)){const e=mC(t,n);if(e){return e.transform(t)}}else if(h(t)){const e=t.opr;if(ie(e)){const r=w.getSymbolValue(e);if(!p(r)&&h(r)&&sn.equals(r.opr)){const e=ZU(t,w);return[q,e]}}}}return t.meta=A,[T,t]}if(p(t))return[T,t];return w.operatorFor(t).transform(t)},valueOf:t=>w.transform(t)[1]};return w.setSymbolPrintName(uC,"+"),w.setSymbolPrintName(cC,"*"),w.setSymbolPrintName(lC,"expt"),w.setSymbolPrintName(Q(F.rco),">>"),w.setSymbolPrintName(Q(F.lco),"<<"),w.setSymbolPrintName(Q(F.inner),"|"),w.setSymbolPrintName(Q(F.outer),"^"),w.setSymbolPrintName(Q(F.abs),"abs"),w.setSymbolPrintName(Q(F.E),"e"),w.setSymbolPrintName(Q(F.PI),"pi"),w.setSymbolPrintName(Q(F.NIL),"()"),w.setSymbolPrintName(Q(F.IMU),"i"),w.setSymbolPrintName(Q(F.exp),"exp"),w.pushNativeDirective($.useCaretForExponentiation,e.useCaretForExponentiation),w}(function(t){const e=function(t,e){return t};if(t){return e({assumes:t.assumes,dependencies:["Blade","Flt","Imu","Uom","Vector"],disable:t.disable,noOptimize:!1,useCaretForExponentiation:t.useCaretForExponentiation,useDefinitions:t.useDefinitions})}return e({assumes:{},dependencies:["Blade","Flt","Imu","Uom","Vector"],disable:[],noOptimize:!1,useCaretForExponentiation:!1,useDefinitions:!1})}(t));!function(t,e){if(nr(),t.clearBindings(),t.clearOperators(),e&&e.assumes){const r=Object.keys(e.assumes);for(const n of r){const r=e.assumes[n];t.setSymbolProps(B(n),r)}}(function(t){const e=Q(F.add),r=Q(F.test_eq);t.setSymbolOrder(e,new Ch),t.setSymbolOrder(ke,new Kh),t.defineOperator(sE(ke,e)),t.defineOperator(iE(ke,e)),t.defineOperator(sE(Fe,e)),t.defineOperator(iE(Fe,e)),t.defineOperator(M_),t.defineOperator(Z_),t.defineOperator(H_),t.defineOperator(X_),t.defineOperator(z_),t.defineOperator(mx),t.defineOperator(Ox),t.defineOperator(wx),t.defineOperator(xx),t.defineOperator(vx),t.defineOperator(kx),t.defineOperator(Ix),t.defineOperator(Fx),t.defineOperator(Sx),t.defineOperator(Dx),t.defineOperator(B_),t.defineOperator(E_),t.defineOperator(ux),t.defineOperator(fx),t.defineOperator(sx),t.defineOperator(DF),t.defineOperator(ZP),t.defineOperator(SP),t.defineOperator(JF),t.defineOperator(aU),t.defineOperator(mP),t.defineOperator(yP),t.defineOperator(EF),t.defineOperator(pF),t.defineOperator(rF),t.defineOperator(IF),t.defineOperator(hU),t.defineOperator(px),t.defineOperator(qx),t.defineOperator(U_),t.defineOperator(tx),t.defineOperator(R_),t.defineOperator($_),t.defineOperator(Gx),t.defineAssociative(e,Jt),t.defineAssociative(ke,Ut),t.defineOperator(gL),t.defineOperator(cL),t.defineOperator(oL),t.defineOperator(eL),t.defineOperator(fL),t.defineLegacyTransformer(Ie,PU),t.defineOperator(ZN),t.defineOperator(xM),t.defineOperator(vM),t.defineOperator(AM),t.defineOperator(PM),t.defineOperator($M),t.defineOperator(UM),t.defineOperator(RM),t.defineOperator(qM),t.defineOperator(QM),t.defineOperator(GM),t.defineOperator(IN),t.defineOperator(FN),t.defineOperator(CN),t.defineOperator(BN),t.defineOperator(zN),t.defineOperator(kN),t.defineOperator(xN),t.defineOperator(vR),t.defineOperator(vN),t.defineOperator(jM),t.defineOperator(iN),t.defineOperator(uN),t.defineOperator(NS("HCOLA Flt * Uom",di(ke,ke,ri),ke,Mh,V_)),t.defineOperator(NS("HCOLA Rat * Uom",di(ke,ke,ii),ke,Mh,V_)),t.defineOperator(NS("HCOLA Sym * Blade",di(ke,ke,ai),ke,ie,Z)),t.defineOperator(NS("HCOLA Sym * Uom",di(ke,ke,ai),ke,ie,V_)),t.defineOperator(NS("HCOLA Blade * Uom",di(ke,ke,Ys),ke,Z,V_)),t.defineOperator($N),t.defineOperator(_$),t.defineOperator(VN),t.defineOperator(DM),t.defineOperator(YN),t.defineOperator(JN),t.defineOperator(HN),t.defineOperator(e$),t.defineOperator(i$),t.defineOperator(n$),t.defineOperator(u$),t.defineOperator(pN),t.defineOperator(wN),t.defineOperator(qN),t.defineOperator(rN),t.defineOperator(KM),t.defineOperator(h$),t.defineOperator(l$),t.defineOperator(d$),t.defineOperator(SM),t.defineOperator(OM),t.defineOperator(dU),t.defineOperator(q$),t.defineLegacyTransformer(fr,lh),t.defineOperator(Pv),t.defineLegacyTransformer(br,Vv),t.defineOperator(Jv),t.defineLegacyTransformer(Sr,Hh),t.defineKeyword(Tr,Gh),t.defineOperator(gb),t.defineOperator(Ab),t.defineOperator(Rb),t.defineOperator(Lb),t.defineOperator(Ob),t.defineOperator(Sb),t.defineOperator(vb),t.defineOperator(Nb),t.defineOperator(xb),t.defineOperator(PO),t.defineOperator(SS),t.defineOperator(qS),t.defineOperator(LS),t.defineOperator(mq),t.defineOperator(xq),t.defineOperator(vq),t.defineOperator(wq),t.defineOperator(pq),t.defineOperator(fq),t.defineOperator(cq),t.defineOperator(Sq),t.defineOperator(Aq),t.defineOperator(aq),t.defineOperator(Oq),t.defineOperator(iq),t.defineOperator(nq),t.defineOperator(eq),t.defineOperator(YT),t.defineOperator(JA),t.defineOperator(eM),t.defineOperator(iM),t.defineOperator(sE(Ce,e)),t.defineOperator(iE(Ce,e)),t.defineOperator(nM),t.defineOperator(lM),t.defineOperator(hM),t.defineOperator(wM),t.defineOperator(Q$),t.defineOperator(J$),t.defineOperator(sE(Pe,e)),t.defineOperator(iE(Pe,e)),t.defineOperator(G$),t.defineOperator(V$),t.defineOperator(K$),t.defineOperator(C$),t.defineOperator(PL),t.defineOperator(QL),t.defineOperator(sE(De,e)),t.defineOperator(iE(De,e)),t.defineOperator(GL),t.defineOperator(KL),t.defineOperator(DL),t.defineOperator(Uv),t.defineOperator(qi),t.defineOperator($h),t.defineOperator(qh),t.defineOperator(zw),t.defineOperator(Yw),t.defineOperator(a_),t.defineOperator(e_),t.defineOperator(n_),t.defineOperator(c_),t.defineOperator(h_),t.defineOperator(g_),t.defineOperator(Vw),t.defineOperator(xy),t.defineOperator(Ey),t.defineLegacyTransformer(lr,Kb),t.defineOperator(qy),t.defineOperator(Ny),t.defineOperator(ky),t.defineOperator(Iy),t.defineOperator(Uy),t.defineOperator(By),t.defineOperator(Gy),t.defineOperator(Xy),t.defineOperator(rv),t.defineOperator(lv),t.defineOperator(dv),t.defineOperator(_v),t.defineOperator(Ov),t.defineOperator(jy),t.defineOperator(Mv),t.defineOperator(qv),t.defineOperator($v),t.defineOperator(kv),t.defineOperator(Kv),t.defineOperator(Qv),t.defineOperator(Dv),t.defineOperator(sb),t.defineOperator(ob),t.defineOperator(ub),t.defineOperator(lb),t.defineOperator(hb),t.defineOperator(Vb),t.defineOperator(Jb),t.defineOperator(aO),t.defineOperator(cO),t.defineOperator(sO),t.defineOperator(rO),t.defineOperator(fO),t.defineOperator(pO),t.defineOperator(_O),t.defineOperator(sE(dO,e)),t.defineOperator(iE(dO,e)),t.defineOperator(gO),t.defineOperator(RO),t.defineOperator(UO),t.defineOperator(HO),t.defineOperator(DO),t.defineOperator(KO),t.defineOperator(ZO),t.defineOperator(jO),t.defineOperator(JO),t.defineOperator(YO),t.defineOperator(lE),t.defineOperator(hE),t.defineOperator(qE),t.defineOperator(OE),t.defineOperator(SE),t.defineOperator(NE),t.defineOperator(LE),t.defineOperator(FE),t.defineOperator(HE),t.defineOperator(jE),t.defineOperator(JE),t.defineOperator(KE),t.defineOperator(oS),t.defineOperator(uS),t.defineOperator(lS),t.defineOperator(pS),t.defineOperator(mS),t.defineOperator(wS),t.defineOperator(yS),t.defineOperator(bS),t.defineOperator(IS),t.defineOperator(BS),t.defineOperator(GS),t.defineOperator(WS),t.defineOperator(tT),t.defineOperator(nT),t.defineOperator(oT),t.defineOperator(lT),t.defineOperator(FT),t.defineOperator(BT),t.defineOperator(QT),t.defineOperator(yT),t.defineOperator(dT),t.defineOperator(ET),t.defineOperator(AT),t.defineOperator(RT),t.defineOperator(zS),t.defineOperator(JT),t.defineOperator(Nq),t.defineOperator(Iq),t.defineOperator(Lq),t.defineOperator(Qq),t.defineOperator(HA),t.defineOperator(QA),t.defineOperator($$),t.defineOperator(k$),t.defineOperator(I$),t.defineLegacyTransformer(vn,xd),t.defineOperator(F$),t.defineOperator(yL),t.defineOperator(_L),t.defineLegacyTransformer(qn,Tm),t.defineOperator(ML("print",(()=>tr.printMode))),t.defineOperator(ML("printascii",(()=>We))),t.defineOperator(ML("printhuman",(()=>Xe))),t.defineOperator(ML("printinfix",(()=>Je))),t.defineOperator(ML("printlatex",(()=>je))),t.defineOperator(ML("printsexpr",(()=>Ye))),t.defineOperator(TL("print",(()=>tr.printMode))),t.defineOperator(TL("printascii",(()=>We))),t.defineOperator(TL("printhuman",(()=>Xe))),t.defineOperator(TL("printinfix",(()=>Je))),t.defineOperator(TL("printlatex",(()=>je))),t.defineOperator(TL("printsexpr",(()=>Ye))),t.defineOperator($L),t.defineLegacyTransformer(Ln,LL),t.defineOperator(RL),t.defineOperator(UL),t.defineOperator(WL),t.defineOperator(rk),t.defineOperator(ok),t.defineOperator(ck),t.defineOperator(pk),t.defineOperator(mk),t.defineOperator(xk),t.defineOperator(Ok),t.defineOperator(Lk),t.defineOperator(Fk),t.defineOperator(Ck),t.defineOperator(Kk),t.defineOperator(Qk),t.defineOperator(XL),t.defineOperator(Bq),t.defineOperator(Uq),t.defineOperator(Xq),t.defineOperator(rA),t.defineOperator(uA),t.defineOperator(lA),t.defineOperator(hA),t.defineOperator(dA),t.defineOperator(gA),t.defineOperator(yA),t.defineOperator(MA),t.defineOperator(kA),t.defineOperator(EA),t.defineOperator(Vq),t.defineOperator(IA),t.defineOperator(FA),t.defineOperator(CA),t.defineOperator((n=Fn,new DA(n))),t.defineOperator(sA),t.defineOperator(jk),t.defineOperator(Yk),t.defineLegacyTransformer(Cn,km),t.defineOperator(eR),t.defineOperator(sR),t.defineOperator(oR),t.defineOperator(uR),t.defineOperator(fR),t.defineOperator(iy),t.defineOperator(mR),t.defineOperator(_R),t.defineOperator(FR),t.defineOperator(CR),t.defineOperator(BR),t.defineOperator(IR),t.defineOperator(lI),t.defineOperator(uI),t.defineOperator(OR),t.defineOperator(kR),t.defineOperator(MR),t.defineOperator($R),t.defineOperator(qR),t.defineOperator(ZR),t.defineOperator(zR),t.defineOperator(jR),t.defineOperator(tI),t.defineOperator(rI),t.defineOperator(sI),t.defineOperator(JR),t.defineOperator(oI),t.defineOperator(pI),t.defineOperator(UI),t.defineOperator(AI),t.defineOperator($I),t.defineOperator(II),t.defineOperator(bU),t.defineOperator(xU),t.defineOperator(gU),t.defineOperator(BI),t.defineLegacyTransformer(r,Fb),t.defineLegacyTransformer(rs,Db),t.defineOperator(jI),t.defineOperator(YI),t.defineOperator(eP),t.defineOperator(JI),t.defineLegacyTransformer(ns,Bb),t.defineLegacyTransformer(ts,Ub),t.defineOperator(ZI),t.defineOperator(HI),t.defineOperator(zI),t.defineLegacyTransformer(es,Cb),t.defineOperator(nP),t.defineOperator(wI),t.defineOperator(xI),t.defineOperator(EI),t.defineOperator(vI),t.defineOperator(mI),t.defineOperator($x),t.defineOperator(mh),t.defineOperator(W_),t.defineOperator(FS),t.defineOperator(IE),t.defineOperator(GT),t.defineOperator(EU),t.defineOperator(TU),t.defineOperator(MU),t.defineOperator(M$),t.defineOperator(Zb);var n})(t),t.buildOperators(),Zh(`${ws.text}=${_s}`,t),e&&e.useDefinitions&&Qh(t)}(r,t);return{clearBindings(){r.clearBindings()},defineFunction(t,e){return r.defineFunction(t,e),this},getSymbolProps:t=>r.getSymbolProps(t),getSymbolValue:t=>r.getSymbolValue(t),getSymbolsInfo:()=>r.getSymbolsInfo(),evaluate:t=>xC(t,r),useStandardDefinitions(){Qh(r)},executeScript(e,n){const s={syntaxKind:cf.Native};return t&&(t.syntaxKind&&(s.syntaxKind=t.syntaxKind),t.disable),n&&n.syntaxKind&&(s.syntaxKind=n.syntaxKind),function(t,e,r,n){const{trees:s,errors:i}=hf(t,e,r);if(i.length>0)return{values:[],prints:[],errors:i};const o=[],a=[];try{for(const t of s){const e=xC(t,n);e.value&&(p(e.value)||o.push(e.value));for(const t of e.prints)a.push(t);for(const t of e.errors)i.push(t)}}catch(t){t instanceof Error?i.push(t):i.push(new Error(`${t}`))}return{values:o,prints:a,errors:i}}("",e,function(t,e){return t?{syntaxKind:t.syntaxKind,useCaretForExponentiation:e.getNativeDirective($.useCaretForExponentiation),explicitAssocAdd:!1,explicitAssocMul:!1}:{syntaxKind:cf.Native,useCaretForExponentiation:!1,explicitAssocAdd:!1,explicitAssocMul:!1}}(s,r),r)},renderAsAscii:t=>$g(t,r),renderAsInfix:t=>Rw(t,r),renderAsHuman:t=>vL(t,r),renderAsLaTeX:t=>Iw(t,r),renderAsSExpr:t=>sw(t,r),addRef(){e++},release(){e--,0===e&&function(t){t.clearBindings(),t.clearOperators()}(r)}}},create_str:function(t){return new re(t)},create_sym:B,create_tensor:b,create_uom:Ne,human_readable_syntax_kind:lf,is_atom:f,is_blade:Z,is_boo:W,is_cons:h,is_flt:ot,is_hyp:ct,is_imu:ht,is_nil:p,is_num:ee,is_rat:te,is_str:se,is_sym:ie,is_tensor:v,is_uom:Me,items_to_cons:c,native_sym:Q,parse_expr:function(t,e){const{trees:r,errors:n}=hf("",t,e);if(0==n.length){if(r.length>0)return r[0];throw new Error}throw n[1]},parse_script:hf});class a{constructor(t,e,o,a,u){this.pos=a,this.end=u,n.set(this,void 0),s.set(this,void 0),i.set(this,void 0),r(this,n,e,"f"),r(this,s,o,"f"),r(this,i,t,"f")}get meta(){return e(this,i,"f")}set meta(t){r(this,i,t,"f")}get name(){return e(this,n,"f")?"Cons":"Nil"}get car(){return e(this,n,"f")?e(this,n,"f"):l}get cdr(){if(e(this,s,"f")){if(e(this,s,"f")instanceof a)return e(this,s,"f");throw new Error}return l}get argList(){return this.cdr}contains(t){return!(this!==t&&!this.equals(t))||!(!e(this,n,"f")||!e(this,s,"f"))&&(e(this,n,"f").contains(t)||e(this,s,"f").contains(t))}equals(t){return this===t||!!h(t)&&function(t,e){let r=t,n=e;for(;;){if(h(r)&&h(n)){if(r.car.equals(n.car)){r=r.cdr,n=n.cdr;continue}return!1}return!h(r)&&(!h(n)&&!!r.equals(n))}}(this,t)}isCons(){return!!e(this,n,"f")}isNil(){return!e(this,n,"f")}reset(t){this.meta=o(this.meta,t),e(this,n,"f")&&e(this,n,"f").reset(t),e(this,s,"f")&&e(this,s,"f").reset(t)}toString(){const t=e(this,n,"f"),r=e(this,s,"f");return t?`(${t} ${r})`:"()"}*[(n=new WeakMap,s=new WeakMap,i=new WeakMap,Symbol.iterator)](){let t=this;for(;h(t);)yield t.car,t=t.cdr}get head(){return this.car}tail(){if(this!==l){const t=e(this,s,"f");return t&&h(t)?[...t]:[]}throw new Error("tail property is not allowed for the empty list.")}map(t){if(this!==l){const e=this.car,r=this.cdr;return new a(0,t(e),h(r)?r.map(t):r)}return l}get length(){if(this!==l){const t=this.argList;return h(t)?t.length+1:1}return 0}get opr(){return this.item(0)}get arg(){return this.item(1)}get lhs(){return this.item(1)}get rhs(){return this.item(2)}item(t){if(t>=0&&this!==l){if(0===t)return this.car;{const e=this.argList;if(h(e))return e.item(t-1)}}throw new Error("index out of bounds.")}}function u(t,e){if(e instanceof a)return new a(0,t,e);throw new Error}function c(...t){let e=l;for(let r=t.length-1;r>=0;r--)e=new a(0,t[r],e);return e}t("Cons",a);const l=t("nil",new a(0,void 0,void 0));function f(t){return!h(t)&&!p(t)}function h(t){return void 0!==t&&(t instanceof a&&!p(t))}function p(t){return t.equals(l)}function d(t){return h(t)?t.car:l}function m(t){return h(t)?t.cdr:l}var g,w,_;class x{constructor(t,e,r){this.name=t,this.pos=e,this.end=r,g.set(this,0)}reset(t){r(this,g,o(e(this,g,"f"),t),"f")}get meta(){return e(this,g,"f")}set meta(t){r(this,g,t,"f")}contains(t){return this.equals(t)}equals(t){throw new Error(`Atom(name=${this.name}).equals(other=${t}) Method not implemented.`)}isCons(){return!1}isNil(){return!1}}t("Atom",x),g=new WeakMap;class y extends x{constructor(t,e,n,s){super("Tensor",n,s),w.set(this,void 0),_.set(this,void 0),r(this,w,t,"f"),r(this,_,e,"f")}get rank(){for(const t of e(this,_,"f"))if(v(t))return e(this,w,"f").length+t.rank;return e(this,w,"f").length}get ndim(){return e(this,w,"f").length}get nelem(){return e(this,_,"f").length}contains(t){return!!this.equals(t)||this.someElements((function(e){return e.contains(t)}))}copyDimensions(){return[...e(this,w,"f")]}copyElements(){return[...e(this,_,"f")]}dim(t){if(t<0)throw new Error("n must be greater than or equal to zero.");if(t>e(this,w,"f").length-1)throw new Error("n + 1 must be less than ndim.");return e(this,w,"f")[t]}elem(t){return e(this,_,"f")[t]}equals(t){return!!(t instanceof y&&function(t,e){if(t.length===e.length){for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}(e(this,w,"f"),e(t,w,"f"))&&function(t,e){if(t.length===e.length){for(let r=0;r<t.length;r++)if(!t[r].equals(e[r]))return!1;return!0}return!1}(e(this,_,"f"),e(t,_,"f")))}everyElement(t){return e(this,_,"f").every(t)}filterElements(t){return e(this,_,"f").filter(t)}map(t){return this.withElements(e(this,_,"f").map(t))}mapElements(t){return e(this,_,"f").map(t)}isCons(){return!1}isNil(){return!1}sameDimensions(t){return this.ndim===t.ndim&&e(this,w,"f").every(((e,r)=>e===t.dim(r)))}sliceDimensions(t,r){return e(this,w,"f").slice(t,r)}someElements(t){return e(this,_,"f").some(t)}toInfixString(){return"<tensor>"}toListString(){return"<tensor>"}toString(){return`${this.name}(ndim=${this.ndim}, dim=[${e(this,w,"f")}], elems=[${e(this,_,"f").map((function(t){return`${t}`})).join(",")}])`}withElements(t){return new y(e(this,w,"f"),t)}}function v(t){return t instanceof y}function b(t){if(t.length>0){const e=[t.length],r=[];let n=!1;for(let s=0;s<t.length;s++){const i=t[s];if(v(i)){const t=i;if(n);else{for(let r=0;r<t.ndim;r++)e[r+1]=t.dim(r);n=!0}for(let e=0;e<t.nelem;e++)r.push(t.elem(e))}else r.push(i)}return new y(e,r)}return new y([0],[])}t("Tensor",y),w=new WeakMap,_=new WeakMap;const O=-1,E=0,S=1,T=0,q=1,A=2,M=4;function N(t){return(t&q)===q}var $;t("Directive",$),function(t){t[t.expand=0]="expand",t[t.evaluatingAsFloat=1]="evaluatingAsFloat",t[t.evaluatingAsPolar=2]="evaluatingAsPolar",t[t.evaluatingAsClock=3]="evaluatingAsClock",t[t.evaluatingTrigAsExp=4]="evaluatingTrigAsExp",t[t.keepZeroTermsInSums=5]="keepZeroTermsInSums",t[t.factor=6]="factor",t[t.renderFloatAsEcmaScript=7]="renderFloatAsEcmaScript",t[t.useCaretForExponentiation=8]="useCaretForExponentiation"}($||t("Directive",$={}));const L=1,k=2,R=[L,k],I=L|k,P=L|k;var F,U;t("Native",F),function(t){t[t.E=0]="E",t[t.IMU=1]="IMU",t[t.MASH=2]="MASH",t[t.NIL=3]="NIL",t[t.PI=4]="PI",t[t.abs=5]="abs",t[t.add=6]="add",t[t.arctan=7]="arctan",t[t.arg=8]="arg",t[t.conj=9]="conj",t[t.cos=10]="cos",t[t.divide=11]="divide",t[t.exp=12]="exp",t[t.imag=13]="imag",t[t.inner=14]="inner",t[t.inverse=15]="inverse",t[t.is_complex=16]="is_complex",t[t.is_real=17]="is_real",t[t.is_zero=18]="is_zero",t[t.lco=19]="lco",t[t.log=20]="log",t[t.mod=21]="mod",t[t.multiply=22]="multiply",t[t.outer=23]="outer",t[t.pow=24]="pow",t[t.real=25]="real",t[t.rect=26]="rect",t[t.rco=27]="rco",t[t.sin=28]="sin",t[t.spread=29]="spread",t[t.subtract=30]="subtract",t[t.succ=31]="succ",t[t.tau=32]="tau",t[t.test_eq=33]="test_eq",t[t.test_ge=34]="test_ge",t[t.test_gt=35]="test_gt",t[t.test_le=36]="test_le",t[t.test_lt=37]="test_lt",t[t.test_ne=38]="test_ne"}(F||t("Native",F={}));const C=Math.random(),D=new Map;function B(t,e,r){const n=D.get(t);if(n)return n;const s=new K(C,t,e,r);return D.set(t,s),s}class K extends x{constructor(t,e,n,s){if(super("Sym",n,s),U.set(this,void 0),r(this,U,e,"f"),t!==C)throw new Error("Sym instances must be created using the create_sym function.")}compare(t){return r=e(this,U,"f"),n=e(t,U,"f"),r===n?0:r>n?1:-1;var r,n}contains(t){return t instanceof K&&this.equalsSym(t)}clone(t,r){return B(e(this,U,"f"),t,r)}equals(t){return t instanceof K&&this.equalsSym(t)}equalsSym(t){return this===t||e(this,U,"f")===e(t,U,"f")}key(){return e(this,U,"f")}get text(){return e(this,U,"f")}toString(){return e(this,U,"f")}}t("Sym",K),U=new WeakMap;const z=new Map;function Q(t){const e=z.get(t);if(e)return e;{const e=function(t){switch(t){case F.E:return B("E");case F.IMU:return B("IMU");case F.MASH:return B("MASH");case F.NIL:return B("NIL");case F.PI:return B("PI");case F.abs:return B("abs");case F.add:return B("add");case F.arctan:return B("arctan");case F.arg:return B("arg");case F.conj:return B("conj");case F.cos:return B("cos");case F.divide:return B("/");case F.exp:return B("exp");case F.imag:return B("imag");case F.inner:return B("inner");case F.inverse:return B("inv");case F.is_complex:return B("iscomplex");case F.is_real:return B("isreal");case F.is_zero:return B("iszero");case F.lco:return B("<<");case F.log:return B("log");case F.mod:return B("mod");case F.multiply:return B("*");case F.outer:return B("outer");case F.pow:return B("pow");case F.real:return B("real");case F.rect:return B("rect");case F.rco:return B(">>");case F.sin:return B("sin");case F.spread:return B("...");case F.subtract:return B("-");case F.succ:return B("succ");case F.tau:return B("tau");case F.test_eq:return B("==");case F.test_ge:return B(">=");case F.test_gt:return B(">");case F.test_le:return B("<=");case F.test_lt:return B("<");case F.test_ne:return B("!=");default:throw new Error(`${t}`)}}(t);return z.set(t,e),e}}function Z(t){if("object"==typeof t){return"Blade"===t.name}return!1}class G extends x{constructor(t,e,r){super("Boo",e,r),this.b=t}equals(t){return this===t||t instanceof G&&this.equalsBoo(t)}equalsBoo(t){return this.b===t.b}isTrue(){return this.b}toString(){return this.b?`${this.name}(true)`:`${this.name}(false)`}static valueOf(t){return t?V:j}}function H(t){return G.valueOf(t)}t("Boo",G);const V=t("booT",new G(!0)),j=t("booF",new G(!1));function W(t){return t instanceof G}function J(t,e,r){return t===Y.d?Y:t===tt.d?tt:t===st.d?st:t===et.d?et:t===it.d?it:new X(t,e,r)}class X extends x{constructor(t,e,r){super("Flt",e,r),this.d=t}abs(){return this.d>=0?this:this.neg()}add(t){return J(this.d+t.d)}compare(t){return this.d>t.d?1:this.d<t.d?-1:0}equals(t){return this===t||t instanceof X&&this.equalsFlt(t)}equalsFlt(t){return this.d===t.d}inv(){return new X(1/this.d,this.pos,this.end)}isNegative(){return this.d<0}isMinusOne(){return-1===this.d}isOne(){return 1===this.d}isPositive(){return this.d>0}isZero(){return 0===this.d}mul(t){return J(this.d*t.d)}neg(){return J(-this.d)}sub(t){return J(this.d-t.d)}toInfixString(){return`${this.d}`}toListString(){return`${this.d}`}toNumber(){return this.d}toString(){return`${this.name}(${this.d})`}}t("Flt",X);const Y=t("zeroAsFlt",new X(0)),tt=t("oneAsFlt",new X(1)),et=new X(2),rt=new X(Math.PI);new X(1e-6);const nt=new X(Math.E),st=new X(-1),it=new X(-2);function ot(t){return t instanceof X}class at extends x{constructor(t,e,r){super("Hyp",e,r),this.printname=t}equals(t){return t instanceof at&&this.equalsHyp(t)}equalsHyp(t){return this===t||this.printname===t.printname}toInfixString(){throw new Error("Hyp Method not implemented.")}toListString(){throw new Error("Hyp Method not implemented.")}toString(){return`${this.name}()`}}t("Hyp",at);const ut=t("epsilon",new at("ε"));t("delta",new at("δ"));function ct(t){return t instanceof at}class lt extends x{constructor(t,e){super("Imu",t,e)}equals(t){return this===t||t instanceof lt}toString(){return"i"}}t("Imu",lt);const ft=t("imu",new lt);function ht(t){return t instanceof lt}var pt,dt,mt={};pt={get exports(){return mt},set exports(t){mt=t}},dt=function(t){var e=1e7,r=7,n=9007199254740992,s=h(n),i="0123456789abcdefghijklmnopqrstuvwxyz",o="function"==typeof BigInt;function a(t,e,r,n){return void 0===t?a[0]:void 0===e||10==+e&&!r?W(t):Z(t,e,r,n)}function u(t,e){this.value=t,this.sign=e,this.isSmall=!1}function c(t){this.value=t,this.sign=t<0,this.isSmall=!0}function l(t){this.value=t}function f(t){return-n<t&&t<n}function h(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function p(t){d(t);var r=t.length;if(r<4&&N(t,s)<0)switch(r){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function d(t){for(var e=t.length;0===t[--e];);t.length=e+1}function m(t){for(var e=new Array(t),r=-1;++r<t;)e[r]=0;return e}function g(t){return t>0?Math.floor(t):Math.ceil(t)}function w(t,r){var n,s,i=t.length,o=r.length,a=new Array(i),u=0,c=e;for(s=0;s<o;s++)u=(n=t[s]+r[s]+u)>=c?1:0,a[s]=n-u*c;for(;s<i;)u=(n=t[s]+u)===c?1:0,a[s++]=n-u*c;return u>0&&a.push(u),a}function _(t,e){return t.length>=e.length?w(t,e):w(e,t)}function x(t,r){var n,s,i=t.length,o=new Array(i),a=e;for(s=0;s<i;s++)n=t[s]-a+r,r=Math.floor(n/a),o[s]=n-r*a,r+=1;for(;r>0;)o[s++]=r%a,r=Math.floor(r/a);return o}function y(t,r){var n,s,i=t.length,o=r.length,a=new Array(i),u=0,c=e;for(n=0;n<o;n++)(s=t[n]-u-r[n])<0?(s+=c,u=1):u=0,a[n]=s;for(n=o;n<i;n++){if(!((s=t[n]-u)<0)){a[n++]=s;break}s+=c,a[n]=s}for(;n<i;n++)a[n]=t[n];return d(a),a}function v(t,r,n){var s,i,o=t.length,a=new Array(o),l=-r,f=e;for(s=0;s<o;s++)i=t[s]+l,l=Math.floor(i/f),i%=f,a[s]=i<0?i+f:i;return"number"==typeof(a=p(a))?(n&&(a=-a),new c(a)):new u(a,n)}function b(t,r){var n,s,i,o,a=t.length,u=r.length,c=m(a+u),l=e;for(i=0;i<a;++i){o=t[i];for(var f=0;f<u;++f)n=o*r[f]+c[i+f],s=Math.floor(n/l),c[i+f]=n-s*l,c[i+f+1]+=s}return d(c),c}function O(t,r){var n,s,i=t.length,o=new Array(i),a=e,u=0;for(s=0;s<i;s++)n=t[s]*r+u,u=Math.floor(n/a),o[s]=n-u*a;for(;u>0;)o[s++]=u%a,u=Math.floor(u/a);return o}function E(t,e){for(var r=[];e-- >0;)r.push(0);return r.concat(t)}function S(t,e){var r=Math.max(t.length,e.length);if(r<=30)return b(t,e);r=Math.ceil(r/2);var n=t.slice(r),s=t.slice(0,r),i=e.slice(r),o=e.slice(0,r),a=S(s,o),u=S(n,i),c=S(_(s,n),_(o,i)),l=_(_(a,E(y(y(c,a),u),r)),E(u,2*r));return d(l),l}function T(t,r,n){return new u(t<e?O(r,t):b(r,h(t)),n)}function q(t){var r,n,s,i,o=t.length,a=m(o+o),u=e;for(s=0;s<o;s++){n=0-(i=t[s])*i;for(var c=s;c<o;c++)r=i*t[c]*2+a[s+c]+n,n=Math.floor(r/u),a[s+c]=r-n*u;a[s+o]=n}return d(a),a}function A(t,r){var n,s,i,o,a=t.length,u=m(a),c=e;for(i=0,n=a-1;n>=0;--n)i=(o=i*c+t[n])-(s=g(o/r))*r,u[n]=0|s;return[u,0|i]}function M(t,r){var n,s=W(r);if(o)return[new l(t.value/s.value),new l(t.value%s.value)];var i,f=t.value,w=s.value;if(0===w)throw new Error("Cannot divide by zero");if(t.isSmall)return s.isSmall?[new c(g(f/w)),new c(f%w)]:[a[0],t];if(s.isSmall){if(1===w)return[t,a[0]];if(-1==w)return[t.negate(),a[0]];var _=Math.abs(w);if(_<e){i=p((n=A(f,_))[0]);var x=n[1];return t.sign&&(x=-x),"number"==typeof i?(t.sign!==s.sign&&(i=-i),[new c(i),new c(x)]):[new u(i,t.sign!==s.sign),new c(x)]}w=h(_)}var v=N(f,w);if(-1===v)return[a[0],t];if(0===v)return[a[t.sign===s.sign?1:-1],a[0]];n=f.length+w.length<=200?function(t,r){var n,s,i,o,a,u,c,l=t.length,f=r.length,h=e,d=m(r.length),g=r[f-1],w=Math.ceil(h/(2*g)),_=O(t,w),x=O(r,w);for(_.length<=l&&_.push(0),x.push(0),g=x[f-1],s=l-f;s>=0;s--){for(n=h-1,_[s+f]!==g&&(n=Math.floor((_[s+f]*h+_[s+f-1])/g)),i=0,o=0,u=x.length,a=0;a<u;a++)i+=n*x[a],c=Math.floor(i/h),o+=_[s+a]-(i-c*h),i=c,o<0?(_[s+a]=o+h,o=-1):(_[s+a]=o,o=0);for(;0!==o;){for(n-=1,i=0,a=0;a<u;a++)(i+=_[s+a]-h+x[a])<0?(_[s+a]=i+h,i=0):(_[s+a]=i,i=1);o+=i}d[s]=n}return _=A(_,w)[0],[p(d),p(_)]}(f,w):function(t,r){for(var n,s,i,o,a,u=t.length,c=r.length,l=[],f=[],h=e;u;)if(f.unshift(t[--u]),d(f),N(f,r)<0)l.push(0);else{i=f[(s=f.length)-1]*h+f[s-2],o=r[c-1]*h+r[c-2],s>c&&(i=(i+1)*h),n=Math.ceil(i/o);do{if(N(a=O(r,n),f)<=0)break;n--}while(n);l.push(n),f=y(f,a)}return l.reverse(),[p(l),p(f)]}(f,w),i=n[0];var b=t.sign!==s.sign,E=n[1],S=t.sign;return"number"==typeof i?(b&&(i=-i),i=new c(i)):i=new u(i,b),"number"==typeof E?(S&&(E=-E),E=new c(E)):E=new u(E,S),[i,E]}function N(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var r=t.length-1;r>=0;r--)if(t[r]!==e[r])return t[r]>e[r]?1:-1;return 0}function $(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function L(t,e){for(var r,n,s,i=t.prev(),o=i,a=0;o.isEven();)o=o.divide(2),a++;t:for(n=0;n<e.length;n++)if(!t.lesser(e[n])&&!(s=dt(e[n]).modPow(o,t)).isUnit()&&!s.equals(i)){for(r=a-1;0!=r;r--){if((s=s.square().mod(t)).isUnit())return!1;if(s.equals(i))continue t}return!1}return!0}u.prototype=Object.create(a.prototype),c.prototype=Object.create(a.prototype),l.prototype=Object.create(a.prototype),u.prototype.add=function(t){var e=W(t);if(this.sign!==e.sign)return this.subtract(e.negate());var r=this.value,n=e.value;return e.isSmall?new u(x(r,Math.abs(n)),this.sign):new u(_(r,n),this.sign)},u.prototype.plus=u.prototype.add,c.prototype.add=function(t){var e=W(t),r=this.value;if(r<0!==e.sign)return this.subtract(e.negate());var n=e.value;if(e.isSmall){if(f(r+n))return new c(r+n);n=h(Math.abs(n))}return new u(x(n,Math.abs(r)),r<0)},c.prototype.plus=c.prototype.add,l.prototype.add=function(t){return new l(this.value+W(t).value)},l.prototype.plus=l.prototype.add,u.prototype.subtract=function(t){var e=W(t);if(this.sign!==e.sign)return this.add(e.negate());var r=this.value,n=e.value;return e.isSmall?v(r,Math.abs(n),this.sign):function(t,e,r){var n;return N(t,e)>=0?n=y(t,e):(n=y(e,t),r=!r),"number"==typeof(n=p(n))?(r&&(n=-n),new c(n)):new u(n,r)}(r,n,this.sign)},u.prototype.minus=u.prototype.subtract,c.prototype.subtract=function(t){var e=W(t),r=this.value;if(r<0!==e.sign)return this.add(e.negate());var n=e.value;return e.isSmall?new c(r-n):v(n,Math.abs(r),r>=0)},c.prototype.minus=c.prototype.subtract,l.prototype.subtract=function(t){return new l(this.value-W(t).value)},l.prototype.minus=l.prototype.subtract,u.prototype.negate=function(){return new u(this.value,!this.sign)},c.prototype.negate=function(){var t=this.sign,e=new c(-this.value);return e.sign=!t,e},l.prototype.negate=function(){return new l(-this.value)},u.prototype.abs=function(){return new u(this.value,!1)},c.prototype.abs=function(){return new c(Math.abs(this.value))},l.prototype.abs=function(){return new l(this.value>=0?this.value:-this.value)},u.prototype.multiply=function(t){var r,n,s,i=W(t),o=this.value,c=i.value,l=this.sign!==i.sign;if(i.isSmall){if(0===c)return a[0];if(1===c)return this;if(-1===c)return this.negate();if((r=Math.abs(c))<e)return new u(O(o,r),l);c=h(r)}return n=o.length,s=c.length,new u(-.012*n-.012*s+15e-6*n*s>0?S(o,c):b(o,c),l)},u.prototype.times=u.prototype.multiply,c.prototype._multiplyBySmall=function(t){return f(t.value*this.value)?new c(t.value*this.value):T(Math.abs(t.value),h(Math.abs(this.value)),this.sign!==t.sign)},u.prototype._multiplyBySmall=function(t){return 0===t.value?a[0]:1===t.value?this:-1===t.value?this.negate():T(Math.abs(t.value),this.value,this.sign!==t.sign)},c.prototype.multiply=function(t){return W(t)._multiplyBySmall(this)},c.prototype.times=c.prototype.multiply,l.prototype.multiply=function(t){return new l(this.value*W(t).value)},l.prototype.times=l.prototype.multiply,u.prototype.square=function(){return new u(q(this.value),!1)},c.prototype.square=function(){var t=this.value*this.value;return f(t)?new c(t):new u(q(h(Math.abs(this.value))),!1)},l.prototype.square=function(t){return new l(this.value*this.value)},u.prototype.divmod=function(t){var e=M(this,t);return{quotient:e[0],remainder:e[1]}},l.prototype.divmod=c.prototype.divmod=u.prototype.divmod,u.prototype.divide=function(t){return M(this,t)[0]},l.prototype.over=l.prototype.divide=function(t){return new l(this.value/W(t).value)},c.prototype.over=c.prototype.divide=u.prototype.over=u.prototype.divide,u.prototype.mod=function(t){return M(this,t)[1]},l.prototype.mod=l.prototype.remainder=function(t){return new l(this.value%W(t).value)},c.prototype.remainder=c.prototype.mod=u.prototype.remainder=u.prototype.mod,u.prototype.pow=function(t){var e,r,n,s=W(t),i=this.value,o=s.value;if(0===o)return a[1];if(0===i)return a[0];if(1===i)return a[1];if(-1===i)return s.isEven()?a[1]:a[-1];if(s.sign)return a[0];if(!s.isSmall)throw new Error("The exponent "+s.toString()+" is too large.");if(this.isSmall&&f(e=Math.pow(i,o)))return new c(g(e));for(r=this,n=a[1];!0&o&&(n=n.times(r),--o),0!==o;)o/=2,r=r.square();return n},c.prototype.pow=u.prototype.pow,l.prototype.pow=function(t){var e=W(t),r=this.value,n=e.value,s=BigInt(0),i=BigInt(1),o=BigInt(2);if(n===s)return a[1];if(r===s)return a[0];if(r===i)return a[1];if(r===BigInt(-1))return e.isEven()?a[1]:a[-1];if(e.isNegative())return new l(s);for(var u=this,c=a[1];(n&i)===i&&(c=c.times(u),--n),n!==s;)n/=o,u=u.square();return c},u.prototype.modPow=function(t,e){if(t=W(t),(e=W(e)).isZero())throw new Error("Cannot take modPow with modulus 0");var r=a[1],n=this.mod(e);for(t.isNegative()&&(t=t.multiply(a[-1]),n=n.modInv(e));t.isPositive();){if(n.isZero())return a[0];t.isOdd()&&(r=r.multiply(n).mod(e)),t=t.divide(2),n=n.square().mod(e)}return r},l.prototype.modPow=c.prototype.modPow=u.prototype.modPow,u.prototype.compareAbs=function(t){var e=W(t),r=this.value,n=e.value;return e.isSmall?1:N(r,n)},c.prototype.compareAbs=function(t){var e=W(t),r=Math.abs(this.value),n=e.value;return e.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},l.prototype.compareAbs=function(t){var e=this.value,r=W(t).value;return(e=e>=0?e:-e)===(r=r>=0?r:-r)?0:e>r?1:-1},u.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=W(t),r=this.value,n=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:N(r,n)*(this.sign?-1:1)},u.prototype.compareTo=u.prototype.compare,c.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=W(t),r=this.value,n=e.value;return e.isSmall?r==n?0:r>n?1:-1:r<0!==e.sign?r<0?-1:1:r<0?1:-1},c.prototype.compareTo=c.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,r=W(t).value;return e===r?0:e>r?1:-1},l.prototype.compareTo=l.prototype.compare,u.prototype.equals=function(t){return 0===this.compare(t)},l.prototype.eq=l.prototype.equals=c.prototype.eq=c.prototype.equals=u.prototype.eq=u.prototype.equals,u.prototype.notEquals=function(t){return 0!==this.compare(t)},l.prototype.neq=l.prototype.notEquals=c.prototype.neq=c.prototype.notEquals=u.prototype.neq=u.prototype.notEquals,u.prototype.greater=function(t){return this.compare(t)>0},l.prototype.gt=l.prototype.greater=c.prototype.gt=c.prototype.greater=u.prototype.gt=u.prototype.greater,u.prototype.lesser=function(t){return this.compare(t)<0},l.prototype.lt=l.prototype.lesser=c.prototype.lt=c.prototype.lesser=u.prototype.lt=u.prototype.lesser,u.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},l.prototype.geq=l.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals,u.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},l.prototype.leq=l.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals,u.prototype.isEven=function(){return 0==(1&this.value[0])},c.prototype.isEven=function(){return 0==(1&this.value)},l.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},u.prototype.isOdd=function(){return 1==(1&this.value[0])},c.prototype.isOdd=function(){return 1==(1&this.value)},l.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},u.prototype.isPositive=function(){return!this.sign},c.prototype.isPositive=function(){return this.value>0},l.prototype.isPositive=c.prototype.isPositive,u.prototype.isNegative=function(){return this.sign},c.prototype.isNegative=function(){return this.value<0},l.prototype.isNegative=c.prototype.isNegative,u.prototype.isUnit=function(){return!1},c.prototype.isUnit=function(){return 1===Math.abs(this.value)},l.prototype.isUnit=function(){return this.abs().value===BigInt(1)},u.prototype.isZero=function(){return!1},c.prototype.isZero=function(){return 0===this.value},l.prototype.isZero=function(){return this.value===BigInt(0)},u.prototype.isDivisibleBy=function(t){var e=W(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},l.prototype.isDivisibleBy=c.prototype.isDivisibleBy=u.prototype.isDivisibleBy,u.prototype.isPrime=function(e){var r=$(this);if(r!==t)return r;var n=this.abs(),s=n.bitLength();if(s<=64)return L(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var i=Math.log(2)*s.toJSNumber(),o=Math.ceil(!0===e?2*Math.pow(i,2):i),a=[],u=0;u<o;u++)a.push(dt(u+2));return L(n,a)},l.prototype.isPrime=c.prototype.isPrime=u.prototype.isPrime,u.prototype.isProbablePrime=function(e,r){var n=$(this);if(n!==t)return n;for(var s=this.abs(),i=e===t?5:e,o=[],a=0;a<i;a++)o.push(dt.randBetween(2,s.minus(2),r));return L(s,o)},l.prototype.isProbablePrime=c.prototype.isProbablePrime=u.prototype.isProbablePrime,u.prototype.modInv=function(t){for(var e,r,n,s=dt.zero,i=dt.one,o=W(t),a=this.abs();!a.isZero();)e=o.divide(a),r=s,n=o,s=i,o=a,i=r.subtract(e.multiply(i)),a=n.subtract(e.multiply(a));if(!o.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===s.compare(0)&&(s=s.add(t)),this.isNegative()?s.negate():s},l.prototype.modInv=c.prototype.modInv=u.prototype.modInv,u.prototype.next=function(){var t=this.value;return this.sign?v(t,1,this.sign):new u(x(t,1),this.sign)},c.prototype.next=function(){var t=this.value;return t+1<n?new c(t+1):new u(s,!1)},l.prototype.next=function(){return new l(this.value+BigInt(1))},u.prototype.prev=function(){var t=this.value;return this.sign?new u(x(t,1),!0):v(t,1,this.sign)},c.prototype.prev=function(){var t=this.value;return t-1>-n?new c(t-1):new u(s,!0)},l.prototype.prev=function(){return new l(this.value-BigInt(1))};for(var k=[1];2*k[k.length-1]<=e;)k.push(2*k[k.length-1]);var R=k.length,I=k[R-1];function P(t){return Math.abs(t)<=e}function F(t,e,r){e=W(e);for(var n=t.isNegative(),s=e.isNegative(),i=n?t.not():t,o=s?e.not():e,a=0,u=0,c=null,l=null,f=[];!i.isZero()||!o.isZero();)a=(c=M(i,I))[1].toJSNumber(),n&&(a=I-1-a),u=(l=M(o,I))[1].toJSNumber(),s&&(u=I-1-u),i=c[0],o=l[0],f.push(r(a,u));for(var h=0!==r(n?1:0,s?1:0)?dt(-1):dt(0),p=f.length-1;p>=0;p-=1)h=h.multiply(I).add(dt(f[p]));return h}u.prototype.shiftLeft=function(t){var e=W(t).toJSNumber();if(!P(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var r=this;if(r.isZero())return r;for(;e>=R;)r=r.multiply(I),e-=R-1;return r.multiply(k[e])},l.prototype.shiftLeft=c.prototype.shiftLeft=u.prototype.shiftLeft,u.prototype.shiftRight=function(t){var e,r=W(t).toJSNumber();if(!P(r))throw new Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=R;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(e=M(n,I))[1].isNegative()?e[0].prev():e[0],r-=R-1}return(e=M(n,k[r]))[1].isNegative()?e[0].prev():e[0]},l.prototype.shiftRight=c.prototype.shiftRight=u.prototype.shiftRight,u.prototype.not=function(){return this.negate().prev()},l.prototype.not=c.prototype.not=u.prototype.not,u.prototype.and=function(t){return F(this,t,(function(t,e){return t&e}))},l.prototype.and=c.prototype.and=u.prototype.and,u.prototype.or=function(t){return F(this,t,(function(t,e){return t|e}))},l.prototype.or=c.prototype.or=u.prototype.or,u.prototype.xor=function(t){return F(this,t,(function(t,e){return t^e}))},l.prototype.xor=c.prototype.xor=u.prototype.xor;var U=1<<30,C=(e&-e)*(e&-e)|U;function D(t){var r=t.value,n="number"==typeof r?r|U:"bigint"==typeof r?r|BigInt(U):r[0]+r[1]*e|C;return n&-n}function B(t,e){if(e.compareTo(t)<=0){var r=B(t,e.square(e)),n=r.p,s=r.e,i=n.multiply(e);return i.compareTo(t)<=0?{p:i,e:2*s+1}:{p:n,e:2*s}}return{p:dt(1),e:0}}function K(t,e){return t=W(t),e=W(e),t.greater(e)?t:e}function z(t,e){return t=W(t),e=W(e),t.lesser(e)?t:e}function Q(t,e){if(t=W(t).abs(),e=W(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var r,n,s=a[1];t.isEven()&&e.isEven();)r=z(D(t),D(e)),t=t.divide(r),e=e.divide(r),s=s.multiply(r);for(;t.isEven();)t=t.divide(D(t));do{for(;e.isEven();)e=e.divide(D(e));t.greater(e)&&(n=e,e=t,t=n),e=e.subtract(t)}while(!e.isZero());return s.isUnit()?t:t.multiply(s)}u.prototype.bitLength=function(){var t=this;return t.compareTo(dt(0))<0&&(t=t.negate().subtract(dt(1))),0===t.compareTo(dt(0))?dt(0):dt(B(t,dt(2)).e).add(dt(1))},l.prototype.bitLength=c.prototype.bitLength=u.prototype.bitLength;var Z=function(t,e,r,n){r=r||i,t=String(t),n||(t=t.toLowerCase(),r=r.toLowerCase());var s,o=t.length,a=Math.abs(e),u={};for(s=0;s<r.length;s++)u[r[s]]=s;for(s=0;s<o;s++)if("-"!==(f=t[s])&&f in u&&u[f]>=a){if("1"===f&&1===a)continue;throw new Error(f+" is not a valid digit in base "+e+".")}e=W(e);var c=[],l="-"===t[0];for(s=l?1:0;s<t.length;s++){var f;if((f=t[s])in u)c.push(W(u[f]));else{if("<"!==f)throw new Error(f+" is not a valid character");var h=s;do{s++}while(">"!==t[s]&&s<t.length);c.push(W(t.slice(h+1,s)))}}return G(c,e,l)};function G(t,e,r){var n,s=a[0],i=a[1];for(n=t.length-1;n>=0;n--)s=s.add(t[n].times(i)),i=i.times(e);return r?s.negate():s}function H(t,e){if((e=dt(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var n=!1;if(t.isNegative()&&e.isPositive()&&(n=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:n};for(var s,i=[],o=t;o.isNegative()||o.compareAbs(e)>=0;){s=o.divmod(e),o=s.quotient;var a=s.remainder;a.isNegative()&&(a=e.minus(a).abs(),o=o.next()),i.push(a.toJSNumber())}return i.push(o.toJSNumber()),{value:i.reverse(),isNegative:n}}function V(t,e,r){var n=H(t,e);return(n.isNegative?"-":"")+n.value.map((function(t){return function(t,e){return t<(e=e||i).length?e[t]:"<"+t+">"}(t,r)})).join("")}function j(t){if(f(+t)){var e=+t;if(e===g(e))return o?new l(BigInt(e)):new c(e);throw new Error("Invalid integer: "+t)}var n="-"===t[0];n&&(t=t.slice(1));var s=t.split(/e/i);if(s.length>2)throw new Error("Invalid integer: "+s.join("e"));if(2===s.length){var i=s[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==g(i)||!f(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var a=s[0],h=a.indexOf(".");if(h>=0&&(i-=a.length-h-1,a=a.slice(0,h)+a.slice(h+1)),i<0)throw new Error("Cannot include negative exponent part for integers");t=a+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(o)return new l(BigInt(n?"-"+t:t));for(var p=[],m=t.length,w=r,_=m-w;m>0;)p.push(+t.slice(_,m)),(_-=w)<0&&(_=0),m-=w;return d(p),new u(p,n)}function W(t){return"number"==typeof t?function(t){if(o)return new l(BigInt(t));if(f(t)){if(t!==g(t))throw new Error(t+" is not an integer.");return new c(t)}return j(t.toString())}(t):"string"==typeof t?j(t):"bigint"==typeof t?new l(t):t}u.prototype.toArray=function(t){return H(this,t)},c.prototype.toArray=function(t){return H(this,t)},l.prototype.toArray=function(t){return H(this,t)},u.prototype.toString=function(e,r){if(e===t&&(e=10),10!==e)return V(this,e,r);for(var n,s=this.value,i=s.length,o=String(s[--i]);--i>=0;)n=String(s[i]),o+="0000000".slice(n.length)+n;return(this.sign?"-":"")+o},c.prototype.toString=function(e,r){return e===t&&(e=10),10!=e?V(this,e,r):String(this.value)},l.prototype.toString=c.prototype.toString,l.prototype.toJSON=u.prototype.toJSON=c.prototype.toJSON=function(){return this.toString()},u.prototype.valueOf=function(){return parseInt(this.toString(),10)},u.prototype.toJSNumber=u.prototype.valueOf,c.prototype.valueOf=function(){return this.value},c.prototype.toJSNumber=c.prototype.valueOf,l.prototype.valueOf=l.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var J=0;J<1e3;J++)a[J]=W(J),J>0&&(a[-J]=W(-J));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=K,a.min=z,a.gcd=Q,a.lcm=function(t,e){return t=W(t).abs(),e=W(e).abs(),t.divide(Q(t,e)).multiply(e)},a.isInstance=function(t){return t instanceof u||t instanceof c||t instanceof l},a.randBetween=function(t,r,n){t=W(t),r=W(r);var s=n||Math.random,i=z(t,r),o=K(t,r).subtract(i).add(1);if(o.isSmall)return i.add(Math.floor(s()*o));for(var u=H(o,e).value,c=[],l=!0,f=0;f<u.length;f++){var h=l?u[f]+(f+1<u.length?u[f+1]/e:0):e,p=g(s()*h);c.push(p),p<u[f]&&(l=!1)}return i.add(a.fromArray(c,e,!1))},a.fromArray=function(t,e,r){return G(t.map(W),W(e||10),r)},a}(),pt.hasOwnProperty("exports")&&(pt.exports=dt);var gt=function(){function t(t,e){this.key=t,this.value=e,this.flag=!1,this.l=this,this.r=this,this.p=this}return t.prototype.toString=function(){return"".concat(this.flag?"red":"black"," ").concat(this.key)},t}(),wt=function(){function t(t,e,r,n){this.highKey=e,this.comp=n,this.N=0,this.lowNode=new gt(t,r),this.highNode=new gt(e,r);var s=new gt(null,r);this.head=new gt(t,r),this.head.l=s,this.head.r=s,this.head.p=this.head}return Object.defineProperty(t.prototype,"root",{get:function(){return this.head.r},set:function(t){this.head.r=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this.head.l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lowKey",{get:function(){return this.head.key},enumerable:!1,configurable:!0}),t.prototype.assertLegalKey=function(t,e){if(e(t,this.lowKey)<=0)throw new Error("key, ".concat(t,", must be greater than the low key, ").concat(this.lowKey,"."));if(e(t,this.highKey)>=0)throw new Error("key, ".concat(t,", must be less than the high key, ").concat(this.highKey,"."))},t.prototype.insert=function(t,e){var r=this.comp;this.assertLegalKey(t,r);var n=new gt(t,e);return function(t,e,r){var n=e.key,s=t.z,i=t.root;i.p=t.head;for(;i!==s;)i.l.p=i,i.r.p=i,i=r(n,i.key)<0?i.l:i.r;e.p=i.p,i.p===t.head?t.root=e:r(n,i.p.key)<0?i.p.l=e:i.p.r=e;e.l=s,e.r=s,e.p.flag?function(t,e){if(e.flag=!0,!e.p.flag)throw new Error("n.p must be red.");for(;e.flag;){var r=e.p;if(e===t.root)return void(t.root.flag=!1);if(r===t.root)return void(t.root.flag=!1);var n,s=r.p;if(!r.flag||s.flag)break;e=r===s.l?(n=s.r).flag?_t(r,s,n):e===r.r?xt(s):vt(s):(n=s.l).flag?_t(r,s,n):e===e.p.l?yt(s):bt(s)}t.root.flag=!1}(t,e):e.flag=!0}(this,n,r),this.root.flag=!1,this.N+=1,n},t.prototype.glb=function(t){var e=this.comp;this.assertLegalKey(t,e);var r=this.lowNode,n=St(this,this.root,t,e,r);return n!==r?n:null},t.prototype.lub=function(t){var e=this.comp;this.assertLegalKey(t,e);var r=this.highNode,n=Tt(this,this.root,t,e,r);return n!==r?n:null},t.prototype.search=function(t){var e=this.comp;this.assertLegalKey(t,e);var r=this.root;for(this.z.key=t;0!==e(t,r.key);)r=e(t,r.key)<0?r.l:r.r;return r.value},t.prototype.remove=function(t){var e=this.comp;this.assertLegalKey(t,e);var r=this.head,n=this.z,s=this.root,i=r;for(n.key=t;0!==e(t,s.key);)i=s,s=e(t,s.key)<0?s.l:s.r;var o=s;if(o.r===n)s=o.l;else if(o.r.l===n)(s=o.r).l=o.l;else{for(var a=o.r;a.l.l!==n;)a=a.l;s=a.l,a.l=s.r,s.l=o.l,s.r=o.r}e(t,i.key)<0?i.l=s:i.r=s},Object.defineProperty(t.prototype,"heightInvariant",{get:function(){return t=this.root,e=this.z,Et(t,e)>=0;var t,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colorInvariant",{get:function(){return Ot(this.root,this.head.flag,this.z)},enumerable:!1,configurable:!0}),t}();function _t(t,e,r){return t.flag=!1,e.flag=!0,r.flag=!1,e}function xt(t){var e=t.p,r=t,n=r.l,s=n.r,i=s.l,o=s.r;return n.flag=!1,s.l=n,n.p=s,s.r=r,r.p=s,n.r=i,i.p=n,r.l=o,o.p=r,e.r===t?e.r=s:e.l=s,s.p=e,s}function yt(t){var e=t.p,r=t,n=r.r,s=n.l,i=s.l,o=s.r;return n.flag=!1,s.l=r,r.p=s,s.r=n,n.p=s,r.r=i,i.p=r,n.l=o,o.p=n,e.r===t?e.r=s:e.l=s,s.p=e,s}function vt(t){var e=t.p,r=t,n=r.l,s=n.r;return n.l.flag=!1,n.r=r,r.p=n,r.l=s,s.p=r,e.r===t?e.r=n:e.l=n,n.p=e,n}function bt(t){var e=t.p,r=t,n=r.r,s=n.l;return n.r.flag=!1,n.l=r,r.p=n,r.r=s,s.p=r,e.r===t?e.r=n:e.l=n,n.p=e,n}function Ot(t,e,r){return t===r||(!e||!t.flag)&&(Ot(t.l,t.flag,r)&&Ot(t.r,t.flag,r))}function Et(t,e){if(t===e)return 0;var r=Et(t.l,e);if(r>=0){var n=Et(t.r,e);if(n>=0&&n==n)return t.flag?r:r+1}return-1}function St(t,e,r,n,s){return e===t.z?s:n(r,e.key)>=0?function(t,e,r){return r(t.key,e.key)>0?t:r(t.key,e.key)<0?e:t}(e,St(t,e.r,r,n,s),n):St(t,e.l,r,n,s)}function Tt(t,e,r,n,s){return e===t.z?s:n(r,e.key)<=0?function(t,e,r){return r(t.key,e.key)<0?t:r(t.key,e.key)>0?e:t}(e,Tt(t,e.l,r,n,s),n):Tt(t,e.r,r,n,s)}function qt(t,e){return t.multiply(e)}function At(t,e){return t.divide(e)}function Mt(t,e){return mt.gcd(t,e)}function Nt(t){return t.isZero()}function $t(t,e){if(t.isPositive()){if(e.isNegative())return t.multiply(mt(-1))}else if(e.isPositive())return t.multiply(mt(-1));return t}class Lt extends x{constructor(t,e,r,n){super("Rat",r,n),this.a=t,this.b=e}abs(){return((t=this.a).isPositive()?1:t.isZero()?0:-1)>=0?this:this.neg();var t}add(t){const e=function(t,e){return t.add(e)}(qt(this.a,t.b),qt(this.b,t.a));if(Nt(e))return Jt;const r=qt(this.b,t.b),n=$t(Mt(e,r),r),s=At(e,n),i=At(r,n);return new Lt(s,i)}ceiling(){if(this.isInteger())return this;const t=new Lt(At(this.a,this.b),mt.one);return this.isNegative()?t:t.succ()}compare(t){const e=qt(this.a,t.b),r=qt(this.b,t.a);return n=r,e.compare(n);var n}denom(){return new Lt(mt(this.b),mt.one)}div(t){if(t.isZero())throw new Error("divide by zero");if(this.isZero())return this;const e=qt(this.a,t.b),r=qt(this.b,t.a),n=$t(Mt(e,r),r);return new Lt(At(e,n),At(r,n))}equals(t){return t instanceof Lt&&this.equalsRat(t)}equalsRat(t){return this===t||0===this.compare(t)}gcd(t){const e=Mt(this.a,t.a),r=Mt(this.b,t.b);return new Lt(function(t){return t.isPositive()?t:t.multiply(mt(-1))}(e),r)}inv(){const t=this.a,e=$t(this.b,t),r=function(t,e){if(t.isPositive()){if(e<0)return t.multiply(mt(-1))}else if(e>0)return t.multiply(mt(-1));return t}(t,1);return new Lt(e,r,this.pos,this.end)}isDenom(t){return this.b.equals(t)}isFraction(){return!this.isInteger()}isHalf(){return this.isNumer(1)&&this.isDenom(2)}isInteger(){return this.isDenom(1)}isIntegerNumber(t){return this.isNumer(t)&&this.isDenom(1)}isNegative(){return this.a.isNegative()}isNumer(t){return this.a.equals(t)}isMinusOne(){return this.isIntegerNumber(-1)}isOne(){return this.isIntegerNumber(1)}isPositive(){return this.a.isPositive()}isPositiveInteger(){return this.isPositive()&&this.isInteger()}isTwo(){return this.isIntegerNumber(2)}isZero(){return Nt(this.a)}mul(t){if(Nt(this.a)||Nt(t.a))return Jt;const e=qt(this.a,t.a),r=qt(this.b,t.b),n=$t(Mt(e,r),r);return new Lt(At(e,n),At(r,n))}neg(){return new Lt(mt(this.a.multiply(mt.minusOne)),mt(this.b),this.pos,this.end)}numer(){return new Lt(mt(this.a),mt.one)}pred(){return this.sub(Ut)}sub(t){return this.add(t.neg())}succ(){return this.add(Ut)}toInfixString(){return this.isFraction()?`${this.a.toString()}/${this.b.toString()}`:this.a.toString()}toListString(){return this.toInfixString()}toNumber(){const t=this.a.divmod(this.b);return t.quotient.toJSNumber()+t.remainder.toJSNumber()/this.b.toJSNumber()}toString(){const t=this.a.toString();if(this.isFraction()){const e=this.b.toString();return`${this.name}(${t},${e})`}return`${this.name}(${t})`}}t("Rat",Lt);const kt=-129,Rt=128,It=new Lt(mt(kt),mt.one),Pt=new wt(kt,Rt,It,(function(t,e){return t<e?-1:t>e?1:0}));for(let t=kt+1;t<Rt;t++)Pt.insert(t,new Lt(mt(t),mt.one));function Ft(t,e,r){return t<Rt&&t>kt?Pt.search(t):new Lt(mt(t),mt.one,e,r)}const Ut=t("one",new Lt(mt(1),mt.one)),Ct=new Lt(mt(2),mt.one),Dt=new Lt(mt(3),mt.one),Bt=new Lt(mt(4),mt.one),Kt=new Lt(mt(5),mt.one),zt=new Lt(mt(6),mt.one),Qt=new Lt(mt(7),mt.one),Zt=new Lt(mt(8),mt.one),Gt=new Lt(mt(9),mt.one),Ht=new Lt(mt(10),mt.one),Vt=new Lt(mt(11),mt.one),jt=Ut.neg();Ct.neg(),Dt.neg();const Wt=Bt.neg();Kt.neg(),zt.neg(),Qt.neg(),Zt.neg(),Gt.neg(),Ht.neg(),Vt.neg();const Jt=t("zero",new Lt(mt(0),mt.one)),Xt=new Lt(mt(1),mt(2));Xt.neg();const Yt=new Lt(mt(1),mt(3));function te(t){return t instanceof Lt}function ee(t){return ot(t)||te(t)}let re=class t extends x{constructor(t,e,r){super("Str",e,r),this.str=t}equals(e){return e instanceof t&&this.equalsStr(e)}equalsStr(t){return this===t||this.str===t.str}toInfixString(){return JSON.stringify(this.str)}toListString(){return JSON.stringify(this.str)}toString(){return`${this.name}(${this.str})`}};t("Str",re);const ne=new re("");function se(t){return t instanceof re}function ie(t){return t instanceof K}function oe(t,e,r,n){if(!e){const e=r?r():"satisfy some condition",s=n?" in "+n():"";throw new Error(t+" must "+e+s+".")}}function ae(){return"be a string"}function ue(t,e,r){return oe(t,"string"==typeof e,ae,r),e}function ce(t){ue("name",t);return{get message(){return"Method `"+t+"` is not supported."}}}function le(){return"be an integer"}function fe(t,e,r){var n;return oe(t,"number"==typeof(n=e)&&n%1==0,le,r),e}function he(t){ue("name",t);return{get message(){return"Property `"+t+"` is readonly."}}}var pe,de;const me=Math.random();class ge{constructor(t,e,n){if(pe.set(this,void 0),de.set(this,void 0),n!==me)throw new Error("Use the static create method instead of the constructor");let s;fe("n",t),fe("d",e);if(0===e)throw new Error("denominator must not be zero");s=0===t?1:function(t,e){let r;for(t<0&&(t=-t),e<0&&(e=-e),e>t&&(r=t,t=e,e=r);;){if(0==(t%=e))return e;if(0==(e%=t))return t}}(Math.abs(t),Math.abs(e)),e<0&&(t=-t,e=-e),r(this,pe,t/s,"f"),r(this,de,e/s,"f")}get numer(){return e(this,pe,"f")}set numer(t){throw new Error(he("numer").message)}get denom(){return e(this,de,"f")}set denom(t){throw new Error(he("denom").message)}add(t){return ge.valueOf(e(this,pe,"f")*e(t,de,"f")+e(this,de,"f")*e(t,pe,"f"),e(this,de,"f")*e(t,de,"f"))}sub(t){return ge.valueOf(e(this,pe,"f")*e(t,de,"f")-e(this,de,"f")*e(t,pe,"f"),e(this,de,"f")*e(t,de,"f"))}mul(t){return ge.valueOf(e(this,pe,"f")*e(t,pe,"f"),e(this,de,"f")*e(t,de,"f"))}div(t){const r=e(this,pe,"f")*e(t,de,"f"),n=e(this,de,"f")*e(t,pe,"f");return 0===r?0===n?ge.valueOf(r,n):ge.ZERO:ge.valueOf(r,n)}isOne(){return 1===e(this,pe,"f")&&1===e(this,de,"f")}isZero(){return 0===e(this,pe,"f")&&1===e(this,de,"f")}hashCode(){return 37*this.numer+13*this.denom}inv(){return ge.valueOf(e(this,de,"f"),e(this,pe,"f"))}neg(){return ge.valueOf(-e(this,pe,"f"),e(this,de,"f"))}equals(t){return t instanceof ge&&e(this,pe,"f")*e(t,de,"f")==e(this,de,"f")*e(t,pe,"f")}toString(){return e(this,pe,"f")+"/"+e(this,de,"f")}__add__(t){return t instanceof ge?this.add(t):void 0}__radd__(t){return t instanceof ge?t.add(this):void 0}__sub__(t){return t instanceof ge?this.sub(t):void 0}__rsub__(t){return t instanceof ge?t.sub(this):void 0}__mul__(t){return t instanceof ge?this.mul(t):void 0}__rmul__(t){return t instanceof ge?t.mul(this):void 0}__div__(t){return t instanceof ge?this.div(t):void 0}__rdiv__(t){return t instanceof ge?t.div(this):void 0}__pos__(){return this}__neg__(){return this.neg()}static valueOf(t,e){if(0===t){if(0!==e)return ge.ZERO}else if(0===e);else{if(t===e)return ge.ONE;if(1===t){if(2===e)return ge.POS_01_02;if(3===e)return ge.POS_01_03;if(4===e)return ge.POS_01_04;if(5===e)return ge.POS_01_05;if(-3===e)return ge.NEG_01_03}else if(-1===t){if(1===e)return ge.NEG_01_01;if(3===e)return ge.NEG_01_03}else if(2===t){if(1===e)return ge.POS_02_01;if(3===e)return ge.POS_02_03}else if(-2===t){if(1===e)return ge.NEG_02_01}else if(3===t){if(1===e)return ge.POS_03_01}else if(-3===t){if(1===e)return ge.NEG_03_01}else if(4===t){if(1===e)return ge.POS_04_01}else if(5===t){if(1===e)return ge.POS_05_01}else if(6===t){if(1===e)return ge.POS_06_01}else if(7===t){if(1===e)return ge.POS_07_01}else if(8===t&&1===e)return ge.POS_08_01}return new ge(t,e,me)}}t("QQ",ge),pe=new WeakMap,de=new WeakMap,ge.POS_08_01=new ge(8,1,me),ge.POS_07_01=new ge(7,1,me),ge.POS_06_01=new ge(6,1,me),ge.POS_05_01=new ge(5,1,me),ge.POS_04_01=new ge(4,1,me),ge.POS_03_01=new ge(3,1,me),ge.POS_02_01=new ge(2,1,me),ge.ONE=new ge(1,1,me),ge.POS_01_02=new ge(1,2,me),ge.POS_01_03=new ge(1,3,me),ge.POS_01_04=new ge(1,4,me),ge.POS_01_05=new ge(1,5,me),ge.ZERO=new ge(0,1,me),ge.NEG_01_03=new ge(-1,3,me),ge.NEG_01_01=new ge(-1,1,me),ge.NEG_02_01=new ge(-2,1,me),ge.NEG_03_01=new ge(-3,1,me),ge.POS_02_03=new ge(2,3,me);const we=ge.valueOf(0,1),_e=ge.valueOf(1,1),xe=ge.valueOf(2,1),ye=ge.valueOf(-1,1);function ve(t,e){if(e instanceof ge)return e;throw new Error("Argument '"+e+"' must be a QQ")}class be{constructor(t,e,r,n,s,i,o){if(this.M=t,this.L=e,this.T=r,this.Q=n,this.temperature=s,this.amount=i,this.intensity=o,ve(0,t),ve(0,e),ve(0,r),ve(0,n),ve(0,s),ve(0,i),ve(0,o),7!==arguments.length)throw new Error("Expecting 7 arguments")}compatible(t){if(this.M.equals(t.M)&&this.L.equals(t.L)&&this.T.equals(t.T)&&this.Q.equals(t.Q)&&this.temperature.equals(t.temperature)&&this.amount.equals(t.amount)&&this.intensity.equals(t.intensity))return this;throw this.isOne()?t.isOne()?new Error:new Error("Dimensions must be equal (dimensionless, "+t+")"):t.isOne()?new Error("Dimensions must be equal ("+this+", dimensionless)"):new Error("Dimensions must be equal ("+this+", "+t+")")}mul(t){return new be(this.M.add(t.M),this.L.add(t.L),this.T.add(t.T),this.Q.add(t.Q),this.temperature.add(t.temperature),this.amount.add(t.amount),this.intensity.add(t.intensity))}div(t){return new be(this.M.sub(t.M),this.L.sub(t.L),this.T.sub(t.T),this.Q.sub(t.Q),this.temperature.sub(t.temperature),this.amount.sub(t.amount),this.intensity.sub(t.intensity))}equals(t){return this.M.equals(t.M)&&this.L.equals(t.L)&&this.T.equals(t.T)&&this.Q.equals(t.Q)&&this.temperature.equals(t.temperature)&&this.amount.equals(t.amount)&&this.intensity.equals(t.intensity)}pow(t){return new be(this.M.mul(t),this.L.mul(t),this.T.mul(t),this.Q.mul(t),this.temperature.mul(t),this.amount.mul(t),this.intensity.mul(t))}sqrt(){return new be(this.M.div(xe),this.L.div(xe),this.T.div(xe),this.Q.div(xe),this.temperature.div(xe),this.amount.div(xe),this.intensity.div(xe))}isOne(){return this.M.isZero()&&this.L.isZero()&&this.T.isZero()&&this.Q.isZero()&&this.temperature.isZero()&&this.amount.isZero()&&this.intensity.isZero()}inv(){return new be(this.M.neg(),this.L.neg(),this.T.neg(),this.Q.neg(),this.temperature.neg(),this.amount.neg(),this.intensity.neg())}neg(){throw new Error(ce("neg").message)}toString(){const t=function(t,e){return 0===t.numer?null:1===t.denom?1===t.numer?""+e:e+" ** "+t.numer:e+" ** "+t};return[t(this.M,"mass"),t(this.L,"length"),t(this.T,"time"),t(this.Q,"charge"),t(this.temperature,"thermodynamic temperature"),t(this.amount,"amount of substance"),t(this.intensity,"luminous intensity")].filter((function(t){return"string"==typeof t})).join(" * ")}__add__(t){return t instanceof be?this.compatible(t):void 0}__radd__(t){return t instanceof be?t.compatible(this):void 0}__sub__(t){return t instanceof be?this.compatible(t):void 0}__rsub__(t){return t instanceof be?t.compatible(this):void 0}__mul__(t){return t instanceof be?this.mul(t):void 0}__rmul__(t){return t instanceof be?t.mul(this):void 0}__div__(t){return t instanceof be?this.div(t):void 0}__rdiv__(t){return t instanceof be?t.div(this):void 0}__pos__(){return this}__neg__(){return this}}function Oe(t){ue("name",t);return{get message(){return`'${t}' method is not yet implemented.`}}}t("Dimensions",be),be.ONE=new be(we,we,we,we,we,we,we),be.MASS=new be(_e,we,we,we,we,we,we),be.LENGTH=new be(we,_e,we,we,we,we,we),be.TIME=new be(we,we,_e,we,we,we,we),be.CHARGE=new be(we,we,we,_e,we,we,we),be.CURRENT=new be(we,we,ye,_e,we,we,we),be.TEMPERATURE=new be(we,we,we,we,_e,we,we),be.AMOUNT=new be(we,we,we,we,we,_e,we),be.INTENSITY=new be(we,we,we,we,we,we,_e);const Ee=["kg","m","s","C","K","mol","cd"],Se=[[-1,1,-3,1,2,1,2,1,0,1,0,1,0,1],[-1,1,-2,1,1,1,2,1,0,1,0,1,0,1],[-1,1,-2,1,2,1,2,1,0,1,0,1,0,1],[-1,1,0,1,0,1,1,1,0,1,0,1,0,1],[0,1,-3,1,0,1,1,1,0,1,0,1,0,1],[0,1,2,1,-2,1,0,1,0,1,0,1,0,1],[0,1,0,1,-1,1,0,1,0,1,0,1,0,1],[0,1,0,1,-1,1,1,1,0,1,0,1,0,1],[0,1,1,1,-2,1,0,1,0,1,0,1,0,1],[0,1,1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,-1,1,-2,1,0,1,0,1,0,1,0,1],[1,1,-1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,0,1,-3,1,0,1,0,1,0,1,0,1],[1,1,0,1,-2,1,0,1,0,1,0,1,0,1],[1,1,0,1,-1,1,-1,1,0,1,0,1,0,1],[1,1,1,1,-3,1,0,1,-1,1,0,1,0,1],[1,1,1,1,-2,1,-1,1,0,1,0,1,0,1],[1,1,1,1,-2,1,0,1,0,1,0,1,0,1],[1,1,1,1,0,1,-2,1,0,1,0,1,0,1],[1,1,2,1,-2,1,0,1,-1,1,0,1,0,1],[0,1,2,1,-2,1,0,1,-1,1,0,1,0,1],[1,1,2,1,-2,1,0,1,-1,1,-1,1,0,1],[1,1,2,1,-2,1,0,1,0,1,-1,1,0,1],[1,1,2,1,-2,1,0,1,0,1,0,1,0,1],[1,1,2,1,-1,1,0,1,0,1,0,1,0,1],[1,1,2,1,-3,1,0,1,0,1,0,1,0,1],[1,1,2,1,-2,1,-1,1,0,1,0,1,0,1],[1,1,2,1,-1,1,-2,1,0,1,0,1,0,1],[1,1,2,1,0,1,-2,1,0,1,0,1,0,1],[1,1,2,1,-1,1,-1,1,0,1,0,1,0,1]],Te=[["F/m"],["S"],["F"],["C/kg"],["C/m ** 3"],["J/kg"],["Hz"],["A"],["m/s ** 2"],["m/s"],["kg·m/s"],["Pa"],["Pa·s"],["W/m ** 2"],["N/m"],["T"],["W/(m·K)"],["V/m"],["N"],["H/m"],["J/K"],["J/(kg·K)"],["J/(mol·K)"],["J/mol"],["J"],["J·s"],["W"],["V"],["Ω"],["H"],["Wb"]],qe=function(t,e,r,n){const s=e.M,i=e.L,o=e.T,a=e.Q,u=e.temperature,c=e.amount,l=e.intensity;for(let t=0,e=Se.length;t<e;t++){const e=Se[t];if(s.numer===e[0]&&s.denom===e[1]&&i.numer===e[2]&&i.denom===e[3]&&o.numer===e[4]&&o.denom===e[5]&&a.numer===e[6]&&a.denom===e[7]&&u.numer===e[8]&&u.denom===e[9]&&c.numer===e[10]&&c.denom===e[11]&&l.numer===e[12]&&l.denom===e[13])return Te[t][0]}return function(t,e,r,n){const s=function(t,e){return 0===t.numer?null:1===t.denom?1===t.numer?e:e+" ** "+t.numer:e+" ** "+t},i=[s(e.M,r[0]),s(e.L,r[1]),s(e.T,r[2]),s(e.Q,r[3]),s(e.temperature,r[4]),s(e.amount,r[5]),s(e.intensity,r[6])].filter((function(t){return"string"==typeof t})).join(" ");return n?i:i?"1"!==t?`${t} ${i}`:i:t}(t,e,r,n)};class Ae extends x{constructor(t,e){if(super("Uom",0,0),this.dimensions=t,this.labels=e,7!==e.length)throw new Error("Expecting 7 elements in the labels array.")}compatible(t){if(t instanceof Ae)return this.dimensions.compatible(t.dimensions),this;throw new Error("Illegal Argument for Unit.compatible: "+t)}equals(t){return t instanceof Ae&&this.dimensions.equals(t.dimensions)}mul(t){return function(t,e){return new Ae(t.dimensions.mul(e.dimensions),t.labels)}(this,t)}div(t){return function(t,e){return new Ae(t.dimensions.div(e.dimensions),t.labels)}(this,t)}pattern(){const t=[];return t.push(this.dimensions.M.numer),t.push(this.dimensions.M.denom),t.push(this.dimensions.L.numer),t.push(this.dimensions.L.denom),t.push(this.dimensions.T.numer),t.push(this.dimensions.T.denom),t.push(this.dimensions.Q.numer),t.push(this.dimensions.Q.denom),t.push(this.dimensions.temperature.numer),t.push(this.dimensions.temperature.denom),t.push(this.dimensions.amount.numer),t.push(this.dimensions.amount.denom),t.push(this.dimensions.intensity.numer),t.push(this.dimensions.intensity.denom),JSON.stringify(t)}pow(t){return new Ae(this.dimensions.pow(t),this.labels)}inv(){return new Ae(this.dimensions.inv(),this.labels)}isOne(){return this.dimensions.isOne()}lerp(t,e){throw new Error(Oe("lerp").message)}quad(){return new Ae(this.dimensions.mul(this.dimensions),this.labels)}reflect(t){return this}rotate(t){return this}slerp(t,e){throw new Error(Oe("slerp").message)}sqrt(){return new Ae(this.dimensions.sqrt(),this.labels)}stress(t){throw new Error(ce("stress").message)}toExponential(t,e){return qe(Number(1).toExponential(t),this.dimensions,this.labels,e)}toFixed(t,e){return qe(Number(1).toFixed(t),this.dimensions,this.labels,e)}toInfixString(){return qe(Number(1).toString(10),this.dimensions,this.labels,!0)}toListString(){return qe(Number(1).toString(10),this.dimensions,this.labels,!0)}toPrecision(t,e){return qe(Number(1).toPrecision(t),this.dimensions,this.labels,e)}toString(t,e){return qe(Number(1).toString(t),this.dimensions,this.labels,e)}static isOne(t){if(void 0===t)return!0;if(t instanceof Ae)return t.isOne();throw new Error("isOne argument must be a Unit or undefined.")}static assertDimensionless(t){if(!Ae.isOne(t))throw new Error("uom must be dimensionless.")}static compatible(t,e){if(t){if(e)return t.compatible(e);if(t.isOne())return;throw new Error(t+" is incompatible with 1")}if(e){if(e.isOne())return;throw new Error("1 is incompatible with "+e)}}static mul(t,e){return t?e?t.mul(e):Ae.isOne(e)?t:void 0:Ae.isOne(t)?e:void 0}static div(t,e){return t?e?t.div(e):t:e?e.inv():void 0}static sqrt(t){return void 0!==t?t.isOne()?void 0:new Ae(t.dimensions.sqrt(),t.labels):void 0}}function Me(t){return t instanceof Ae}function Ne(t){switch(t){case"kilogram":return Ae.KILOGRAM;case"meter":return Ae.METER;case"second":return Ae.SECOND;case"coulomb":return Ae.COULOMB;case"ampere":return Ae.AMPERE;case"kelvin":return Ae.KELVIN;case"mole":return Ae.MOLE;case"candela":return Ae.CANDELA;default:throw new Error(`Unknown name ${t}`)}}t("Uom",Ae),Ae.ZERO=new Ae(be.ONE,Ee),Ae.ONE=new Ae(be.ONE,Ee),Ae.KILOGRAM=new Ae(be.MASS,Ee),Ae.METER=new Ae(be.LENGTH,Ee),Ae.SECOND=new Ae(be.TIME,Ee),Ae.COULOMB=new Ae(be.CHARGE,Ee),Ae.AMPERE=new Ae(be.CURRENT,Ee),Ae.KELVIN=new Ae(be.TEMPERATURE,Ee),Ae.MOLE=new Ae(be.AMOUNT,Ee),Ae.CANDELA=new Ae(be.INTENSITY,Ee);const $e=Q(F.add),Le=Q(F.subtract),ke=Q(F.multiply),Re=Q(F.divide),Ie=Q(F.pow),Pe=Q(F.outer),Fe=Q(F.inner),Ue=Q(F.inverse),Ce=Q(F.lco),De=Q(F.rco),Be=Q(F.sin);Q(F.succ),B("pred");const Ke=Q(F.E),ze=Q(F.PI),Qe=B("component"),Ze=B("factorial");B("iszero");const Ge=Q(F.test_lt),He=Q(F.test_gt);Q(F.test_le),B(":"),Q(F.tau);const Ve=Q(F.IMU),je="PRINTMODE_LATEX",We="PRINTMODE_ASCII",Je="PRINTMODE_INFIX",Xe="PRINTMODE_HUMAN",Ye="PRINTMODE_SEXPR";const tr=new class{constructor(){this.$test_flag=!1,this.$printMode=Je,this.recursionLevelNestedRadicalsRemoval=0,this.errorMessage="",this.symbolsDependencies={},this.symbolsHavingReassignments=[],this.symbolsInExpressionsWithoutAssignments=[],this.patternHasBeenFound=!1,this.tos=0,this.trigmode=0,this.stack=[],this.out_count=0,this.codeGen=!1,this.userSimplificationsInListForm=[],this.userSimplificationsInStringForm=[],this.imuToken="i"}get printMode(){return this.$printMode}setPrintMode(t){this.$printMode=t}get testFlag(){return this.$test_flag}setTestFlag(t){this.$test_flag=t}};function er(t){tr.errorMessage+="Stop: ",tr.errorMessage+=t;const e=tr.errorMessage;throw tr.errorMessage="",rr(0),new Error(e)}function rr(t){if(tr.tos<=t)tr.tos=t;else for(;tr.tos>t;)tr.stack[tr.tos]=null,tr.tos--}function nr(){rr(0)}function sr(t,e,r){r.pushNativeDirective($.expand,!1);try{return t(e,r)}finally{r.popNativeDirective()}}function ir(t,e,r){r.pushNativeDirective($.expand,!0);try{return t(e,r)}finally{r.popNativeDirective()}}function or(t,e,r,n){n.pushNativeDirective($.expand,!0);try{return t(e,r,n)}finally{n.popNativeDirective()}}class ar{static NegOne(t){return t.getNativeDirective($.evaluatingAsFloat)?st:jt}static Pi(t){return t.getNativeDirective($.evaluatingAsFloat)?rt:ze}}const ur=Q(F.add),cr=B("adj");B("algebra");const lr=B("and"),fr=B("approxratio"),hr=B("arccos"),pr=B("arccosh"),dr=B("arcsin"),mr=B("arcsinh"),gr=B("arctan"),wr=B("arctanh");B("atomize");const _r=B("besselj"),xr=B("bessely");B("binding");const yr=B("binomial"),vr=B("ceiling"),br=B("check"),Or=B("choose"),Er=B("circexp"),Sr=B("clear"),Tr=B("clearall");B("clearpatterns");const qr=B("clock"),Ar=B("coeff"),Mr=B("cofactor");B("compare"),B("compare-factors"),B("compare-terms");const Nr=B("condense"),$r=B("contract"),Lr=B("cos"),kr=B("cosh");B("decomp");const Rr=B("defint"),Ir=B("degree"),Pr=B("denominator"),Fr=B("det"),Ur=B("dim"),Cr=B("dirac");B("divide");const Dr=B("divisors"),Br=B("do"),Kr=B("dot");B("draw"),B("dsolve");const zr=B("eigen"),Qr=B("eigenval"),Zr=B("eigenvec");B("equal");const Gr=B("erf"),Hr=B("erfc"),Vr=B("eval"),jr=B("exp"),Wr=B("expand"),Jr=B("expcos"),Xr=B("expsin"),Yr=B("factor"),tn=Ze;B("factorpoly"),B("filter");const en=B("float"),rn=B("floor"),nn=B("for"),sn=B("function"),on=B("gamma"),an=B("gcd"),un=B("hermite"),cn=B("hilbert");B("if");const ln=Q(F.imag),fn=Qe,hn=B("integral"),pn=Ue;B("invg"),B("isinteger");const dn=B("isprime"),mn=B("laguerre");B("laplace");const gn=B("lcm");B("lco"),B("leading");const wn=B("legendre"),_n=Q(F.log);B("lookup");const xn=ke,yn=B("not"),vn=B("nroots"),bn=B("number"),On=B("numerator"),En=B("operator"),Sn=B("or"),Tn=B("pattern");B("patternsinfo");const qn=B("polar"),An=Ie;B("prime");const Mn=B("printLeaveEAlone"),Nn=B("printLeaveXAlone");B("print");const $n=B("product"),Ln=B("quote"),kn=B("quotient"),Rn=B("rank"),In=B("rationalize");B("rco");const Pn=Q(F.real),Fn=Q(F.is_real),Un=B("round"),Cn=Q(F.rect),Dn=B("roots"),Bn=B("="),Kn=B("sgn");B("silentpattern");const zn=B("simplify"),Qn=Be,Zn=B("sinh"),Gn=B("shape"),Hn=B("sqrt");B("stop");const Vn=B("subst");B("-");const jn=B("sum");B("symbolsinfo");const Wn=B("tan"),Jn=B("tanh"),Xn=B("taylor"),Yn=B("test"),ts=B("testge"),es=B("testgt"),rs=B("testle"),ns=B("testlt"),ss=B("transpose"),is=B("unit");B("uom");const os=B("zero");B("lastPrint");const as=B("lastAsciiPrint"),us=B("lastInfixPrint"),cs=B("lastLatexPrint"),ls=B("lastSexprPrint"),fs=B("lastHumanPrint"),hs=B("autoexpand"),ps=B("autofactor"),ds=B("bake"),ms=B("assumeRealVariables");B("trace");const gs=B("forceFixedPrintout"),ws=B("maxFixedPrintoutDigits"),_s=6;B("$DRAWX");const xs=B("$METAA"),ys=B("$METAB"),vs=B("$METAX"),bs=B("$SECRETX");B("version");const Os=ze;B("a"),B("b"),B("c");const Es=B("d"),Ss=B("i"),Ts=B("j");B("n"),B("r");const qs=B("s"),As=B("t"),Ms=B("x"),Ns=B("y"),$s=B("z"),Ls=B("I"),ks=B("a_"),Rs=B("b_"),Is=B("x_");B("$C1"),B("$C2"),B("$C3"),B("$C4"),B("$C5"),B("$C6");const Ps=1e4,Fs=5,Us=10,Cs=24,Ds=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"],Bs=function(){const t=[2];let e=3;for(;t.length<Ps;){let r=0;const n=Math.sqrt(e);for(;r<t.length&&t[r]<=n;){if(e%t[r]==0){r=-1;break}r++}-1!==r&&t.push(e),e+=2}return t[Ps]=0,t}(),Ks=7488,zs=String.fromCharCode(183);function Qs(t){return t.isZero()?0:t.isPositive()?1:-1}function Zs(t,e){return t.equals(e)}const Gs="Err";var Hs;class Vs extends x{constructor(t,e,n){super(Gs,e,n),Hs.set(this,void 0),r(this,Hs,t,"f")}get cause(){return e(this,Hs,"f")}equals(t){return this===t||t instanceof Vs&&this.equalsErr(t)}equalsErr(t){return this.cause.equals(t.cause)}toString(){return`${Gs}(${e(this,Hs,"f").toString()})`}toInfixString(){throw new Error}toListString(){throw new Error}}function js(t){return t instanceof Vs}Hs=new WeakMap;const Ws=0,Js=1,Xs=2,Ys="Blade",ti="Boo",ei=Gs,ri="Flt",ni="Hyp",si="Imu",ii="Rat",oi="Str",ai="Sym",ui="Tensor",ci="Uom",li="U",fi="Nil";function hi(t,e,r){return`(${t.key()} ${e} ${r})`}function pi(t,e,r){return`(${t.key()} ${e} (${r.key()}))`}function di(t,e,r){return`(${t.key()} (${e.key()}) ${r})`}function mi(t,e,r){return`(${t.key()} (${e.key()}) (${r.key()}))`}function gi(t,e){return`(${t.key()} ${e})`}function wi(t,e){return`(${t.key()} (${e.key()}))`}function _i(t){return`(${t.key()})`}function xi(t){const e=[],r=vi(t,0);if(e.push(yi(r)),r.kind===Js)3===r.parts.length&&(e.push(yi({kind:Js,parts:[r.parts[0],r.parts[1],li]})),e.push(yi({kind:Js,parts:[r.parts[0],li,r.parts[2]]})),e.push(yi({kind:Js,parts:[r.parts[0],li,li]})),e.push(yi({kind:Js,parts:[r.parts[0]]}))),2===r.parts.length&&(e.push(yi({kind:Js,parts:[r.parts[0],li]})),e.push(yi({kind:Js,parts:[r.parts[0]]})));return e}function yi(t){switch(t.kind){case Js:return`(${t.parts.join(" ")})`;case Xs:return t.parts[0];default:return fi}}function vi(t,e){if(h(t)){if(0===e){if(3===t.length){const r=t.opr,n=t.lhs,s=t.rhs;return{kind:Js,parts:[bi(r),yi(vi(n,e+1)),yi(vi(s,e+1))]}}if(2===t.length){const r=t.opr,n=t.arg;return{kind:Js,parts:[bi(r),yi(vi(n,e+1))]}}if(ie(t.head))return{kind:Js,parts:[bi(t.head)]};if(te(t.head))return{kind:Js,parts:[bi(t.head)]};throw new Error(`${t}`)}return{kind:Js,parts:[bi(t.opr)]}}if(ie(t))return{kind:Xs,parts:[ai]};if(te(t))return{kind:Xs,parts:[ii]};if(Z(t))return{kind:Xs,parts:[Ys]};if(ht(t))return{kind:Xs,parts:[si]};if(v(t))return{kind:Xs,parts:[ui]};if(Me(t))return{kind:Xs,parts:[ci]};if(ot(t))return{kind:Xs,parts:[ri]};if(p(t))return{kind:Ws,parts:[fi]};if(se(t))return{kind:Xs,parts:[oi]};if(W(t))return{kind:Xs,parts:[ti]};if(ct(t))return{kind:Xs,parts:[ni]};if(js(t))return{kind:Xs,parts:[ei]};throw new Error(`hash_string(${t})`)}function bi(t){if(ie(t))return t.key();if(te(t))return t.name;throw new Error(`hash_arg(arg=${t})`)}class Oi{constructor(t){this.extensionProvider=t}create(t){return new Ei(this.extensionProvider(t),t)}}class Ei{constructor(t,e){this.extension=t,this.$=e}get key(){return this.extension.key}get hash(){return this.extension.hash}get name(){return this.extension.name}get phases(){return this.extension.phases}get dependencies(){return this.extension.dependencies}isImag(t){return this.extension.isImag(t,this.$)}isKind(t){return this.extension.isKind(t,this.$)}isMinusOne(t){return this.extension.isMinusOne(t,this.$)}isOne(t){return this.extension.isOne(t,this.$)}isReal(t){return this.extension.isReal(t,this.$)}isScalar(t){return this.extension.isScalar(t,this.$)}isZero(t){return this.extension.isZero(t,this.$)}valueOf(t){return this.extension.transform(t,this.$)[1]}subst(t,e,r){return this.extension.subst(t,e,r,this.$)}toInfixString(t){return this.extension.toInfixString(t,this.$)}toLatexString(t){return this.extension.toLatexString(t,this.$)}toListString(t){return this.extension.toListString(t,this.$)}evaluate(t,e){return this.extension.evaluate(t,e,this.$)}transform(t){return this.extension.transform(t,this.$)}}function Si(t){return t instanceof Lt}class Ti{constructor(t){this.$=t}get key(){return Ut.name}get hash(){return ii}get name(){return"RatExtension"}isImag(t){return!1}isKind(t,e){return h(t)&&function(t){if(l===t)return!1;const e=t.cdr;return l===e}(t)?this.isKind(t.head,e):t instanceof Lt}isMinusOne(t){return t.isMinusOne()}isOne(t){return t.isOne()}isReal(t){return!0}isScalar(t){return!0}isZero(t){return t.isZero()}subst(t,e,r){return Si(e)&&t.equals(e)?r:t}toInfixString(t){return t.toInfixString()}toLatexString(t){return t.toInfixString()}toListString(t){return t.toListString()}evaluate(t,e){if(h(t))throw new Error(`The expr is really a Cons! ${t}`);return this.transform(u(t,e))}transform(t){return t instanceof Lt?this.$.getNativeDirective($.evaluatingAsFloat)?[q,J(t.toNumber())]:[A,t]:[T,t]}valueOf(t){return this.transform(t)[1]}}const qi=new Oi((function(t){return new Ti(t)}));class Ai extends Error{constructor(t){super(t),this.name="SystemError",console.warn(t,(new Error).stack)}}function Mi(t){if(ie(t))return t;throw new Ai(`expr => ${t}`)}function Ni(t,e){if(t===e)return t;throw new Ai}function $i(t,e){return t.clone(e.pos,e.end)}const Li=function(t){let e=1001;return function(t){return{text:t,code:e++}}}(),ki=Li("Int"),Ri=Li("Flt"),Ii=Li("Sym"),Pi=Li("Function"),Fi=Li("-"),Ui=Li("NewLine"),Ci=Li("+"),Di=Li("Str"),Bi=Li(">="),Ki=Li(">>"),zi=Li("<="),Qi=Li("<<"),Zi=Li("<"),Gi=Li(">"),Hi=Li("*"),Vi=Li("/"),ji=Li("("),Wi=Li(")"),Ji=Li("·"),Xi=Li("=="),Yi=Li("!="),to=Li(":"),eo=Li(":="),ro=Li("="),no=Li("**"),so=Li("^"),io=Li("|"),oo=Li("End"),ao=Li(","),uo=Li("["),co=Li("]");class lo{parse(t,e,r){const n=parseFloat(t);return new X(n,e,r)}}class fo{parse(t,e,r){const n=t[0];if("+"===n){const n=mt(t.substring(1));return new Lt(n,mt.one,e,r)}if("-"===n){const n=mt(t.substring(1));return new Lt(n,mt.one,e,r).neg()}const s=mt(t);return new Lt(s,mt.one,e,r)}}B("if"),B("nil"),B("false"),B("true"),B("undefined");const ho=B(":=");function po(t){return null!=t&&/^\d+$/.test(t)}function mo(t,e){if(po(t.curr)||"."===t.curr){for(;po(t.curr);)t.consumeChars(1);if("."===t.curr){for(t.consumeChars(1);po(t.curr);)t.consumeChars(1);if(t.currEquals("e")&&("+"===t.next||"-"===t.next||po(t.next)))for(t.consumeChars(2);po(t.curr);)t.consumeChars(1);return e.flt(),!0}return e.int(),!0}return!1}function go(t){return null!=t&&(function(t){return null!=t&&-1===t.search(/[^A-Za-z_]/)}(t)||po(t))}let wo=class extends Error{constructor(t,e,r){super(`${t} in range [${e}, ${r}]`)}};var _o;const xo={fltParser:new lo,intParser:new fo,strParser:new class{parse(t,e,r){const n=t.substring(1,t.length-1);return new re(n,e,r)}},symParser:new class{parse(t,e,r){return B(t,e,r)}},lexicon:{"+":Q(F.add),"-":Q(F.subtract),"*":Q(F.multiply),"/":Q(F.divide),"^":Q(F.outer),"|":Q(F.inner),">>":Q(F.rco),"<<":Q(F.lco),"**":Q(F.pow),"<=":Q(F.test_le),"<":Q(F.test_lt),">=":Q(F.test_ge),">":Q(F.test_gt),"!=":Q(F.test_ne),"==":Q(F.test_eq),":=":ho,"=":Bn,abs:Q(F.abs),cos:Q(F.cos),exp:Q(F.exp),iscomplex:Q(F.is_complex),isreal:Q(F.is_real),sin:Q(F.sin)},meta:{a:xs,b:ys,x:vs},parse_time_simplifications:!0};class yo{constructor(t,e=0){this.sourceText=t,_o.set(this,void 0),this.meta_mode=!1,this.useCaretForExponentiation=!1,this.explicitAssocAdd=!1,this.explicitAssocMul=!1,r(this,_o,{txt:"",pos:0,end:e},"f"),this.newLine=!1,this.input_str=0,this.lastFoundSymbol=null,this.symbolsRightOfAssignment=[],this.symbolsLeftOfAssignment=[],this.isSymbolLeftOfAssignment=null,this.scanningParameters=[],this.functionInvokationsScanningStack=[],this.skipRootVariableToBeSolved=!1,this.assignmentFound=null}get code(){const t=e(this,_o,"f").code;if(t)return t;throw new Error}peek(t){return this.sourceText.slice(e(this,_o,"f").end,e(this,_o,"f").end+t)}read(t){return new yo(this.sourceText,e(this,_o,"f").end+t)}get done(){return e(this,_o,"f").end===this.sourceText.length}get text(){return e(this,_o,"f").txt}get pos(){return e(this,_o,"f").pos}get end(){return e(this,_o,"f").end}get scanned(){return e(this,_o,"f").pos-this.input_str}get curr(){return this.sourceText[e(this,_o,"f").end]}get next(){return this.sourceText[e(this,_o,"f").end+1]}advance(){for(this.newLine=!1;this.get_token(),e(this,_o,"f").code===Ui;)this.newLine=!0}consumeChars(t){e(this,_o,"f").end+=t}currEquals(t){return this.curr===t}expect(t){if(this.code===t)return{pos:this.pos,end:this.end};this.scan_error(`${t.text} expected`)}tokenToFlt(){return xo.fltParser.parse(e(this,_o,"f").txt,e(this,_o,"f").pos,e(this,_o,"f").end)}tokenToInt(){return xo.intParser.parse(e(this,_o,"f").txt,e(this,_o,"f").pos,e(this,_o,"f").end)}tokenToStr(){return xo.strParser.parse(e(this,_o,"f").txt,e(this,_o,"f").pos,e(this,_o,"f").end)}tokenToSym(){const t=e(this,_o,"f").txt;if(this.meta_mode&&"string"==typeof e(this,_o,"f").txt){const e=xo.meta[t];if(e)return e}return xo.lexicon[t]?xo.lexicon[t].clone(e(this,_o,"f").pos,e(this,_o,"f").end):B(t,e(this,_o,"f").pos,e(this,_o,"f").end)}get_token(){for(;null!=(t=this.curr)&&(" "===t||"\t"===t||"\n"===t||"\v"===t||"\f"===t||"\r"===t);){if("\n"===this.curr||"\r"===this.curr)return e(this,_o,"f").code=Ui,void e(this,_o,"f").end++;e(this,_o,"f").end++}var t;if(e(this,_o,"f").pos=e(this,_o,"f").end,e(this,_o,"f").end===this.sourceText.length)return e(this,_o,"f").txt="",void(e(this,_o,"f").code=oo);if(!mo(this,{flt:()=>{e(this,_o,"f").code=Ri,this.update_token_text(e(this,_o,"f").pos,e(this,_o,"f").end)},int:()=>{e(this,_o,"f").code=ki,this.update_token_text(e(this,_o,"f").pos,e(this,_o,"f").end)}})){if(null==(r=this.curr)||-1!==r.search(/[^A-Za-z]/)){var r;if('"'===this.curr){for(e(this,_o,"f").end++;'"'!==this.curr;)e(this,_o,"f").end===this.sourceText.length-1&&(e(this,_o,"f").end++,this.scan_error("runaway string"),e(this,_o,"f").end--),e(this,_o,"f").end++;return e(this,_o,"f").end++,e(this,_o,"f").code=Di,void this.update_token_text(e(this,_o,"f").pos,e(this,_o,"f").end)}if("#"===this.curr||"-"===this.curr&&"-"===this.next){for(;this.curr&&!this.currEquals("\n")&&!this.currEquals("\r");)e(this,_o,"f").end++;return this.curr&&e(this,_o,"f").end++,void(e(this,_o,"f").code=Ui)}switch(this.curr){case"*":return"*"===this.next?(e(this,_o,"f").code=no,e(this,_o,"f").txt="**",void(e(this,_o,"f").end+=2)):(e(this,_o,"f").txt="*",e(this,_o,"f").code=Hi,void(e(this,_o,"f").end+=1));case":":return"="===this.next?(e(this,_o,"f").code=eo,e(this,_o,"f").txt=":=",void(e(this,_o,"f").end+=2)):(e(this,_o,"f").code=to,e(this,_o,"f").txt=":",void(e(this,_o,"f").end+=1));case"=":return"="===this.next?(e(this,_o,"f").code=Xi,e(this,_o,"f").txt="==",void(e(this,_o,"f").end+=2)):(e(this,_o,"f").code=ro,e(this,_o,"f").txt="=",void(e(this,_o,"f").end+=1));case">":switch(this.next){case"=":return e(this,_o,"f").code=Bi,e(this,_o,"f").txt=">=",void(e(this,_o,"f").end+=2);case">":return e(this,_o,"f").code=Ki,e(this,_o,"f").txt=">>",void(e(this,_o,"f").end+=2);default:return e(this,_o,"f").code=Gi,e(this,_o,"f").txt=">",void(e(this,_o,"f").end+=1)}case"<":switch(this.next){case"=":return e(this,_o,"f").code=zi,e(this,_o,"f").txt="<=",void(e(this,_o,"f").end+=2);case"<":return e(this,_o,"f").code=Qi,e(this,_o,"f").txt="<<",void(e(this,_o,"f").end+=2);default:return e(this,_o,"f").code=Zi,e(this,_o,"f").txt="<",void(e(this,_o,"f").end+=1)}case"!":if("="===this.next)return e(this,_o,"f").code=Yi,e(this,_o,"f").txt="!=",void(e(this,_o,"f").end+=2);break;case"(":return this.next,e(this,_o,"f").code=ji,e(this,_o,"f").txt="(",void(e(this,_o,"f").end+=1);case")":return this.next,e(this,_o,"f").code=Wi,e(this,_o,"f").txt=")",void(e(this,_o,"f").end+=1);case",":return this.next,e(this,_o,"f").code=ao,e(this,_o,"f").txt=",",void(e(this,_o,"f").end+=1);case"[":return this.next,e(this,_o,"f").code=uo,e(this,_o,"f").txt="[",void(e(this,_o,"f").end+=1);case"]":return this.next,e(this,_o,"f").code=co,e(this,_o,"f").txt="]",void(e(this,_o,"f").end+=1)}if("+"===this.curr)return e(this,_o,"f").txt=this.curr,e(this,_o,"f").code=Ci,void(e(this,_o,"f").end+=1);if("-"===this.curr)return e(this,_o,"f").txt=this.curr,e(this,_o,"f").code=Fi,void(e(this,_o,"f").end+=1);if("^"===this.curr)return e(this,_o,"f").txt=this.curr,e(this,_o,"f").code=so,void(e(this,_o,"f").end+=1);if("|"===this.curr)return e(this,_o,"f").txt=this.curr,e(this,_o,"f").code=io,void(e(this,_o,"f").end+=1);if("/"===this.curr)return e(this,_o,"f").txt=this.curr,e(this,_o,"f").code=Vi,void(e(this,_o,"f").end+=1);if("·"===this.curr)return e(this,_o,"f").txt=this.curr,e(this,_o,"f").code=Ji,void(e(this,_o,"f").end+=1);throw e(this,_o,"f").txt=this.sourceText[e(this,_o,"f").end++],new Error(`text = ${e(this,_o,"f").txt}`)}for(e(this,_o,"f").code=Ii,e(this,_o,"f").end++;go(this.curr);)e(this,_o,"f").code=Ii,e(this,_o,"f").end++;this.update_token_text(e(this,_o,"f").pos,e(this,_o,"f").end)}}update_token_text(t,r){e(this,_o,"f").txt=this.sourceText.substring(t,r)}scan_error(t){for(tr.errorMessage="";this.input_str!==e(this,_o,"f").end&&("\n"!==this.sourceText[this.input_str]&&"\r"!==this.sourceText[this.input_str]||this.input_str+1!==e(this,_o,"f").end);)tr.errorMessage+=this.sourceText[this.input_str++];for(tr.errorMessage+=" ? ";this.sourceText[this.input_str]&&"\n"!==this.sourceText[this.input_str]&&"\r"!==this.sourceText[this.input_str];)tr.errorMessage+=this.sourceText[this.input_str++];throw tr.errorMessage+="\n",new wo(t,e(this,_o,"f").pos,e(this,_o,"f").end)}tokenCharCode(){const t=this.munge(e(this,_o,"f"));if("string"==typeof t)return t.charCodeAt(0)}munge(t){const e=t.code;return"object"==typeof e&&"number"==typeof e.code?e.code:t.txt}get parse_time_simplifications(){return xo.parse_time_simplifications}}function vo(t){return te(t)||ot(t)?t.inv():c(Ie.clone(t.pos,t.end),t,jt)}function bo(t){return te(t)||ot(t)?t.neg():c(ke.clone(t.pos,t.end),jt,t)}function Oo(t,e){const r=new yo(t);if(r.lastFoundSymbol=null,r.symbolsRightOfAssignment=[],r.symbolsLeftOfAssignment=[],r.isSymbolLeftOfAssignment=!0,r.scanningParameters=[],r.functionInvokationsScanningStack=[""],r.assignmentFound=!1,r.useCaretForExponentiation=e.useCaretForExponentiation,r.explicitAssocAdd=e.explicitAssocAdd,r.explicitAssocMul=e.explicitAssocMul,r.advance(),r.code===oo)return[0,l];const n=qo(r);return r.assignmentFound||(tr.symbolsInExpressionsWithoutAssignments=tr.symbolsInExpressionsWithoutAssignments.concat(r.symbolsLeftOfAssignment)),[r.scanned,n]}function Eo(t){const e=new yo(t);return e.meta_mode=!0,e.advance(),e.code===oo?l:qo(e)}function So(t){return t===eo}function To(t){return So(t)||function(t){return t===ro}(t)}function qo(t){let e=Ao(t);if(To(t.code)){const r=t.lastFoundSymbol;t.assignmentFound=!0,t.isSymbolLeftOfAssignment=!1;const{pos:n,end:s}=t.tokenToSym(),i=So(t.code);t.advance();let o=Ao(t);if(i&&(o=c(Ln.clone(n,s),o)),e=c(Bn.clone(n,s),e,o),t.isSymbolLeftOfAssignment=!0,tr.codeGen){if(r){const e=t.symbolsRightOfAssignment.indexOf(r);-1!==e&&(t.symbolsRightOfAssignment.splice(e,1),tr.symbolsHavingReassignments.push(r))}if(r){null==tr.symbolsDependencies[r]&&(tr.symbolsDependencies[r]=[]);const e=tr.symbolsDependencies[r];for(const r of Array.from(t.symbolsRightOfAssignment))-1===e.indexOf(r)&&e.push(r)}t.symbolsRightOfAssignment=[]}}return e}function Ao(t){const e=function(t,e){return t},r=No(t);if(function(t){switch(t){case Xi:case Yi:case zi:case Bi:case Zi:case Gi:return!0;default:return!1}}(t.code)){const n=t.tokenToSym();t.advance();return e(c(n,r,No(t)))}return e(r)}function Mo(t,e){if(e)return!1;switch(t){case Ci:case Fi:return!0;default:return!1}}function No(t){return t.explicitAssocAdd?function(t){const e=function(t,e){return t};let r=ko(t);for(;Mo(t.code,t.newLine);)switch(t.code){case Ci:{const e=$i(Q(F.add),t.tokenToSym());t.advance(),r=c(e,r,ko(t));break}default:{Ni(t.code,Fi);const e=$i(Q(F.add),t.tokenToSym());t.advance(),r=c(e,r,bo(ko(t)));break}}return e(r)}(t):function(t){const e=[Q(F.add)];switch(t.code){case Ci:t.advance(),e.push(ko(t));break;case Fi:t.advance(),e.push($o(ko(t)));break;default:e.push(ko(t))}for(;!1===t.newLine&&(t.code===Ci||t.code===Fi);)t.code===Ci?(t.advance(),e.push(ko(t))):(t.advance(),e.push($o(ko(t))));if(2===e.length)return e[1];return c(...e)}(t)}function $o(t){return ee(t)?t.neg():c(ke,t,jt)}function Lo(t,e){switch(t){case Hi:case Vi:return!0}return!1}function ko(t){return t.explicitAssocMul?function(t){const e=function(t,e){return t};let r=Io(t);for(;Lo(t.code,t.newLine);)switch(t.code){case Hi:{const e=$i(ke,t.tokenToSym());t.advance(),r=c(e,r,Io(t));break}case Vi:if(Si(r)&&r.isOne())t.advance(),r=vo(Io(t));else{const e=$i(ke,t.tokenToSym());t.advance(),r=c(e,r,vo(Io(t)))}break;default:throw new Error(`${JSON.stringify(t)}`)}return e(r)}(t):function(t){const e=[Io(t)];for(;Lo(t.code,t.newLine);)t.code===Hi?(t.advance(),e.push(Io(t))):t.code===Vi?(Ro(e),t.advance(),e.push(vo(Io(t)))):e.push(Io(t));if(0===e.length)return Ut;if(1==e.length)return e[0];return c(ke,...e)}(t)}function Ro(t){if(t.length>0){const e=t[t.length-1];Si(e)&&e.isOne()&&t.pop()}}function Io(t){let e=Po(t);for(;r=t.code,n=t.newLine,s=t.useCaretForExponentiation,!n&&r===so&&!s;){const r=$i(Pe,t.tokenToSym());t.advance(),e=c(r,e,Po(t))}var r,n,s;return e}function Po(t){let e=Fo(t);for(;r=t.code,!t.newLine&&(r===Qi||r===Ki||r===io||r===Ji);)switch(t.code){case Qi:{const r=$i(Ce,t.tokenToSym());t.advance(),e=c(r,e,Fo(t));break}case Ki:{const r=$i(De,t.tokenToSym());t.advance(),e=c(r,e,Fo(t));break}case io:{const r=$i(Fe,t.tokenToSym());t.advance(),e=c(r,e,Fo(t));break}default:{t.expect(Ji);const r=$i(Fe,t.tokenToSym());t.advance(),e=c(r,e,Fo(t));break}}var r;return e}function Fo(t){const e=[];for(e.push(Uo(t));r=t.code,n=t.newLine,s=t.useCaretForExponentiation,!n&&(s?r===so:r===no);)e.push(t.tokenToSym()),t.advance(),e.push(Uo(t));for(var r,n,s;e.length>0;){const t=e.pop();if(!(e.length>0))return t;{const r=Mi(e.pop()),n=e.pop();e.push(c($i(Ie,r),n,t))}}throw new Error}function Uo(t){switch(t.code){case Ci:return t.advance(),Uo(t);case Fi:return t.advance(),bo(Uo(t));default:return function(t){const e=t.code;return e===ji?Vo(t):function(t){const e=function(t){const e=t.code;if(e===ji)return[!1,Vo(t)];if(e===Ii){if("true"===t.text){const e=new G(!0,t.pos,t.end);return t.advance(),[!1,e]}if("false"===t.text){const e=new G(!1,t.pos,t.end);return t.advance(),[!1,e]}return[!1,Qo(t)]}if(e===Pi)return[!1,Go(t)];if(e===uo)return[!1,jo(t)];if(e===ki)return[!0,Do(t)];if(e===Ri)return[!0,Co(t)];if(e===Di)return[!1,Bo(t)];t.scan_error(`Unexpected token ${JSON.stringify(e.text)}`)}(t),r=e[0];let n=e[1];for(;t.code===uo||t.code===ji&&!t.newLine&&!r;)t.code===uo?n=Ko(n,t):t.code===ji&&(n=Ho(n,t));for(;"!"===t.text;)t.advance(),n=c(tn,n);for(;t.tokenCharCode()===Ks;)t.advance(),n=c(ss,n);return n}(t)}(t)}}function Co(t){const e=t.tokenToFlt();return t.advance(),e}function Do(t){const e=t.tokenToInt();return t.advance(),e}function Bo(t){const e=t.tokenToStr();return t.advance(),e}function Ko(t,e){e.expect(uo),e.advance();const r=[Qe,t];if(e.code!==co)for(r.push(No(e));e.code===ao;)e.advance(),r.push(No(e));return e.expect(co),e.advance(),c(...r)}function zo(t,e){if(-1===Ds.indexOf(e)&&-1===t.symbolsRightOfAssignment.indexOf(e)&&-1===t.symbolsRightOfAssignment.indexOf("'"+e)&&!t.skipRootVariableToBeSolved){let r="";for(let e=1;e<t.functionInvokationsScanningStack.length;e++)""!==t.functionInvokationsScanningStack[e]&&(r+=t.functionInvokationsScanningStack[e]+"_"+e+"_");e=r+e,t.symbolsRightOfAssignment.push(e)}}function Qo(t){t.expect(Ii);const e=t.tokenToSym();return 0===t.scanningParameters.length?(t.lastFoundSymbol=t.text,t.isSymbolLeftOfAssignment&&function(t,e){if(-1===Ds.indexOf(e)&&-1===t.symbolsLeftOfAssignment.indexOf(e)&&-1===t.symbolsLeftOfAssignment.indexOf("'"+e)&&!t.skipRootVariableToBeSolved){let r="";for(let e=1;e<t.functionInvokationsScanningStack.length;e++)""!==t.functionInvokationsScanningStack[e]&&(r+=t.functionInvokationsScanningStack[e]+"_"+e+"_");e=r+e,t.symbolsLeftOfAssignment.push(e)}}(t,t.text)):t.isSymbolLeftOfAssignment&&zo(t,"'"+t.text),t.isSymbolLeftOfAssignment||zo(t,t.text),t.advance(),e}function Zo(t){switch(t){case"defint":case"for":case"product":case"roots":case"sum":return!0;default:return!1}}function Go(t){t.expect(Pi);let e=1;const r=[t.tokenToSym()],n=t.text;Zo(n)&&t.functionInvokationsScanningStack.push(t.text),t.lastFoundSymbol=t.text,t.isSymbolLeftOfAssignment||zo(t,t.text),t.advance(),t.advance(),t.scanningParameters.push(!0);try{if(t.code!==Wi){for(r.push(qo(t)),e++;t.code===ao;)t.advance(),2===e&&-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("roots")&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("roots_"+(t.functionInvokationsScanningStack.length-1)+"_"+t.text).test(e))),t.skipRootVariableToBeSolved=!0),2===e&&-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("sum")&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("sum_"+(t.functionInvokationsScanningStack.length-1)+"_"+t.text).test(e))),t.skipRootVariableToBeSolved=!0),2===e&&-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("product")&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("product_"+(t.functionInvokationsScanningStack.length-1)+"_"+t.text).test(e))),t.skipRootVariableToBeSolved=!0),2===e&&-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("for")&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("for_"+(t.functionInvokationsScanningStack.length-1)+"_"+t.text).test(e))),t.skipRootVariableToBeSolved=!0),-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("defint")&&(2===e||e>2&&(e-2)%3==0)&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("defint_"+(t.functionInvokationsScanningStack.length-1)+"_"+t.text).test(e))),t.skipRootVariableToBeSolved=!0),r.push(qo(t)),t.skipRootVariableToBeSolved=!1,e++;2===e&&-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("roots")&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("roots_"+(t.functionInvokationsScanningStack.length-1)+"_x").test(e))))}}finally{t.scanningParameters.pop()}for(let e=0;e<=t.symbolsRightOfAssignment.length;e++)null!=t.symbolsRightOfAssignment[e]&&("roots"===n&&(t.symbolsRightOfAssignment[e]=t.symbolsRightOfAssignment[e].replace(new RegExp("roots_"+(t.functionInvokationsScanningStack.length-1)+"_"),"")),"defint"===n&&(t.symbolsRightOfAssignment[e]=t.symbolsRightOfAssignment[e].replace(new RegExp("defint_"+(t.functionInvokationsScanningStack.length-1)+"_"),"")),"sum"===n&&(t.symbolsRightOfAssignment[e]=t.symbolsRightOfAssignment[e].replace(new RegExp("sum_"+(t.functionInvokationsScanningStack.length-1)+"_"),"")),"product"===n&&(t.symbolsRightOfAssignment[e]=t.symbolsRightOfAssignment[e].replace(new RegExp("product_"+(t.functionInvokationsScanningStack.length-1)+"_"),"")),"for"===n&&(t.symbolsRightOfAssignment[e]=t.symbolsRightOfAssignment[e].replace(new RegExp("for_"+(t.functionInvokationsScanningStack.length-1)+"_"),"")));return t.expect(Wi),t.advance(),Zo(n)&&t.functionInvokationsScanningStack.pop(),Tn.equals(B(n))&&(tr.patternHasBeenFound=!0),c(...r)}function Ho(t,e){e.expect(ji);const r=[t];Ni(e.code,ji),e.advance(),e.scanningParameters.push(!0);try{if(e.code!==Wi)for(r.push(qo(e));e.code===ao;)e.advance(),r.push(qo(e))}finally{e.scanningParameters.pop()}return e.expect(Wi),e.advance(),c(...r)}function Vo(t){t.expect(ji),t.advance();const e=qo(t);return t.expect(Wi),t.advance(),e}function jo(t){t.expect(uo),t.advance();const e=[qo(t)];for(;t.code===ao;)t.advance(),e.push(qo(t));const r=b(e);return t.expect(co),t.advance(),r}function Wo(t,e,r){const n=function(t){return t?{useCaretForExponentiation:!!t.useCaretForExponentiation,explicitAssocAdd:!!t.explicitAssocAdd,explicitAssocMul:!!t.explicitAssocMul}:{useCaretForExponentiation:!1,explicitAssocAdd:!1,explicitAssocMul:!1}}(r),s=function(t){let e=t;return e=e.replace(new RegExp(String.fromCharCode(8901),"g"),zs),e=e.replace(new RegExp(String.fromCharCode(8226),"g"),zs),e=e.replace(new RegExp(String.fromCharCode(12539),"g"),zs),e=e.replace(new RegExp(String.fromCharCode(55296),"g"),zs),e=e.replace(new RegExp(String.fromCharCode(65381),"g"),zs),e}(e);let i,o=0,a=0;const u=[],c=[];for(;;){try{tr.errorMessage="",[o,i]=Oo(s.substring(a),{useCaretForExponentiation:n.useCaretForExponentiation,explicitAssocAdd:n.explicitAssocAdd,explicitAssocMul:n.explicitAssocMul}),o>0&&u.push(i)}catch(t){t instanceof Error?c.push(t):c.push(new Error(`${t}`)),nr();break}if(0===o)break;if(o===e.length)break;a+=o}return{trees:u,errors:c}}_o=new WeakMap;const Jo=Q(F.exp),Xo={};class Yo{constructor(t){this.value=t}static get(t){return void 0===Xo[t]?new re(t):Xo[t]}}class ta{constructor(){this.name="CommentMarker",this.meta=0}contains(t){return t instanceof ta}equals(t){return t instanceof ta}isCons(){return!1}isNil(){return!1}reset(t){this.meta=t}}class ea{constructor(){this.name="EOS",this.meta=0}contains(t){return t instanceof ea}equals(t){return t instanceof ea}isCons(){return!1}isNil(){return!1}reset(t){this.meta=t}}class ra{constructor(t,e){this.car=t,this.cdr=e,this.name="Pair",this.meta=0}contains(t){throw new Error("Method not implemented.")}equals(t){throw new Error("Method not implemented.")}isCons(){throw new Error("Method not implemented.")}isNil(){throw new Error("Method not implemented.")}reset(t){throw new Error("Method not implemented.")}toString(){return`Pair(${this.car} ${this.cdr})`}}var na,sa,ia,oa,aa,ua,ca,la,fa;const ha=new ea,pa=new ta;class da{constructor(t){this.chars=t,this.pos=0}get curr(){return this.chars[this.pos]}get next(){return this.chars[this.pos+1]}consumeChars(t){this.pos+=t}currEquals(t){return this.curr===t}}class ma{constructor(t){this.chars=t,na.set(this,void 0)}get num(){if(e(this,na,"f"))return e(this,na,"f");throw new Error}flt(){r(this,na,(new lo).parse(this.chars,0,0),"f")}int(){r(this,na,(new fo).parse(this.chars,0,0),"f")}}na=new WeakMap;let ga=class{constructor(t,e){this.options=e,sa.add(this),ia.set(this,0),oa.set(this,[]),r(this,oa,function(t){const e=[];let r=null,n=0;for(;""!=t&&r!=t;)r=t,t=t.replace(/^\s*(;[^\r\n]*(\r|\n|$)|#;|#\||#\\[^\w]|#?(\(|\[|{)|\)|\]|}|'|`|,@|,|\+inf\.0|-inf\.0|\+nan\.0|"(\\(.|$)|[^"\\])*("|$)|[^\s()[\]{}]+)/,(function(t,r){const s=r;if("#|"==s)return n++,"";if(n>0){if(/(.*\|#)/.test(s)){if(n--,n<0)throw new Error("Found an extra comment terminator: `|#'");return s.substring(RegExp.$1.length,s.length)}return""}return";"!=s.charAt(0)&&(e[e.length]=s),""}));return e}(t),"f")}value(){return wa(e(this,sa,"m",aa).call(this))}};function wa(t){if(t instanceof ra){return u(wa(t.car),wa(t.cdr))}return t}function _a(t,e){return e&&e.lexicon&&e.lexicon[t]?e.lexicon[t]:B(t)}function xa(t,e){if(!t)throw new Error(e)}function ya(t){xa(!1,t)}function va(t){return"number"==typeof t}function ba(t){return xa(void 0!==t),Array.isArray(t.children)?t.children.length:0}function Oa(t,e){return xa(void 0!==e&&e>=0),Ea(t)[e]}function Ea(t){if(xa(void 0!==t),t.children)return t.children;throw new Error("node does not have any children")}function Sa(t){return t.length-1}var Ta;ia=new WeakMap,oa=new WeakMap,sa=new WeakSet,aa=function t(){let r=e(this,sa,"m",ca).call(this);if(r!==pa)return r;if(r=e(this,sa,"m",t).call(this),r===ha)throw new Error("Readable object not found after S expression comment.");return r=e(this,sa,"m",t).call(this),r},ua=function(t){var n,s;let i=l,o=i;for(;e(this,ia,"f")<e(this,oa,"f").length;){if(e(this,sa,"m",fa).call(this,"Input stream terminated unexpectedly (in list)."),")"===e(this,oa,"f")[e(this,ia,"f")]||"]"===e(this,oa,"f")[e(this,ia,"f")]||"}"===e(this,oa,"f")[e(this,ia,"f")]){r(this,ia,(n=e(this,ia,"f"),++n),"f");break}if("."===e(this,oa,"f")[e(this,ia,"f")]){r(this,ia,(s=e(this,ia,"f"),++s),"f");const t=e(this,sa,"m",aa).call(this);t!==ha&&i!==l&&(o.cdr=t)}else{const t=new ra(e(this,sa,"m",aa).call(this),l);i===l?i=t:o.cdr=t,o=t}}return i},ca=function(){var t,n;if(e(this,ia,"f")>=e(this,oa,"f").length)return ha;const s=e(this,oa,"f")[(r(this,ia,(n=e(this,ia,"f"),t=n++,n),"f"),t)];if("#;"==s)return pa;const i="'"==s?"quote":"`"==s?"quasiquote":","==s?"unquote":",@"==s&&"unquote-splicing";if(i||"("==s||"#("==s||"["==s||"#["==s||"{"==s||"#{"==s)return i?new ra(_a(i,this.options),new ra(e(this,sa,"m",aa).call(this),l)):"("==s||"["==s||"{"==s?e(this,sa,"m",ua).call(this,s):e(this,sa,"m",la).call(this,s);switch(s){case"+inf.0":return new X(1/0);case"-inf.0":return new X(-1/0);case"+nan.0":return new X(NaN)}if(/^#x[0-9a-z]+$/i.test(s))return Ft(new Number("0x"+s.substring(2,s.length)).valueOf());if(/^#d[0-9.]+$/i.test(s))return J(new Number(s.substring(2,s.length)).valueOf());{const t=new da(s),e=new ma(s);if(mo(t,e))return e.num}if("#f"==s||"#F"==s)return G.valueOf(!1);if("#t"==s||"#T"==s)return G.valueOf(!0);if("#\\newline"==s.toLowerCase())return Yo.get("\n");if("#\\space"==s.toLowerCase())return Yo.get(" ");if("#\\tab"==s.toLowerCase())return Yo.get("\t");if(/^#\\.$/.test(s))return Yo.get(s.charAt(2));if(/^#\\x[a-zA-Z0-9]+$/.test(s)){const t=parseInt(s.slice(3),16);if(t>=55296&&t<=57343)throw new Error("Character in Unicode excluded range.");if(t>65535)throw new Error("Character literal out of range.");return Yo.get(String.fromCharCode(t))}if(/^"(\\(.|$)|[^"\\])*"?$/.test(s)){const t=s.replace(/(\r?\n|\\n)/g,"\n").replace(/^"|\\(.|$)|"$/g,(function(t,e){return e||""}));return new re(t)}return _a(s,this.options)},la=function(t){var n;const s=[];for(;e(this,ia,"f")<e(this,oa,"f").length;){if(e(this,sa,"m",fa).call(this,"Input stream terminated unexpectedly(in vector)"),")"==e(this,oa,"f")[e(this,ia,"f")]||"]"==e(this,oa,"f")[e(this,ia,"f")]||"}"==e(this,oa,"f")[e(this,ia,"f")]){r(this,ia,(n=e(this,ia,"f"),++n),"f");break}s[s.length]=e(this,sa,"m",aa).call(this)}return c(...s)},fa=function(t){for(var n;"#;"==e(this,oa,"f")[e(this,ia,"f")];)if(r(this,ia,(n=e(this,ia,"f"),++n),"f"),e(this,sa,"m",aa).call(this)==ha||e(this,ia,"f")>=e(this,oa,"f").length)throw new Error(t)},function(t){t[t.T_ENDMARKER=0]="T_ENDMARKER",t[t.T_NAME=1]="T_NAME",t[t.T_NUMBER=2]="T_NUMBER",t[t.T_STRING=3]="T_STRING",t[t.T_NEWLINE=4]="T_NEWLINE",t[t.T_INDENT=5]="T_INDENT",t[t.T_DEDENT=6]="T_DEDENT",t[t.T_LPAR=7]="T_LPAR",t[t.T_RPAR=8]="T_RPAR",t[t.T_LSQB=9]="T_LSQB",t[t.T_RSQB=10]="T_RSQB",t[t.T_COLON=11]="T_COLON",t[t.T_COMMA=12]="T_COMMA",t[t.T_SEMI=13]="T_SEMI",t[t.T_PLUS=14]="T_PLUS",t[t.T_MINUS=15]="T_MINUS",t[t.T_STAR=16]="T_STAR",t[t.T_SLASH=17]="T_SLASH",t[t.T_VBAR=18]="T_VBAR",t[t.T_AMPER=19]="T_AMPER",t[t.T_LESS=20]="T_LESS",t[t.T_GREATER=21]="T_GREATER",t[t.T_EQUAL=22]="T_EQUAL",t[t.T_DOT=23]="T_DOT",t[t.T_PERCENT=24]="T_PERCENT",t[t.T_BACKQUOTE=25]="T_BACKQUOTE",t[t.T_LBRACE=26]="T_LBRACE",t[t.T_RBRACE=27]="T_RBRACE",t[t.T_EQEQUAL=28]="T_EQEQUAL",t[t.T_NOTEQUAL=29]="T_NOTEQUAL",t[t.T_LESSEQUAL=30]="T_LESSEQUAL",t[t.T_GREATEREQUAL=31]="T_GREATEREQUAL",t[t.T_TILDE=32]="T_TILDE",t[t.T_CIRCUMFLEX=33]="T_CIRCUMFLEX",t[t.T_LEFTSHIFT=34]="T_LEFTSHIFT",t[t.T_RIGHTSHIFT=35]="T_RIGHTSHIFT",t[t.T_DOUBLESTAR=36]="T_DOUBLESTAR",t[t.T_PLUSEQUAL=37]="T_PLUSEQUAL",t[t.T_MINEQUAL=38]="T_MINEQUAL",t[t.T_STAREQUAL=39]="T_STAREQUAL",t[t.T_SLASHEQUAL=40]="T_SLASHEQUAL",t[t.T_PERCENTEQUAL=41]="T_PERCENTEQUAL",t[t.T_AMPEREQUAL=42]="T_AMPEREQUAL",t[t.T_VBAREQUAL=43]="T_VBAREQUAL",t[t.T_CIRCUMFLEXEQUAL=44]="T_CIRCUMFLEXEQUAL",t[t.T_LEFTSHIFTEQUAL=45]="T_LEFTSHIFTEQUAL",t[t.T_RIGHTSHIFTEQUAL=46]="T_RIGHTSHIFTEQUAL",t[t.T_DOUBLESTAREQUAL=47]="T_DOUBLESTAREQUAL",t[t.T_DOUBLESLASH=48]="T_DOUBLESLASH",t[t.T_DOUBLESLASHEQUAL=49]="T_DOUBLESLASHEQUAL",t[t.T_AT=50]="T_AT",t[t.T_ATEQUAL=51]="T_ATEQUAL",t[t.T_OP=52]="T_OP",t[t.T_COMMENT=53]="T_COMMENT",t[t.T_NL=54]="T_NL",t[t.T_RARROW=55]="T_RARROW",t[t.T_AWAIT=56]="T_AWAIT",t[t.T_ASYNC=57]="T_ASYNC",t[t.T_ERRORTOKEN=58]="T_ERRORTOKEN",t[t.T_N_TOKENS=59]="T_N_TOKENS",t[t.T_NT_OFFSET=256]="T_NT_OFFSET"}(Ta||(Ta={}));const qa={"(":Ta.T_LPAR,")":Ta.T_RPAR,"[":Ta.T_LSQB,"]":Ta.T_RSQB,":":Ta.T_COLON,",":Ta.T_COMMA,";":Ta.T_SEMI,"+":Ta.T_PLUS,"-":Ta.T_MINUS,"*":Ta.T_STAR,"/":Ta.T_SLASH,"|":Ta.T_VBAR,"&":Ta.T_AMPER,"<":Ta.T_LESS,">":Ta.T_GREATER,"=":Ta.T_EQUAL,".":Ta.T_DOT,"%":Ta.T_PERCENT,"`":Ta.T_BACKQUOTE,"{":Ta.T_LBRACE,"}":Ta.T_RBRACE,"@":Ta.T_AT,"==":Ta.T_EQEQUAL,"!=":Ta.T_NOTEQUAL,"<>":Ta.T_NOTEQUAL,"<=":Ta.T_LESSEQUAL,">=":Ta.T_GREATEREQUAL,"~":Ta.T_TILDE,"^":Ta.T_CIRCUMFLEX,"<<":Ta.T_LEFTSHIFT,">>":Ta.T_RIGHTSHIFT,"**":Ta.T_DOUBLESTAR,"+=":Ta.T_PLUSEQUAL,"-=":Ta.T_MINEQUAL,"*=":Ta.T_STAREQUAL,"/=":Ta.T_SLASHEQUAL,"%=":Ta.T_PERCENTEQUAL,"&=":Ta.T_AMPEREQUAL,"|=":Ta.T_VBAREQUAL,"^=":Ta.T_CIRCUMFLEXEQUAL,"<<=":Ta.T_LEFTSHIFTEQUAL,">>=":Ta.T_RIGHTSHIFTEQUAL,"**=":Ta.T_DOUBLESTAREQUAL,"//":Ta.T_DOUBLESLASH,"//=":Ta.T_DOUBLESLASHEQUAL,"->":Ta.T_RARROW},Aa=0,Ma=1,Na={sym:{AndExpr:257,ArithmeticExpr:258,AtomExpr:259,BitwiseAndExpr:260,BitwiseOrExpr:261,BitwiseXorExpr:262,ComparisonExpr:263,ExprList:264,ExprStmt:265,GeometricExpr:266,GlobalStmt:267,IfExpr:268,ImportList:269,ImportSpecifier:270,LambdaExpr:271,ModuleSpecifier:272,NonLocalStmt:273,NotExpr:274,OrExpr:275,PowerExpr:276,ShiftExpr:277,UnaryExpr:278,YieldExpr:279,annasign:280,arglist:281,argument:282,assert_stmt:283,augassign:284,break_stmt:285,classdef:286,comp_op:287,compound_stmt:288,continue_stmt:289,decorated:290,decorator:291,decorators:292,del_stmt:293,dictmaker:294,dotted_as_name:295,dotted_as_names:296,dotted_name:297,encoding_decl:298,eval_input:299,except_clause:300,exec_stmt:301,file_input:302,flow_stmt:303,for_stmt:304,fpdef:305,fplist:306,funcdef:307,gen_for:308,gen_if:309,gen_iter:310,if_stmt:311,import_from:312,import_name:313,import_stmt:314,list_for:315,list_if:316,list_iter:317,listmaker:318,old_LambdaExpr:319,old_test:320,parameters:321,pass_stmt:322,print_stmt:323,raise_stmt:324,return_stmt:325,simple_stmt:326,single_input:256,sliceop:327,small_stmt:328,stmt:329,subscript:330,subscriptlist:331,suite:332,testlist:333,testlist1:334,testlist_gexp:335,testlist_safe:336,trailer:337,try_stmt:338,varargslist:339,while_stmt:340,with_stmt:341,with_var:342,yield_stmt:343},number2symbol:{256:"single_input",257:"AndExpr",258:"ArithmeticExpr",259:"AtomExpr",260:"BitwiseAndExpr",261:"BitwiseOrExpr",262:"BitwiseXorExpr",263:"ComparisonExpr",264:"ExprList",265:"ExprStmt",266:"GeometricExpr",267:"GlobalStmt",268:"IfExpr",269:"ImportList",270:"ImportSpecifier",271:"LambdaExpr",272:"ModuleSpecifier",273:"NonLocalStmt",274:"NotExpr",275:"OrExpr",276:"PowerExpr",277:"ShiftExpr",278:"UnaryExpr",279:"YieldExpr",280:"annasign",281:"arglist",282:"argument",283:"assert_stmt",284:"augassign",285:"break_stmt",286:"classdef",287:"comp_op",288:"compound_stmt",289:"continue_stmt",290:"decorated",291:"decorator",292:"decorators",293:"del_stmt",294:"dictmaker",295:"dotted_as_name",296:"dotted_as_names",297:"dotted_name",298:"encoding_decl",299:"eval_input",300:"except_clause",301:"exec_stmt",302:"file_input",303:"flow_stmt",304:"for_stmt",305:"fpdef",306:"fplist",307:"funcdef",308:"gen_for",309:"gen_if",310:"gen_iter",311:"if_stmt",312:"import_from",313:"import_name",314:"import_stmt",315:"list_for",316:"list_if",317:"list_iter",318:"listmaker",319:"old_LambdaExpr",320:"old_test",321:"parameters",322:"pass_stmt",323:"print_stmt",324:"raise_stmt",325:"return_stmt",326:"simple_stmt",327:"sliceop",328:"small_stmt",329:"stmt",330:"subscript",331:"subscriptlist",332:"suite",333:"testlist",334:"testlist1",335:"testlist_gexp",336:"testlist_safe",337:"trailer",338:"try_stmt",339:"varargslist",340:"while_stmt",341:"with_stmt",342:"with_var",343:"yield_stmt"},dfas:{256:[[[[1,1],[2,1],[3,2]],[[0,1]],[[1,1]]],{1:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1,30:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1}],257:[[[[38,1]],[[39,0],[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],258:[[[[40,1]],[[5,0],[6,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],259:[[[[8,1],[9,2],[10,3],[11,4],[12,5],[13,5],[14,6]],[[41,7],[42,7],[43,5]],[[44,8],[45,5]],[[46,9],[47,5]],[[48,10]],[[0,5]],[[14,6],[0,6]],[[43,5]],[[45,5]],[[47,5]],[[11,5]]],{8:1,9:1,10:1,11:1,12:1,13:1,14:1}],260:[[[[49,1]],[[50,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],261:[[[[51,1]],[[52,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],262:[[[[53,1]],[[54,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],263:[[[[55,1]],[[56,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],264:[[[[55,1]],[[57,2],[0,1]],[[55,1],[0,2]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],265:[[[[58,1]],[[59,2],[60,3],[61,4],[0,1]],[[0,2]],[[41,2],[58,2]],[[41,5],[58,5]],[[61,4],[0,5]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],266:[[[[62,1]],[[63,0],[64,0],[65,0],[66,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],267:[[[[26,1]],[[12,2]],[[57,1],[0,2]]],{26:1}],268:[[[[67,1],[68,2]],[[30,3],[0,1]],[[0,2]],[[67,4]],[[69,5]],[[70,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],269:[[[[71,1]],[[57,2],[0,1]],[[71,1],[0,2]]],{12:1}],270:[[[[12,1]],[[72,2],[0,1]],[[12,3]],[[0,3]]],{12:1}],271:[[[[15,1]],[[73,2],[74,3]],[[74,3]],[[70,4]],[[0,4]]],{15:1}],272:[[[[14,1]],[[0,1]]],{14:1}],273:[[[[27,1]],[[12,2]],[[57,1],[0,2]]],{27:1}],274:[[[[4,1],[75,2]],[[38,2]],[[0,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],275:[[[[76,1]],[[77,0],[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],276:[[[[78,1]],[[79,1],[80,2],[0,1]],[[49,3]],[[0,3]]],{8:1,9:1,10:1,11:1,12:1,13:1,14:1}],277:[[[[81,1]],[[82,0],[83,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],278:[[[[5,1],[6,1],[7,1],[84,2]],[[49,2]],[[0,2]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],279:[[[[23,1]],[[58,2],[0,1]],[[0,2]]],{23:1}],280:[[[[74,1]],[[70,2]],[[61,3],[0,2]],[[70,4]],[[0,4]]],{74:1}],281:[[[[85,1],[63,2],[80,3]],[[57,4],[0,1]],[[70,5]],[[70,6]],[[85,1],[63,2],[80,3],[0,4]],[[57,7],[0,5]],[[0,6]],[[85,5],[80,3]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,63:1,80:1}],282:[[[[70,1]],[[86,2],[61,3],[0,1]],[[0,2]],[[70,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],283:[[[[29,1]],[[70,2]],[[57,3],[0,2]],[[70,4]],[[0,4]]],{29:1}],284:[[[[87,1],[88,1],[89,1],[90,1],[91,1],[92,1],[93,1],[94,1],[95,1],[96,1],[97,1],[98,1]],[[0,1]]],{87:1,88:1,89:1,90:1,91:1,92:1,93:1,94:1,95:1,96:1,97:1,98:1}],285:[[[[19,1]],[[0,1]]],{19:1}],286:[[[[36,1]],[[12,2]],[[8,3],[74,4]],[[58,5],[43,6]],[[99,7]],[[43,6]],[[74,4]],[[0,7]]],{36:1}],287:[[[[100,1],[101,1],[102,1],[103,1],[104,1],[105,1],[105,1],[106,1],[4,2],[107,3]],[[0,1]],[[106,1]],[[4,1],[0,3]]],{4:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1,107:1}],288:[[[[108,1],[109,1],[110,1],[111,1],[112,1],[113,1],[114,1],[115,1]],[[0,1]]],{30:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1}],289:[[[[20,1]],[[0,1]]],{20:1}],290:[[[[116,1]],[[114,2],[113,2]],[[0,2]]],{37:1}],291:[[[[37,1]],[[117,2]],[[8,3],[1,4]],[[118,5],[43,6]],[[0,4]],[[43,6]],[[1,4]]],{37:1}],292:[[[[119,1]],[[119,1],[0,1]]],{37:1}],293:[[[[17,1]],[[120,2]],[[0,2]]],{17:1}],294:[[[[70,1]],[[74,2]],[[70,3]],[[57,4],[0,3]],[[70,1],[0,4]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],295:[[[[117,1]],[[72,2],[0,1]],[[12,3]],[[0,3]]],{12:1}],296:[[[[121,1]],[[57,0],[0,1]]],{12:1}],297:[[[[12,1]],[[122,0],[0,1]]],{12:1}],298:[[[[12,1]],[[0,1]]],{12:1}],299:[[[[58,1]],[[1,1],[123,2]],[[0,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],300:[[[[124,1]],[[70,2],[0,1]],[[72,3],[57,3],[0,2]],[[70,4]],[[0,4]]],{124:1}],301:[[[[28,1]],[[55,2]],[[106,3],[0,2]],[[70,4]],[[57,5],[0,4]],[[70,6]],[[0,6]]],{28:1}],302:[[[[1,0],[125,0],[123,1]],[[0,1]]],{1:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1,30:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1,123:1}],303:[[[[126,1],[127,1],[128,1],[129,1],[130,1]],[[0,1]]],{19:1,20:1,21:1,22:1,23:1}],304:[[[[32,1]],[[120,2]],[[106,3]],[[58,4]],[[74,5]],[[99,6]],[[69,7],[0,6]],[[74,8]],[[99,9]],[[0,9]]],{32:1}],305:[[[[12,1],[8,2]],[[74,3],[0,1]],[[131,4]],[[70,5]],[[43,5]],[[0,5]]],{8:1,12:1}],306:[[[[132,1]],[[57,2],[0,1]],[[132,1],[0,2]]],{8:1,12:1}],307:[[[[35,1]],[[12,2]],[[133,3]],[[134,4],[74,5]],[[70,6]],[[99,7]],[[74,5]],[[0,7]]],{35:1}],308:[[[[32,1]],[[120,2]],[[106,3]],[[67,4]],[[135,5],[0,4]],[[0,5]]],{32:1}],309:[[[[30,1]],[[136,2]],[[135,3],[0,2]],[[0,3]]],{30:1}],310:[[[[86,1],[137,1]],[[0,1]]],{30:1,32:1}],311:[[[[30,1]],[[70,2]],[[74,3]],[[99,4]],[[138,1],[69,5],[0,4]],[[74,6]],[[99,7]],[[0,7]]],{30:1}],312:[[[[25,1]],[[139,2]],[[24,3]],[[63,4],[8,5],[140,4]],[[0,4]],[[140,6]],[[43,4]]],{25:1}],313:[[[[24,1]],[[141,2]],[[0,2]]],{24:1}],314:[[[[142,1],[143,1]],[[0,1]]],{24:1,25:1}],315:[[[[32,1]],[[120,2]],[[106,3]],[[144,4]],[[145,5],[0,4]],[[0,5]]],{32:1}],316:[[[[30,1]],[[136,2]],[[145,3],[0,2]],[[0,3]]],{30:1}],317:[[[[146,1],[147,1]],[[0,1]]],{30:1,32:1}],318:[[[[70,1]],[[146,2],[57,3],[0,1]],[[0,2]],[[70,4],[0,3]],[[57,3],[0,4]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],319:[[[[15,1]],[[73,2],[74,3]],[[74,3]],[[136,4]],[[0,4]]],{15:1}],320:[[[[67,1],[148,1]],[[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],321:[[[[8,1]],[[73,2],[43,3]],[[43,3]],[[0,3]]],{8:1}],322:[[[[18,1]],[[0,1]]],{18:1}],323:[[[[16,1]],[[70,2],[83,3],[0,1]],[[57,4],[0,2]],[[70,5]],[[70,2],[0,4]],[[57,6],[0,5]],[[70,7]],[[57,8],[0,7]],[[70,7],[0,8]]],{16:1}],324:[[[[22,1]],[[70,2],[0,1]],[[57,3],[0,2]],[[70,4]],[[57,5],[0,4]],[[70,6]],[[0,6]]],{22:1}],325:[[[[21,1]],[[58,2],[0,1]],[[0,2]]],{21:1}],326:[[[[149,1]],[[150,2],[1,3]],[[149,1],[1,3]],[[0,3]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1}],327:[[[[74,1]],[[70,2],[0,1]],[[0,2]]],{74:1}],328:[[[[151,1],[152,1],[153,1],[154,1],[155,1],[156,1],[157,1],[158,1],[159,1],[160,1]],[[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1}],329:[[[[2,1],[3,1]],[[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1,30:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1}],330:[[[[122,1],[70,2],[74,3]],[[122,4]],[[74,3],[0,2]],[[70,5],[161,6],[0,3]],[[122,6]],[[161,6],[0,5]],[[0,6]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,74:1,122:1}],331:[[[[162,1]],[[57,2],[0,1]],[[162,1],[0,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,74:1,122:1}],332:[[[[2,1],[1,2]],[[0,1]],[[163,3]],[[125,4]],[[125,4],[164,1]]],{1:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1}],333:[[[[70,1]],[[57,2],[0,1]],[[70,1],[0,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],334:[[[[70,1]],[[57,0],[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],335:[[[[70,1]],[[86,2],[57,3],[0,1]],[[0,2]],[[70,4],[0,3]],[[57,3],[0,4]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],336:[[[[136,1]],[[57,2],[0,1]],[[136,3]],[[57,4],[0,3]],[[136,3],[0,4]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],337:[[[[8,1],[9,2],[122,3]],[[118,4],[43,5]],[[165,6]],[[12,5]],[[43,5]],[[0,5]],[[45,5]]],{8:1,9:1,122:1}],338:[[[[33,1]],[[74,2]],[[99,3]],[[166,4],[167,5]],[[74,6]],[[74,7]],[[99,8]],[[99,9]],[[166,4],[69,10],[167,5],[0,8]],[[0,9]],[[74,11]],[[99,12]],[[167,5],[0,12]]],{33:1}],339:[[[[132,1],[63,2],[80,3]],[[61,4],[57,5],[0,1]],[[12,6]],[[12,7]],[[70,8]],[[132,1],[63,2],[80,3],[0,5]],[[57,9],[0,6]],[[0,7]],[[57,5],[0,8]],[[80,3]]],{8:1,12:1,63:1,80:1}],340:[[[[31,1]],[[70,2]],[[74,3]],[[99,4]],[[69,5],[0,4]],[[74,6]],[[99,7]],[[0,7]]],{31:1}],341:[[[[34,1]],[[70,2]],[[168,3],[74,4]],[[74,4]],[[99,5]],[[0,5]]],{34:1}],342:[[[[72,1]],[[55,2]],[[0,2]]],{72:1}],343:[[[[41,1]],[[0,1]]],{23:1}]},states:[[[[1,1],[2,1],[3,2]],[[0,1]],[[1,1]]],[[[38,1]],[[39,0],[0,1]]],[[[40,1]],[[5,0],[6,0],[0,1]]],[[[8,1],[9,2],[10,3],[11,4],[12,5],[13,5],[14,6]],[[41,7],[42,7],[43,5]],[[44,8],[45,5]],[[46,9],[47,5]],[[48,10]],[[0,5]],[[14,6],[0,6]],[[43,5]],[[45,5]],[[47,5]],[[11,5]]],[[[49,1]],[[50,0],[0,1]]],[[[51,1]],[[52,0],[0,1]]],[[[53,1]],[[54,0],[0,1]]],[[[55,1]],[[56,0],[0,1]]],[[[55,1]],[[57,2],[0,1]],[[55,1],[0,2]]],[[[58,1]],[[59,2],[60,3],[61,4],[0,1]],[[0,2]],[[41,2],[58,2]],[[41,5],[58,5]],[[61,4],[0,5]]],[[[62,1]],[[63,0],[64,0],[65,0],[66,0],[0,1]]],[[[26,1]],[[12,2]],[[57,1],[0,2]]],[[[67,1],[68,2]],[[30,3],[0,1]],[[0,2]],[[67,4]],[[69,5]],[[70,2]]],[[[71,1]],[[57,2],[0,1]],[[71,1],[0,2]]],[[[12,1]],[[72,2],[0,1]],[[12,3]],[[0,3]]],[[[15,1]],[[73,2],[74,3]],[[74,3]],[[70,4]],[[0,4]]],[[[14,1]],[[0,1]]],[[[27,1]],[[12,2]],[[57,1],[0,2]]],[[[4,1],[75,2]],[[38,2]],[[0,2]]],[[[76,1]],[[77,0],[0,1]]],[[[78,1]],[[79,1],[80,2],[0,1]],[[49,3]],[[0,3]]],[[[81,1]],[[82,0],[83,0],[0,1]]],[[[5,1],[6,1],[7,1],[84,2]],[[49,2]],[[0,2]]],[[[23,1]],[[58,2],[0,1]],[[0,2]]],[[[74,1]],[[70,2]],[[61,3],[0,2]],[[70,4]],[[0,4]]],[[[85,1],[63,2],[80,3]],[[57,4],[0,1]],[[70,5]],[[70,6]],[[85,1],[63,2],[80,3],[0,4]],[[57,7],[0,5]],[[0,6]],[[85,5],[80,3]]],[[[70,1]],[[86,2],[61,3],[0,1]],[[0,2]],[[70,2]]],[[[29,1]],[[70,2]],[[57,3],[0,2]],[[70,4]],[[0,4]]],[[[87,1],[88,1],[89,1],[90,1],[91,1],[92,1],[93,1],[94,1],[95,1],[96,1],[97,1],[98,1]],[[0,1]]],[[[19,1]],[[0,1]]],[[[36,1]],[[12,2]],[[8,3],[74,4]],[[58,5],[43,6]],[[99,7]],[[43,6]],[[74,4]],[[0,7]]],[[[100,1],[101,1],[102,1],[103,1],[104,1],[105,1],[105,1],[106,1],[4,2],[107,3]],[[0,1]],[[106,1]],[[4,1],[0,3]]],[[[108,1],[109,1],[110,1],[111,1],[112,1],[113,1],[114,1],[115,1]],[[0,1]]],[[[20,1]],[[0,1]]],[[[116,1]],[[114,2],[113,2]],[[0,2]]],[[[37,1]],[[117,2]],[[8,3],[1,4]],[[118,5],[43,6]],[[0,4]],[[43,6]],[[1,4]]],[[[119,1]],[[119,1],[0,1]]],[[[17,1]],[[120,2]],[[0,2]]],[[[70,1]],[[74,2]],[[70,3]],[[57,4],[0,3]],[[70,1],[0,4]]],[[[117,1]],[[72,2],[0,1]],[[12,3]],[[0,3]]],[[[121,1]],[[57,0],[0,1]]],[[[12,1]],[[122,0],[0,1]]],[[[12,1]],[[0,1]]],[[[58,1]],[[1,1],[123,2]],[[0,2]]],[[[124,1]],[[70,2],[0,1]],[[72,3],[57,3],[0,2]],[[70,4]],[[0,4]]],[[[28,1]],[[55,2]],[[106,3],[0,2]],[[70,4]],[[57,5],[0,4]],[[70,6]],[[0,6]]],[[[1,0],[125,0],[123,1]],[[0,1]]],[[[126,1],[127,1],[128,1],[129,1],[130,1]],[[0,1]]],[[[32,1]],[[120,2]],[[106,3]],[[58,4]],[[74,5]],[[99,6]],[[69,7],[0,6]],[[74,8]],[[99,9]],[[0,9]]],[[[12,1],[8,2]],[[74,3],[0,1]],[[131,4]],[[70,5]],[[43,5]],[[0,5]]],[[[132,1]],[[57,2],[0,1]],[[132,1],[0,2]]],[[[35,1]],[[12,2]],[[133,3]],[[134,4],[74,5]],[[70,6]],[[99,7]],[[74,5]],[[0,7]]],[[[32,1]],[[120,2]],[[106,3]],[[67,4]],[[135,5],[0,4]],[[0,5]]],[[[30,1]],[[136,2]],[[135,3],[0,2]],[[0,3]]],[[[86,1],[137,1]],[[0,1]]],[[[30,1]],[[70,2]],[[74,3]],[[99,4]],[[138,1],[69,5],[0,4]],[[74,6]],[[99,7]],[[0,7]]],[[[25,1]],[[139,2]],[[24,3]],[[63,4],[8,5],[140,4]],[[0,4]],[[140,6]],[[43,4]]],[[[24,1]],[[141,2]],[[0,2]]],[[[142,1],[143,1]],[[0,1]]],[[[32,1]],[[120,2]],[[106,3]],[[144,4]],[[145,5],[0,4]],[[0,5]]],[[[30,1]],[[136,2]],[[145,3],[0,2]],[[0,3]]],[[[146,1],[147,1]],[[0,1]]],[[[70,1]],[[146,2],[57,3],[0,1]],[[0,2]],[[70,4],[0,3]],[[57,3],[0,4]]],[[[15,1]],[[73,2],[74,3]],[[74,3]],[[136,4]],[[0,4]]],[[[67,1],[148,1]],[[0,1]]],[[[8,1]],[[73,2],[43,3]],[[43,3]],[[0,3]]],[[[18,1]],[[0,1]]],[[[16,1]],[[70,2],[83,3],[0,1]],[[57,4],[0,2]],[[70,5]],[[70,2],[0,4]],[[57,6],[0,5]],[[70,7]],[[57,8],[0,7]],[[70,7],[0,8]]],[[[22,1]],[[70,2],[0,1]],[[57,3],[0,2]],[[70,4]],[[57,5],[0,4]],[[70,6]],[[0,6]]],[[[21,1]],[[58,2],[0,1]],[[0,2]]],[[[149,1]],[[150,2],[1,3]],[[149,1],[1,3]],[[0,3]]],[[[74,1]],[[70,2],[0,1]],[[0,2]]],[[[151,1],[152,1],[153,1],[154,1],[155,1],[156,1],[157,1],[158,1],[159,1],[160,1]],[[0,1]]],[[[2,1],[3,1]],[[0,1]]],[[[122,1],[70,2],[74,3]],[[122,4]],[[74,3],[0,2]],[[70,5],[161,6],[0,3]],[[122,6]],[[161,6],[0,5]],[[0,6]]],[[[162,1]],[[57,2],[0,1]],[[162,1],[0,2]]],[[[2,1],[1,2]],[[0,1]],[[163,3]],[[125,4]],[[125,4],[164,1]]],[[[70,1]],[[57,2],[0,1]],[[70,1],[0,2]]],[[[70,1]],[[57,0],[0,1]]],[[[70,1]],[[86,2],[57,3],[0,1]],[[0,2]],[[70,4],[0,3]],[[57,3],[0,4]]],[[[136,1]],[[57,2],[0,1]],[[136,3]],[[57,4],[0,3]],[[136,3],[0,4]]],[[[8,1],[9,2],[122,3]],[[118,4],[43,5]],[[165,6]],[[12,5]],[[43,5]],[[0,5]],[[45,5]]],[[[33,1]],[[74,2]],[[99,3]],[[166,4],[167,5]],[[74,6]],[[74,7]],[[99,8]],[[99,9]],[[166,4],[69,10],[167,5],[0,8]],[[0,9]],[[74,11]],[[99,12]],[[167,5],[0,12]]],[[[132,1],[63,2],[80,3]],[[61,4],[57,5],[0,1]],[[12,6]],[[12,7]],[[70,8]],[[132,1],[63,2],[80,3],[0,5]],[[57,9],[0,6]],[[0,7]],[[57,5],[0,8]],[[80,3]]],[[[31,1]],[[70,2]],[[74,3]],[[99,4]],[[69,5],[0,4]],[[74,6]],[[99,7]],[[0,7]]],[[[34,1]],[[70,2]],[[168,3],[74,4]],[[74,4]],[[99,5]],[[0,5]]],[[[72,1]],[[55,2]],[[0,2]]],[[[41,1]],[[0,1]]]],labels:[[0,"EMPTY"],[4,null],[326,null],[288,null],[1,"not"],[14,null],[15,null],[32,null],[7,null],[9,null],[26,null],[25,null],[1,null],[2,null],[3,null],[1,"lambda"],[1,"print"],[1,"del"],[1,"pass"],[1,"break"],[1,"continue"],[1,"return"],[1,"raise"],[1,"yield"],[1,"import"],[1,"from"],[1,"global"],[1,"nonlocal"],[1,"exec"],[1,"assert"],[1,"if"],[1,"while"],[1,"for"],[1,"try"],[1,"with"],[1,"def"],[1,"class"],[50,null],[274,null],[1,"and"],[266,null],[279,null],[335,null],[8,null],[318,null],[10,null],[294,null],[27,null],[334,null],[278,null],[19,null],[262,null],[18,null],[260,null],[33,null],[258,null],[287,null],[12,null],[333,null],[280,null],[284,null],[22,null],[277,null],[16,null],[17,null],[24,null],[48,null],[275,null],[271,null],[1,"else"],[268,null],[270,null],[1,"as"],[339,null],[11,null],[263,null],[257,null],[1,"or"],[259,null],[337,null],[36,null],[261,null],[34,null],[35,null],[276,null],[282,null],[308,null],[37,null],[38,null],[39,null],[40,null],[41,null],[42,null],[43,null],[44,null],[45,null],[46,null],[47,null],[49,null],[332,null],[20,null],[21,null],[28,null],[31,null],[30,null],[29,null],[1,"in"],[1,"is"],[311,null],[340,null],[304,null],[338,null],[341,null],[307,null],[286,null],[290,null],[292,null],[297,null],[281,null],[291,null],[264,null],[295,null],[23,null],[0,null],[1,"except"],[329,null],[285,null],[289,null],[325,null],[324,null],[343,null],[306,null],[305,null],[321,null],[55,null],[310,null],[320,null],[309,null],[1,"elif"],[272,null],[269,null],[296,null],[313,null],[312,null],[336,null],[317,null],[315,null],[316,null],[319,null],[328,null],[13,null],[265,null],[323,null],[293,null],[322,null],[303,null],[314,null],[267,null],[273,null],[301,null],[283,null],[327,null],[330,null],[5,null],[6,null],[331,null],[300,null],[1,"finally"],[342,null]],keywords:{and:39,as:72,assert:29,break:19,class:36,continue:20,def:35,del:17,elif:138,else:69,except:124,exec:28,finally:167,for:32,from:25,global:26,if:30,import:24,in:106,is:107,lambda:15,nonlocal:27,not:4,or:77,pass:18,print:16,raise:22,return:21,try:33,while:31,with:34,yield:23},tokens:{0:123,1:12,2:13,3:14,4:1,5:163,6:164,7:8,8:43,9:9,10:45,11:74,12:57,13:150,14:5,15:6,16:63,17:64,18:52,19:50,20:100,21:101,22:61,23:122,24:65,25:11,26:10,27:47,28:102,29:105,30:104,31:103,32:7,33:54,34:82,35:83,36:80,37:87,38:88,39:89,40:90,41:91,42:92,43:93,44:94,45:95,46:96,47:97,48:66,49:98,50:37,55:134},start:256},$a={};function La(t){const e=$a[t];return e||Na.number2symbol[t]}$a[Ta.T_AMPER]="T_AMPER",$a[Ta.T_AMPEREQUAL]="T_AMPEREQUAL",$a[Ta.T_AT]="T_AT",$a[Ta.T_BACKQUOTE]="T_BACKQUOTE",$a[Ta.T_CIRCUMFLEX]="T_CIRCUMFLEX",$a[Ta.T_CIRCUMFLEXEQUAL]="T_CIRCUMFLEXEQUAL",$a[Ta.T_COLON]="T_COLON",$a[Ta.T_COMMA]="T_COMMA",$a[Ta.T_COMMENT]="T_COMMENT",$a[Ta.T_DEDENT]="T_DEDENT",$a[Ta.T_DOT]="T_DOT",$a[Ta.T_DOUBLESLASH]="T_DOUBLESLASH",$a[Ta.T_DOUBLESLASHEQUAL]="T_DOUBLESLASHEQUAL",$a[Ta.T_DOUBLESTAR]="T_DOUBLESTAR",$a[Ta.T_DOUBLESTAREQUAL]="T_DOUBLESTAREQUAL",$a[Ta.T_ENDMARKER]="T_ENDMARKER",$a[Ta.T_EQEQUAL]="T_EQEQUAL",$a[Ta.T_EQUAL]="T_EQUAL",$a[Ta.T_ERRORTOKEN]="T_ERRORTOKEN",$a[Ta.T_GREATER]="T_GREATER",$a[Ta.T_GREATEREQUAL]="T_GREATEREQUAL",$a[Ta.T_INDENT]="T_INDENT",$a[Ta.T_LBRACE]="T_LBRACE",$a[Ta.T_LEFTSHIFT]="T_LEFTSHIFT",$a[Ta.T_LEFTSHIFTEQUAL]="T_LEFTSHIFTEQUAL",$a[Ta.T_LESS]="T_LESS",$a[Ta.T_LESSEQUAL]="T_LESSEQUAL",$a[Ta.T_LPAR]="T_LPAR",$a[Ta.T_LSQB]="T_LSQB",$a[Ta.T_MINEQUAL]="T_MINEQUAL",$a[Ta.T_MINUS]="T_MINUS",$a[Ta.T_N_TOKENS]="T_N_TOKENS",$a[Ta.T_NAME]="T_NAME",$a[Ta.T_NEWLINE]="T_NEWLINE",$a[Ta.T_NL]="T_NL",$a[Ta.T_NOTEQUAL]="T_NOTEQUAL",$a[Ta.T_NT_OFFSET]="T_NT_OFFSET",$a[Ta.T_NUMBER]="T_NUMBER",$a[Ta.T_OP]="T_OP",$a[Ta.T_PERCENT]="T_PERCENT",$a[Ta.T_PERCENTEQUAL]="T_PERCENTEQUAL",$a[Ta.T_PLUS]="T_PLUS",$a[Ta.T_PLUSEQUAL]="T_PLUSEQUAL",$a[Ta.T_RARROW]="T_RARROW",$a[Ta.T_RBRACE]="T_RBRACE",$a[Ta.T_RIGHTSHIFT]="T_RIGHTSHIFT",$a[Ta.T_RPAR]="T_RPAR",$a[Ta.T_RSQB]="T_RSQB",$a[Ta.T_SEMI]="T_SEMI",$a[Ta.T_SLASH]="T_SLASH",$a[Ta.T_SLASHEQUAL]="T_SLASHEQUAL",$a[Ta.T_STAR]="T_STAR",$a[Ta.T_STAREQUAL]="T_STAREQUAL",$a[Ta.T_STRING]="T_STRING",$a[Ta.T_TILDE]="T_TILDE",$a[Ta.T_VBAR]="T_VBAR",$a[Ta.T_VBAREQUAL]="T_VBAREQUAL";class ka extends Error{constructor(t,e,r){super(t),this.lineNumber=e,this.columnNumber=r,xa(va(e),"lineNumber must be a number"),xa(va(r),"columnNumber must be a number")}}const Ra=Ta.T_COMMENT,Ia=Ta.T_DEDENT,Pa=Ta.T_ENDMARKER,Fa=Ta.T_ERRORTOKEN,Ua=Ta.T_INDENT,Ca=Ta.T_NAME,Da=Ta.T_NEWLINE,Ba=Ta.T_NL,Ka=Ta.T_NUMBER,za=Ta.T_OP,Qa=Ta.T_STRING,Za=du("0[bB][01]*","0[xX][\\da-fA-F]*[lL]?","0[oO]?[0-7]*[lL]?","[1-9]\\d*[lL]?"),Ga="[eE][-+]?\\d+",Ha=du("\\d+\\.\\d*","\\.\\d+")+function(t){return du.apply(null,arguments)+"?"}(Ga),Va=du(Ha,"\\d+"+Ga),ja=du("\\d+[jJ]",Va+"[jJ]"),Wa=du(ja,Va,Za),Ja=du("[ubUB]?[rR]?'''",'[ubUB]?[rR]?"""'),Xa=du("\\*\\*=?",">>=?","<<=?","<>","!=","//=?","->","[+\\-*/%&|^=<>]=?","~"),Ya=du("\\r?\\n","[:;.,`@]"),tu=du(Xa,"[\\][(){}]",Ya),eu=du("[uUbB]?[rR]?'[^\\n'\\\\]*(?:\\\\.[^\\n'\\\\]*)*"+du("'","\\\\\\r?\\n"),'[uUbB]?[rR]?"[^\\n"\\\\]*(?:\\\\.[^\\n"\\\\]*)*'+du('"',"\\\\\\r?\\n")),ru=du("\\\\\\r?\\n","#[^\\r\\n]*",Ja,"'{3}[^]*'{3}"),nu="^"+du(ru,Wa,tu,eu,"[a-zA-Z_]\\w*"),su=new RegExp(nu),iu=new RegExp("[^'\\\\]*(?:(?:\\\\.|'(?!''))[^'\\\\]*)*'''","g"),ou=new RegExp('[^"\\\\]*(?:(?:\\\\.|"(?!""))[^"\\\\]*)*"""',"g"),au={"'":new RegExp("^[^'\\\\]*(?:\\\\.[^'\\\\]*)*'","g"),'"':new RegExp('^[^"\\\\]*(?:\\\\.[^"\\\\]*)*"',"g"),"'''":iu,'"""':ou,"r'''":iu,'r"""':ou,"u'''":iu,'u"""':ou,"b'''":iu,'b"""':ou,"ur'''":iu,'ur"""':ou,"br'''":iu,'br"""':ou,"R'''":iu,'R"""':ou,"U'''":iu,'U"""':ou,"B'''":iu,'B"""':ou,"uR'''":iu,'uR"""':ou,"Ur'''":iu,'Ur"""':ou,"UR'''":iu,'UR"""':ou,"bR'''":iu,'bR"""':ou,"Br'''":iu,'Br"""':ou,"BR'''":iu,'BR"""':ou,r:null,R:null,u:null,U:null,b:null,B:null},uu={"'''":!0,'"""':!0,"r'''":!0,'r"""':!0,"R'''":!0,'R"""':!0,"u'''":!0,'u"""':!0,"U'''":!0,'U"""':!0,"b'''":!0,'b"""':!0,"B'''":!0,'B"""':!0,"ur'''":!0,'ur"""':!0,"Ur'''":!0,'Ur"""':!0,"uR'''":!0,'uR"""':!0,"UR'''":!0,'UR"""':!0,"br'''":!0,'br"""':!0,"Br'''":!0,'Br"""':!0,"bR'''":!0,'bR"""':!0,"BR'''":!0,'BR"""':!0},cu={"'":!0,'"':!0,"r'":!0,'r"':!0,"R'":!0,'R"':!0,"u'":!0,'u"':!0,"U'":!0,'U"':!0,"b'":!0,'b"':!0,"B'":!0,'B"':!0,"ur'":!0,'ur"':!0,"Ur'":!0,'Ur"':!0,"uR'":!0,'uR"':!0,"UR'":!0,'UR"':!0,"br'":!0,'br"':!0,"Br'":!0,'Br"':!0,"bR'":!0,'bR"':!0,"BR'":!0,'BR"':!0},lu=0,fu=1,hu="done";class pu{constructor(t,e){this.callback=e,this.begin=[-1,-1],this.end=[-1,-1],this.lnum=0,this.parenlev=0,this.strstart=[-1,-1],this.callback=e,this.continued=!1,this.contstr="",this.needcont=!1,this.contline=void 0,this.indents=[0],this.endprog=/.*/,this.interactive=t,this.doneFunc=function(){const t=this.begin,r=this.end;t[lu]=r[lu]=this.lnum,t[fu]=r[fu]=0;const n=this.indents.length;for(let s=1;s<n;++s)if(e(Ia,"",t,r,""))return hu;return e(Pa,"",t,r,"")?hu:"failed"}}generateTokens(t){let e,r,n;t||(t=""),this.lnum+=1;let s=0,i=t.length;const o=this.callback,a=this.begin;a[lu]=this.lnum;const u=this.end;if(u[lu]=this.lnum,this.contstr.length>0){if(!t)throw new ka("EOF in multi-line string",this.strstart[lu],this.strstart[fu]);if(this.endprog.lastIndex=0,e=this.endprog.test(t),!e)return this.needcont&&"\\\n"!==t.substring(t.length-2)&&"\\\r\n"!==t.substring(t.length-3)?(xa("string"==typeof this.contline),u[fu]=t.length,o(Fa,this.contstr+t,this.strstart,u,this.contline)?hu:(this.contstr="",this.contline=void 0,!1)):(this.contstr+=t,this.contline=this.contline+t,!1);if(s=n=this.endprog.lastIndex,u[fu]=n,o(Qa,this.contstr+t.substring(0,n),this.strstart,u,this.contline+t))return hu;this.contstr="",this.needcont=!1,this.contline=void 0}else if(0!==this.parenlev||this.continued){if(!t)throw new ka("EOF in multi-line statement",this.lnum,0);this.continued=!1}else{if(!t)return this.doneFunc();for(r=0;s<i;){const e=t.charAt(s);if(" "===e)r+=1;else if("\t"===e)r=8*(r/8+1);else{if("\f"!==e)break;r=0}s+=1}if(s===i)return this.doneFunc();if(-1!=="#\r\n".indexOf(t.charAt(s))){if("#"===t.charAt(s)){const e=function(t,e){let r;for(r=t.length;r>0&&-1!==e.indexOf(t.charAt(r-1));--r);return t.substring(0,r)}(t.substring(s),"\r\n"),r=s+e.length;return a[fu]=s,u[fu]=r,o(Ra,e,a,u,t)?hu:(a[fu]=r,u[fu]=t.length,!!o(Ba,t.substring(r),a,u,t)&&hu)}if(a[fu]=s,u[fu]=t.length,o(Ba,t.substring(s),a,u,t))return hu;if(!this.interactive)return!1}if(-1!=="'''".indexOf(t.charAt(s))){if("'"===t.charAt(s)){const e=t.substring(s),r=s+e.length;return a[fu]=s,u[fu]=r,o(Ra,e,a,u,t)?hu:(a[fu]=r,u[fu]=t.length,!!o(Ba,t.substring(r),a,u,t)&&hu)}if(a[fu]=s,u[fu]=t.length,o(Ba,t.substring(s),a,u,t))return hu;if(!this.interactive)return!1}if(r>this.indents[this.indents.length-1]&&(this.indents.push(r),a[fu]=0,u[fu]=s,o(Ua,t.substring(0,s),a,u,t)))return hu;for(;r<this.indents[this.indents.length-1];){if(!mu(this.indents,r))throw a[fu]=0,u[fu]=s,gu("unindent does not match any outer indentation level",a,u);if(this.indents.splice(this.indents.length-1,1),a[fu]=s,u[fu]=s,o(Ia,"",a,u,t))return hu}}for(;s<i;){let r=t.charAt(s);for(;" "===r||"\f"===r||"\t"===r;)s+=1,r=t.charAt(s);su.lastIndex=0;const i=su.exec(t.substring(s));if(i){const r=s;n=r+i[1].length,a[fu]=r,u[fu]=n,s=n;const c=t.substring(r,n),l=t.charAt(r);if(-1!=="0123456789".indexOf(l)||"."===l&&"."!==c){if(o(Ka,c,a,u,t))return hu}else if("\r"===l||"\n"===l){let e=Da;if(this.parenlev>0&&(e=Ba),o(e,c,a,u,t))return hu}else if("#"===l||"'''"===l){if(o(Ra,c,a,u,t))return hu}else if(uu.hasOwnProperty(c)){if(this.endprog=au[c],this.endprog.lastIndex=0,e=this.endprog.test(t.substring(s)),!e)return this.strstart[lu]=this.lnum,this.strstart[fu]=r,this.contstr=t.substring(r),this.contline=t,!1;{s=this.endprog.lastIndex+s;const e=t.substring(r,s);if(u[fu]=s,o(Qa,e,a,u,t))return hu}}else if(cu.hasOwnProperty(l)||cu.hasOwnProperty(c.substring(0,2))||cu.hasOwnProperty(c.substring(0,3))){if("\n"===c[c.length-1])return this.endprog=au[l]||au[c[1]]||au[c[2]],xa(this.endprog instanceof RegExp),this.contstr=t.substring(r),this.needcont=!0,this.contline=t,!1;if(o(Qa,c,a,u,t))return hu}else if(-1!=="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_".indexOf(l)){if(o(Ca,c,a,u,t))return hu}else if("\\"===l){if(u[fu]=s,o(Ba,c,a,u,t))return hu;this.continued=!0}else if(-1!=="([{".indexOf(l)?this.parenlev+=1:-1!==")]}".indexOf(l)&&(this.parenlev-=1),o(za,c,a,u,t))return hu}else{if(a[fu]=s,u[fu]=s+1,o(Fa,t.charAt(s),a,u,t))return hu;s+=1}}return!1}}function du(t,e,r,n,s,i,o,a,u,c){return"("+Array.prototype.slice.call(arguments).join("|")+")"}function mu(t,e){let r=t.length;for(;r--;)if(t[r]===e)return!0;return!1}function gu(t,e,r,n){xa(Array.isArray(e),"begin must be an Array"),xa(Array.isArray(r),"end must be an Array");const s=new SyntaxError(t);return s.name="IndentationError",e&&(s.lineNumber=e[lu],s.columnNumber=e[fu]),s}class wu{constructor(t,e){this.line=t,this.column=e}get row(){return this.line-1}toString(){return`[${this.line}, ${this.column}]`}}class _u extends SyntaxError{constructor(t){super(t),this.name="ParseError"}}class xu extends _u{constructor(t,e,r){super(`Unexpected ${t} at ${JSON.stringify([e[0],e[1]+1])}`),this.tokenName=t,this.name="UnexpectedTokenError",Array.isArray(e)&&(this.begin=new wu(e[0],e[1])),Array.isArray(r)&&(this.end=new wu(r[0],r[1]))}}function yu(t,e,r){const n=new _u(t);return Array.isArray(e)&&(n.begin=new wu(e[0],e[1])),Array.isArray(r)&&(n.end=new wu(r[0],r[1])),n}class vu{constructor(t,e){xa(t,"begin must be defined"),xa(e,"end must be defined"),this.begin=t,this.end=e}toString(){return`${this.begin} to ${this.end}`}}const bu=Ta.T_COMMENT,Ou=Ta.T_ENDMARKER,Eu=Ta.T_NAME,Su=Ta.T_NL,Tu=Ta.T_NT_OFFSET,qu=Ta.T_OP;class Au{constructor(t){this.stack=[],this.used_names={},this.grammar=t}setup(t){const e={type:t=t||this.grammar.start,range:null,value:null,children:[]},r={dfa:this.grammar.dfas[t][0],beginTokens:this.grammar.dfas[t][1],stateId:0,node:e};this.stack.push(r)}addtoken(t,e,r,n,s){const i=this.classify(t,e,r,n,s),o=this.stack,a=this.grammar,u=a.dfas,c=a.labels;t:for(;;){let a=o[o.length-1],l=a.dfa;const f=l[a.stateId];for(const h of f){const f=h[Aa],p=h[Ma],d=c[f][0];if(i===f){this.shiftToken(t,e,p,r,n,s);let i=p,u=l[i];for(;1===u.length&&0===u[0][Aa]&&u[0][Ma]===i;){this.popNonTerminal();const t=o.length;if(0===t)return!0;a=o[t-1],i=a.stateId,l=a.dfa,u=l[i]}return!1}if(Lu(d)){const t=u[d],e=t[0],o=t[1];if(o.hasOwnProperty(i)){this.pushNonTerminal(d,e,o,p,r,n,s);continue t}}}if(!Mu(f,[Ou,a.stateId])){const t=La(a.stateId);throw new xu(t,r,n)}if(this.popNonTerminal(),0===o.length)throw yu("too much input")}}classify(t,e,r,n,s){!function(t){xa(t<Tu,"terminal symbols should be less than T_NT_OFFSET")}(t);const i=this.grammar;if(t===Eu){this.used_names[e]=!0;const t=i.keywords;if(t.hasOwnProperty(e)){return t[e]}}const o=i.tokens;let a;if(o.hasOwnProperty(t)&&(a=o[t]),!a)throw yu("bad token",r,n);return a}shiftToken(t,e,r,n,s,i){const o=this.stack,a=o[o.length-1],u=a.node,c={type:t,value:e,range:new vu(new wu(n[0],n[1]),new wu(s[0],s[1])),children:null};c&&u.children&&u.children.push(c),a.stateId=r}pushNonTerminal(t,e,r,n,s,i,o){const a=this.stack;a[a.length-1].stateId=n;const u=s?new wu(s[0],s[1]):null,c=i?new wu(i[0],i[1]):null,l={type:t,value:null,range:new vu(u,c),children:[]};a.push({dfa:e,beginTokens:r,stateId:0,node:l})}popNonTerminal(){const t=this.stack,e=t.pop();if(e){const r=e.node;if(r){const e=t.length;if(0!==e){const n=t[e-1].node.children;n&&n.push(r)}else this.rootNode=r,r.used_names=this.used_names}}}}function Mu(t,e){let r=t.length;for(;r--;){const n=t[r];if(n[Aa]===e[Aa]&&n[Ma]===e[Ma])return!0}return!1}var Nu;function $u(t,e=Nu.File){const r=function(t){void 0===t&&(t=Nu.File);const e=new Au(Na);switch(t){case Nu.File:e.setup(Na.sym.file_input);break;case Nu.Eval:e.setup(Na.sym.eval_input);break;case Nu.Single:e.setup(Na.sym.single_input);break;default:throw new Error("SourceKind must be one of File, Eval, or Single.")}const r=new pu(t===Nu.Single,(function(t,r,n,s,i){return n[0],n[1],t===bu||t===Su?(s[0],s[1],void r[r.length-1]):(t===qu&&(t=qa[r]),!!e.addtoken(t,r,n,s,i)||void 0)}));return function(t){const n=r.generateTokens(t);if(n){if("done"!==n)throw yu("incomplete input");return e.rootNode}return!1}}(e),n=function(t){const e=[];"\n"!==t.substr(Sa(t),1)&&(t+="\n");const r=t.split("\n"),n=r.length;for(let t=0;t<n;++t){const n=r[t]+(t===Sa(r)?"":"\n");e.push(n)}return e}(t);let s=!1;for(const t of n)s=r(t);return s}function Lu(t){return t>=Tu}function ku(t){return{text:t,value:parseFloat(t),isFloat:function(){return!0},isInt:function(){return!1},isLong:function(){return!1},toString:function(){return t}}}function Ru(t){return{value:t,isFloat:function(){return!1},isInt:function(){return!0},isLong:function(){return!1},toString:function(){return""+t}}}function Iu(t,e){return{text:t,radix:e,isFloat:function(){return!1},isInt:function(){return!1},isLong:function(){return!0},toString:function(){return t}}}!function(t){t[t.File=0]="File",t[t.Eval=1]="Eval",t[t.Single=2]="Single"}(Nu||(Nu={}));class Pu{}class Fu{}class Uu{}class Cu{}class Du{}class Bu{}class Ku{}class zu{}class Qu{}class Zu{}class Gu{}class Hu{}class Vu{}class ju{}class Wu{}class Ju{}class Xu{}class Yu{}class tc{}class ec{}class rc{}class nc{}class sc{}class ic{}class oc{}class ac{}class uc{}class cc{}class lc{}class fc{}class hc{}class pc{}class dc{}class mc{}class gc{constructor(t,e){this.value=t,this.range=e,xa(void 0!==t,"value must be defined.")}}class wc{constructor(){}accept(t){throw new Error(`"Expression.accept" is not implemented. this=${JSON.stringify(this,null,2)}`)}}class _c{accept(t){throw new Error('"Statement.accept" is not implemented.')}}class xc extends _c{}class yc{constructor(t){this.body=t}accept(t){t.module(this)}}class vc extends _c{constructor(t,e,r,n,s,i){super(),this.range=i,this.name=t,this.args=e,this.body=r,this.decorator_list=s,this.returnType=n}accept(t){t.functionDef(this)}}class bc{constructor(t,e){this.name=t,this.type=e||null}}class Oc extends _c{constructor(t,e,r,n,s){super(),this.range=s,this.name=t,this.bases=e,this.body=r,this.decorator_list=n}accept(t){t.classDef(this)}}class Ec extends _c{constructor(t,e){super(),this.range=e,this.value=t}accept(t){t.returnStatement(this)}}class Sc extends _c{constructor(t,e){super(),this.range=e,this.targets=t}}class Tc extends _c{constructor(t,e,r,n,s){super(),this.range=r,this.eqRange=n,this.targets=t,this.value=e,s&&(this.type=s)}accept(t){t.assign(this)}}class qc extends _c{constructor(t,e,r,n){super(),this.range=n,this.target=t,this.op=e,this.value=r}}class Ac extends _c{constructor(t,e,r){super(),this.range=r,this.value=t,this.target=e}accept(t){t.annAssign(this)}}class Mc extends _c{constructor(t,e,r,n){super(),this.range=n,this.dest=t,this.values=e,this.nl=r}accept(t){t.print(this)}}class Nc extends _c{constructor(t,e,r,n,s){super(),this.range=s,this.target=t,this.iter=e,this.body=r,this.orelse=n}accept(t){t.forStatement(this)}}class $c extends xc{constructor(t,e,r,n){super(),this.range=n,this.test=t,this.body=e,this.orelse=r}}class Lc extends _c{constructor(t,e,r,n){super(),this.range=n,this.test=t,this.consequent=e,this.alternate=r}accept(t){t.ifStatement(this)}}class kc extends _c{constructor(t,e,r,n){super(),this.range=n,this.context_expr=t,this.optional_vars=e,this.body=r}}class Rc extends _c{constructor(t,e,r,n){super(),this.range=n,this.type=t,this.inst=e,this.tback=r}}class Ic extends _c{constructor(t,e,r,n){super(),this.range=n,this.body=t,this.handlers=e,this.orelse=r}}class Pc extends _c{constructor(t,e,r){super(),this.range=r,this.body=t,this.finalbody=e}}class Fc extends _c{constructor(t,e,r){super(),this.range=r,this.test=t,this.msg=e}}class Uc extends _c{constructor(t,e){super(),this.range=e,this.names=t}}class Cc extends _c{constructor(t,e,r,n){super(),this.range=n,xa("string"==typeof t.value,"module must be a string."),xa(Array.isArray(e),"names must be an Array."),this.module=t,this.names=e,this.level=r}accept(t){t.importFrom(this)}}class Dc extends _c{constructor(t,e,r,n){super(),this.range=n,this.body=t,this.globals=e,this.locals=r}}class Bc extends _c{constructor(t,e){super(),this.range=e,this.names=t}}class Kc extends _c{constructor(t,e){super(),this.range=e,this.names=t}}class zc extends _c{constructor(t,e){super(),this.range=e,this.value=t}accept(t){t.expressionStatement(this)}}class Qc extends _c{constructor(t){super(),this.range=t}}class Zc extends _c{constructor(t){super(),this.range=t}}class Gc extends _c{constructor(t){super(),this.range=t}}class Hc extends wc{constructor(t,e,r){super(),this.range=r,this.op=t,this.values=e}}class Vc extends wc{constructor(t,e,r,n){super(),this.range=n,this.lhs=t,this.op=e.op,this.opRange=e.range,this.rhs=r}accept(t){t.binOp(this)}}class jc extends wc{constructor(t,e,r){super(),this.op=t,this.operand=e,this.range=r,xa(t===sc||t===ic||t===rc||t===nc,"op must be defined."),xa(!!e,"operand must be defined")}accept(t){t.unaryOp(this)}}let Wc=class extends wc{constructor(t,e,r){super(),this.range=r,this.args=t,this.body=e}};class Jc extends wc{constructor(t,e,r,n){super(),this.range=n,this.test=t,this.body=e,this.orelse=r}}class Xc extends wc{constructor(t,e,r){super(),this.range=r,this.keys=t,this.values=e}accept(t){t.dict(this)}}class Yc extends wc{constructor(t,e,r){super(),this.range=r,this.elt=t,this.generators=e}}class tl extends wc{constructor(t,e,r){super(),this.range=r,this.elt=t,this.generators=e}}class el extends wc{constructor(t,e){super(),this.range=e,this.value=t}}class rl extends wc{constructor(t,e,r,n){super(),this.range=n,this.left=t;for(const t of e)switch(t){case oc:case ac:case lc:case fc:case uc:case cc:case dc:case mc:case hc:case pc:break;default:throw new Error(`ops must only contain CompareOperator(s) but contains ${t}`)}this.ops=e,this.comparators=r}accept(t){t.compareExpression(this)}}class nl extends wc{constructor(t,e,r,n,s){super(),this.func=t,this.args=e,this.keywords=r,this.starargs=n,this.kwargs=s}accept(t){t.callExpression(this)}}class sl extends wc{constructor(t){super(),this.n=t}accept(t){t.num(this)}}class il extends wc{constructor(t){super(),this.s=t}accept(t){t.str(this)}}class ol extends wc{constructor(t,e,r,n){super(),this.range=n,this.value=t,this.attr=e,this.ctx=r}accept(t){t.attribute(this)}}class al extends wc{constructor(t,e,r,n){super(),this.range=n,this.value=t,this.slice=e,this.ctx=r}accept(t){t.subscript(this)}}class ul extends wc{constructor(t,e){super(),this.id=t,this.ctx=e}accept(t){t.name(this)}}class cl extends wc{constructor(t,e,r){super(),this.range=r,this.elts=t,this.ctx=e}accept(t){t.list(this)}}class ll extends wc{constructor(t,e,r){super(),this.range=r,this.elts=t,this.ctx=e}}class fl{constructor(){}}class hl{constructor(t,e,r){this.lower=t,this.upper=e,this.step=r}}class pl{constructor(t){this.dims=t}}class dl{constructor(t){this.value=t}}class ml{constructor(t,e,r,n){this.range=n,this.target=t,this.iter=e,this.ifs=r}}class gl{constructor(t,e,r,n){this.range=n,this.type=t,this.name=e,this.body=r}}class wl{constructor(t,e,r,n){this.args=t,this.vararg=e,this.kwarg=r,this.defaults=n}}class _l{constructor(t,e){this.arg=t,this.value=e}}class xl{constructor(t,e){xa("string"==typeof t.value),xa("string"==typeof e||null===e),this.name=t,this.asname=e}toString(){return`${this.name.value} as ${this.asname}`}}yc.prototype._astname="Module",yc.prototype._fields=["body",function(t){return t.body}],wc.prototype._astname="Expression",wc.prototype._fields=["body",function(t){}],vc.prototype._astname="FunctionDef",vc.prototype._fields=["name",function(t){return t.name.value},"args",function(t){return t.args},"body",function(t){return t.body},"returnType",function(t){return t.returnType},"decorator_list",function(t){return t.decorator_list}],Oc.prototype._astname="ClassDef",Oc.prototype._fields=["name",function(t){return t.name.value},"bases",function(t){return t.bases},"body",function(t){return t.body},"decorator_list",function(t){return t.decorator_list}],Ec.prototype._astname="ReturnStatement",Ec.prototype._fields=["value",function(t){return t.value}],Sc.prototype._astname="DeleteStatement",Sc.prototype._fields=["targets",function(t){return t.targets}],Tc.prototype._astname="Assign",Tc.prototype._fields=["targets",function(t){return t.targets},"value",function(t){return t.value}],qc.prototype._astname="AugAssign",qc.prototype._fields=["target",function(t){return t.target},"op",function(t){return t.op},"value",function(t){return t.value}],Ac.prototype._astname="AnnAssign",Ac.prototype._fields=["target",function(t){return t.target},"type",function(t){return t.value}],Mc.prototype._astname="Print",Mc.prototype._fields=["dest",function(t){return t.dest},"values",function(t){return t.values},"nl",function(t){return t.nl}],Nc.prototype._astname="ForStatement",Nc.prototype._fields=["target",function(t){return t.target},"iter",function(t){return t.iter},"body",function(t){return t.body},"orelse",function(t){return t.orelse}],$c.prototype._astname="WhileStatement",$c.prototype._fields=["test",function(t){return t.test},"body",function(t){return t.body},"orelse",function(t){return t.orelse}],Lc.prototype._astname="IfStatement",Lc.prototype._fields=["test",function(t){return t.test},"consequent",function(t){return t.consequent},"alternate",function(t){return t.alternate}],kc.prototype._astname="WithStatement",kc.prototype._fields=["context_expr",function(t){return t.context_expr},"optional_vars",function(t){return t.optional_vars},"body",function(t){return t.body}],Rc.prototype._astname="Raise",Rc.prototype._fields=["type",function(t){return t.type},"inst",function(t){return t.inst},"tback",function(t){return t.tback}],Ic.prototype._astname="TryExcept",Ic.prototype._fields=["body",function(t){return t.body},"handlers",function(t){return t.handlers},"orelse",function(t){return t.orelse}],Pc.prototype._astname="TryFinally",Pc.prototype._fields=["body",function(t){return t.body},"finalbody",function(t){return t.finalbody}],Fc.prototype._astname="Assert",Fc.prototype._fields=["test",function(t){return t.test},"msg",function(t){return t.msg}],Uc.prototype._astname="Import",Uc.prototype._fields=["names",function(t){return t.names}],Cc.prototype._astname="ImportFrom",Cc.prototype._fields=["module",function(t){return t.module.value},"names",function(t){return t.names},"level",function(t){return t.level}],Dc.prototype._astname="Exec",Dc.prototype._fields=["body",function(t){return t.body},"globals",function(t){return t.globals},"locals",function(t){return t.locals}],Bc.prototype._astname="Global",Bc.prototype._fields=["names",function(t){return t.names}],Kc.prototype._astname="NonLocal",Kc.prototype._fields=["names",function(t){return t.names}],zc.prototype._astname="ExpressionStatement",zc.prototype._fields=["value",function(t){return t.value}],Qc.prototype._astname="Pass",Qc.prototype._fields=[],Zc.prototype._astname="BreakStatement",Zc.prototype._fields=[],Gc.prototype._astname="ContinueStatement",Gc.prototype._fields=[],Hc.prototype._astname="BoolOp",Hc.prototype._fields=["op",function(t){return t.op},"values",function(t){return t.values}],Vc.prototype._astname="BinOp",Vc.prototype._fields=["lhs",function(t){return t.lhs},"op",function(t){return t.op},"rhs",function(t){return t.rhs}],jc.prototype._astname="UnaryOp",jc.prototype._fields=["op",function(t){return t.op},"operand",function(t){return t.operand}],Wc.prototype._astname="Lambda",Wc.prototype._fields=["args",function(t){return t.args},"body",function(t){return t.body}],Jc.prototype._astname="IfExp",Jc.prototype._fields=["test",function(t){return t.test},"body",function(t){return t.body},"orelse",function(t){return t.orelse}],Xc.prototype._astname="Dict",Xc.prototype._fields=["keys",function(t){return t.keys},"values",function(t){return t.values}],Yc.prototype._astname="ListComp",Yc.prototype._fields=["elt",function(t){return t.elt},"generators",function(t){return t.generators}],tl.prototype._astname="GeneratorExp",tl.prototype._fields=["elt",function(t){return t.elt},"generators",function(t){return t.generators}],el.prototype._astname="Yield",el.prototype._fields=["value",function(t){return t.value}],rl.prototype._astname="Compare",rl.prototype._fields=["left",function(t){return t.left},"ops",function(t){return t.ops},"comparators",function(t){return t.comparators}],nl.prototype._astname="Call",nl.prototype._fields=["func",function(t){return t.func},"args",function(t){return t.args},"keywords",function(t){return t.keywords},"starargs",function(t){return t.starargs},"kwargs",function(t){return t.kwargs}],sl.prototype._astname="Num",sl.prototype._fields=["n",function(t){return t.n.value}],il.prototype._astname="Str",il.prototype._fields=["s",function(t){return t.s.value}],ol.prototype._astname="Attribute",ol.prototype._fields=["value",function(t){return t.value},"attr",function(t){return t.attr.value},"ctx",function(t){return t.ctx}],al.prototype._astname="Subscript",al.prototype._fields=["value",function(t){return t.value},"slice",function(t){return t.slice},"ctx",function(t){return t.ctx}],ul.prototype._astname="Name",ul.prototype._fields=["id",function(t){return t.id.value},"ctx",function(t){return t.ctx}],cl.prototype._astname="List",cl.prototype._fields=["elts",function(t){return t.elts},"ctx",function(t){return t.ctx}],ll.prototype._astname="Tuple",ll.prototype._fields=["elts",function(t){return t.elts},"ctx",function(t){return t.ctx}],Pu.prototype._astname="Load",Pu.prototype._isenum=!0,Fu.prototype._astname="Store",Fu.prototype._isenum=!0,Uu.prototype._astname="Del",Uu.prototype._isenum=!0,Cu.prototype._astname="AugLoad",Cu.prototype._isenum=!0,Du.prototype._astname="AugStore",Du.prototype._isenum=!0,Bu.prototype._astname="Param",Bu.prototype._isenum=!0,fl.prototype._astname="Ellipsis",fl.prototype._fields=[],hl.prototype._astname="Slice",hl.prototype._fields=["lower",function(t){return t.lower},"upper",function(t){return t.upper},"step",function(t){return t.step}],pl.prototype._astname="ExtSlice",pl.prototype._fields=["dims",function(t){return t.dims}],dl.prototype._astname="Index",dl.prototype._fields=["value",function(t){return t.value}],Ku.prototype._astname="And",Ku.prototype._isenum=!0,zu.prototype._astname="Or",zu.prototype._isenum=!0,Qu.prototype._astname="Add",Qu.prototype._isenum=!0,Zu.prototype._astname="Sub",Zu.prototype._isenum=!0,Gu.prototype._astname="Mult",Gu.prototype._isenum=!0,Hu.prototype._astname="Div",Hu.prototype._isenum=!0,Vu.prototype._astname="Mod",Vu.prototype._isenum=!0,ju.prototype._astname="Pow",ju.prototype._isenum=!0,Wu.prototype._astname="LShift",Wu.prototype._isenum=!0,Ju.prototype._astname="RShift",Ju.prototype._isenum=!0,Xu.prototype._astname="BitOr",Xu.prototype._isenum=!0,Yu.prototype._astname="BitXor",Yu.prototype._isenum=!0,tc.prototype._astname="BitAnd",tc.prototype._isenum=!0,ec.prototype._astname="FloorDiv",ec.prototype._isenum=!0,rc.prototype._astname="Invert",rc.prototype._isenum=!0,nc.prototype._astname="Not",nc.prototype._isenum=!0,sc.prototype._astname="UAdd",sc.prototype._isenum=!0,ic.prototype._astname="USub",ic.prototype._isenum=!0,oc.prototype._astname="Eq",oc.prototype._isenum=!0,ac.prototype._astname="NotEq",ac.prototype._isenum=!0,uc.prototype._astname="Lt",uc.prototype._isenum=!0,cc.prototype._astname="LtE",cc.prototype._isenum=!0,lc.prototype._astname="Gt",lc.prototype._isenum=!0,fc.prototype._astname="GtE",fc.prototype._isenum=!0,hc.prototype._astname="Is",hc.prototype._isenum=!0,pc.prototype._astname="IsNot",pc.prototype._isenum=!0,dc.prototype._astname="In",dc.prototype._isenum=!0,mc.prototype._astname="NotIn",mc.prototype._isenum=!0,ml.prototype._astname="Comprehension",ml.prototype._fields=["target",function(t){return t.target},"iter",function(t){return t.iter},"ifs",function(t){return t.ifs}],gl.prototype._astname="ExceptHandler",gl.prototype._fields=["type",function(t){return t.type},"name",function(t){return t.name},"body",function(t){return t.body}],wl.prototype._astname="Arguments",wl.prototype._fields=["args",function(t){return t.args},"vararg",function(t){return t.vararg},"kwarg",function(t){return t.kwarg},"defaults",function(t){return t.defaults}],_l.prototype._astname="Keyword",_l.prototype._fields=["arg",function(t){return t.arg.value},"value",function(t){return t.value}],bc.prototype._astname="FunctionParamDef",bc.prototype._fields=["name",function(t){return t.name},"type",function(t){return t.type}],xl.prototype._astname="Alias",xl.prototype._fields=["name",function(t){return t.name.value},"asname",function(t){return t.asname}];const yl=Na.sym,vl=Math.pow(2,53);function bl(t,e){xa("string"==typeof t,"message must be a string"),xa(va(e.begin.line),"lineNumber must be a number");const r=new SyntaxError(t);return r.lineNumber=e.begin.line,r}class Ol{constructor(t){this.c_encoding=t}}function El(t,e){t.type!==e&&ya(`node must have type ${e} = ${La(e)}, but was ${t.type} = ${La(t.type)}.`)}function Sl(t){return"string"!=typeof t&&ya("expecting string, got "+typeof t),t}function Tl(t){switch(t.type){case yl.single_input:return Oa(t,0).type===Ta.T_NEWLINE?0:Tl(Oa(t,0));case yl.file_input:let e=0;for(let r=0;r<ba(t);++r){const n=Oa(t,r);n.type===yl.stmt&&(e+=Tl(n))}return e;case yl.stmt:return Tl(Oa(t,0));case yl.compound_stmt:return 1;case yl.simple_stmt:return Math.floor(ba(t)/2);case yl.suite:if(1===ba(t))return Tl(Oa(t,0));{let e=0;for(let r=2;r<ba(t)-1;++r)e+=Tl(Oa(t,r));return e}default:throw new Error("Non-statement found")}}function ql(t,e,r,n){if("None"===r)throw bl("assignment to None",n);if("True"===r||"False"===r)throw bl("assignment to True or False is forbidden",n)}function Al(t,e,r,n){xa(r!==Du&&r!==Cu);let s=null,i=null;if(e instanceof ol)r===Fu&&ql(0,0,e.attr.value,n.range),e.ctx=r;else if(e instanceof ul)r===Fu&&ql(0,0,void 0,n.range),e.ctx=r;else if(e instanceof al)e.ctx=r;else if(e instanceof cl)e.ctx=r,s=e.elts;else if(e instanceof ll){if(0===e.elts.length)throw bl("can't assign to ()",n.range);e.ctx=r,s=e.elts}else if(e instanceof Wc)i="lambda";else if(e instanceof nl)i="function call";else if(e instanceof Hc)i="operator";else switch(e.constructor){case Hc:case Vc:case jc:i="operator";break;case tl:i="generator expression";break;case el:i="yield expression";break;case Yc:i="list comprehension";break;case Xc:case sl:case il:i="literal";break;case rl:i="comparison expression";break;case Jc:i="conditional expression";break;default:throw new Error("unhandled expression in assignment")}if(i)throw bl("can't "+(r===Fu?"assign to":"delete")+" "+i,n.range);if(s)for(const e of s)Al(t,e,r,n)}const Ml={};function Nl(t){return xa(void 0!==Ml[t.type],`${t.type}`),{op:Ml[t.type],range:t.range}}function $l(t,e){if(El(e,yl.comp_op),1===ba(e))switch((e=Oa(e,0)).type){case Ta.T_LESS:return uc;case Ta.T_GREATER:return lc;case Ta.T_EQEQUAL:return oc;case Ta.T_LESSEQUAL:return cc;case Ta.T_GREATEREQUAL:return fc;case Ta.T_NOTEQUAL:return ac;case Ta.T_NAME:if("in"===e.value)return dc;if("is"===e.value)return hc}else if(2===ba(e)&&Oa(e,0).type===Ta.T_NAME){if("in"===Oa(e,1).value)return mc;if("is"===Oa(e,0).value)return pc}throw new Error("invalid comp_op")}function Ll(t,e){xa(e.type===yl.testlist||e.type===yl.listmaker||e.type===yl.testlist_gexp||e.type===yl.testlist_safe||e.type===yl.testlist1);const r=[];for(let n=0;n<ba(e);n+=2)xa(Oa(e,n).type===yl.IfExpr||Oa(e,n).type===yl.old_test),r[n/2]=sf(t,Oa(e,n));return r}function kl(t,e){El(e,yl.suite);const r=[];let n,s=0;if(Oa(e,0).type===yl.simple_stmt){let n=ba(e=Oa(e,0))-1;Oa(e,n-1).type===Ta.T_SEMI&&(n-=1);for(let i=0;i<n;i+=2)r[s++]=of(t,Oa(e,i))}else for(let i=2;i<ba(e)-1;++i){if(n=Oa(e,i),El(n,yl.stmt),1===Tl(n))r[s++]=of(t,n);else{n=Oa(n,0),El(n,yl.simple_stmt);for(let e=0;e<ba(n);e+=2){if(0===ba(Oa(n,e))){xa(e+1===ba(n));break}r[s++]=of(t,Oa(n,e))}}}return xa(s===Tl(e)),r}function Rl(t,e,r){if(El(e,yl.except_clause),El(r,yl.suite),1===ba(e))return new gl(null,null,kl(t,r),e.range);if(2===ba(e))return new gl(sf(t,Oa(e,1)),null,kl(t,r),e.range);if(4===ba(e)){const n=sf(t,Oa(e,3));return Al(t,n,Fu,Oa(e,3)),new gl(sf(t,Oa(e,1)),n,kl(t,r),e.range)}throw new Error("wrong number of children for except clause")}function Il(t,e){El(e,yl.decorator),El(Oa(e,0),Ta.T_AT),El(Oa(e,ba(e)-1),Ta.T_NEWLINE);const r=function(t,e){El(e,yl.dotted_name);const r=Oa(e,0);let n=new gc(r.value,r.range),s=new ul(n,Pu);for(let t=2;t<ba(e);t+=2){const r=Oa(e,t);n=new gc(r.value,r.range),s=new ol(s,n,Pu,e.range)}return s}(0,Oa(e,1));return 3===ba(e)?r:5===ba(e)?new nl(r,[],[],null,null):zl(t,Oa(e,3),r)}function Pl(t,e){El(e,yl.decorated);const r=function(t,e){El(e,yl.decorators);const r=[];for(let n=0;n<ba(e);++n)r[n]=Il(t,Oa(e,n));return r}(t,Oa(e,0));xa(Oa(e,1).type===yl.funcdef||Oa(e,1).type===yl.classdef);let n=null;if(Oa(e,1).type===yl.funcdef)n=Gl(t,Oa(e,1),r);else{if(Oa(e,1).type!==yl.classdef)throw new Error("astForDecorated");n=Hl(t,Oa(e,1),r)}return n}function Fl(t,e){let r=3;xa(e.type===yl.with_stmt);const n=sf(t,Oa(e,1));let s;return Oa(e,2).type===yl.with_var&&(s=function(t,e){return El(e,yl.with_var),sf(t,Oa(e,1))}(t,Oa(e,2)),Al(t,s,Fu,e),r=4),new kc(n,s,kl(t,Oa(e,r)),e.range)}function Ul(t,e,r){El(e,yl.ExprList);const n=[];for(let s=0;s<ba(e);s+=2){const i=sf(t,Oa(e,s));n[s/2]=i,r&&Al(t,i,r,Oa(e,s))}return n}function Cl(t,e){t:for(;;)switch(e.type){case yl.ImportSpecifier:{let t=null;const r=Oa(e,0),n=Sl(r.value),s=r.range;return 3===ba(e)&&(t=Oa(e,2).value),new xl(new gc(n,s),null==t?null:Sl(t))}case yl.dotted_as_name:if(1===ba(e)){e=Oa(e,0);continue t}{const r=Cl(t,Oa(e,0));return xa(!r.asname),r.asname=Sl(Oa(e,2).value),r}case yl.dotted_name:if(1===ba(e)){const t=Oa(e,0),r=Sl(t.value),n=t.range;return new xl(new gc(r,n),null)}{let t="";for(let r=0;r<ba(e);r+=2)t+=Oa(e,r).value+".";return new xl(new gc(t.substr(0,t.length-1),null),null)}case Ta.T_STAR:return new xl(new gc("*",e.range),null);case Ta.T_NAME:return new xl(new gc(e.value,e.range),null);default:throw bl(`unexpected import name ${La(e.type)}`,e.range)}}function Dl(t,e){El(e,yl.ModuleSpecifier);const r=ba(e);let n,s="";for(let i=0;i<r;++i){const r=Oa(e,i);s+=tf(t,r.value),n=r.range}return{value:s,range:n}}function Bl(t,e){El(e,yl.import_stmt);let r=Oa(e,0);if(r.type===yl.import_name){const n=Oa(r,1);El(n,yl.dotted_as_names);const s=[];for(let e=0;e<ba(n);e+=2)s[e/2]=Cl(t,Oa(n,e));return new Uc(s,e.range)}if(r.type===yl.import_from){let n,s,i,o=0;for(i=1;i<ba(r);++i){const e=Oa(r,i),s=e.type;if(s===yl.dotted_name)throw bl(`unknown import statement ${La(s)}.`,e.range);if(s===yl.ModuleSpecifier){n=Dl(t,e);break}if(s!==Ta.T_DOT)throw bl(`unknown import statement ${La(s)}.`,e.range);o++}++i;let a=r;switch(Oa(r,i).type){case Ta.T_STAR:a=Oa(r,i),s=1;break;case Ta.T_LPAR:a=Oa(a,i+1),s=ba(a);break;case yl.ImportList:if(a=Oa(a,i),s=ba(a),s%2==0)throw bl("trailing comma not allowed without surrounding parentheses",a.range)}const u=[];if(a.type===Ta.T_STAR)u[0]=Cl(t,a);else{El(a,yl.import_from);const e=Oa(a,function(t,e){xa(void 0!==e);const r=Ea(t),n=r.length;for(let t=0;t<n;t++)if(r[t].type===e)return t;return-1}(a,yl.ImportList));!function(t,e,r){El(e,yl.ImportList);const n=ba(e);for(let s=0;s<n;s++){const n=Oa(e,s);n.type===yl.ImportSpecifier&&r.push(Cl(t,n))}}(t,e,u)}return xa("string"==typeof n.value),new Cc(new gc(n.value,n.range),u,o,e.range)}throw bl(`unknown import statement ${La(r.type)}.`,r.range)}function Kl(t,e){if(Oa(e,0).type===Ta.T_MINUS&&2===ba(e)){const r=Oa(e,1);if(r.type===yl.UnaryExpr&&1===ba(r)){const e=Oa(r,0);if(e.type===yl.PowerExpr&&1===ba(e)){const r=Oa(e,0);if(r.type===yl.AtomExpr){const e=Oa(r,0);if(e.type===Ta.T_NUMBER)return e.value="-"+e.value,rf(t,r)}}}}const r=sf(t,Oa(e,1));switch(Oa(e,0).type){case Ta.T_PLUS:return new jc(sc,r,e.range);case Ta.T_MINUS:return new jc(ic,r,e.range);case Ta.T_TILDE:return new jc(rc,r,e.range)}throw new Error("unhandled UnaryExpr")}function zl(t,e,r){El(e,yl.arglist);let n=0,s=0,i=0;for(let t=0;t<ba(e);++t){const r=Oa(e,t);r.type===yl.argument&&(1===ba(r)?n++:Oa(r,1).type===yl.gen_for?i++:s++)}if(i>1||i&&(n||s))throw bl("Generator expression must be parenthesized if not sole argument",e.range);if(n+s+i>255)throw bl("more than 255 arguments",e.range);const o=[],a=[];n=0,s=0;let u=null,c=null;for(let r=0;r<ba(e);++r){const i=Oa(e,r);if(i.type===yl.argument)if(1===ba(i)){if(s)throw bl("non-keyword arg after keyword arg",e.range);if(u)throw bl("only named arguments may follow *expression",e.range);o[n++]=sf(t,Oa(i,0))}else if(Oa(i,1).type===yl.gen_for)o[n++]=jl(t,i);else{const r=sf(t,Oa(i,0));if(r.constructor===Wc)throw bl("lambda cannot contain assignment",e.range);if(r.constructor!==ul)throw bl("keyword can't be an expression",e.range);const n=r.id;ql(0,Oa(i,0),n.value,e.range);for(let t=0;t<s;++t){if(a[t].arg.value===n.value)throw bl("keyword argument repeated",e.range)}a[s++]=new _l(n,sf(t,Oa(i,2)))}else i.type===Ta.T_STAR?u=sf(t,Oa(e,++r)):i.type===Ta.T_DOUBLESTAR&&(c=sf(t,Oa(e,++r)))}const l=function(t){let e=[],r=[];for(const n of t)r.push(n.value),e.push(new ul(new gc(n.arg.value,n.arg.range),Pu));return new Xc(e,r)}(a);return 0!==l.keys.length&&o.push(l),new nl(r,o,[],u,c)}function Ql(t,e,r){const n=e,s=Oa(n,0),i=Oa(n,1),o=Oa(n,2);if(El(n,yl.trailer),s.type===Ta.T_LPAR)return 2===ba(n)?new nl(r,[],[],null,null):zl(t,i,r);if(s.type===Ta.T_DOT)return new ol(r,new gc(i.value,i.range),Pu,n.range);{El(s,Ta.T_LSQB),El(o,Ta.T_RSQB);const e=i;if(1===ba(e))return new al(r,ef(t,Oa(e,0)),Pu,e.range);{let n=!0;const s=[];for(let r=0;r<ba(e);r+=2){const i=ef(t,Oa(e,r));i.constructor!==dl&&(n=!1),s[r/2]=i}if(!n)return new al(r,new pl(s),Pu,e.range);const i=[];for(let t=0;t<s.length;++t){let e=s[t];e instanceof dl?(xa(null!==e.value&&void 0!==e.value),i[t]=e.value):xa(e instanceof dl)}const o=new ll(i,Pu,e.range);return new al(r,new dl(o),Pu,e.range)}}}function Zl(t,e){let r,n=null,s=null;if(e.type===yl.parameters){if(2===ba(e))return new wl([],null,null,[]);e=Oa(e,1)}El(e,yl.varargslist);const i=[],o=[];let a=!1,u=0,c=0,l=0;for(;u<ba(e);)switch(r=Oa(e,u),r.type){case yl.fpdef:let f=0,h=!1;t:for(;;){if(u+1<ba(e)&&Oa(e,u+1).type===Ta.T_EQUAL)o[c++]=sf(t,Oa(e,u+2)),u+=2,a=!0;else if(a){if(h&&!f)throw bl("parenthesized arg with default",e.range);throw bl("non-default argument follows default argument",e.range)}if(3===ba(r)&&r.children[2].type===Ta.T_RPAR){if(r=Oa(r,1),1!==ba(r))throw bl("tuple parameter unpacking has been removed",e.range);h=!0,r=Oa(r,0),xa(r.type===yl.fpdef);continue t}const n=Oa(r,0);if(n.type===Ta.T_NAME){ql(0,0,n.value,e.range);const s=new gc(n.value,n.range),o=Oa(r,2);if(o){let e=sf(t,o);i[l++]=new bc(new ul(s,Bu),e)}else i[l++]=new bc(new ul(s,Bu))}if(u+=2,h)throw bl("parenthesized argument names are invalid",e.range);break}break;case Ta.T_STAR:ql(0,Oa(e,u+1),Oa(e,u+1).value,e.range),n=Sl(Oa(e,u+1).value),u+=3;break;case Ta.T_DOUBLESTAR:ql(0,Oa(e,u+1),Oa(e,u+1).value,e.range),s=Sl(Oa(e,u+1).value),u+=3;break;default:throw new Error("unexpected node in varargslist")}return new wl(i,n,s,o)}function Gl(t,e,r){El(e,yl.funcdef);const n=ba(e);let s,i,o,a,u;return 8!==n&&6!==n?(s=Oa(e,1),i=Sl(s.value),ql(0,0,i,e.range),o=Zl(t,Oa(e,2))):(s=Oa(e,2),i=Sl(s.value),ql(0,0,i,e.range),o=Zl(t,Oa(e,3))),5===n?(a=kl(t,Oa(e,4)),u=null):6===n?(a=kl(t,Oa(e,5)),u=null):7===n?(u=sf(t,Oa(e,4)),a=kl(t,Oa(e,6))):8===n?(u=sf(t,Oa(e,5)),a=kl(t,Oa(e,7))):ya(`Was expecting 5, 7 or 8 children, received ${n} children`),new vc(new gc(i,s.range),o,a,u,r,e.range)}function Hl(t,e,r){const n=e,s=ba(n);let i,o,a;if(El(n,yl.classdef),5!==s&&8!==s?7===s&&Oa(n,4).type===Ta.T_RPAR||(i=Oa(n,1),ql(0,0,i.value,n.range),o=Sl(i.value),a=i.range):(i=Oa(n,2),ql(0,0,i.value,n.range),o=Sl(i.value),a=i.range),4===s)return new Oc(new gc(o,a),[],kl(t,Oa(n,3)),r,n.range);7===s&&(Oa(n,3).type,Ta.T_RPAR);const u=Oa(n,3);if(u.type===Ta.T_RPAR)return new Oc(new gc(o,a),[],kl(t,Oa(n,5)),r,n.range);const c=function(t,e){const r=ba(e);return xa(r>0),El(e,yl.testlist),1===r?[sf(t,Oa(e,0))]:Ll(t,e)}(t,u),l=kl(t,Oa(n,6));return new Oc(new gc(o,a),c,l,r,n.range)}function Vl(t,e){let r,n;return 3===ba(e)?(r=new wl([],null,null,[]),n=sf(t,Oa(e,2))):(r=Zl(t,Oa(e,1)),n=sf(t,Oa(e,3))),new Wc(r,n,e.range)}function jl(t,e){function r(t,e){let r=0;for(;;){if(El(e,yl.gen_iter),Oa(e,0).type===yl.gen_for)return r;if(El(e=Oa(e,0),yl.gen_if),r++,2===ba(e))return r;e=Oa(e,2)}}xa(e.type===yl.testlist_gexp||e.type===yl.argument),xa(ba(e)>1);const n=sf(t,Oa(e,0)),s=function(t,e){let r=0,n=Oa(e,1);t:for(;;){if(r++,El(n,yl.gen_for),5!==ba(n))return r;n=Oa(n,4);e:for(;;){if(El(n,yl.gen_iter),n=Oa(n,0),n.type===yl.gen_for)continue t;if(n.type===yl.gen_if){if(3===ba(n)){n=Oa(n,2);continue e}return r}break}break}throw new Error("logic error in countGenFors")}(0,e),i=[];let o=Oa(e,1);for(let e=0;e<s;++e){El(o,yl.gen_for);const n=Oa(o,1),s=Ul(t,n,Fu);let a,u=sf(t,Oa(o,3));if(a=1===ba(n)?new ml(s[0],u,[]):new ml(new ll(s,Fu,o.range),u,[]),5===ba(o)){o=Oa(o,4);const e=r(0,o),n=[];for(let r=0;r<e;++r)El(o,yl.gen_iter),o=Oa(o,0),El(o,yl.gen_if),u=sf(t,Oa(o,1)),n[r]=u,3===ba(o)&&(o=Oa(o,2));o.type===yl.gen_iter&&(o=Oa(o,0)),a.ifs=n}i[e]=a}return new tl(n,i,e.range)}function Wl(t,e){let r=new Vc(sf(t,Oa(e,0)),Nl(Oa(e,1)),sf(t,Oa(e,2)),e.range);const n=(ba(e)-1)/2;for(let s=1;s<n;++s){const n=Oa(e,2*s+1),i=sf(t,Oa(e,2*s+2));r=new Vc(r,Nl(n),i,n.range)}return r}function Jl(t,e){return xa(ba(e)>0),e.type===yl.testlist_gexp?ba(e)>1&&xa(Oa(e,1).type!==yl.gen_for):xa(e.type===yl.testlist||e.type===yl.testlist_safe||e.type===yl.testlist1),1===ba(e)?sf(t,Oa(e,0)):new ll(Ll(t,e),Pu,e.range)}function Xl(t,e){const r=e;if(El(r,yl.ExprStmt),1===ba(r))return new zc(Jl(t,Oa(r,0)),r.range);if(Oa(r,1).type===yl.augassign){let e=Oa(r,0);const n=Jl(t,e);switch(n.constructor){case tl:throw bl("augmented assignment to generator expression not possible",r.range);case el:throw bl("augmented assignment to yield expression not possible",r.range);case ul:ql(0,0,n.id.value,r.range);break;case ol:case al:break;default:throw bl("illegal expression for augmented assignment",r.range)}let s;return Al(t,n,Fu,e),e=Oa(r,2),s=e.type===yl.testlist?Jl(t,e):sf(t,e),new qc(n,function(t,e){switch(El(e,yl.augassign),(e=Oa(e,0)).value.charAt(0)){case"+":return Qu;case"-":return Zu;case"/":return"/"===e.value.charAt(1)?ec:Hu;case"%":return Vu;case"<":return Wu;case">":return Ju;case"&":return tc;case"^":return Yu;case"|":return Xu;case"*":return"*"===e.value.charAt(1)?ju:Gu;default:throw new Error("invalid augassign")}}(0,Oa(r,1)),s,r.range)}if(Oa(r,1).type===yl.annasign){const e=Oa(r,0),n=Oa(r,1),s=sf(t,Oa(n,1)),i=Oa(n,2);if(i){El(i,Ta.T_EQUAL);const o=[Jl(t,e)],a=Oa(n,3);let u;return u=a.type===yl.testlist?Jl(t,a):sf(t,a),new Tc(o,u,r.range,i.range,s)}return new Ac(s,Jl(t,e),r.range)}{const e=Oa(r,1);El(e,Ta.T_EQUAL);const n=[],s=ba(r);for(let e=0;e<s-2;e+=2){const s=Oa(r,e);if(s.type===yl.YieldExpr)throw bl("assignment to yield expression not possible",r.range);const i=Jl(t,s);Al(t,i,Fu,Oa(r,e)),n[e/2]=i}const i=Oa(r,s-1);let o;return o=i.type===yl.testlist?Jl(t,i):sf(t,i),new Tc(n,o,r.range,e.range)}}function Yl(t,e){return xa(5===ba(e)),new Jc(sf(t,Oa(e,2)),sf(t,Oa(e,0)),sf(t,Oa(e,4)),e.range)}function tf(t,e){const r=function(t){return decodeURIComponent(function(t){return encodeURIComponent(t)}(t))};let n=e.charAt(0),s=!1;return"u"===n||"U"===n?n=(e=e.substr(1)).charAt(0):"r"!==n&&"R"!==n||(n=(e=e.substr(1)).charAt(0),s=!0),xa("b"!==n&&"B"!==n,"todo; haven't done b'' strings yet"),xa("'"===n||'"'===n&&e.charAt(e.length-1)===n),(e=e.substr(1,e.length-2)).length>=4&&e.charAt(0)===n&&e.charAt(1)===n&&(xa(e.charAt(e.length-1)===n&&e.charAt(e.length-2)===n),e=e.substr(2,e.length-4)),s||-1===e.indexOf("\\")?Sl(r(e)):Sl(function(t,e){const r=t.length;let n="";for(let e=0;e<r;++e){let r=t.charAt(e);if("\\"===r)if(++e,r=t.charAt(e),"n"===r)n+="\n";else if("\\"===r)n+="\\";else if("t"===r)n+="\t";else if("r"===r)n+="\r";else if("b"===r)n+="\b";else if("f"===r)n+="\f";else if("v"===r)n+="\v";else if("0"===r)n+="\0";else if('"'===r)n+='"';else if("'"===r)n+="'";else if("\n"===r);else if("x"===r){const r=t.charAt(++e),s=t.charAt(++e);n+=String.fromCharCode(parseInt(r+s,16))}else if("u"===r||"U"===r){const r=t.charAt(++e),s=t.charAt(++e),i=t.charAt(++e),o=t.charAt(++e);n+=String.fromCharCode(parseInt(r+s,16),parseInt(i+o,16))}else n+="\\"+r;else n+=r}return n}(e))}function ef(t,e){const r=e;El(r,yl.subscript);let n=Oa(r,0),s=null,i=null,o=null;if(n.type===Ta.T_DOT)return new fl;if(1===ba(r)&&n.type===yl.IfExpr){const e=sf(t,n);return new dl(e)}if(n.type===yl.IfExpr&&(s=sf(t,n)),n.type===Ta.T_COLON){if(ba(r)>1){const e=Oa(r,1);e.type===yl.IfExpr&&(i=sf(t,e))}}else if(ba(r)>2){const e=Oa(r,2);e.type===yl.IfExpr&&(i=sf(t,e))}return n=Oa(r,ba(r)-1),n.type===yl.sliceop&&(1===ba(n)?(n=Oa(n,0),o=new ul(new gc("None",null),Pu)):(n=Oa(n,1),n.type===yl.IfExpr&&(o=sf(t,n)))),new hl(s,i,o)}function rf(t,e){const r=Oa(e,0);switch(r.type){case Ta.T_NAME:return new ul(new gc(r.value,r.range),Pu);case Ta.T_STRING:return new il(new gc(function(t,e){El(Oa(e,0),Ta.T_STRING);let r="";for(let t=0;t<ba(e);++t){const n=Oa(e,t);try{r+=tf(0,n.value)}catch(t){throw bl("invalid string (possibly contains a unicode character)",n.range)}}return r}(0,e),e.range));case Ta.T_NUMBER:return new sl(new gc(function(t,e,r){const n=e.charAt(e.length-1);if("j"===n||"J"===n)throw bl("complex numbers are currently unsupported",r);if(-1!==e.indexOf("."))return ku(e);let s,i=e,o=10,a=!1;if("-"===e.charAt(0)&&(i=e.substr(1),a=!0),"0"!==i.charAt(0)||"x"!==i.charAt(1)&&"X"!==i.charAt(1)){if(-1!==e.indexOf("e")||-1!==e.indexOf("E"))return ku(e);if("0"!==i.charAt(0)||"b"!==i.charAt(1)&&"B"!==i.charAt(1))if("0"===i.charAt(0))if("0"===i)s=0;else{if("l"===n||"L"===n)return Iu(e.substr(0,e.length-1),8);o=8,i=i.substring(1),"o"!==i.charAt(0)&&"O"!==i.charAt(0)||(i=i.substring(1)),s=parseInt(i,8)}else{if("l"===n||"L"===n)return Iu(e.substr(0,e.length-1),o);s=parseInt(i,o)}else i=i.substring(2),s=parseInt(i,2),o=2}else i=i.substring(2),s=parseInt(i,16),o=16;return s>vl&&Math.floor(s)===s&&-1===e.indexOf("e")&&-1===e.indexOf("E")?Iu(e,0):"l"===n||"L"===n?Iu(e.substr(0,e.length-1),o):Ru(a?-s:s)}(0,r.value,r.range),e.range));case Ta.T_LPAR:{const r=Oa(e,1);return r.type===Ta.T_RPAR?new ll([],Pu,e.range):r.type===yl.YieldExpr?sf(t,r):ba(r)>1&&Oa(r,1).type===yl.gen_for?jl(t,r):function(t,e){return xa(e.type===yl.testlist_gexp||e.type===yl.argument),ba(e)>1&&Oa(e,1).type===yl.gen_for?jl(t,e):Jl(t,e)}(t,r)}case Ta.T_LSQB:{const r=Oa(e,1);return r.type===Ta.T_RSQB?new cl([],Pu,e.range):(El(r,yl.listmaker),1===ba(r)||Oa(r,1).type===Ta.T_COMMA?new cl(Ll(t,r),Pu,e.range):function(t,e){function r(t,e){let r=0;for(;;){if(El(e,yl.list_iter),Oa(e,0).type===yl.list_for)return r;if(El(e=Oa(e,0),yl.list_if),r++,2===ba(e))return r;e=Oa(e,2)}}El(e,yl.listmaker),xa(ba(e)>1);const n=sf(t,Oa(e,0)),s=function(t,e){let r=0,n=Oa(e,1);t:for(;;){if(r++,El(n,yl.list_for),5!==ba(n))return r;n=Oa(n,4);e:for(;;){if(El(n,yl.list_iter),n=Oa(n,0),n.type===yl.list_for)continue t;if(n.type===yl.list_if){if(3===ba(n)){n=Oa(n,2);continue e}return r}break}break}throw new Error("TODO: Should this be returning void 0?")}(0,e),i=[];let o=Oa(e,1);for(let e=0;e<s;++e){El(o,yl.list_for);const n=Oa(o,1),s=Ul(t,n,Fu),a=Jl(t,Oa(o,3));let u;if(u=1===ba(n)?new ml(s[0],a,[]):new ml(new ll(s,Fu,o.range),a,[]),5===ba(o)){o=Oa(o,4);const e=r(0,o),n=[];for(let r=0;r<e;++r)El(o,yl.list_iter),o=Oa(o,0),El(o,yl.list_if),n[r]=sf(t,Oa(o,1)),3===ba(o)&&(o=Oa(o,2));o.type===yl.list_iter&&(o=Oa(o,0)),u.ifs=n}i[e]=u}return new Yc(n,i,e.range)}(t,r))}case Ta.T_LBRACE:{const r=Oa(e,1),n=ba(r),s=[],i=[];for(let e=0;e<n;e+=4)s[e/4]=sf(t,Oa(r,e)),i[e/4]=sf(t,Oa(r,e+2));return new Xc(s,i,e.range)}case Ta.T_BACKQUOTE:throw bl("backquote not supported, use repr()",e.range);default:throw new Error(`unhandled atom '${La(r.type)}'`)}}function nf(t,e){const r=e;El(r,yl.PowerExpr);const n=ba(r),s=n-1;let i=rf(t,Oa(r,0));if(1===n)return i;for(let e=1;e<n;++e){const n=Oa(r,e);if(n.type!==yl.trailer)break;i=Ql(t,n,i)}if(Oa(r,s).type===yl.UnaryExpr){const e=sf(t,Oa(r,s));return new Vc(i,Nl(Oa(r,n-2)),e,r.range)}return i}function sf(t,e){t:for(;;)switch(e.type){case yl.IfExpr:case yl.old_test:if(Oa(e,0).type===yl.LambdaExpr||Oa(e,0).type===yl.old_LambdaExpr)return Vl(t,Oa(e,0));if(ba(e)>1)return Yl(t,e);case yl.OrExpr:case yl.AndExpr:if(1===ba(e)){e=Oa(e,0);continue t}const n=[];for(let r=0;r<ba(e);r+=2)n[r/2]=sf(t,Oa(e,r));return"and"===Oa(e,1).value?new Hc(Ku,n,e.range):(xa("or"===Oa(e,1).value),new Hc(zu,n,e.range));case yl.NotExpr:if(1===ba(e)){e=Oa(e,0);continue t}return new jc(nc,sf(t,Oa(e,1)),e.range);case yl.ComparisonExpr:if(1===ba(e)){e=Oa(e,0);continue t}{const r=[],n=[];for(let s=1;s<ba(e);s+=2)r[(s-1)/2]=$l(0,Oa(e,s)),n[(s-1)/2]=sf(t,Oa(e,s+1));return new rl(sf(t,Oa(e,0)),r,n,e.range)}case yl.ArithmeticExpr:case yl.GeometricExpr:case yl.ShiftExpr:case yl.BitwiseOrExpr:case yl.BitwiseXorExpr:case yl.BitwiseAndExpr:if(1===ba(e)){e=Oa(e,0);continue t}return Wl(t,e);case yl.YieldExpr:let s=null;return 2===ba(e)&&(s=Jl(t,Oa(e,1))),new el(s,e.range);case yl.UnaryExpr:if(1===ba(e)){e=Oa(e,0);continue t}return Kl(t,e);case yl.PowerExpr:return nf(t,e);default:throw new Error(`unhandled expr: n.type: ${e.type}, n.value: ${e.value}, n.range= ${e.range}, dump=${r=e,function t(e,r){let n="";if(Lu(e.type)){if(n+=r+Na.number2symbol[e.type]+"\n",e.children)for(let s=0;s<e.children.length;++s)n+=t(e.children[s],"  "+r)}else n+=r+$a[e.type]+": "+e.value+"\n";return n}(r,"")}`)}var r}function of(t,e){if(e.type===yl.stmt&&(xa(1===ba(e)),e=Oa(e,0)),e.type===yl.simple_stmt&&(xa(1===Tl(e)),e=Oa(e,0)),e.type===yl.small_stmt)switch(El(e,yl.small_stmt),(e=Oa(e,0)).type){case yl.ExprStmt:return Xl(t,e);case yl.print_stmt:return function(t,e){let r=1,n=null;El(e,yl.print_stmt),ba(e)>=2&&Oa(e,1).type===Ta.T_RIGHTSHIFT&&(n=sf(t,Oa(e,2)),r=4);const s=[];for(let n=r,i=0;n<ba(e);n+=2,++i)s[i]=sf(t,Oa(e,n));const i=Oa(e,ba(e)-1).type!==Ta.T_COMMA;return new Mc(n,s,i,e.range)}(t,e);case yl.del_stmt:return function(t,e){return El(e,yl.del_stmt),new Sc(Ul(t,Oa(e,1),Uu),e.range)}(t,e);case yl.pass_stmt:return new Qc(e.range);case yl.flow_stmt:return function(t,e){El(e,yl.flow_stmt);const r=Oa(e,0);switch(r.type){case yl.break_stmt:return new Zc(e.range);case yl.continue_stmt:return new Gc(e.range);case yl.yield_stmt:return new zc(sf(t,Oa(r,0)),e.range);case yl.return_stmt:return 1===ba(r)?new Ec(null,e.range):new Ec(Jl(t,Oa(r,1)),e.range);case yl.raise_stmt:if(1===ba(r))return new Rc(null,null,null,e.range);if(2===ba(r))return new Rc(sf(t,Oa(r,1)),null,null,e.range);if(4===ba(r))return new Rc(sf(t,Oa(r,1)),sf(t,Oa(r,3)),null,e.range);if(6===ba(r))return new Rc(sf(t,Oa(r,1)),sf(t,Oa(r,3)),sf(t,Oa(r,5)),e.range);throw new Error("unhandled flow statement");default:throw new Error("unexpected flow_stmt")}}(t,e);case yl.import_stmt:return Bl(t,e);case yl.GlobalStmt:return function(t,e){El(e,yl.GlobalStmt);const r=[];for(let t=1;t<ba(e);t+=2)r[(t-1)/2]=Sl(Oa(e,t).value);return new Bc(r,e.range)}(0,e);case yl.NonLocalStmt:return function(t,e){El(e,yl.NonLocalStmt);const r=[];for(let t=1;t<ba(e);t+=2)r[(t-1)/2]=Sl(Oa(e,t).value);return new Kc(r,e.range)}(0,e);case yl.exec_stmt:return function(t,e){let r=null,n=null;const s=ba(e);xa(2===s||4===s||6===s),El(e,yl.exec_stmt);const i=sf(t,Oa(e,1));return s>=4&&(r=sf(t,Oa(e,3))),6===s&&(n=sf(t,Oa(e,5))),new Dc(i,r,n,e.range)}(t,e);case yl.assert_stmt:return function(t,e){if(El(e,yl.assert_stmt),2===ba(e))return new Fc(sf(t,Oa(e,1)),null,e.range);if(4===ba(e))return new Fc(sf(t,Oa(e,1)),sf(t,Oa(e,3)),e.range);throw new Error("improper number of parts to assert stmt")}(t,e);default:throw new Error("unhandled small_stmt")}else{const r=Oa(e,0);switch(El(e,yl.compound_stmt),r.type){case yl.if_stmt:return function(t,e){if(El(e,yl.if_stmt),4===ba(e))return new Lc(sf(t,Oa(e,1)),kl(t,Oa(e,3)),[],e.range);const r=Oa(e,4).value.charAt(2);if("s"===r)return new Lc(sf(t,Oa(e,1)),kl(t,Oa(e,3)),kl(t,Oa(e,6)),e.range);if("i"===r){let r=ba(e)-4,n=!1,s=[];Oa(e,r+1).type===Ta.T_NAME&&"s"===Oa(e,r+1).value.charAt(2)&&(n=!0,r-=3),r/=4,n&&(s=[new Lc(sf(t,Oa(e,ba(e)-6)),kl(t,Oa(e,ba(e)-4)),kl(t,Oa(e,ba(e)-1)),Oa(e,ba(e)-6).range)],r--);for(let n=0;n<r;++n){const i=5+4*(r-n-1);s=[new Lc(sf(t,Oa(e,i)),kl(t,Oa(e,i+2)),s,Oa(e,i).range)]}return new Lc(sf(t,Oa(e,1)),kl(t,Oa(e,3)),s,e.range)}throw new Error("unexpected token in 'if' statement")}(t,r);case yl.while_stmt:return function(t,e){if(El(e,yl.while_stmt),4===ba(e))return new $c(sf(t,Oa(e,1)),kl(t,Oa(e,3)),[],e.range);if(7===ba(e))return new $c(sf(t,Oa(e,1)),kl(t,Oa(e,3)),kl(t,Oa(e,6)),e.range);throw new Error("wrong number of tokens for 'while' stmt")}(t,r);case yl.for_stmt:return function(t,e){let r=[];El(e,yl.for_stmt),9===ba(e)&&(r=kl(t,Oa(e,8)));const n=Oa(e,1),s=Ul(t,n,Fu);let i;return i=1===ba(n)?s[0]:new ll(s,Fu,e.range),new Nc(i,Jl(t,Oa(e,3)),kl(t,Oa(e,5)),r,e.range)}(t,r);case yl.try_stmt:return function(t,e){const r=ba(e);let n=(r-3)/3,s=[],i=null;El(e,yl.try_stmt);let o=kl(t,Oa(e,2));if(Oa(e,r-3).type===Ta.T_NAME)"finally"===Oa(e,r-3).value?(r>=9&&Oa(e,r-6).type===Ta.T_NAME&&(s=kl(t,Oa(e,r-4)),n--),i=kl(t,Oa(e,r-1)),n--):(s=kl(t,Oa(e,r-1)),n--);else if(Oa(e,r-3).type!==yl.except_clause)throw bl("malformed 'try' statement",e.range);if(n>0){const r=[];for(let s=0;s<n;++s)r[s]=Rl(t,Oa(e,3+3*s),Oa(e,5+3*s));const a=new Ic(o,r,s,e.range);if(!i)return a;o=[a]}return xa(null!==i),new Pc(o,i,e.range)}(t,r);case yl.with_stmt:return Fl(t,r);case yl.funcdef:return Gl(t,r,[]);case yl.classdef:return Hl(t,r,[]);case yl.decorated:return Pl(t,r);default:throw new Error("unhandled compound_stmt")}}}Ml[Ta.T_DOUBLESTAR]=ju,Ml[Ta.T_STAR]=Gu,Ml[Ta.T_SLASH]=Hu,Ml[Ta.T_PERCENT]=Vu,Ml[Ta.T_PLUS]=Qu,Ml[Ta.T_MINUS]=Zu,Ml[Ta.T_LEFTSHIFT]=Wu,Ml[Ta.T_RIGHTSHIFT]=Ju,Ml[Ta.T_AMPER]=tc,Ml[Ta.T_CIRCUMFLEX]=Yu,Ml[Ta.T_VBAR]=Xu,Ml[Ta.T_DOUBLESLASH]=ec;class af{constructor(){this.stack=[]}annAssign(t){throw new Error("Method not implemented.")}assign(t){t.targets.forEach((t=>{t.accept(this)})),t.value.accept(this);const e=this.stack.pop(),r=this.stack.pop();this.stack.push(c(Bn,r,e))}attribute(t){throw new Error("Method not implemented.")}binOp(t){t.lhs.accept(this),t.rhs.accept(this);const e=this.stack.pop(),r=this.stack.pop();switch(t.op){case Qu:this.stack.push(c($e,r,e));break;case Zu:this.stack.push(c(Le,r,e));break;case Gu:this.stack.push(c(ke,r,e));break;case Hu:this.stack.push(c(Re,r,e));break;case ju:this.stack.push(c(Ie,r,e));break;case Yu:this.stack.push(c(Pe,r,e));break;case Xu:this.stack.push(c(Fe,r,e));break;case Wu:this.stack.push(c(Ce,r,e));break;case Ju:this.stack.push(c(De,r,e));break;default:throw new Error(JSON.stringify(t,null,2))}}callExpression(t){const e=B(t.func.id?.value),r=[];t.args.forEach((t=>{t.accept(this),r.push(this.stack.pop())})),this.stack.push(c(e,...r))}classDef(t){throw new Error("Method not implemented.")}compareExpression(t){throw new Error("Method not implemented.")}dict(t){throw new Error("Method not implemented.")}expressionStatement(t){t.value.accept(this)}functionDef(t){const e=B(t.name.value),r=[];t.args.args.forEach((t=>{t.name.accept(this),r.push(this.stack.pop())}));const n=[];t.body.forEach((t=>{t.accept(this),n.push(this.stack.pop())}));const s=c(B("lambda"),c(...r),...n);this.stack.push(c(B("define"),e,s))}ifStatement(t){throw new Error("Method not implemented.")}importFrom(t){throw new Error("Method not implemented.")}list(t){const e=[];t.elts.forEach((t=>{t.accept(this),e.push(this.stack.pop())})),this.stack.push(b(e))}module(t){t.body.forEach((t=>{t.accept(this)}))}name(t){t.id.range,t.id.value,this.stack.push(B(t.id.value))}num(t){const e=t.n.value;if(t.n.range.begin,e.isInt())this.stack.push(Ft(e.value));else if(e.isFloat())this.stack.push((new lo).parse(e.text,0,0));else{if(!e.isLong())throw new Error;this.stack.push((new fo).parse(e.text,0,0))}}print(t){throw new Error("Method not implemented.")}returnStatement(t){t.value?t.value.accept(this):this.stack.push(l)}str(t){t.s.range;const e=t.s.value;this.stack.push(new re(e,0,0))}subscript(t){t.value.accept(this);const e=this.stack.pop();if(t.slice instanceof fl)throw new Error;if(t.slice instanceof dl){t.slice.value.accept(this);const r=this.stack.pop();this.stack.push(c(Qe,e,r))}if(t.slice instanceof ul)throw new Error;if(t.slice instanceof hl)throw new Error}unaryOp(t){throw new Error("Method not implemented.")}forStatement(t){throw new Error("Method not implemented.")}}function uf(t,e,r){const n=$u(e,Nu.File);if("object"==typeof n){const t=function(t){const e=new Ol("utf-8"),r=[];let n=0;for(let s=0;s<ba(t)-1;++s){let i=Oa(t,s);if(t.type===Ta.T_NEWLINE)continue;El(i,yl.stmt);const o=Tl(i);if(1===o)r[n++]=of(e,i);else{i=Oa(i,0),El(i,yl.simple_stmt);for(let t=0;t<o;++t)r[n++]=of(e,Oa(i,2*t))}}return r}(n),e=new yc(t),r=new af;e.accept(r);const s=[];for(;r.stack.length>0;)s.push(r.stack.pop());return s.reverse(),{trees:s,errors:[]}}throw new Error}var cf;function lf(t){switch(t){case cf.Native:return"Native";case cf.Python:return"Python";case cf.Scheme:return"Scheme"}}t("SyntaxKind",cf),function(t){t[t.Native=1]="Native",t[t.Python=2]="Python",t[t.Scheme=3]="Scheme"}(cf||t("SyntaxKind",cf={}));const ff=t("syntaxKinds",[cf.Native,cf.Python,cf.Scheme]);function hf(t,e,r){const n=function(t){return t&&t.syntaxKind?t.syntaxKind:cf.Native}(r);switch(n){case cf.Native:return Wo(0,e,function(t){return t?{explicitAssocAdd:t.explicitAssocAdd,explicitAssocMul:t.explicitAssocMul,useCaretForExponentiation:t.useCaretForExponentiation}:{}}(r));case cf.Scheme:return function(t,e,r){const n=new ga(e,r),s=[];let i=!1;for(;!i;){const t=n.value();t===ha?i=!0:s.push(t)}return{trees:s,errors:[]}}(0,e,pf(r));case cf.Python:return uf(0,e,function(t){if(t){if(t.useCaretForExponentiation)throw new Error("useCaretForExponentiation is not supported by the Python parser");return{explicitAssocAdd:t.explicitAssocAdd,explicitAssocMul:t.explicitAssocMul}}}(r));default:throw new Error(`options.syntaxKind ${n} must be one of ${JSON.stringify(ff.map(lf).sort())}.`)}}function pf(t){if(t){if(t.useCaretForExponentiation)throw new Error("useCaretForExponentiation is not supported by the Scheme parser");return{lexicon:{"+":$e,"*":ke,exp:Jo,expt:Ie,quote:Ln,"real?":Fn},explicitAssocAdd:t.explicitAssocAdd,explicitAssocMul:t.explicitAssocMul}}return pf({})}function df(t,e){return t.multiply(e)}function mf(t,e){return t.divide(e)}function gf(t,e){return t.mod(e)}function wf(t,e){const r=t.divmod(e);return[r.quotient,r.remainder]}function _f(t,e){return t.pow(e)}function xf(t){return t.geq(Number.MIN_SAFE_INTEGER)&&t.leq(Number.MAX_SAFE_INTEGER)}function yf(t){return te(t)&&t.isInteger()}function vf(t){let e=NaN;return te(t)?yf(t)&&xf(t.a)&&(e=t.a.toJSNumber()):ot(t)&&Math.floor(t.d)===t.d&&(e=t.d),e}function bf(t){if(void 0===t)throw new Error("expr must be defined.");tr.stack[tr.tos++]=t}function Of(){if(0===tr.tos)throw new Ai("stack underflow");const t=tr.stack[--tr.tos];return tr.stack[tr.tos]=null,t}function Ef(t){for(;t.length>0;)bf(t.shift())}function Sf(t){bf(l);for(let e=0;e<t;e++){const t=Of();bf(u(Of(),t))}}function Tf(t){return mt(t)}function qf(t,e){if(t.isPositive()){if(e.isNegative())return t.multiply(mt(-1))}else if(e.isPositive())return t.multiply(mt(-1));return t}function Af(t,e){if(t.isPositive()){if(e<0)return t.multiply(mt(-1))}else if(e>0)return t.multiply(mt(-1));return t}function Mf(t){const e=mf(t.a,t.b);return new Lt(e,mt.one)}function Nf(t){return te(t)?t.numer():Ut}function $f(t){return te(t)?t.denom():Ut}function Lf(t,e){return new Lt(mt(t),mt(e))}function kf(t){return te(t)||ot(t)?t.toNumber():0}function Rf(t){return new Lt(function(t){let e;if(0===t||1===t)return e=mt(1),e;e=mt(2);let r=mt(0);if(3<=t)for(let n=3;n<=t;n++)r=mt(n),e=df(e,r);return e}(t),mt.one)}function If(t,e){const r=t.car;return!!ie(r)&&r.equalsSym(e)}const Pf=Q(F.abs);function Ff(t){return h(t)&&If(t,Pf)}function Uf(t){return h(t)&&function(t){return If(t,$e)}(t)}function Cf(t){return h(t)&&If(t,ke)}function Df(t){return h(t)&&If(t,Ie)}function Bf(t){return h(t)&&If(t,Ze)}function Kf(t){return h(t)&&If(t,Pe)}function zf(t){return!!h(t)&&(!!If(t,Fe)||!!If(t,Kr))}function Qf(t){return h(t)&&If(t,ss)}function Zf(t){return h(t)&&If(t,pn)}function Gf(t){return!(!ee(t)&&!Ls.equals(t))||!!v(t)&&t.everyElement(Gf)}function Hf(t){return Ls.equals(t)}const Vf=Q(F.E);function jf(t){if(ie(t))return Vf.equals(t);if(Df(t)){const e=t.lhs,r=t.rhs;return!(!ee(r)||!r.isOne())&&jf(e)}return!1}function Wf(t){return d(d(t))}function Jf(t){return d(m(t))}function Xf(t){return m(m(t))}function Yf(t){return d(d(m(t)))}function th(t){return d(m(m(t)))}function eh(t){return m(d(m(t)))}function rh(t){return m(m(m(t)))}function nh(t){return d(m(d(m(t))))}function sh(t){return d(m(m(m(t))))}function ih(t){return d(m(m(m(m(t)))))}function oh(t){return!!ie(t)&&ze.equalsSym(t)}function ah(t,e){e.pushNativeDirective($.evaluatingAsFloat,!0);try{return e.valueOf(uh(e.valueOf(t),e))}finally{e.popNativeDirective()}}function uh(t,e){e.pushNativeDirective($.evaluatingAsFloat,!0);try{return ch(t,e)}finally{e.popNativeDirective()}}function ch(t,e){return h(t)?e.valueOf(c(...t.map((function(t){return ch(t,e)})))):v(t)?t.map((function(t){return ch(t,e)})):te(t)?J(t.toNumber()):oh(t)?rt:jf(t)?nt:t}function lh(t,e){return fh(e.valueOf(t.argList.head),e)}function fh(t,e){if(v(t))return t.map((function(t){return fh(t,e)}));if(ot(t))return function(t,e){const r=ah(t,e);if(ot(r)){const t=r.d,e=t.toString().split(".");if(2===e.length){const r=e[1].length,n=function(t,e){if(isNaN(t))return[0,0];if(t===1/0)return[1,0];if(t===-1/0)return[-1,0];const r=t<0?-1:1;if(t=Math.abs(t),Math.abs(t-Math.floor(t))<e){return[t*r,1]}if(t<1e-19){return[r,1e19]}if(t>1e19){return[1e19*r,1]}let n,s=t,i=0,o=1;for(;;){s=1/(s-Math.floor(s));const r=o;if(o=o*Math.floor(s)+i,i=r,n=Math.floor(t*o+.5),!(Math.abs(t-n/o)>e)||s===Math.floor(s))break}return n*=r,[n,o]}(t,1/Math.pow(10,r));return Lf(n[0],n[1])}return Ft(t)}return c(fr,r)}(t,e);if(h(t)){const r=t.head,n=t.argList;return u(fh(r,e),fh(n,e))}return t}function hh(t){return t=(t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135,t+=t>>8,63&(t+=t>>16)}function ph(t,e){const r=t.bitmap,n=e.bitmap;return r<n?O:r>n?S:E}class dh{constructor(t){}get key(){return"Blade"}get hash(){return Ys}get name(){return"BladeExtension"}get dependencies(){return["Blade"]}isImag(t){return!1}isKind(t){return Z(t)}isMinusOne(){return!1}isOne(){return!1}isReal(t){return!1}isScalar(t){return 0===hh(t.bitmap)}isZero(t){return!1}subst(t,e,r){return Z(e)&&t.equals(e)?r:t}toInfixString(t){return t.toInfixString()}toLatexString(t){return t.toLatexString()}toListString(t){return t.toListString()}evaluate(t,e){return this.transform(u(t,e))}transform(t){return Z(t)?[A,t]:[T,t]}valueOf(t){return t}}const mh=new Oi((function(t){return new dh(t)}));function gh(t){return If(t,ke)}function wh(t,e){return gh(t)?_h(t.argList,e):0}function _h(t,e){if(p(t))return 0;return e(t.car)?1+_h(t.argList,e):_h(t.argList,e)}function xh(t){const e=t;if(gh(e)){const t=e.cdr;return p(t)?Ut:p(t.cdr)?t.car:e}return e}function yh(t){if(h(t)){const e=t;if(gh(e)){const t=e.cdr;if(p(t))return Ut;{const e=t.car;return ee(e)?e:Ut}}return Ut}return Ut}function vh(t){if(h(t)){const e=t;if(gh(e)){const t=e.cdr;if(p(t))return Ut;if(ee(t.car)){const r=t.cdr;return xh(u(e.opr,r))}return e}return e}return t}function bh(t,e){return h(t)?gh(t)?xh(u(t.opr,Oh(t.argList,e))):t:e(t)?Ut:t}function Oh(t,e){if(p(t))return t;{const r=t.car;return e(r)?Oh(t.argList,e):u(r,Oh(t.argList,e))}}function Eh(t,e){return t===e?0:t>e?1:-1}function Sh(t){return t instanceof re}class Th{constructor(t){}get key(){return ne.name}get hash(){return oi}get name(){return"StrExtension"}valueOf(t){return t}isImag(t){return!1}isKind(t){return Sh(t)}isMinusOne(){return!1}isOne(){return!1}isReal(t){return!1}isScalar(t){return!0}isZero(){return!1}subst(t,e,r){return Sh(e)&&t.equals(e)?r:t}toInfixString(t){return t.toInfixString()}toLatexString(t){return t.toInfixString()}toListString(t){return t.toListString()}evaluate(t,e){return this.transform(u(t,e))}transform(t){return Sh(t)?[A,t]:[T,t]}}const qh=new Oi((function(t){return new Th(t)}));function Ah(t,e){let r;if(tr.codeGen||e.getNativeDirective($.renderFloatAsEcmaScript))return`${t}`;if(e.is_zero(e.getSymbolValue(gs)))r=""+t,r=tr.printMode===je?/\d*\.\d*e.*/gm.test(r)?r.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):r.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(r)?r.replace(/e(.*)/gm,"*10^($1)"):r.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)");else{const n=e.getSymbolValue(ws),s=vf(p(n)?Ft(_s):n);r=t.toFixed(s),r=r.replace(/(\.\d*?[1-9])0+$/gm,"$1"),r=r.replace(/\.0+$/gm,""),-1===r.indexOf(".")&&(r+=".0"),parseFloat(r)!==t&&(r=t.toFixed(s)+"...")}return r}function Mh(t){return t instanceof X}class Nh{constructor(t){}get key(){return tt.name}get name(){return"FltExtension"}get dependencies(){return["Flt"]}evaluate(t,e){return this.transform(u(t,e))}transform(t){return[t instanceof X?A:T,t]}isImag(t){return!1}isKind(t){return Mh(t)}isMinusOne(t){return t.isMinusOne()}isOne(t){return t.isOne()}isReal(t){return!0}isScalar(t){return!0}isZero(t){return t.isZero()}subst(t,e,r){return Mh(e)&&t.equals(e)?r:t}toInfixString(t,e){return Ah(t.d,e)}toLatexString(t,e){return Ah(t.d,e)}toListString(t,e){return Ah(t.d,e)}valueOf(t){return t}}const $h=new Oi((function(t){return new Nh(t)}));function Lh(t,e){if(Si(t)&&Si(e))return t.compare(e);const r=(Mh(t),t.toNumber()),n=(Mh(e),e.toNumber());return r<n?O:r>n?S:E}function kh(t,e){return oh(t)&&oh(e)?E:oh(t)?O:oh(e)?S:t.compare(e)}function Rh(t,e,r){if(t.ndim<e.ndim)return O;if(t.ndim>e.ndim)return S;const n=t.ndim;for(let r=0;r<n;r++){if(t.dim(r)<e.dim(r))return O;if(t.dim(r)>e.dim(r))return S}const s=t.nelem;for(let r=0;r<s;r++)switch(Ih(t.elem(r),e.elem(r))){case S:return S;case O:return O;default:continue}return E}function Ih(t,e,r){let n=E;if(t===e)return E;if(p(t)&&p(e))return E;if(p(t))return O;if(p(e))return S;if(ee(t)&&ee(e))return Lh(t,e);if(ee(t))return O;if(ee(e))return S;if(se(t)&&se(e))return Eh(t.str,e.str);if(se(t))return O;if(se(e))return S;if(ie(t)&&ie(e))return kh(t,e);if(ie(t))return O;if(ie(e))return S;if(v(t)&&v(e))return Rh(t,e);if(v(t))return O;if(v(e))return S;if(Me(t)&&Me(e))return E;if(Me(t))return S;if(Me(e))return O;if(Z(t)&&Z(e))return ph(t,e);if(Z(t))return S;if(Z(e))return O;if(ht(t)&&ht(e))return E;if(ht(t))return S;if(ht(e))return O;for(;h(t)&&h(e);){if(n=Ih(d(t),d(e)),0!==n)return n;t=m(t),e=m(e)}return h(e)?O:h(t)?S:E}function Ph(t){return!!Z(t)||!(!h(t)||!gh(t)||1!==wh(t,Z))}const Fh=t=>!Z(t);function Uh(t){if(Z(t))return t;if(h(t)&&gh(t)&&1===wh(t,Z)){const e=bh(t,Fh);if(Z(e))return e;throw new Error}throw new Error}class Ch{compare(t,e,r){switch(function(t,e,r){if(t.equals(e))return E;if(Ph(t)&&Ph(e)){const n=Uh(t),s=Uh(e);if(n.equals(t)&&s.equals(e))return ph(n,s);switch(Dh(n,s,r)){case S:return S;case O:return O;default:return Dh(bh(t,Z),bh(e,Z),r)}}if(Ph(t))return S;if(Ph(e))return O;if(Bh(t)&&Bh(e))return Dh(bh(t,ht),bh(e,ht),r);if(Bh(t))return S;if(Bh(e))return O;if(ee(t)&&ee(e))return E;if(v(t)&&v(e)){if(t.ndim<e.ndim)return O;if(t.ndim>e.ndim)return S;const r=t.ndim;for(let n=0;n<r;n++){if(t.dim(n)<e.dim(n))return O;if(t.dim(n)>e.dim(n))return S}return E}const n=vh(t),s=vh(e);return n.equals(t)&&s.equals(e)?Ih(n,s):Dh(n,s,r)}(vh(t),vh(e),r)){case S:return S;case O:return O;case E:return Lh(yh(t),yh(e))}}}function Dh(t,e,r){return r.compareFn($e)(t,e)}function Bh(t){return!!ht(t)||!(!h(t)||!gh(t)||1!==wh(t,ht))}class Kh{compare(t,e,r){if(t===e||t.equals(e))return E;if(t===e)return E;if(p(t)&&p(e))return E;if(p(t))return O;if(p(e))return S;if(ee(t)&&ee(e))return Lh(t,e);if(ee(t))return O;if(ee(e))return S;if(ht(t)&&ht(e))return E;if(ht(t))return O;if(ht(e))return S;if(se(t)&&se(e))return Eh(t.str,e.str);if(se(t))return O;if(se(e))return S;if(ie(t)&&ie(e))return kh(t,e);if(ie(t))return O;if(ie(e))return S;if(v(t)&&v(e))return Rh(t,e);if(v(t))return O;if(v(e))return S;for(;h(t)&&h(e);){const r=Ih(d(t),d(e));if(r!==E)return r;t=m(t),e=m(e)}return h(t)?O:h(e)?S:Z(t)&&Z(e)?E:Z(t)?O:Z(e)?S:Me(t)&&Me(e)?E:Me(t)?O:Me(e)?S:E}}const zh=["e=exp(1)","i=sqrt(-1)","pi=tau(1)/2","autoexpand=1","assumeRealVariables=1","last=0","trace=0","forceFixedPrintout=1",`${ws}=${_s}`,"printLeaveEAlone=1","printLeaveXAlone=0"];function Qh(t){const e=tr.codeGen;tr.codeGen=!1;try{for(let e=0;e<zh.length;e++){Zh(zh[e],t)}}finally{tr.codeGen=e}}function Zh(t,e){const r=tr.codeGen;tr.codeGen=!1;try{const[r,n]=Oo(t,{useCaretForExponentiation:e.getNativeDirective($.useCaretForExponentiation),explicitAssocAdd:!1,explicitAssocMul:!1});try{if(r>0){e.pushNativeDirective($.expand,!0);try{e.valueOf(n)}finally{e.popNativeDirective()}}}catch(e){throw e instanceof Error?new Error(`Unable to compute the value of definition ${JSON.stringify(t)}. Cause: ${e.message}. Stack: ${e.stack}`):new Error(`Unable to compute the value of definition ${JSON.stringify(t)}. Cause: ${e}`)}}finally{tr.codeGen=r}}function Gh(t){return tr.userSimplificationsInListForm=[],tr.userSimplificationsInStringForm=[],t.clearBindings(),Qh(t),l}function Hh(t,e){let r=t.argList;for(;h(r);){const t=d(r);ie(t)?e.remove(t):er("symbol error"),r=m(r)}return l}function Vh(t){return t.contains(Ms)?Ms:t.contains(Ns)?Ns:t.contains($s)?$s:t.contains(As)?As:t.contains(qs)?qs:Ms}function jh(t){return h(t)?[...t].length:0}function Wh(t){return(te(t)||!!ot(t))&&t.isNegative()}function Jh(t){return te(t)?1===Qs(t.a):!!ot(t)&&t.d>0}function Xh(t){return te(t)?Zs(t.a,2)&&Zs(t.b,1):!!ot(t)&&2===t.d}function Yh(t){return!!ee(t)&&t.isMinusOne()}function tp(t,e){return e.isOne(t)||Yh(t)}function ep(t){return ot(t)?t.d===Math.round(t.d):te(t)?t.isInteger():yf(t)}function rp(t){return!!yf(t)&&t.isPositiveInteger()}function np(t,e,r){return null==e&&(e=Vh(t)),function(t,e,r){return function(t,e,r){return Cf(t)?t.tail().every((t=>sp(t,e))):sp(t,e)}(t,e)}(t,e)&&1===function(...t){return t.reduce(((t,e)=>t+Number(e)),0)}(t.contains(Ms),t.contains(Ns),t.contains($s))?e:l}function sp(t,e,r){return Df(t)?rp(th(t))&&op(Jf(t),e):op(t,e)}function ip(t,e,r){return!!t.contains(e)&&op(t,e)}function op(t,e,r){return Uf(t)?t.tail().every((t=>ap(t,e))):ap(t,e)}function ap(t,e,r){return Cf(t)?t.tail().every((t=>up(t,e))):up(t,e)}function up(t,e,r){return!!t.equals(e)||(Df(t)&&Jf(t).equals(e)?rp(th(t)):!t.contains(e))}function cp(t){return!!(Df(t)&&te(d(m(m(t))))&&Wh(d(m(t))))}function lp(t,e){return Cf(t)&&3===jh(t)&&ot(Jf(t))&&cp(th(t))||e.equals(t,ft)}function fp(t){if(Cf(t)&&3===jh(t)){if(ee(Jf(t))&&th(t).equals(ft))return!0;if(t.equals(ft))return!0;if(cp(th(t)))return!0}return!1}function hp(t,e){if(Uf(t)){if(3===jh(t)){if(ee(Jf(t))&&(fp(th(t))||fp(t)))return!0}}return!1}function pp(t){return yf(t)&&t.a.isEven()}function dp(t){return te(t)&&t.isFraction()}function mp(t,e){return null!==t&&(te(t)?Zs(t.a,e)&&Zs(t.b,1):!!ot(t)&&t.d===e)}function gp(t,e,r){return te(t)?t.numer().isIntegerNumber(e)&&t.denom().isIntegerNumber(r):!!ot(t)&&t.d===e/r}function wp(t){return gp(t,1,2)}function _p(t){return gp(t,-1,2)}function xp(t){return Df(t)&&mp(Jf(t),2)&&gp(th(t),-1,2)}function yp(t){return Cf(t)&&mp(Jf(t),-1)&&xp(th(t))&&3===jh(t)}function vp(t){return Cf(t)&&wp(Jf(t))&&Op(th(t))&&3===jh(t)}function bp(t){return Cf(t)&&_p(Jf(t))&&Op(th(t))&&3===jh(t)}function Op(t){return Df(t)&&mp(Jf(t),3)&&wp(th(t))}function Ep(t){return!(!ot(t)&&!en.equals(t))||!!h(t)&&[...t].some(Ep)}function Sp(t,e){const r=new Array(t);for(let n=0;n<t;n++)r[n]=e;return r}function Tp(t,e,r){const n=Sp(t*t,r);for(let r=0;r<t;r++)n[t*r+r]=e;return n}function qp(t,e,r){const n=r.negate(e);return r.add(t,n)}function Ap(t,e){const r=e.valueOf(t);return ee(r)?function(t){if(t.isZero())throw new Error("divide by zero");if(ot(t))return t.inv();if(te(t))return t.inv();throw new Error}(r):e.valueOf(c(Ie,r,jt))}function Mp(t,e,r){if(ee(t)&&ee(e))return function(t,e){if(te(t)&&te(e))return t.div(e);if(e.isZero())throw new Error("divide by zero");return J((ot(t)?t.d:t.toNumber())/(ot(e)?e.d:e.toNumber()))}(t,e);{const n=Ap(e,r);return r.multiply(t,n)}}function Np(t,e,r){r.pushNativeDirective($.expand,!0);try{return Mp(t,e,r)}finally{r.popNativeDirective()}}function $p(t,e,r){return function(t,e,r){if(Uf(t))return function(t,e,r){return t.tail().reduce(((t,n)=>r.add(t,$p(n,e,r))),Jt)}(t,e,r);if(v(t))return function(t,e,r){return t.map((t=>$p(t,e,r)))}(t,e,r);if(t.contains(e))return Jt;return t}(t,e,r)}function Lp(t){return 3===t.length}function kp(t){return function(e){return If(e,t)&&Lp(e)}}function Rp(t){return kp(ke)(t)}function Ip(t,e,r,n){if(t.equals(e))return r;if(h(t)){const s=t.car,i=t.cdr,o=s.contains(e),a=i.contains(e);if(o){const t=Ip(s,e,r,n);if(a){return u(t,Ip(i,e,r,n))}return u(t,i)}if(a){return u(s,Ip(i,e,r,n))}return t}return n.operatorFor(t).subst(t,e,r)}function Pp(t,e,r){const n=[];let s=t;let i=0;for(;;){const t=Ip(s,e,Jt,r),o=r.valueOf(t);if(n.push(o),s=s.equals(o)?Jt:r.valueOf(qp(s,o,r)),s.equals(Jt))return n;if(s.equals(e)?s=Ut:h(s)&&Fp(s,e)?s=s.lhs:(s=Np(s,e,r),s=r.valueOf(s)),i++,i>10)throw new Error("No making progress computing coefficients.")}}function Fp(t,e){return!!Rp(t)&&t.rhs.equals(e)}function Up(t,e){return c(ln,t)}function Cp(t,e){const r=e.negate(ft),n=Ip(t,ft,r,e);return e.valueOf(n)}const Dp=Q(F.exp),Bp=Q(F.log),Kp=Q(F.multiply),zp=Q(F.real);function Qp(t,e,r){const n=r.valueOf(c(Bp,t)),s=r.valueOf(c(Kp,e,n)),i=r.valueOf(c(zp,s));return r.valueOf(c(Dp,i))}const Zp=Q(F.log),Gp=Q(F.multiply),Hp=Q(F.imag);function Vp(t,e,r){const n=r.valueOf(c(Zp,t)),s=r.valueOf(c(Gp,e,n));return r.valueOf(c(Hp,s))}const jp=Q(F.add),Wp=Q(F.cos),Jp=Q(F.exp),Xp=Q(F.imag),Yp=Q(F.multiply),td=Q(F.pow),ed=Q(F.real);function rd(t,e){const r=function(t,e){return t};if(e.is_real(t))return r(t);if(te(t))return t;if(ie(t)){const r=e.getSymbolValue(ms);return te(r)&&r.isOne()?t:c(ed,t)}if(Uf(t)){const n=t.argList.map((function(t){return rd(t,e)}));return r(e.valueOf(u(jp,n)))}if(Df(t)){const n=t.lhs,s=t.rhs;if(n.contains(ft)){if(te(s)&&s.isInteger()&&s.isNegative()){const t=Cp(n,e),i=e.valueOf(c(td,n,s.succ())),o=e.valueOf(t),a=Mp(e.valueOf(c(Yp,i,o)),e.valueOf(c(Yp,n,t)),e);return r(e.valueOf(c(ed,a)))}throw new Error("Power")}{const t=Qp(n,s,e),i=Vp(n,s,e),o=e.valueOf(c(Wp,i));return r(e.valueOf(c(Yp,t,o)))}}if(Cf(t)){const r=[],n=[];[...t.argList].forEach((function(t){if(e.is_real(t))r.push(t);else if(ie(t)){const e=c(ed,t),r=c(Xp,t),s=c(Yp,ft,r),i=c(jp,e,s);n.push(i)}else if(t.equals(ft))n.push(t);else if(Df(t)){const s=t.lhs,i=t.rhs;if(te(i)&&i.isMinusOne()){const t=e.conj(s),r=e.valueOf(c(Yp,t,s)),i=e.valueOf(c(td,r,jt)),o=e.multiply(t,i);n.push(o)}else{const t=Qp(s,i,e),o=Vp(s,i,e),a=e.valueOf(c(Yp,ft,o)),u=e.valueOf(c(Jp,a));r.push(t),n.push(u)}}else{if(!h(t)||!ie(t.opr))throw new Error(e.toSExprString(t));n.push(t)}}));const s=nd(r,e),i=nd(n,e),o=e.valueOf(c(ed,i));return e.valueOf(c(Yp,s,o))}return t.equals(ft)?Jt:r(t)}function nd(t,e){return t.length>1?e.valueOf(c(Yp,...t)):1===t.length?e.valueOf(t[0]):Ut}const sd=101,id=1e-6,od=1e-9;function ad(t){return Math.sqrt(t.r*t.r+t.i*t.i)}function ud(){return 4*Math.random()-2}class cd{constructor(){this.r=0,this.i=0}}const ld=new cd,fd=new cd,hd=new cd,pd=new cd,dd=new cd,md=new cd,gd=new cd,wd=new cd,_d=[];for(let t=0;t<sd;t++)_d[t]=new cd;function xd(t,e){let r=e.valueOf(th(t)),n=e.valueOf(Jf(t));r=p(r)?Vh(n):r,ip(n,r)||er(`nroots: Polynomial ${e.toInfixString(n)} in variable ${e.toInfixString(r)} must be in expanded form.`);const s=tr.tos,i=Pp(n,r,e);let o=i.length;o>sd&&er("nroots: degree?");for(let t=0;t<o;t++)n=e.valueOf(uh(rd(i[t],e),e)),r=e.valueOf(uh(Up(i[t]),e)),ot(n)&&ot(r)||er("nroots: coefficients?"),_d[t].r=n.d,_d[t].i=r.d;!function(t){pd.r=_d[t-1].r,pd.i=_d[t-1].i;const e=pd.r*pd.r+pd.i*pd.i;for(let r=0;r<t-1;r++)_d[r].r=(_d[r].r*pd.r+_d[r].i*pd.i)/e,_d[r].i=(_d[r].i*pd.r-_d[r].r*pd.i)/e;_d[t-1].r=1,_d[t-1].i=0}(o);for(let t=o;t>1;t--)yd(t),Math.abs(ld.r)<id&&(ld.r=0),Math.abs(ld.i)<id&&(ld.i=0),bf(e.add(J(ld.r),e.multiply(J(ld.i),ft))),bd(t);if(o=tr.tos-s,o>1){!function(t,e){const r=tr.tos-t,n=tr.stack.slice(r,r+t);n.sort((function(t,r){return Dh(t,r,e)})),tr.stack=tr.stack.slice(0,r).concat(n).concat(tr.stack.slice(r+t))}(o,e);const t=[o],r=tr.stack.slice(s,s+o);rr(s),bf(new y(t,r))}return Of()}function yd(t){if(ad(_d[0])<id)return ld.r=0,void(ld.i=0);for(let e=0;e<100;e++){ld.r=ud(),ld.i=ud(),vd(t),fd.r=ld.r,fd.i=ld.i,md.r=dd.r,md.i=dd.i,ld.r=ud(),ld.i=ud();for(let e=0;e<1e3;e++){vd(t);if(ad(dd)<od)return;ad(dd)<ad(md)&&(hd.r=ld.r,hd.i=ld.i,ld.r=fd.r,ld.i=fd.i,fd.r=hd.r,fd.i=hd.i,hd.r=dd.r,hd.i=dd.i,dd.r=md.r,dd.i=md.i,md.r=hd.r,md.i=hd.i),gd.r=fd.r-ld.r,gd.i=fd.i-ld.i,wd.r=md.r-dd.r,wd.i=md.i-dd.i;const e=wd.r*wd.r+wd.i*wd.i;if(0===e)break;pd.r=(gd.r*wd.r+gd.i*wd.i)/e,pd.i=(gd.i*wd.r-gd.r*wd.i)/e,ld.r=fd.r-(pd.r*md.r-pd.i*md.i),ld.i=fd.i-(pd.r*md.i+pd.i*md.r)}}er("nroots: convergence error")}function vd(t){hd.r=ld.r,hd.i=ld.i,dd.r=_d[0].r+_d[1].r*hd.r-_d[1].i*hd.i,dd.i=_d[0].i+_d[1].r*hd.i+_d[1].i*hd.r;for(let e=2;e<t;e++){const t=ld.r*hd.r-ld.i*hd.i;hd.i=ld.r*hd.i+ld.i*hd.r,hd.r=t,dd.r+=_d[e].r*hd.r-_d[e].i*hd.i,dd.i+=_d[e].r*hd.i+_d[e].i*hd.r}}function bd(t){for(let e=t-1;e>0;e--)_d[e-1].r+=_d[e].r*ld.r-_d[e].i*ld.i,_d[e-1].i+=_d[e].i*ld.r+_d[e].r*ld.i;ad(_d[0])>id&&er("nroots: residual error");for(let e=0;e<t-1;e++)_d[e].r=_d[e+1].r,_d[e].i=_d[e+1].i}function Od(t,e){if(e>0){const r=t.argList;return h(r)?Od(r,e-1):r}return t.car}function Ed(t,e){return Lh(t,e)===O}function Sd(t,e){return e.power(Q(F.E),t)}function Td(t){return Wh(t)||Cf(t)&&Wh(Jf(t))}function qd(t){return Uf(t)&&Td(Jf(t))||Td(t)}function Ad(t,e,r){if(ht(t))return!1;if(Df(t)&&!yf(th(e))&&Jf(t).contains(ft))return!0;if(Df(t)&&mp(Jf(t),-1)&&!yf(th(e)))return!0;if(v(t)){for(let r=0;r<t.nelem;r++)if(Ad(t.elem(r),e))return!0;return!1}return!!h(t)&&[...t].some((t=>Ad(t,e)))}function Md(t,e){if(h(t)){if(Df(t)){const e=t.cdr;if(h(e)){if(jf(e.car)){const t=e.argList;if(h(t)){return t.car.contains(ft)}}}}return[...t].some((function(t){return Md(t)}))}if(v(t)){for(let e=0;e<t.nelem;e++)if(Md(t.elem(e)))return!0;return!1}return!1}function Nd(...t){return c(...t)}function $d(t,e){if(te(t)){if(te(e))return t.mul(e);return J(t.toNumber()*e.d)}if(te(e)){return J(t.d*e.toNumber())}return t.mul(e)}function Ld(t,e){if(te(t)){if(te(e))return t.add(e);return J(t.toNumber()+e.d)}if(te(e)){return J(t.d+e.toNumber())}return t.add(e)}function kd(t,e){const r=function(t,e){const r=t.map((function(t,e){return{value:t,index:e}})),n=e.compareFn($e);r.sort((function(t,e){return n(t.value,e.value)}));const s=r.map((function(t){return t.value}));return s}(t,e);return function(t,e){let r=0,n=Jt;for(;r<t.length-1;){const s=t[r],i=t[r+1];if(v(s)&&v(i)){const n=e.add(s,i);l!==n&&(t.splice(r,2,n),r--),r++;continue}if(v(s)||v(i)){r++;continue}if(ee(s)&&ee(i)){const o=Ld(s,i);e.is_zero(o)?(n=$d(n,o),t.splice(r,2)):t.splice(r,2,o),r--,r++;continue}if(ee(s)||ee(i)){r++;continue}const o=Rd(s),a=o.denorm,c=o.lhs,f=o.rhs,h=Rd(i),p=h.lhs,d=h.rhs;if(!e.equals(f,d)){r++;continue}const m=Ld(c,p);if(e.is_zero(m)){t.splice(r,2),r--,r++;continue}const g=f,w=a?u(ke,g):g,_=e.multiply(m,w);t.splice(r,2,_),r--,r++}return t.length>0?t.length>1?u($e,Nd(...t)):t[0]:n}(r,e)}function Rd(t){if(h(t)&&Cf(t)){const e=t.cdr,r=d(e);if(ee(r)){const t=m(e),n=m(t);if(l===n){return{denorm:!1,lhs:r,rhs:d(t)}}return{denorm:!0,lhs:r,rhs:t}}return{denorm:!0,lhs:Ut,rhs:e}}return{denorm:!1,lhs:Ut,rhs:t}}function Id(t,e,r){if(h(e)&&Uf(e)){e.tail().forEach((function(e){Id(t,e,r)}))}else r.is_zero(e)?r.getNativeDirective($.keepZeroTermsInSums)&&t.push(e):t.push(e)}function Pd(t,e){const r=[];for(const n of t)Id(r,n,e);return kd(r,e)}function Fd(t,e,r,n){const s=c(t,e,r);return n.valueOf(s)}function Ud(t,e,r){return Fd(ke,t,e,r)}function Cd(t,e,r){return function(t,e,r,n){n.pushNativeDirective($.expand,!1);try{return t(e,r,n)}finally{n.popNativeDirective()}}(Ud,t,e,r)}function Dd(t,e){if(t.length>1){let r=t[0];for(let n=1;n<t.length;n++)r=e.multiply(r,t[n]);return r}return 1===t.length?t[0]:Ut}function Bd(t,e){e.pushNativeDirective($.factor,!0);try{return Dd(t,e)}finally{e.popNativeDirective()}}function Kd(t,e,r){return or(zd,t,e,r)}function zd(t,e,r){if(t.equals(e))return t;if(te(t)&&te(e))return t.gcd(e);const n=Qd(t,e);return n?function(t,e,r,n){t=n.factorize(t,r),e=n.factorize(e,r),(Cf(t)||Cf(e))&&(Cf(t)||(t=Nd(xn,t,Ut)),Cf(e)||(e=Nd(xn,e,Ut)));if(Cf(t)&&Cf(e))return Zd(t,e,n);return Gd(t,e,n)}(t,e,n,r):Uf(t)&&Uf(e)?function(t,e,r){if(jh(t)!==jh(e))return Ut;const n=h(t)?t.tail().reduce((function(t,e){return Kd(t,e,r)})):d(m(t)),s=h(e)?e.tail().reduce((function(t,e){return Kd(t,e,r)})):d(m(e)),i=Mp(t,n,r),o=Mp(e,s,r);if(i.equals(o))return r.multiply(i,Kd(n,s,r));return Ut}(t,e,r):(Uf(t)&&(t=Hd(t,r)),Uf(e)&&(e=Hd(e,r)),Cf(t)?function(t,e,r){return h(t)?t.tail().reduce(((t,n)=>r.multiply(t,Kd(n,e,r))),Ut):Ut}(t,e,r):Cf(e)?function(t,e,r){return h(e)?e.tail().reduce(((e,n)=>r.multiply(e,Kd(t,n,r))),Ut):Ut}(t,e,r):Cf(t)&&Cf(e)?Zd(t,e,r):Gd(t,e,r))}function Qd(t,e,r){const n=np(t,null);if(n&&np(e,n))return n}function Zd(t,e,r){const n=m(t),s=m(e);if(h(n))return[...n].reduce(((t,e)=>{if(h(s))return r.multiply(t,[...s].reduce(((t,n)=>r.multiply(t,Kd(e,n,r))),Ut));throw new Error}),Ut);throw new Error}function Gd(t,e,r){let n,s;if(Df(t)?(n=th(t),t=Jf(t)):n=Ut,Df(e)?(s=th(e),e=Jf(e)):s=Ut,!t.equals(e))return Ut;if(ee(n)&&ee(s)){const e=Lh(n,s)<0?n:s;return r.power(t,e)}if(ee(Mp(n,s,r))){const e=Jf(n),i=Cf(n)&&ee(e)?e:Ut,o=Jf(s),a=Lh(i,Cf(s)&&ee(o)?o:Ut)<0?n:s;return r.power(t,a)}const i=r.subtract(n,s);if(!ee(i))return Ut;const o=Wh(i)?n:s;return r.power(t,o)}function Hd(t,e){return h(t)?t.tail().reduce((function(t,r){return Kd(t,r,e)})):d(m(t))}function Vd(t,e){return sr(jd,t,e)}function jd(t,e){if(!Uf(t))return t;const r=Ap(t.tail().reduce((function(t,r){return Kd(t,r,e)})),e);return Mp(function(t,e){return ir((function(t){return e.valueOf(t)}),t,e)}(t.tail().reduce(((t,n)=>e.add(t,Cd(r,n,e))),Jt),e),r,e)}function Wd(t,e){return ah(e.valueOf(zm(e.valueOf(t),e)),e)}const Jd=Q(F.test_eq);function Xd(t,e,r){const n=Pp(t,e,r);n.forEach((function(t){}));const s=n[n.length-1];return n.map((t=>Mp(t,s,r)))}function Yd(t,e,r){if(tr.recursionLevelNestedRadicalsRemoval>1)return new y([],[]);const n=Xd(t,e,r);n.forEach((function(t){}));const s=[];if(function(t,e){return!(t.length<=2)&&!e.is_zero(t[0])&&t.slice(1,t.length-1).every((t=>e.is_zero(t)))}(n,r)){const t=n.length,e=n[0],i=function(t,e,r,n){t-=1;const s=Mp(n.power(r,Lf(1,t)),n.power(e,Lf(1,t)),n),i=[];if(t%2==0){for(let e=1;e<=t;e+=2){const r=n.multiply(s,n.power(jt,Lf(e,t)));i.push(r),i.push(n.negate(r))}return i}for(let e=1;e<=t;e++){let r=n.multiply(s,n.power(jt,Lf(e,t)));e%2==0&&(r=n.negate(r)),i.push(r)}return i}(t,n.pop(),e,r);s.push(...i)}else{const n=function(t,e,r){const n=Xd(t,e,r);if(n.some((t=>hp(t)))){if(Cf(t)){const n=t.tail().map((t=>tm(t,e,r)));return n.flat()}return tm(t,e,r)}{const n=r.factorize(t,e);if(Cf(n)){return n.tail().map((t=>tm(t,e,r))).flat()}return tm(n,e,r)}}(t,e,r);s.push(...n)}const i=s.length;if(0===i&&er("roots: the polynomial is not factorable, try nroots"),1===i)return new y([1],s);s.sort((function(t,e){return Ih(t,e)}));return new y([i],s)}function tm(t,e,r){if(Df(t)&&ip(Jf(t),e)&&rp(th(t))){return em(Xd(Jf(t),e,r),r)}if(ip(t,e)){return em(Xd(t,e,r),r)}return[]}function em(t,e){t.forEach((function(t){}));const r=t.length;if(2===r){return function(t,e,r){return[r.negate(Mp(e,t,r))]}(t.pop(),t.pop(),e)}if(3===r){return function(t,e,r,n){const s=n.power(n.subtract(n.power(e,Ct),n.multiply(n.multiply(Bt,t),r)),Xt),i=Mp(n.subtract(s,e),n.multiply(t,Ct),n),o=n.multiply(Mp(n.negate(n.add(s,e)),t,n),Xt);return[i,o]}(t.pop(),t.pop(),t.pop(),e)}if(4===r){return function(t,e,r,n,s){const i=s.multiply(s.multiply(r,r),r),o=s.multiply(e,e),a=s.multiply(o,e),u=s.multiply(s.multiply(a,n),Wt),c=s.multiply(a,Ct),f=s.multiply(Dt,t),h=s.multiply(s.multiply(t,t),n),p=s.multiply(h,Ft(27)),d=s.multiply(s.multiply(h,n),Ft(-27)),m=s.multiply(s.multiply(t,r),e),g=s.multiply(s.multiply(t,r),Dt),w=s.multiply(Wt,s.multiply(t,i)),_=s.negate(s.multiply(m,Gt)),x=s.multiply(s.multiply(m,n),Ft(18)),y=s.subtract(o,g),v=s.multiply(o,s.multiply(r,r)),b=Mp(s.negate(e),f,s),O=s.multiply(s.power(y,Dt),Bt),E=Wd(Pm(y,s),s),S=Wd(Pm(Pd([x,u,v,w,d],s),s),s),T=Pd([c,_,p],s),q=Pm(s.power(s.subtract(s.power(T,Ct),O),Xt),s);if(s.is_zero(S)){return function(t,e,r,n,s,i){const{R_DELTA0_toBeCheckedIfZero:o,R_m_b_over_3a:a,R_DELTA0:u,R_b3:c,R_a_b_c:l}=s;if(i.is_zero(o))return[a];const f=Mp(i.subtract(i.multiply(t,i.multiply(n,Gt)),i.multiply(e,r)),i.multiply(u,Ct),i),h=i.negate(c),p=i.negate(i.multiply(t,i.multiply(t,i.multiply(n,Gt)))),d=i.multiply(l,Bt),m=Mp(Pd([d,p,h],i),i.multiply(t,u),i);return[f,f,m]}(t,e,r,n,{R_DELTA0_toBeCheckedIfZero:E,R_m_b_over_3a:b,R_DELTA0:y,R_b3:a,R_a_b_c:m},s)}let A=!1,M=!1,N=l;for(;!A;){const t=M?s.negate(q):q;N=Pm(s.power(s.multiply(s.add(t,T),Xt),Yt),s);const e=Wd(Pm(N,s),s);s.is_zero(e)?M=!0:A=!0}const $=s.multiply(s.multiply(N,f),Ct),L=s.multiply(ft,s.power(Dt,Xt)),k=s.add(Ut,L),R=s.subtract(Ut,L),I=Mp(N,f,s),P=b,F=s.negate(I),U=s.negate(Mp(y,s.multiply(N,f),s)),C=Pm(Pd([P,F,U],s),s),D=b,B=Mp(s.multiply(I,k),Ct,s),K=Mp(s.multiply(R,y),$,s),z=Pm(Pd([D,B,K],s),s),Q=b,Z=Mp(s.multiply(I,R),Ct,s),G=Mp(s.multiply(k,y),$,s),H=Pm(Pd([Q,Z,G],s),s);return[C,z,H]}(t.pop(),t.pop(),t.pop(),t.pop(),e)}if(5===r){return function(t,e,r,n,s,i){if(i.is_zero(e)&&i.is_zero(n)&&!i.is_zero(r)&&!i.is_zero(s))return function(t,e,r,n,s,i){const o=Yd(i.add(i.multiply(t,i.power(bs,Ct)),i.add(i.multiply(r,bs),s)),bs,i),a=[];for(const t of o.copyElements())a.push(Pm(i.power(t,Xt),i)),a.push(Pm(i.negate(i.power(t,Xt)),i));return a}(t,0,r,0,s,i);return i.is_zero(e)?function(t,e,r,n,s,i){const o=r,a=n,u=s,c=i.multiply(Lf(5,2),o),f=i.subtract(i.multiply(Ct,i.power(o,Ct)),u),h=i.add(i.multiply(Lf(-1,2),i.multiply(o,u)),i.add(Mp(i.power(o,Dt),Ct,i),i.multiply(Lf(-1,8),i.power(a,Ct)))),p=i.add(i.power(bs,Dt),i.add(i.multiply(c,i.power(bs,Ct)),i.add(i.multiply(f,bs),h))),d=Yd(p,bs,i);let m=l;for(const t of d.copyElements()){const e=Wd(i.add(i.multiply(t,Ct),o),i);if(!i.is_zero(e)){m=t;break}}const g=Pm(i.power(i.add(i.multiply(m,Ct),o),Xt),i),w=Pm(Mp(i.multiply(a,Ct),g,i),i),_=i.add(i.multiply(o,Dt),i.multiply(m,Ct)),x=Pm(i.power(i.negate(i.add(_,w)),Xt),i),y=Mp(i.add(g,x),Ct,i),v=Pm(i.power(i.negate(i.add(_,w)),Xt),i),b=Mp(i.subtract(g,v),Ct,i),O=Pm(i.power(i.negate(i.subtract(_,w)),Xt),i),E=Mp(i.add(i.negate(g),O),Ct,i),S=Pm(i.power(i.negate(i.subtract(_,w)),Xt),i),T=Mp(i.subtract(i.negate(g),S),Ct,i);return[y,b,E,T]}(0,0,r,n,s,i):function(t,e,r,n,s,i){const o=Mp(i.add(i.multiply(Zt,i.multiply(r,t)),i.multiply(Ft(-3),i.power(e,Ct))),i.multiply(Zt,i.power(t,Ct)),i),a=Mp(i.add(i.power(e,Dt),i.add(i.multiply(Wt,i.multiply(t,i.multiply(e,r))),i.multiply(Zt,i.multiply(n,i.power(t,Ct))))),i.multiply(Zt,i.power(t,Dt)),i),u=i.multiply(i.multiply(t,t),t),c=i.multiply(e,e),l=i.multiply(i.multiply(t,t),n),f=Mp(i.add(i.multiply(i.power(e,Bt),Ft(-3)),i.add(i.multiply(Ft(256),i.multiply(u,s)),i.add(i.multiply(Ft(-64),i.multiply(l,e)),i.multiply(Ft(16),i.multiply(c,i.multiply(t,r)))))),i.multiply(Ft(256),i.power(t,Bt)),i),h=i.power(bs,Bt),p=i.multiply(o,i.power(bs,Ct)),d=i.multiply(a,bs),m=Pm(Pd([h,p,d,f],i),i),g=Yd(m,bs,i);return g.mapElements((r=>Pm(i.subtract(r,Mp(e,i.multiply(Bt,t),i)),i)))}(t,e,r,n,s,i)}(t.pop(),t.pop(),t.pop(),t.pop(),t.pop(),e)}return[]}const rm=t=>t.reduce(((t,e)=>t+e),0);function nm(t){let e;if(h(t)){const r=[...t];e=rm(r.map(nm))+r.length}else e=1;return e}function sm(t,e,r){let n=0;return h(e)?n=rm([...e].map((e=>sm(t,e,r)))):r.equals(t,e)&&(n=1),n}function im(t){const e=vf(t);return e<0||isNaN(e)?Nd(tn,t):Rf(e)}function om(t,e){if(Uf(t)){return Pd(t.tail().map((function(t){return am(t,e)})),e)}return am(t,e)}function am(t,e){if(!Cf(t))return t;const r=t.tail();for(;um(r,e););return Bd(r,e)}function um(t,e){for(let r=0;r<t.length;r++){const n=t[r];for(let s=0;s<t.length;s++){if(r===s)continue;const i=t[s];if(Bf(n)&&Df(i)&&Yh(th(i))&&e.equals(Jf(n),Jf(i)))return t[r]=im(e.subtract(Jf(n),Ut)),t[s]=Ut,!0;if(Df(i)&&Yh(th(i))&&Yf(i).equals(tn)&&e.equals(n,nh(i)))return t[r]=Ap(im(e.add(n,jt)),e),t[s]=Ut,!0;if(Bf(i)){const o=e.subtract(n,Jf(i));if(e.isOne(o))return t[r]=im(n),t[s]=Ut,!0}if(Df(n)&&Yh(th(n))&&Df(i)&&Yh(th(i))&&Yf(i).equals(tn)){const o=e.subtract(Jf(n),Jf(Jf(i)));if(e.isOne(o))return t[r]=Ap(im(Jf(n)),e),t[s]=Ut,!0}if(Bf(n)&&Df(i)&&Yh(th(i))&&Yf(i).equals(tn)){const o=e.subtract(Jf(n),Jf(Jf(i)));if(e.isOne(o))return t[r]=Jf(n),t[s]=Ut,!0;if(Yh(o))return t[r]=Ap(Jf(Jf(i)),e),t[s]=Ut,!0;if(mp(o,2))return t[r]=Jf(n),t[s]=e.add(Jf(n),jt),!0;if(mp(o,-2))return t[r]=Ap(Jf(Jf(i)),e),t[s]=Ap(e.add(Jf(Jf(i)),jt),e),!0}}}return!1}function cm(t,e){e.pushNativeDirective($.evaluatingAsClock,!0);try{const r=e.arg(t),n=ar.Pi(e),s=c(An,jt,Mp(r,n,e)),i=zm(t,e);return e.multiply(i,s)}finally{e.popNativeDirective()}}function lm(t,e){e.pushNativeDirective($.factor,!0);try{return function(t,e){if(v(t))return function(t,e){if(!v(t))return t;const r=t.mapElements((function(t){return lm(t,e)}));return t.withElements(r)}(t,e);if(!Uf(t))return t;const r=function(t,e){if(Uf(t))return t.tail().reduce(((t,r)=>fm(r,t,e)),Ut);return fm(t,Ut,e)}(t,e);let n=Jt;h(t)&&(n=t.tail().reduce(((t,n)=>e.add(t,e.multiply(r,n))),n));const s=Vd(n,e),i=Mp(s,r,e);return i}(t,e)}finally{e.popNativeDirective()}}function fm(t,e,r){return Cf(t)?t.tail().reduce(((t,e)=>hm(e,t,r)),e):hm(t,e,r)}function hm(t,e,r){if(!Df(t))return e;const n=t;return Wh(t=th(t))||Cf(t)&&Wh(Jf(t))?pm(e,Ap(n,r),r):e}function pm(t,e,r){return Mp(r.multiply(t,e),Kd(t,e,r),r)}function dm(t,e){if(Uf(t)&&(t=lm(t,e)),h(t)){const r=t.cdr;if(Cf(t)&&!e.isOne(d(r))){const r=function(t,e){const r=function(t){return function(e){return dm(e,t)}}(e),n=t.map(r);return n}(t.tail(),e);return Dd(r,e)}}return te(t)?$f(t):Df(t)&&qd(th(t))?Ap(t,e):Ut}function mm(t,e){return mt.gcd(t,e)}function gm(t){return t.isProbablePrime()}function wm(t,e){return t.compare(e)}let _m=mt(0);function xm(t){if(mp(t,0)||mp(t,1)||mp(t,-1))return t;_m=t.a;const e=function(){const t=[];_m.isNegative()&&(_m=Af(_m,1),t.push(jt));for(let e=0;e<1e4;e++)if(t.push(...ym(e)),0===_m.compare(1))return t;return t.push(...function(){const t=[],e=Tf(1);let r=Tf(5),n=Tf(2),s=1,i=1;for(;;){if(gm(_m))return t.push(vm(_m,1)),t;for(;;){let o=n.subtract(r);o=Af(o,1);const a=mm(o,_m);if(!a.equals(1)){if(t.push(vm(a,1)),0===wm(a,_m))return t;o=mf(_m,a),_m=o,o=gf(r,_m),r=o,o=gf(n,_m),n=o;break}0==--s&&(n=r,i*=2,s=i),o=df(r,r),r=o.add(e),o=gf(r,_m),r=o}}}()),t}();return e.length,1===e.length?e[0]:e.length>1?u(xn,c(...e)):l}function ym(t){const e=[];let r;const n=Tf(Bs[t]);let s=0;for(;;){if(0===_m.compare(1))return s&&e.push(vm(n,s)),e;let t;if([r,t]=Array.from(wf(_m,n)),!t.isZero())break;s++,_m=r}return s&&e.push(vm(n,s)),-1===wm(r,n)&&(e.push(vm(_m,1)),_m=Tf(1)),e}function vm(t,e){let r=new Lt(t,mt.one);return e>1&&(r=c(An,r,new Lt(Tf(e),mt.one))),r}function bm(t,e,r,n){const s=n.factorize(e,r);Cf(s)?t.push(...s.tail()):t.push(s)}function Om(t,e,r){return yf(t)?xm(t):r.factorize(t,e)}function Em(t){isNaN(t)&&er("number too big to factor");const e=[];t<0&&(t=-t);for(let r=0;r<Ps;r++){const n=Bs[r];if(n>t/n)break;let s=0;for(;t%n==0;)t/=n,s++;s&&(e.push(Ft(n)),e.push(Ft(s)))}return t>1&&(e.push(Ft(t)),e.push(Ut)),e}function Sm(t,e){return Uf(t)&&(t=lm(t,e)),Cf(t)&&!e.isOne(d(m(t)))?Dd(t.tail().map((function(t){return Sm(t,e)})),e):te(t)?Nf(t):Df(t)&&qd(th(t))?Ut:t}function Tm(t,e){return qm(e.valueOf(Jf(t)),e)}function qm(t,e){e.pushNativeDirective($.evaluatingAsPolar,!0);try{const r=zm(t,e),n=e.arg(t),s=Sd(e.multiply(ft,n),e);return e.multiply(r,s)}finally{e.popNativeDirective()}}function Am(t){return function(t){const e=t.opr;return!!ie(e)&&Ie.equalsSym(e)}(t)&&Lp(t)}const Mm=Q(F.cos);function Nm(t,e){return e.valueOf(c(Mm,t))}const $m=B("sin");function Lm(t,e){return e.valueOf(c($m,t))}function km(t,e){const r=Od(t,1);return Rm(e.valueOf(r),e)}function Rm(t,e){if(ie(t))return e.is_zero(e.getSymbolValue(ms))?c(Cn,t):t;const r=!e.is_zero(e.getSymbolValue(ms));if(r&&!Md(t)&&!Ad(t,t)&&!(t.contains(Be)&&t.contains(Lr)&&t.contains(ft)))return t;if(h(t)&&Cf(t)&&ht(Jf(t))&&r)return t;if(h(t)&&Uf(t))return t.tail().reduce(((t,r)=>e.add(t,Rm(r,e))),Jt);return e.multiply(zm(t,e),e.add(Nm(e.arg(t),e),e.multiply(ft,Lm(e.arg(t),e))))}function Im(t,e,r,n){let s=0;const i=Array(Cs).fill(0),o=Array(Cs).fill(0);if(ee(t))return t;if((n.isOne(e)&&Xh(r)||n.isOne(r)&&Xh(e))&&Hf(t))return t;if(Qf(t)){const s=d(m(m(t))),i=d(m(m(m(t))));if(n.equals(s,r)&&n.equals(i,e)||n.equals(i,r)&&n.equals(s,e)||n.equals(s,l)&&n.equals(i,l)&&(n.isOne(r)&&Xh(e)||n.isOne(e)&&Xh(r)))return d(m(t))}if(n.isExpanding()&&Uf(t))return t.tail().reduce(((t,s)=>n.add(t,Im(s,e,r,n))),Jt);if(n.isExpanding()&&Cf(t))return t.tail().reduce(((t,s)=>n.multiply(t,Im(s,e,r,n))),Ut);if(n.isExpanding()&&zf(t)){const s=[];return h(t)&&s.push(...t.tail().map((t=>[t,e,r]))),s.reverse(),s.reduce(((t,e)=>n.inner(t,Im(e[0],e[1],e[2],n))),Ls)}if(!v(t))return n.is_zero(t)?Jt:n.isOne(e)&&Xh(r)||n.isOne(r)&&Xh(e)?Nd(ss,t):Nd(ss,t,e,r);const{ndim:a,nelem:u}=t;if(1===a)return t;let c=vf(e),f=vf(r);(c<1||c>a||f<1||f>a)&&er("transpose: index out of range"),c--,f--;const p=new Array(u),g=t.copyDimensions();g[c]=t.dim(f),g[f]=t.dim(c);for(let e=0;e<a;e++)i[e]=0,o[e]=t.dim(e);for(let e=0;e<u;e++){s=i[c],i[c]=i[f],i[f]=s,s=o[c],o[c]=o[f],o[f]=s;let r=0;for(let t=0;t<a;t++)r=r*o[t]+i[t];s=i[c],i[c]=i[f],i[f]=s,s=o[c],o[c]=o[f],o[f]=s,p[r]=t.elem(e);for(let t=a-1;t>=0&&!(++i[t]<o[t]);t--)i[t]=0}return new y(g,p)}function Pm(t,e){const r=function(t,e){if(tr.codeGen&&d(t).equals(sn)){const r=Jf(t),n=Pm(e.valueOf(r),e),s=th(t);return Nd(sn,n,s)}return t}(t,e);if(v(r))return function(t,e){const r=t.map((function(t){return Pm(t,e)}));return e.is_zero(r),r}(r,e);const n=function(t,e){if(t.contains(tn)){const r=om(t,e),n=om(lm(t,e),e);return nm(r)<nm(n)?r:n}return t}(t,e);let s=function(t,e){const r=d(t);if((r.equals(xn)||zf(t))&&d(d(m(t))).equals(ss)&&d(d(m(m(t)))).equals(ss)){const n=Jf(d(m(t))),s=Jf(d(m(m(t))));let i;i=r.equals(xn)?e.multiply(n,s):zf(t)?e.inner(s,n):Of();const o=function(t,e,r,n){n.pushNativeDirective($.factor,!0);try{return Im(t,e,r,n)}finally{n.popNativeDirective()}}(i,Ut,Ct,e);nm(o)<nm(t)&&(t=o)}return t}(n,e);s=function(t,e){if(!h(t)||!Uf(t))return t;const r=lm(t,e);nm(r)<nm(t)&&(t=r);return t}(s,e),s=function(t,e){if(!h(t)||!Uf(t))return t;const r=Vd(t,e);nm(r)<=nm(t)&&(t=r);return t}(s,e),s=function(t,e){const r=lm(e.negate(lm(e.negate(lm(t,e)),e)),e);nm(r)<nm(t)&&(t=r);return t}(s,e),s=function(t,e){if(e.is_zero(t))return t;const r=lm(t,e),n=Ap(r,e),s=lm(n,e),i=Ap(s,e),o=lm(i,e);return nm(o)<nm(t)?o:t}(s,e),s=Fm(s,e),s=function(t,e){if(!h(t)||!Uf(t))return t;let r=m(t);h(r)&&(r=[...r].reduce(((t,r)=>Um(e.add(t,Pm(r,e)),e)),Jt));nm(r)<nm(t)&&(t=r);return t}(s,e),s=function(t,e){const r=Cm(t,e),n=e.valueOf(r);nm(n)<nm(t)&&(t=n);return t}(s,e);{let t;if([t,s]=function(t,e){if(tr.recursionLevelNestedRadicalsRemoval>0)return[T,t];const[r,n]=Bm(t,e),s=sr(jd,r,e);return t=sm(An,r,e)<sm(An,s,e)?r:s,[n,t]}(s,e),t)return Pm(s,e)}return s=function(t,e){const r=t;if(!r.contains(Qn)&&!r.contains(Lr))return r;const n=cm(e.valueOf(r),e);return nm(n)<nm(r)?n:r}(s,e),s=Um(s,e),s}function Fm(t,e){const r=function(t,e){return t};if(!t.contains(Qn)&&!t.contains(Lr))return r(t);tr.trigmode=1;const n=e.valueOf(t);tr.trigmode=2;const s=e.valueOf(t);return tr.trigmode=0,nm(s)<nm(n)||Dm(s)<Dm(n)?nm(s)<nm(t)||Dm(s)<Dm(t)?r(s):r(t):nm(n)<nm(t)||Dm(n)<Dm(t)?r(n):r(t)}function Um(t,e){const r=dm(t,e);if(tp(r,e))return t;const n=Sm(t,e);if(tp(n,e))return t;let s;if(!(s=Qd(n,r)))return t;const i=Om(Kd(n,r,e),s,e);if(tp(i,e))return t;const o=Om(n,s,e),a=Ap(i,e),u=Vd(Mp(Pm(Cd(o,a,e),e),Pm(Cd(Om(r,s,e),a,e),e),e),e);return nm(u)<nm(t)?u:t}function Cm(t,e){if(ht(t))return t;if(d(t).equals(An)&&Yh(Jf(t))){const r=e.negate(Ut),n=Cm(th(t),e);return Rm(qm(e.power(r,n),e),e)}if(h(t)){const r=[];for(;h(t);)r.push(Cm(d(t),e)),t=m(t);return Nd(...r)}return t}function Dm(t){return h(t)&&Uf(t)?jh(t)-1:1}function Bm(t,e){return tr.recursionLevelNestedRadicalsRemoval>0?[t,T]:h(t)?Am(t)?function(t,e){const r=t.lhs,n=t.rhs;if(ee(n)&&n.isMinusOne()||!d(r).equals(ur)||!te(n)||!n.isFraction()||!gp(n,1,3)&&!gp(n,1,2))return[t,T];const s=Jf(r);Bm(s,e);const i=th(r);Bm(i,e);let o=0,a=r;for(;l!==m(a);)o++,a=m(a);if(o>2)return[t,T];const{commonBases:u,termsThatAreNotPowers:c}=function(t,e){let r=null;const n=[],s=[];if(Cf(t)){let i=m(t);if(h(i))for(;h(i);){const t=d(i);if(Df(t)){const s=Jf(t),i=th(t);gp(i,1,2)&&(null==r?(r=i,n.push(s)):e.equals(i,r)&&n.push(s))}else s.push(t);i=m(i)}}else if(Df(t)){const e=Jf(t),s=th(t);null==r&&gp(s,1,2)&&(r=s,n.push(e))}return{commonBases:n,termsThatAreNotPowers:s}}(i,e);if(0===u.length)return[t,T];const f=s,p=u.reduce(e.multiply,Ut),g=c.reduce(e.multiply,Ut);let w=l;if(gp(n,1,3)){const r=Mp(e.multiply(e.negate(f),p),g,e),n=kf(uh(rd(r,e),e));if(Math.abs(n)>Math.pow(2,32))return[t,T];const s=e.multiply(Dt,p),i=kf(uh(rd(s,e),e));if(Math.abs(i)>Math.pow(2,32))return[t,T];const o=e.multiply(s,bs),a=Mp(e.multiply(Ft(-3),f),g,e),u=kf(uh(rd(a,e),e));if(Math.abs(u)>Math.pow(2,32))return[t,T];w=Pd([r,o,e.multiply(a,e.power(bs,Ct)),e.multiply(Ut,e.power(bs,Dt))],e)}else if(gp(n,1,2)){const r=kf(uh(rd(p,e),e));if(Math.abs(r)>Math.pow(2,32))return[t,T];const n=Mp(e.multiply(Ft(-2),f),g,e),s=kf(uh(rd(n,e),e));if(Math.abs(s)>Math.pow(2,32))return[t,T];w=e.add(p,e.add(e.multiply(n,bs),e.multiply(Ut,e.power(bs,Ct))))}tr.recursionLevelNestedRadicalsRemoval++;const _=Yd(w,bs,e);if(tr.recursionLevelNestedRadicalsRemoval--,0===_.ndim)return[t,T];const x=_.filterElements((t=>!t.contains(An)));if(0===x.length)return[t,T];const y=[],v=[];for(const t of Array.from(x)){const r=kf(uh(rd(t,e),e));y.push(t),v.push(r)}const b=v.indexOf(Math.max.apply(Math,v)),O=y[b];if(!gp(n,1,3)&&!gp(n,1,2))return[t,T];if(gp(n,1,3)){const t=e.power(Mp(f,e.add(e.power(O,Dt),e.multiply(e.multiply(Dt,p),O)),e),Yt),r=e.multiply(t,O);return[Pm(e.add(e.multiply(t,e.power(p,Xt)),r),e),q]}if(gp(n,1,2)){const t=e.power(Mp(f,e.add(e.power(O,Ct),p),e),Xt),r=e.multiply(t,O),n=Pm(e.add(e.multiply(t,e.power(p,Xt)),r),e);if(!Wh(uh(rd(n,e),e)))return[n,q];return[Pm(e.add(e.multiply(e.negate(t),e.power(p,Xt)),e.negate(r)),e),q]}return[l,q]}(t,e):function(t,e){let r=T;const n=[];if(h(t)){const s=Array.from(t).map((t=>{if(!r){let n;return[n,r]=Bm(t,e),n}return t}));n.push(...s)}return[Nd(...n),r]}(t,e):[t,T]}const Km=Q(F.abs);function zm(t,e){const r=function(t,e){return t},n=t;if(e.is_zero(n))return r(n);if(e.isOne(n))return r(n);if(Wh(n))return r(e.negate(n));if(Jh(n))return r(n);if(oh(n))return r(n);if(ht(n))return r(Ut);if(h(n)&&Uf(n)&&(Ad(n,n)||Md(n)||n.contains(ft))){const t=n,s=rd(t,e),i=Up(t),o=e.power(s,Ct),a=e.power(i,Ct),u=e.add(o,a);return r(Fm(e.power(u,Xt),e))}if(h(n)&&Df(n)&&mp(d(n.cdr),-1))return r(e.getNativeDirective($.evaluatingAsFloat)?tt:Ut);if(h(n)&&Df(n)){const t=Jf(n),s=th(n);if(ee(s)){if(Jh(s)){const n=zm(t,e);return r(e.power(n,s))}if(te(s)&&ee(t)&&!t.isNegative())return r(e.power(t,s))}}const s=Jf(n);if(Df(n)&&jf(s))return r(Sd(rd(th(n),e),e));if(h(n)&&Cf(n))return r(n.tail().map((function(t){return zm(t,e)})).reduce(e.multiply));if(h(n)&&Ff(n))return r(n);if(v(n)){const t=function(t,e){if(1!==t.ndim)throw new Error("abs(tensor) with tensor rank > 1");const r=Pm(t,e);return e.valueOf(Pm(e.power(e.inner(r,Cp(r,e)),Xt),e))}(n,e);return r(t)}if(qd(n)||h(n)&&Uf(n)&&qd(Jf(n))){const t=e.negate(n);return r(c(Km,t))}return h(n)&&Uf(n),r(c(Km,n))}const Qm=B("derivative"),Zm=B("last");function Gm(t,e,r){return t.bitmap===e.bitmap}function Hm(t){return 0===t.bitmap}function Vm(t,e,r,n){if(!e){const e=r?r():"satisfy some condition",s=n?" in "+n():"";throw new Error(t+" must "+e+s+".")}}function jm(){return"not be 'undefined'"}function Wm(t,e,r){Vm(t,!!e,jm,r)}function Jm(){return"be an integer"}function Xm(t,e,r){var n;return Vm(t,"number"==typeof(n=e)&&n%1==0,Jm,r),e}function Ym(t,e){t>>=1;let r=0;for(;0!==t;)r+=hh(t&e),t>>=1;return 0==(1&r)?1:-1}function tg(t){return 0==(1&t)?1:-1}const eg=0;function rg(t){return ig(eg,t.zero,t)}function ng(t,e){return ig(t,e.one,e)}function sg(t,e){return ig(eg,t,e)}function ig(t,e,r){const n={get bitmap(){return t},get weight(){return e},__neg__:()=>ig(t,r.neg(e),r),__wedge__(n){if(t&n.bitmap)return sg(r.zero,r);{const s=t^n.bitmap,i=Ym(t,n.bitmap),o=r.mul(e,n.weight);return ig(s,i>0?o:r.neg(o),r)}},grade:()=>hh(t),reverse(){const s=n.grade(),i=tg(s*(s-1)/2);return ig(t,i>0?e:r.neg(e),r)},gradeInversion(){const s=tg(n.grade());return ig(t,s>0?e:r.neg(e),r)},cliffordConjugate(){const s=n.grade(),i=tg(s*(s+1)/2);return ig(t,i>0?e:r.neg(e),r)},isOne:()=>n.isScalar()&&r.isOne(e),isScalar:()=>t===eg,isZero:()=>r.isZero(e),zero:()=>sg(r.zero,r),asString(n){let s="",i=1,o=t;for(;0!==o;)0!=(1&o)&&(s.length>0&&(s+=" ^ "),null==n||void 0===n||i>n.length||null==n[i-1]?s=s+"e"+i:s+=n[i-1]),o>>=1,i++;return 0===s.length?r.asString(e):r.isOne(e)?s:r.asString(e)+" * "+s},toString:()=>n.asString(void 0)};return n}function og(t,e){const r={};for(let n=0;n<t.length;n++){const s=t[n],i=r[s.bitmap];if(i){const t=e.add(i.weight,s.weight);e.isZero(t)?delete r[s.bitmap]:r[s.bitmap]=ig(s.bitmap,t,e)}else e.isZero(s.weight)||(r[s.bitmap]=s)}return function(t){const e=Object.keys(t).map((function(t){return parseInt(t)})),r=[];for(let n=0;n<e.length;n++){const s=t[e[n]];r.push(s)}return r}(r)}function ag(t,e,r){const n=t.bitmap^e.bitmap,s=Ym(t.bitmap,e.bitmap),i=r.mul(t.weight,e.weight);return ig(n,s>0?i:r.neg(i),r)}function ug(t,e,r,n){const s=ag(t,e,n);let i=s.weight,o=t.bitmap&e.bitmap,a=0;for(;0!==o;)0!=(1&o)&&(i=n.mul(i,r[a])),a++,o>>=1;return ig(s.bitmap,i,n)}function cg(t,e,r,n){const s=r.toEigenBasis(t),i=r.toEigenBasis(e),o=r.getEigenMetric(),a=[];for(let t=0;t<s.length;t++)for(let e=0;e<i.length;e++)s[t].bitmap,s[t].weight,a.push(ug(s[t],i[e],o,n));return r.toMetricBasis(og(a,n))}function lg(t){return hh(t)}function fg(t){if("object"==typeof t){return"function"==typeof t.scalarCoordinate}return!1}function hg(t){return"function"==typeof t.getEigenMetric}function pg(t,e){if(Array.isArray(t))return t.length;if(hg(t))return t.getEigenMetric().length;if(e.isDimension(t))return e.dim(t);throw new Error("metric is undefined")}function dg(t,e,r,n){const s=e.field;if(t.length>0){const i=t.map((function(t){return{blade:vg(t.bitmap,e,r,n),weight:t.weight}}));return s.sum(i)}return s.treeZero()}function mg(t,e){return e.sum([t])}function gg(t,e,r,n){const s=e.field;if(0===t.bitmap)return s.weightToTree(t.weight);{const i=function(t,e,r,n){return{blade:vg(t.bitmap,e,r,n),weight:t.weight}}(t,e,r,n);return mg(i,s)}}function wg(t,e,r,n,s){const i=r.field;if(i.isField(t)&&fg(e)){const o=[];return o.push(sg(t,i)),o.push(ng(e.bitmap,i)),dg(og(o,i),r,n,s)}if(fg(t)&&i.isField(e)){const o=[];return o.push(sg(e,i)),o.push(ng(t.bitmap,i)),dg(og(o,i),r,n,s)}if(fg(t)&&fg(e)){const o=[];return o.push(ng(t.bitmap,i)),o.push(ng(e.bitmap,i)),dg(og(o,i),r,n,s)}}function _g(t,e,r,n,s){const i=r.field;if(i.isField(t)&&fg(e)){const o=[];return o.push(sg(t,i)),o.push(ng(e.bitmap,i).__neg__()),dg(og(o,i),r,n,s)}if(fg(t)&&i.isField(e)){const o=[];return o.push(sg(i.neg(e),i)),o.push(ng(t.bitmap,i)),dg(og(o,i),r,n,s)}if(fg(t)&&fg(e)){const o=[];return o.push(ng(t.bitmap,i)),o.push(ng(e.bitmap,i).__neg__()),dg(og(o,i),r,n,s)}}function xg(t,e,r,n,s){const i=r.field;if(i.isField(t)&&fg(e)){return mg({blade:e,weight:t},i)}if(fg(t)&&i.isField(e)){return mg({blade:t,weight:e},i)}if(fg(t)&&fg(e)){const o=ig(t.bitmap,i.one,i),a=ig(e.bitmap,i.one,i);if(Array.isArray(n)){return gg(ug(o,a,n,i),r,n,s)}if(hg(n)){const t=cg(o,a,n,i),e=[];for(let r=0;r<t.length;r++)e.push(t[r]);return dg(og(e,i),r,n,s)}return gg(ag(o,a,i),r,n,s)}}function yg(t,e,r,n){return Xm("index",t),Wm("algebra",e),vg(1<<t,e,r,n)}function vg(t,e,r,n){if(0===t){throw new Error("bitmap must be non-zero (without weights a scalar blade is ambiguous)")}const s=e.field;let i=0;const a={get bitmap(){return t},get meta(){return i},set meta(t){i=t},get name(){return"Blade"},reset(t){i=o(i,t)},__abs__(){const t=s.bladeToTree(a),e=a.rev(),r=s.treeScp(t,e);return s.treeSqrt(r)},add:t=>wg(a,t,e,r,n),__add__:t=>wg(a,t,e,r,n),__radd__:t=>wg(t,a,e,r,n),sub:t=>_g(a,t,e,r,n),__sub__:t=>_g(a,t,e,r,n),__rsub__:t=>_g(t,a,e,r,n),__eq__:t=>Gm(a,t),__ge__:t=>function(t,e,r){if(Hm(t)&&Hm(e)){const n=t.scalarCoordinate(),s=e.scalarCoordinate();return r.ge(n,s)}throw new Error(`${t} >= ${e} is not implemented.`)}(a,t,s),__gt__:t=>function(t,e,r){if(Hm(t)&&Hm(e)){const n=t.scalarCoordinate(),s=e.scalarCoordinate();return r.gt(n,s)}throw new Error(`${t} > ${e} is not implemented.`)}(a,t,s),__le__:t=>function(t,e,r){if(Hm(t)&&Hm(e)){const n=t.scalarCoordinate(),s=e.scalarCoordinate();return r.le(n,s)}throw new Error(`${t} <= ${e} is not implemented.`)}(a,t,s),__lt__:t=>function(t,e,r){if(Hm(t)&&Hm(e)){const n=t.scalarCoordinate(),s=e.scalarCoordinate();return r.lt(n,s)}throw new Error(`${t} < ${e} is not implemented.`)}(a,t,s),__ne__:t=>!Gm(a,t),inv(){throw new Error("Multivector.inv method not implemented.")},isCons:()=>!1,isNil:()=>!1,map(i){const o=i(s.one);return s.isZero(o)?s.treeZero():gg(ig(t,o,s),e,r,n)},mul:t=>xg(a,t,e,r,n),__mul__:t=>xg(a,t,e,r,n),__rmul__:t=>xg(t,a,e,r,n),__div__:t=>function(t,e,r){throw new Error(`Multivector division is not yet supported. ${t} / ${e}`)}(a,t),__lshift__(i){const o=ig(t,s.one,s),a=ig(i.bitmap,s.one,s);if(Array.isArray(r)){return gg(function(t,e,r,n){const s=t.grade(),i=e.grade();return s>i||lg(t.bitmap^e.bitmap)!==i-s?rg(n):ug(t,e,r,n)}(o,a,r,s),e,r,n)}if(hg(r)){const t=function(t,e,r,n){const s=t.grade(),i=e.grade();return s>i||lg(t.bitmap^e.bitmap)!==i-s?[]:cg(t,e,r,n)}(o,a,r,s),i=[];for(let e=0;e<t.length;e++)i.push(t[e]);return dg(og(i,s),e,r,n)}return gg(function(t,e,r){const n=t.grade(),s=e.grade();return n>s||lg(t.bitmap^e.bitmap)!==s-n?rg(r):ag(t,e,r)}(o,a,s),e,r,n)},__rshift__(i){const o=ig(t,s.one,s),a=ig(i.bitmap,s.one,s);if(Array.isArray(r)){return gg(function(t,e,r,n){const s=t.grade(),i=e.grade();return s<i||lg(t.bitmap^e.bitmap)!==s-i?rg(n):ug(t,e,r,n)}(o,a,r,s),e,r,n)}if(hg(r)){const t=[],i=function(t,e,r,n){const s=t.grade(),i=e.grade();return s<i||lg(t.bitmap^e.bitmap)!==s-i?[]:cg(t,e,r,n)}(o,a,r,s);for(let e=0;e<i.length;e++)t.push(i[e]);return dg(og(t,s),e,r,n)}return gg(function(t,e,r){const n=t.grade(),s=e.grade();return n<s||lg(t.bitmap^e.bitmap)!==n-s?rg(r):ag(t,e,r)}(o,a,s),e,r,n)},__vbar__(t){const r=e.field,n=a.__mul__(t);return r.extractGrade(n,0)},__wedge__(i){const o=[],a=ng(t,s),u=ng(i.bitmap,s),c=a.__wedge__(u);return o.push(c),dg(og(o,s),e,r,n)},__bang__:()=>a.inv(),__pos__:()=>s.bladeToTree(a),neg:()=>gg(ng(t,s).__neg__(),e,r,n),__neg__:()=>gg(ng(t,s).__neg__(),e,r,n),__tilde__:()=>a.rev(),cliffordConjugate:()=>gg(ng(t,s).cliffordConjugate(),e,r,n),contains:t=>a.equals(t),direction(){const t=s.bladeToTree(a),e=a.rev(),r=s.treeScp(t,e),n=s.scalarCoordinate(r),i=s.sqrt(n);return s.isZero(i)?t:a.divByScalar(i)},equals(t){return a===t||!!fg(t)&&this.bitmap===t.bitmap},exp(){throw new Error("BasisBlade.exp")},extractGrade:function(e){return hh(t)===e?s.bladeToTree(a):s.treeZero()},div:t=>s.treeMul(s.bladeToTree(a),t.inv()),divByScalar(i){const o=s.div(s.one,i);return s.isZero(o)?s.treeZero():gg(ig(t,o,s),e,r,n)},dual(){const t=gg(ig((1<<pg(r,e.field))-1,s.one,s),e,r,n);return s.treeLco(s.bladeToTree(a),t)},gradeInversion:()=>gg(ng(t,s).gradeInversion(),e,r,n),isCompatible:t=>!0,rev:()=>gg(ng(t,s).reverse(),e,r,n),scalarCoordinate:()=>0===t?s.one:s.zero,scp:t=>a.__vbar__(t),sqrt(){if(0===t)return gg(ig(t,s.one,s).reverse(),e,r,n);throw new Error("sqrt on arbitrary multivectors is not yet supported.")},asString(e,r){let n="",s=1,i=t;for(;0!==i;)0!=(1&i)&&(n.length>0&&(n+=r),null==e||void 0===e||s>e.length||null==e[s-1]?n=n+"e"+s:n+=e[s-1]),i>>=1,s++;if(n.length>0)return n;throw new Error(`Expecting something for bitmap ${t}`)},toInfixString:()=>a.asString(n,"^"),toListString:()=>a.asString(n,"^"),toLatexString:()=>a.asString(n," \\wedge "),toString:()=>a.asString(n,"^")};return a}function bg(t,e,r){Wm("metric",t);const n=pg(t,e);Wm("field",e),function(t,e,r){if(e){if(!Array.isArray(e))throw new Error(`${t} must be a string[]`);if(e.length!==r)throw new Error(`${t}.length must match the dimensionality of the vector space.`);for(let r=0;r<e.length;r++)if("string"!=typeof e[r])throw new Error(`${t}[${r}] must be a string.`)}}("labels",r,n);const s=[],i={get field(){return e},unit(t){if(Xm("index",t),t>=0&&t<n)return s[t];throw new Error(`index must be in range [0 ... ${n-1})`)},get units(){return s.map((t=>t))}};for(let e=0;e<n;e++)s[e]=yg(e,i,t,r);return i}const Og=1e4;class Eg{constructor(){this.c=0,this.x=0,this.y=0}}let Sg=[];for(let t=0;t<Og;t++)Sg[t]=new Eg;let Tg=0,qg=0,Ag=0;function Mg(t){let e="";return e+=t,e}function Ng(t){return Mg(t)}function $g(t,e){Tg=0,qg=0,Ag=0,function(t,e){if(d(t).equals(Bn))return kg(Jf(t),e),Vg(" = "),void kg(th(t),e);v(t)?function(t,e){let r=0,n=0,s=0;if(t.ndim>2)return void rw(t,e);const i=t.dim(0);r=2===t.ndim?t.dim(1):1;const o=i*r;if(o>Jg)return void rw(t,e);const a=Ag;for(let r=0;r<o;r++)Yg[r].index=Tg,Yg[r].x=Ag,kg(t.elem(r),e),Yg[r].count=Tg-Yg[r].index,[Yg[r].h,Yg[r].w,Yg[r].y]=Array.from(Gg(Yg[r].index,Tg));let u=0,c=0;for(let t=0;t<o;t++)Yg[t].h>u&&(u=Yg[t].h),Yg[t].w>c&&(c=Yg[t].w);const l=i*u+(i-1)*ew,f=r*c+(r-1)*tw,h=-l/2;for(let t=0;t<i;t++)for(let e=0;e<r;e++){const i=t*r+e;n=a-Yg[i].x,s=h-Yg[i].y,Zg(Yg[i].index,Yg[i].index+Yg[i].count,n,s),n=0,e>0&&(n=e*(c+tw)),s=0,t>0&&(s=t*(u+ew)),n+=(c-Yg[i].w)/2,s+=(u-Yg[i].h)/2,Zg(Yg[i].index,Yg[i].index+Yg[i].count,n,s)}Ag=a+f}(t,e):kg(t,e)}(t,e);const[r,n,s]=Array.from(Gg(0,Tg));if(n>100)return mw(t,e),"";const i=function(){let t="";const e=Sg.slice(0,Tg);e.sort(Wg);const r=Sg.slice(Tg);Sg.length=0,Sg=Sg.concat(e).concat(r);let n=0,{y:s}=Sg[0];for(let e=0;e<Tg;e++){for(;Sg[e].y>s;)t+=Ng("\n"),n=0,s++;for(;Sg[e].x>n;)t+=Mg(" "),n++;t+=Mg(Sg[e].c),n++}return t}();return i}function Lg(t,e){if(qg>0)return!1;if(dp(t))return!0;if(!Cf(t))return!1;if(dp(Jf(t)))return!0;for(;h(t);){if(Pg(d(t)))return!0;t=m(t)}return!1}function kg(t,e){if(Uf(t))for(Rg(d(t=m(t)))&&(Hg("-"),Lg(d(t))&&Hg(" ")),Ig(d(t),e),t=m(t);h(t);)Rg(d(t))?(Hg(" "),Hg("-"),Hg(" ")):(Hg(" "),Hg("+"),Hg(" ")),Ig(d(t),e),t=m(t);else Rg(t)&&(Hg("-"),Lg(t)&&Hg(" ")),Ig(t,e)}function Rg(t){return!!Wh(t)||!(!Cf(t)||!Wh(Jf(t)))}function Ig(t,e){if(Cf(t)){const r=function(t,e){let r=0;t=m(t);for(;h(t);){Pg(d(t))&&r++,t=m(t)}return r}(t);r&&0===qg?function(t,e,r){let n,s,i=0,o=0,a=0,u=0,c=0,l=Ut,f=Ut;te(Jf(t))&&(l=zm(Nf(Jf(t)),r),f=$f(Jf(t)));ot(Jf(t))&&(l=zm(Jf(t),r));u=r.isOne(l)?0:1,n=m(t),ee(d(n))&&(n=m(n));for(;h(n);)s=d(n),Pg(s)||u++,n=m(n);c=Ag,o=Tg,i=0,r.isOne(l)||(jg(l,0,r),i++);n=m(t),ee(d(n))&&(n=m(n));for(;h(n);)s=d(n),Pg(s)||(i>0&&Hg(" "),1===u?kg(s,r):Ug(s,r),i++),n=m(n);0===i&&Hg("1");a=Tg,i=0,r.isOne(f)||(jg(f,0,r),i++,e++);n=m(t),te(d(n))&&(n=m(n));for(;h(n);)s=d(n),Pg(s)&&(i>0&&Hg(" "),Dg(s,e,r),i++),n=m(n);zg(c,o,a)}(t,r,e):function(t,e,r){if(0===e)for(t=m(t),(r.isOne(d(t))||Yh(d(t)))&&(t=m(t)),Ug(d(t),r),t=m(t);h(t);)Hg(" "),Ug(d(t),r),t=m(t);else!function(t,e){let r=Ut;t=m(t),te(d(t))?(r=zm(Nf(d(t)),e),t=m(t)):ot(d(t))&&(r=zm(d(t),e),t=m(t));let n=0;e.isOne(r)||(jg(r,0,e),n++);for(;h(t);)Pg(d(t))||(n>0&&Hg(" "),Ug(d(t),e),n++),t=m(t);0===n&&Hg("1")}(t,r),Hg("/"),e>1||dp(Jf(t))?(Hg("("),Fg(t,r),Hg(")")):Fg(t,r)}(t,r,e)}else Ug(t,e)}function Pg(t,e){const r=Jf(t);return Df(t)&&jf(r)&&Rg(th(t))}function Fg(t,e){let r=0;if(dp(d(t=m(t)))){jg($f(d(t)),0,e),r++,t=m(t)}for(;h(t);)Pg(d(t))&&(r>0&&Hg(" "),Dg(d(t),0,e),r++),t=m(t)}function Ug(t,e){v(t)?rw(t,e):ot(t)?jg(t,0,e):Uf(t)||Cf(t)?Bg(t,e):Df(t)?function(t,e){let r=0,n=0,s=0;const i=Jf(t);if(jf(i))return Vg("exp("),kg(th(t),e),void Hg(")");if(qg>0)return void(Yh(th(t))?(Hg("1"),Hg("/"),Cg(Jf(t))?Ug(Jf(t),e):Bg(Jf(t),e)):(Cg(Jf(t))?Ug(Jf(t),e):Bg(Jf(t),e),e.getNativeDirective($.useCaretForExponentiation)?Hg("^"):(Hg("*"),Hg("*")),Cg(th(t))?Ug(th(t),e):Bg(th(t),e)));if(Rg(th(t)))return s=Ag,r=Tg,Hg("1"),n=Tg,Dg(t,1,e),void zg(s,r,n);r=Tg,Cg(Jf(t))?Ug(Jf(t),e):Bg(Jf(t),e);n=Tg,qg++,kg(th(t),e),qg--,Qg(r,n)}(t,e):h(t)?function(t,e){if(t.opr.equals(fn)&&ie(Jf(t)))return void function(t,e){t=m(t),Wf(t).equals(ur)||Wf(t).equals(xn)||Wf(t).equals(An)||Wf(t).equals(tn)?Bg(d(t),e):kg(d(t),e);if(Hg("["),t=m(t),h(t))for(kg(d(t),e),t=m(t);h(t);)Hg(","),kg(d(t),e),t=m(t);Hg("]")}(t,e);if(Bf(t))return void function(t,e){t=Jf(t),dp(t)||Uf(t)||Cf(t)||Df(t)||Bf(t)?Bg(t,e):kg(t,e);Hg("!")}(t,e);d(t).equals(Qm)?Hg("d"):Kg(d(t),e);Hg("(");let r=t.cdr;if(h(r))for(kg(r.head,e),r=r.cdr;h(r);)Hg(","),kg(r.head,e),r=r.cdr;Hg(")")}(t,e):ee(t)?0===qg?function(t,e){te(t)&&function(t,e){const r=t.numer().abs(),n=t.denom();if(n.isOne())return void jg(r,0,e);const s=Ag,i=Tg;jg(r,0,e);const o=Tg;jg(n,0,e),zg(s,i,o)}(t,e);ot(t)&&function(t,e){const r=t.abs();jg(r,0,e)}(t,e)}(t,e):jg(t,0,e):ie(t)?Kg(t,e):se(t)&&function(t){const e=t.str;Hg('"');for(let t=0;t<e.length;t++)Hg(e[t]);Hg('"')}(t)}function Cg(t){return!(!h(t)||Uf(t)||Cf(t)||Df(t))||(!!ie(t)||!dp(t)&&(!Wh(t)&&!!ee(t)))}function Dg(t,e,r){let n=0,s=0;Yh(th(t))?1===e?kg(Jf(t),r):Ug(Jf(t),r):(n=Tg,Cg(Jf(t))?Ug(Jf(t),r):Bg(Jf(t),r),s=Tg,qg++,function(t,e){if(Uf(t))for(Ig(d(t=m(t)),e),t=m(t);h(t);)Rg(d(t))?(Hg(" "),Hg("-"),Hg(" ")):(Hg(" "),Hg("+"),Hg(" ")),Ig(d(t),e),t=m(t);else Ig(t,e)}(th(t),r),qg--,Qg(n,s))}function Bg(t,e){Hg("("),kg(t,e),Hg(")")}function Kg(t,e){if(jf(t))return void Vg("exp(1)");const r=e.getSymbolPrintName(t);for(let t=0;t<r.length;t++)Hg(r[t])}function zg(t,e,r){let n=0,s=0;const[i,o,a]=Array.from(Gg(e,r)),[u,c,l]=Array.from(Gg(r,Tg));n=c>o?(c-o)/2:0,n++;s=-(a+i-1)-1,Zg(e,r,n,s),n=c>o?-o:(o-c)/2-o,n++,s=1-l,Zg(r,Tg,n,s);let f=0;f=c>o?c:o,f+=2,Ag=t;for(let t=0;t<f;t++)Hg("-")}function Qg(t,e){let r=0,n=0,s=0,i=0,o=0,a=0,u=0;[n,s,i]=Array.from(Gg(t,e)),[o,a,u]=Array.from(Gg(e,Tg)),r=-u-o+1,r+=i-1,Zg(e,Tg,0,r)}function Zg(t,e,r,n){for(let s=t;s<e;s++)Sg[s].x+=r,Sg[s].y+=n}function Gg(t,e){let r=Sg[t].x,n=Sg[t].x,s=Sg[t].y,i=Sg[t].y;for(let o=t+1;o<e;o++)Sg[o].x<r&&(r=Sg[o].x),Sg[o].x>n&&(n=Sg[o].x),Sg[o].y<s&&(s=Sg[o].y),Sg[o].y>i&&(i=Sg[o].y);return[i-s+1,n-r+1,s]}function Hg(t){if(Tg!==Og)return Sg[Tg].c=t,Sg[Tg].x=Ag,Sg[Tg].y=0,Tg++,Ag++}function Vg(t){for(let e=0;e<t.length;e++)Hg(t[e])}function jg(t,e,r){if(te(t)){let r=t.a.toString();"-"===r[0]&&0===e&&(r=r.substring(1));for(let t=0;t<r.length;t++)Hg(r[t]);if(r=t.b.toString(),"1"===r)return;Hg("/");for(let t=0;t<r.length;t++)Hg(r[t])}else if(ot(t)){let n=Ah(t.d,r);"-"===n[0]&&0===e&&(n=n.substring(1));for(let t=0;t<n.length;t++)Hg(n[t])}}function Wg(t,e){return t.y<e.y?-1:t.y>e.y?1:t.x<e.x?-1:t.x>e.x?1:0}const Jg=100;class Xg{constructor(){this.x=0,this.y=0,this.h=0,this.w=0,this.index=0,this.count=0}}const Yg=[];for(let t=0;t<1e4;t++)Yg[t]=new Xg;const tw=3,ew=1;function rw(t,e){nw(t,0,0,e)}function nw(t,e,r,n){Hg("(");for(let s=0;s<t.dim(e);s++)e+1===t.ndim?(kg(t.elem(r),n),r+=1):r=nw(t,e+1,r,n),s+1<t.dim(e)&&Hg(",");return Hg(")"),r}function sw(t,e){if(h(t)){let r="";for(r+="(",r+=sw(d(t),e),t=m(t);h(t);)r+=" ",r+=sw(d(t),e),t=m(t);return t!==l&&(r+=" . ",r+=sw(t,e)),r+=")",r}return e.toSExprString(t)}const iw="undefined",ow=Q(F.E),aw=Q(F.IMU),uw=Q(F.PI),cw=Q(F.test_eq);function lw(t){switch(t){case We:return as;case Xe:return fs;case je:return cs;case Je:return us;case Ye:return ls;default:throw new Error(t)}}function fw(t,e,r){const n='"'+t+'"',[s,i]=Oo(n,{useCaretForExponentiation:r.getNativeDirective($.useCaretForExponentiation),explicitAssocAdd:!1,explicitAssocMul:!1});if(s===n.length){const t=function(t){if(se(t))return t;throw new Ai(`expr => ${t}`)}(i);r.setSymbolValue(e,t)}}function hw(t,e){return function(t){if(te(t)&&(t.isNegative()||t.isFraction()))return!0;if(ot(t)&&t.isNegative())return!0;if(Uf(t))return!0;if(Cf(t))return!0;if(Df(t))return!0;return!1}(t)?`(${mw(t,e)})`:mw(t,e)}function pw(t,e){return te(t)&&t.isFraction()||Uf(t)||Cf(t)||Df(t)?`(${mw(t,e)})`:mw(t,e)}function dw(t,e,r){let n="";const s=Jf(t);let i=th(t);return Yh(i)?(n+=hw(s,r),n):(1===e&&(n+="("),i=r.negate(i),n+=Nw(s,i,r),1===e&&(n+=")"),n)}function mw(t,e){return function(t,e){let r="";if(Uf(t))for("-"===gw(d(t=m(t)))&&(r+="-"),r+=_w(d(t),e),t=m(t);h(t);)"+"===gw(d(t))?tr.printMode!==Xe||tr.testFlag?r+="+":r+=" + ":tr.printMode!==Xe||tr.testFlag?r+="-":r+=" - ",r+=_w(d(t),e),t=m(t);else"-"===gw(t)&&(r+="-"),r+=_w(t,e);return r}(t,e)}function gw(t){if(h(t)&&Cf(t)){const e=d(t.cdr);if(ee(e)&&Ed(e,Jt))return"-"}return ee(t)&&Ed(t,Jt)?"-":"+"}function ww(t,e){let r="",n="",s=m(t);Yh(d(s))&&(s=m(s));let i=!1;ee(d(s))&&(i=!0);let o=!1;tr.printMode===je&&h(m(s))&&function(t){return te(t)&&t.isFraction()&&Zs(t.a.abs(),1)}(d(s))&&(o=!0,r=d(s).b.toString());let a="";for(o?(n=a,a=""):a+=xw(d(s),!1,!1,e),s=m(s);h(s);)tr.printMode===je&&i&&Wf(s).equals(An)&&ee(d(m(d(s))))&&(dp(d(m(m(d(s)))))||(a+=" \\cdot ")),a+=Lw(),a+=xw(d(s),!1,!0,e),i=!1,ee(d(s))&&(i=!0),s=m(s);return o&&(a=n+"\\frac{"+a+"}{"+r+"}"),a}function _w(t,e){return h(t)&&Cf(t)?function(t,e){let r=t.cdr;for(;h(r);){if(kw(r.car))return!0;r=r.cdr}return!1}(t)?function(t,e){let r,n,s="",i=0,o=0,a=0,u=t.cdr,c=d(u);for(te(c)?(r=zm(Nf(c),e),n=$f(c),e.isOne(r)||o++,e.isOne(n)||a++,u=m(u)):(r=Ut,n=Ut);h(u);)c=d(u),kw(c)?a++:o++,u=m(u);if(tr.printMode===je&&(s+="\\frac{"),0===o)s+="1";else for(i=0,u=m(t),te(d(u))&&(u=m(u)),e.isOne(r)||(s+=$w(r,!1,!1,e),i=1);h(u);)c=d(u),kw(c)||(i&&(s+=Lw()),s+=$w(c,!1,!1,e),i=1),u=m(u);for(tr.printMode===je?s+="}{":tr.printMode!==Xe||tr.testFlag?s+="/":s+=" / ",a>1&&tr.printMode!==je&&(s+="("),i=0,u=m(t),te(d(u))&&(u=m(u)),e.isOne(n)||(s+=$w(n,!1,!1,e),i=1);h(u);)c=d(u),kw(c)&&(i&&(s+=Lw()),s+=dw(c,a,e),i=1),u=m(u);return a>1&&tr.printMode!==je&&(s+=")"),tr.printMode===je&&(s+="}"),s}(t,e):ww(t,e):xw(t,!1,!1,e)}function xw(t,e,r,n){if(h(t)&&Kf(t)){let e=t.argList;if(h(e)){let t=vw(e.car,!1,!1,n);for(e=e.cdr;h(e);)t+=yw(),t+=vw(d(e),!1,!0,n),e=e.cdr;return t}throw new Error}return vw(t,e,r,n)}function yw(){return tr.printMode===je?" \\wedge ":tr.printMode!==Xe||tr.testFlag||tr.codeGen?"^":" ^ "}function vw(t,e,r,n){if(h(t)&&zf(t)){let e=t.argList;if(h(e)){let t=$w(e.car,!1,!1,n);for(e=e.cdr;h(e);)t+=bw(),t+=$w(d(e),!1,!0,n),e=e.cdr;return t}throw new Error}if(h(t)&&function(t){return h(t)&&If(t,Ce)}(t)){let e=t.argList;if(h(e)){let t=$w(e.car,!1,!1,n);for(e=e.cdr;h(e);)t+=Ow(),t+=$w(d(e),!1,!0,n),e=e.cdr;return t}throw new Error}if(h(t)&&function(t){return h(t)&&If(t,De)}(t)){let e=t.argList;if(h(e)){let t=$w(e.car,!1,!1,n);for(e=e.cdr;h(e);)t+=Ew(),t+=$w(d(e),!1,!0,n),e=e.cdr;return t}throw new Error}return $w(t,e,r,n)}function bw(){return tr.printMode===je?" \\mid ":tr.printMode!==Xe||tr.testFlag||tr.codeGen?"|":" | "}function Ow(){return tr.printMode===je?" \\ll ":tr.printMode!==Xe||tr.testFlag||tr.codeGen?"<<":" << "}function Ew(){return tr.printMode===je?" \\gg ":tr.printMode!==Xe||tr.testFlag||tr.codeGen?">>":" >> "}function Sw(t,e){let r="";return r+="(",r+=mw(t,e),r+=")",r}function Tw(t,e){let r="";return r+=qw(t,0,0,e)[1],r}function qw(t,e,r,n){let s="";if(s+="[",e<t.ndim-1)for(let i=0;i<t.dim(e);i++){let o;[r,o]=Array.from(qw(t,e+1,r,n)),s+=o,i!==t.dim(e)-1&&(s+=",")}else for(let i=0;i<t.dim(e);i++)s+=mw(t.elem(r),n),i!==t.dim(e)-1&&(s+=","),r++;return s+="]",[r,s]}function Aw(t,e){let r="";return t.ndim<=2&&(r+=Mw(!0,t,0,0,e)[1]),r}function Mw(t,e,r,n,s){let i="";if(t&&(i+="\\begin{bmatrix} "),r<e.ndim-1)for(let t=0;t<e.dim(r);t++){let o;[n,o]=Array.from(Mw(!1,e,r+1,n,s)),i+=o,t!==e.dim(r)-1&&(i+=" \\\\ ")}else for(let t=0;t<e.dim(r);t++)i+=mw(e.elem(n),s),t!==e.dim(r)-1&&(i+=" & "),n++;return t&&(i+=" \\end{bmatrix}"),[n,i]}function Nw(t,e,r){let n="";if(wp(e))if(mp(t,2)){if(tr.codeGen)return n+="Math.SQRT2",n}else{if(tr.printMode===je)return n+="\\sqrt{",n+=mw(t,r),n+="}",n;if(tr.codeGen)return n+="Math.sqrt(",n+=mw(t,r),n+=")",n}if(mp(r.getSymbolValue(Mn),1)&&jf(t))return tr.codeGen?(n+="Math.exp(",n+=pw(e,r),n+=")",n):(tr.printMode===je?(n+="e^{",n+=mw(e,r),n+="}"):(n+="exp(",n+=mw(e,r),n+=")"),n);if(tr.codeGen)return n+="Math.pow(",n+=hw(t,r),n+=", ",n+=pw(e,r),n+=")",n;if(function(t,e){if(ie(t)){if(t.equals(B("x"))){const t=Nn,r=e.getSymbolValue(t);return t===r||!mp(r,1)}return!0}return!0}(t,r)){if(!jf(t)){if(ee(e)&&e.isMinusOne())return tr.printMode===je?n+="\\frac{1}{":tr.printMode!==Xe||tr.testFlag?n+="1/":n+="1 / ",h(t)&&tr.printMode!==je?(n+="(",n+=mw(t,r),n+=")"):n+=mw(t,r),tr.printMode===je&&(n+="}"),n;if(qd(e)){tr.printMode===je?n+="\\frac{1}{":tr.printMode!==Xe||tr.testFlag?n+="1/":n+="1 / ";const s=r.multiply(e,jt);return h(t)&&tr.printMode!==je?(n+="(",n+=Nw(t,s,r),n+=")"):n+=Nw(t,s,r),tr.printMode===je&&(n+="}"),n}}if(dp(e)&&tr.printMode===je){n+="\\sqrt";const s=dm(e,r);return Xh(s)||(n+="[",n+=mw(s,r),n+="]"),n+="{",n+=Nw(t,e=Sm(e,r),r),n+="}",n}}return tr.printMode===je&&r.isOne(e)?n+=mw(t,r):(Df(t)?tr.printMode!==je?(n+="(",n+=$w(t,!0,!1,r),n+=")"):n+=$w(t,!0,!1,r):Wh(t)||Uf(t)?(n+="(",n+=mw(t,r),n+=")"):Cf(t)?tr.printMode!==je?(n+="(",n+=$w(t,!0,!1,r),n+=")"):n+=$w(t,!0,!1,r):Kf(t)||zf(t)?(n+="(",n+=mw(t,r),n+=")"):ee(t)&&(Ed(t,Jt)||dp(t))?(n+="(",n+=$w(t,!1,!1,r),n+=")"):n+=$w(t,!1,!1,r),tr.printMode!==Xe||tr.testFlag?tr.printMode===je||r.getNativeDirective($.useCaretForExponentiation)?n+="^":n+="**":r.getNativeDirective($.useCaretForExponentiation)?n+="^":n+="**",tr.printMode===je?mw(e,r).length>1?(n+="{",n+=mw(e,r),n+="}"):n+=mw(e,r):h(e)||dp(e)||ee(e)&&Ed(e,Jt)?(n+="(",n+=mw(e,r),n+=")"):n+=$w(e,!1,!1,r)),n}function $w(t,e=!1,r=!1,n){const s=e;if(ee(t)){let e="";return r&&Ed(t,Jt)&&(e+="("),e+=function(t,e,r){if(te(t)){let r="",n=t.a.toString();if(e||"-"===n[0]&&(n=n.substring(1)),tr.printMode===je&&t.isFraction()&&(n="\\frac{"+n+"}{"),r+=n,t.isFraction()){tr.printMode!==je&&(r+="/");let e=t.b.toString();tr.printMode===je&&(e+="}"),r+=e}return r}if(ot(t)){let n="",s=Ah(t.d,r);return e||"-"===s[0]&&(s=s.substring(1)),n+=s,n}throw new Error(`print_number(p = ${t})`)}(t,r,n),r&&Ed(t,Jt)&&(e+=")"),e}if(W(t))return t.equals(V)?"true":"false";if(se(t)){let e="";return e+='"',e+=t.str,e+='"',e}if(v(t)){let e="";return tr.printMode===je?e+=Aw(t,n):e+=Tw(t,n),e}if(fg(t)){let e="";return tr.printMode===je?e+=t.toLatexString():e+=t.toInfixString(),e}if(h(t)&&Cf(t)){let e="";return s||"-"!==gw(t)&&tr.printMode===je||(tr.printMode===je?e+=" \\left (":e+="("),e+=mw(t,n),s||"-"!==gw(t)&&tr.printMode===je||(tr.printMode===je?e+=" \\right ) ":e+=")"),e}if(Uf(t)){let e="";return s||(e+="("),e+=mw(t,n),s||(e+=")"),e}if(Df(t)){let e="";return e+=Nw(Jf(t),th(t),n),e}if(d(t).equals(sn)){let e="";const r=Jf(t);if(!tr.codeGen){e+="function ";e+=sw(th(t),n),e+=" -> "}return e+=mw(r,n),e}if(d(t).equals(Tn)){let e="";return e+=mw(Yf(t),n),tr.printMode===je?e+=" \\rightarrow ":tr.printMode!==Xe||tr.testFlag?e+="->":e+=" -> ",e+=mw(d(m(Jf(t))),n),e}if(d(t).equals(fn)&&ie(Jf(t))){let e="";return e+=function(t,e){let r="";if(Wf(t=m(t)).equals(ur)||Wf(t).equals(xn)||Wf(t).equals(An)||Wf(t).equals(tn)?r+=Sw(d(t),e):r+=mw(d(t),e),r+="[",h(t=m(t)))for(r+=mw(d(t),e),t=m(t);h(t);)r+=",",r+=mw(d(t),e),t=m(t);return r+="]",r}(t,n),e}if(h(t)&&Bf(t))return function(t,e){let r="";return dp(t=Jf(t))||Uf(t)||Cf(t)||Df(t)||Bf(t)?r+=Sw(t,e):r+=mw(t,e),r+="!",r}(t,n);if(h(t)&&Ff(t))switch(tr.printMode){case Xe:case Je:return function(t,e){let r="";return r+="abs(",r+=mw(t.argList.head,e),r+=")",r}(t,n);case je:return function(t,e){let r="";return r+="\\left |",r+=mw(t.argList.head,e),r+=" \\right |",r}(t,n);default:throw new Error(tr.printMode)}else{if(d(t).equals(Hn)&&tr.printMode===je){let e="";return e+=function(t,e){let r="";return r+="\\sqrt{",r+=mw(Jf(t),e),r+="} ",r}(t,n),e}if(Qf(t)){if(tr.printMode===je){let e="";return e+=function(t,e){let r="";return r+="{",h(Jf(t))&&(r+="("),r+=mw(Jf(t),e),h(Jf(t))&&(r+=")"),r+="}",r+="^T",r}(t,n),e}if(tr.codeGen){let e="";return e+=function(t,e){let r="";return r+="transpose(",r+=mw(Jf(t),e),r+=")",r}(t,n),e}}else if(d(t).equals(is)){if(tr.codeGen){let e="";return e+=function(t,e){let r="";return r+="identity(",r+=mw(Jf(t),e),r+=")",r}(t,n),e}}else if(h(t)&&Zf(t)){if(tr.printMode===je){let e="";return e+=function(t,e){let r="";return r+="{",h(Jf(t))&&(r+="("),r+=mw(Jf(t),e),h(Jf(t))&&(r+=")"),r+="}",r+="^{-1}",r}(t,n),e}if(tr.codeGen){let e="";return e+=function(t,e){let r="";return r+="inv(",r+=mw(Jf(t),e),r+=")",r}(t,n),e}}else{if(d(t).equals(yr)&&tr.printMode===je){let e="";return e+=function(t,e){let r="";return r+="\\binom{",r+=mw(Jf(t),e),r+="}{",r+=mw(th(t),e),r+="} ",r}(t,n),e}if(d(t).equals(Rr)&&tr.printMode===je){let e="";return e+=function(t,e){let r="";const n=d(m(t)),s=t=m(t);let i=0;for(;h(m(m(t)));){i++;const n=m(m(t));r+="\\int^{",r+=mw(d(m(n)),e),r+="}_{",r+=mw(d(n),e),r+="} \\! ",t=m(n)}r+=mw(n,e),r+=" \\,",t=s;for(let n=1;n<=i;n++){const s=m(t);r+=" \\mathrm{d} ",r+=mw(d(s),e),n<i&&(r+=" \\, "),t=m(m(s))}return r}(t,n),e}if(zf(t)){if(tr.printMode===je){let e="";return e+=function(t,e){let r="";return r+=mw(Jf(t),e),r+=" \\cdot ",r+=mw(th(t),e),r}(t,n),e}if(tr.codeGen){let e="";return e+=function(t,e){let r="dot(";return r+=mw(Jf(t),e),r+=", ",r+=mw(th(t),e),r+=")",r}(t,n),e}}else if(d(t).equals(Qn)){if(tr.codeGen){let e="";return e+=function(t,e){let r="Math.sin(";return r+=mw(Jf(t),e),r+=")",r}(t,n),e}}else if(d(t).equals(Lr)){if(tr.codeGen){let e="";return e+=function(t,e){let r="Math.cos(";return r+=mw(Jf(t),e),r+=")",r}(t,n),e}}else if(d(t).equals(Wn)){if(tr.codeGen){let e="";return e+=function(t,e){let r="Math.tan(";return r+=mw(Jf(t),e),r+=")",r}(t,n),e}}else if(d(t).equals(dr)){if(tr.codeGen){let e="";return e+=function(t,e){let r="Math.asin(";return r+=mw(Jf(t),e),r+=")",r}(t,n),e}}else if(d(t).equals(hr)){if(tr.codeGen){let e="";return e+=function(t,e){let r="Math.acos(";return r+=mw(Jf(t),e),r+=")",r}(t,n),e}}else if(d(t).equals(gr)){if(tr.codeGen){let e="";return e+=function(t,e){let r="Math.atan(";return r+=mw(Jf(t),e),r+=")",r}(t,n),e}}else if(d(t).equals(jn)){if(tr.printMode===je){let e="";return e+=function(t,e){let r="\\sum_{";return r+=mw(th(t),e),r+="=",r+=mw(sh(t),e),r+="}^{",r+=mw(ih(t),e),r+="}{",r+=mw(Jf(t),e),r+="}",r}(t,n),e}if(tr.codeGen){let e="";return e+=function(t,e){const r=Jf(t),n=th(t),s=sh(t),i=ih(t);return"(function(){ var "+mw(n,e)+";  var holderSum = 0;  var lowerlimit = "+mw(s,e)+";  var upperlimit = "+mw(i,e)+";  for ("+mw(n,e)+" = lowerlimit; "+mw(n,e)+" < upperlimit; "+mw(n,e)+"++) {    holderSum += "+mw(r,e)+"; }  return holderSum;})()"}(t,n),e}}else if(d(t).equals($n)){if(tr.printMode===je){let e="";return e+=function(t,e){let r="\\prod_{";return r+=mw(th(t),e),r+="=",r+=mw(sh(t),e),r+="}^{",r+=mw(ih(t),e),r+="}{",r+=mw(Jf(t),e),r+="}",r}(t,n),e}if(tr.codeGen){let e="";return e+=function(t,e){const r=Jf(t),n=th(t),s=sh(t),i=ih(t);return"(function(){ var "+mw(n,e)+";  var holderProduct = 1;  var lowerlimit = "+mw(s,e)+";  var upperlimit = "+mw(i,e)+";  for ("+mw(n,e)+" = lowerlimit; "+mw(n,e)+" < upperlimit; "+mw(n,e)+"++) {    holderProduct *= "+mw(r,e)+"; }  return holderProduct;})()"}(t,n),e}}else if(d(t).equals(nn)){if(tr.codeGen){let e="";return e+=function(t,e){const r=Jf(t),n=th(t),s=sh(t),i=ih(t);return"(function(){ var "+n+";  var lowerlimit = "+mw(s,e)+";  var upperlimit = "+mw(i,e)+";  for ("+n+" = lowerlimit; "+n+" < upperlimit; "+n+"++) {    "+mw(r,e)+" } })()"}(t,n),e}}else if(d(t).equals(Br)){if(tr.codeGen){let e="";return e+=function(t,e){let r="";for(t=m(t);h(t);)r+=mw(d(t),e),t=m(t);return r}(t,n),e}}else if(d(t).equals(Yn)){if(tr.codeGen){let e="";return e+=function(t,e){let r="(function(){";t=m(t);let n=0;for(;h(t);){if(l===m(t)){r+="else {",r+="return ("+mw(d(t),e)+");,$",r+="}";break}n&&(r+=" else "),r+="if ("+mw(d(t),e)+"){,$",r+="return ("+mw(Jf(t),e)+");,$",r+="}",n++,t=Xf(t)}return r+="})()",r}(t,n),e}if(tr.printMode===je){let e="";return e+=function(t,e){let r="\\left\\{ \\begin{array}{ll}";for(t=m(t);h(t);){if(l===m(t)){r+="{",r+=mw(d(t),e),r+="} & otherwise ",r+=" \\\\\\\\";break}r+="{",r+=mw(Jf(t),e),r+="} & if & ",r+=mw(d(t),e),r+=" \\\\\\\\",t=Xf(t)}return r=r.substring(0,r.length-4),r+"\\end{array} \\right."}(t,n),e}}else if(d(t).equals(ns)){if(tr.codeGen){let e="";return e+="(("+mw(Jf(t),n)+") < ("+mw(th(t),n)+"))",e}if(tr.printMode===je){let e="";return e+=function(t,e){let r="{";return r+=mw(Jf(t),e),r+="}",r+=" < ",r+="{",r+=mw(th(t),e),r+"}"}(t,n),e}}else if(d(t).equals(rs)){if(tr.codeGen){let e="";return e+="(("+mw(Jf(t),n)+") <= ("+mw(th(t),n)+"))",e}if(tr.printMode===je){let e="";return e+=function(t,e){let r="{";return r+=mw(Jf(t),e),r+="}",r+=" \\leq ",r+="{",r+=mw(th(t),e),r+"}"}(t,n),e}}else if(d(t).equals(es)){if(tr.codeGen){let e="";return e+="(("+mw(Jf(t),n)+") > ("+mw(th(t),n)+"))",e}if(tr.printMode===je){let e="";return e+=function(t,e){let r="{";return r+=mw(Jf(t),e),r+="}",r+=" > ",r+="{",r+=mw(th(t),e),r+"}"}(t,n),e}}else if(d(t).equals(ts)){if(tr.codeGen){let e="";return e+="(("+mw(Jf(t),n)+") >= ("+mw(th(t),n)+"))",e}if(tr.printMode===je){let e="";return e+=function(t,e){let r="{";return r+=mw(Jf(t),e),r+="}",r+=" \\geq ",r+="{",r+=mw(th(t),e),r+"}"}(t,n),e}}else if(h(t)&&t.opr.equals(cw)){if(tr.codeGen){let e="";return e+="(("+mw(Jf(t),n)+") === ("+mw(th(t),n)+"))",e}if(tr.printMode===je){let e="";return e+=function(t,e){let r="{";return r+=mw(t.lhs,e),r+="}",r+=" = ",r+="{",r+=mw(t.rhs,e),r+"}"}(t,n),e}}else if(d(t).equals(rn)){if(tr.codeGen){let e="";return e+="Math.floor("+mw(Jf(t),n)+"),$",e}if(tr.printMode===je){let e="";return e+=" \\lfloor {"+mw(Jf(t),n)+"} \\rfloor ,$",e}}else if(d(t).equals(vr)){if(tr.codeGen){let e="";return e+="Math.ceiling("+mw(Jf(t),n)+"),$",e}if(tr.printMode===je){let e="";return e+=" \\lceil {"+mw(Jf(t),n)+"} \\rceil ,$",e}}else if(d(t).equals(Un)){if(tr.codeGen){let e="";return e+="Math.round("+mw(Jf(t),n)+"),$",e}}else if(d(t).equals(Bn)){if(tr.codeGen){let e="";return e+=function(t,e){let r="";return r+=mw(Jf(t),e),r+=" = ",r+=mw(th(t),e),r+="; ",r}(t,n),e}{let e="";return e+=mw(Jf(t),n),e+="=",e+=mw(th(t),n),e}}}}return function(t,e,r){if(h(t)){let n="";if(n+=$w(t.car,!1,!1,r),t=t.cdr,l===t)return n;if(e||(n+="("),h(t))for(n+=mw(d(t),r),t=m(t);h(t);)n+=",",n+=mw(d(t),r),t=m(t);return e||(n+=")"),n}if(Me(t)){let e="";return e+=t.toString(),e}if(fg(t)){let e="";return e+=t.toString(),e}if(Qm.equals(t))return"d";if(jf(t))return tr.codeGen?"Math.E":tr.printMode===je?"e":r.getSymbolPrintName(ow);if(oh(t))return tr.printMode===je?"\\pi":r.getSymbolPrintName(uw);if(ie(t))return tr.printMode===Je?r.toInfixString(t):tr.printMode===je?r.toLatexString(t):t.text;if(ct(t))return t.printname;if(p(t))return r.getSymbolPrintName(Q(F.NIL));if(js(t))return iw;if(ht(t))return tr.printMode===je?"i":r.getSymbolPrintName(aw);throw new Error(`${t} ???`)}(t,s,n)}function Lw(){return tr.printMode===je?"":tr.printMode!==Xe||tr.testFlag||tr.codeGen?"*":" "}function kw(t,e){if(h(t)&&Df(t)){const e=t.cdr;if(h(e)){if(!jf(e.car)){const t=e.cdr;if(h(t)){return qd(t.car)}}}}return!1}function Rw(t,e){const r=tr.codeGen,n=tr.printMode;tr.codeGen=!1,tr.setPrintMode(Je);try{let r=mw(t,e);return r=r.replace(/_/g,"\\_"),r}finally{tr.codeGen=r,tr.setPrintMode(n)}}function Iw(t,e){const r=tr.codeGen,n=tr.printMode;tr.codeGen=!1,tr.setPrintMode(je);try{let r=mw(t,e);return r=r.replace(/_/g,"\\_"),r}finally{tr.codeGen=r,tr.setPrintMode(n)}}class Pw{constructor(t,e){this.name=t,this.$=e}compareFactors(t,e){throw new Error("Abtract Operator Method not implemented.")}compareTerms(t,e){throw new Error("Abtract Operator Method not implemented.")}subst(t,e,r){const n=this.$;if(n.equals(t,e))return r;if(h(t)){const s=Od(t,0),i=Ip(s,e,r,n);if(n.equals(i,s)){const i=Od(t,1),o=Od(t,2),a=Ip(i,e,r,n),u=Ip(o,e,r,n);return n.equals(i,a)&&n.equals(o,u)?t:c(s,a,u)}{const s=Od(t,1),o=Od(t,2);return c(i,Ip(s,e,r,n),Ip(o,e,r,n))}}if(ie(t))return ie(e)&&t.equalsSym(e)?r:t;throw new Ai}toInfixString(t){return Rw(t,this.$)}toLatexString(t){return Iw(t,this.$)}toListString(t){return sw(t,this.$)}valueOf(t){throw new Error(`AbstractOperator.valueOf ${t} method not implemented.`)}}class Fw extends Pw{constructor(t,e,r){super(t,r),this.opr=e,this.key=`(${e.key()})`}evaluate(t){const e=u(this.opr,t);return this.transform(e,this.$)}transform(t,e){throw new Error(`FunctionVarArgs.transform must be implemented in ${this.name}`)}isKind(t){return t.opr.equals(this.opr)}isImag(t){return!1}isMinusOne(t){return!1}isOne(t){return!1}isReal(t){return!1}isScalar(t){return!1}isZero(t){return!1}}class Uw extends Fw{constructor(t,e,r,n){super(t,e,n),this.guard=r}isKind(t){return!!this.match(t)}match(t){if(h(t)&&2===t.length){const e=t.opr,r=t.item(1);return ie(e)&&this.opr.equalsSym(e)&&this.guard(r)?t:void 0}}transform(t){const e=this.match(t);if(e){const t=this.$,r=t.valueOf(e.arg);return r.equals(e.arg)?this.transform1(e.opr,e.arg,e):[q,t.valueOf(c(e.opr,r))]}return[T,t]}}class Cw extends Uw{constructor(t,e,r){super(`${t}∘${e}`,t,h,r),this.innerOpr=e,this.hash=gi(this.opr,li)}isKind(t){if(super.isKind(t)){const e=t.arg;return!!h(e)&&e.opr.equals(this.innerOpr)}return!1}}const Dw=Q(F.abs),Bw=Q(F.add);let Kw=class extends Cw{constructor(t){super(Dw,Bw,t)}isKind(t){if(super.isKind(t)){return t.argList.head.tail().some(Ph)}return!1}transform1(t,e,r){const n=this.$,s=n.valueOf(Pm(n.power(n.inner(e,e),Xt),n));return[q,s]}};const zw=new class{create(t){return new Kw(t)}};function Qw(t){if(void 0===t)throw new Error;return!0}function Zw(t,e){return[t.equals(e)?T:q,t]}const Gw=Q(F.abs);let Hw=class extends Uw{constructor(t){super("abs_any",Gw,Qw,t),this.phases=L}isKind(t){if(super.isKind(t)){const e=t.arg;return!!ie(e)||!f(e)}return!1}transform1(t,e,r){return Zw(zm(e,this.$),r)}};const Vw=new class{create(t){return new Hw(t)}},jw=B("sqrt");let Ww=class extends Uw{constructor(t,e,r,n){super(`${t.text}_${r}`,t,e,n),this.hash=gi(this.opr,r)}};class Jw extends Ww{constructor(t,e){super(t,Z,Ys,e)}}let Xw=class extends Jw{constructor(t){super(Q(F.abs),t)}transform1(t,e,r){const n=this.$,s=e.__vbar__(e);return Zw(n.valueOf(c(jw,n.valueOf(s))),r)}};const Yw=new class{create(t){return new Xw(t)}};let t_=class extends Uw{constructor(t){super("abs_rat",Q(F.abs),ot,t),this.hash=gi(this.opr,ri)}transform1(t,e,r){return Zw(e.abs(),r)}};const e_=new class{create(t){return new t_(t)}};let r_=class extends Uw{constructor(t){super("abs_imu",Q(F.abs),ht,t),this.hash=gi(this.opr,si)}transform1(t,e,r){return Zw(Ut,r)}};const n_=new class{create(t){return new r_(t)}},s_=Q(F.pow),i_=Q(F.abs);let o_=class extends Cw{constructor(t){super(i_,s_,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head.rhs;return te(e)&&e.isMinusOne()}return!1}transform1(t,e,r){const n=this.$,s=e.lhs,i=n.valueOf(c(t,s)),o=n.valueOf(c(e.opr,i,jt));return[q,o]}};const a_=new class{create(t){return new o_(t)}};let u_=class extends Uw{constructor(t){super("abs_rat",Q(F.abs),te,t),this.hash=gi(this.opr,ii)}transform1(t,e,r){return Zw(e.abs(),r)}};const c_=new class{create(t){return new u_(t)}};class l_ extends Uw{constructor(t,e){super(`${t.text}_${ui}`,t,v,e),this.hash=gi(this.opr,ui)}}let f_=class extends l_{constructor(t){super(Q(F.abs),t)}transform1(t,e,r){return Zw(function(t,e){if(1!==t.ndim)throw new Error("abs(tensor) with tensor rank > 1");const r=Pm(t,e);return e.valueOf(Pm(e.power(e.inner(r,Cp(r,e)),Xt),e))}(e,this.$),r)}};const h_=new class{create(t){return new f_(t)}};class p_ extends Uw{constructor(t,e,r,n){super(`${t.text}_${ci}`,t,e,n),this.hash=gi(this.opr,ci)}}class d_ extends p_{constructor(t,e){super(t,Me,ci,e)}}let m_=class extends d_{constructor(t){super(Q(F.abs),t)}transform1(t,e,r){return Zw(e,r)}};const g_=new class{create(t){return new m_(t)}};function w_(t,e,r,n,s){if(t.equals(e)){const e=s.valueOf(c(ke,t,r)),n=s.valueOf(c(ke,Ct,e));return[q,n]}if(ee(t)&&ee(e)){const n=s.valueOf(c(ke,Ld(t,e),r));return[q,n]}if(h(t)&&Rp(t)){if(ee(t.lhs)&&t.rhs.equals(e)){const n=s.valueOf(c(ke,Ld(t.lhs,Ut),e)),i=s.valueOf(c(ke,n,r));return[q,i]}if(h(e)&&Rp(e)&&t.rhs.equals(e.rhs))return w_(t.lhs,e.lhs,s.valueOf(c(ke,t.rhs,r)),n,s);if(t.rhs.equals(e)){const n=c($e,t.lhs,Ut),s=c(ke,n,e),i=c(ke,s,r);return[q,i]}}if(h(e)&&Rp(e)&&ee(e.lhs)&&e.rhs.equals(t)){const n=s.valueOf(c(ke,Ld(e.lhs,Ut),t)),i=s.valueOf(c(ke,n,r));return[q,i]}return[T,n]}function __(t,e){if(t.equals(e))return!0;if(ee(t)&&ee(e))return!0;if(h(t)&&Rp(t)){if(ee(t.lhs)&&t.rhs.equals(e))return!0;if(h(e)&&Rp(e)&&t.rhs.equals(e.rhs))return __(t.lhs,e.lhs);if(t.rhs.equals(e))return!0}return!!(h(e)&&Rp(e)&&ee(e.lhs)&&e.rhs.equals(t))}function x_(t,e){return function(r){return t(r)&&e(r)}}class y_ extends Fw{constructor(t,e,r,n,s){super(t,e,s),this.guardL=r,this.guardR=n}isKind(t){return!!this.match(t)}match(t){try{if(h(t)&&3===t.length){const e=t.opr,r=t.item(1),n=t.item(2);return ie(e)&&this.opr.equalsSym(e)&&this.guardL(r)&&this.guardR(n)?t:void 0}return}catch(t){throw new Error(`${this.name} + ${t}`)}}transform(t){const e=this.match(t);if(e){const t=this.$,[r,n]=t.transform(e.lhs),[s,i]=t.transform(e.rhs);return N(r)||N(s)?[q,t.valueOf(c(e.opr,n,i))]:this.transform2(e.opr,e.lhs,e.rhs,e)}return[T,t]}}class v_ extends y_{constructor(t,e,r,n,s,i){super(t,e,r,n,i),this.cross=s,this.$=i}match(t){const e=super.match(t);if(e&&this.cross(e.lhs,e.rhs,e))return e}transform(t){const e=this.match(t);if(e){const t=this.$,[r,n]=t.transform(e.lhs),[s,i]=t.transform(e.rhs);return N(r)||N(s)?[q,t.valueOf(c(e.opr,n,i))]:this.transform2(e.opr,e.lhs,e.rhs,e)}return[T,t]}}function b_(t){return kp($e)(t)}let O_=class extends v_{constructor(t){super("add_2_add_2_any_any_any_factorize_rhs",$e,x_(h,b_),Qw,(function(t,e){return __(t.rhs,e)}),t),this.hash=di($e,$e,li)}transform2(t,e,r,n){const s=this.$;if(s.isExpanding()){const t=e.lhs,i=w_(e.rhs,r,Ut,n,s)[1];return[q,s.valueOf(c($e,t,i))]}return[T,n]}};const E_=new class{create(t){return new O_(t)}};function S_(t){return Rp(t)&&te(t.lhs)&&ie(t.rhs)}function T_(t){if(b_(t)){const e=t.lhs,r=t.rhs;return Qw(e)&&ie(r)}return!1}function q_(t,e){switch(t.rhs.compare(e.rhs)){case S:case E:return!0;default:return!1}}let A_=class extends v_{constructor(t){super("add_2_add_2_any_mul_2_rat_sym",$e,x_(h,T_),x_(h,S_),q_,t),this.hash=mi($e,$e,ke)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.rhs,a=r.lhs;if(i.compare(o)===S){const t=n.valueOf(Nd($e,n.valueOf(Nd($e,s,r)),i));return[q,t]}{const t=n.valueOf(Nd($e,s,n.valueOf(Nd(ke,a.succ(),i))));return[q,t]}}};const M_=new class{create(t){return new A_(t)}};let N_=class extends v_{constructor(t){super("add_2_any_any_factorize_rhs",$e,Qw,Qw,function(t){return function(e,r){return!!t.isFactoring()&&__(e,r)}}(t),t),this.hash=hi($e,li,li)}transform2(t,e,r,n){const s=this.$;return w_(e,r,Ut,n,s)}};const $_=new class{create(t){return new N_(t)}};function L_(t,e,r){if(ee(t)&&ee(e))return function(t,e){return Ld(t,e).isZero()}(t,e);if(h(t)&&Rp(t)){const n=t.lhs,s=t.rhs,i=e;if(s.equals(i))return r.isMinusOne(n)||r.is_zero(s);if(h(e)&&Rp(e)){const t=e.lhs,i=e.rhs;if(s.equals(i))return L_(n,t,r)||r.is_zero(s)}}if(h(e)&&Rp(e)){const n=t,s=e.lhs;if(e.rhs.equals(n))return r.isMinusOne(s)||r.is_zero(n)}return!1}let k_=class extends v_{constructor(t){super("add_2_any_any_zero_sum",$e,Qw,Qw,function(t){return function(e,r){return L_(e,r,t)}}(t),t),this.hash=hi($e,li,li)}transform2(t,e,r,n){return[q,Jt]}};const R_=new class{create(t){return new k_(t)}};function I_(t,e,r){if(Z(t)&&Z(e))return ph(t,e);throw new Error}function P_(t,e){return!0}let F_=class extends v_{constructor(t,e){super("add_2_blade_blade",$e,Z,Z,P_,t),this.comparator=e,this.hash=hi($e,Ys,Ys)}transform2(t,e,r,n){const s=this.$;switch(this.comparator(e,r,s)){case S:return[q,c(t,r,e)];case E:return[q,c(ke,Ct,e)];default:return[A,n]}}};const U_=new class{create(t,e){return e.noOptimize?new F_(t,Dh):new F_(t,I_)}};function C_(t){return Rp(t)&&te(t.lhs)&&Z(t.rhs)}let D_=class extends y_{constructor(t,e){super("add_2_blade_mul_2_rat_blade",$e,Z,x_(h,C_),t),this.config=e,this.hash=pi($e,Ys,ke)}transform2(t,e,r,n){const s=this.$;if(this.config.noOptimize)return[T,n];if(!s.isExpanding())return[T,n];switch(ph(e,r.rhs)){case S:return[q,c(t,r,e)];case E:{const t=r.lhs.succ();return t.isZero()?[q,Jt]:t.isOne()?[q,e]:[q,c(r.opr,t,e)]}default:return[A,n]}}};const B_=new class{create(t,e){return new D_(t,e)}};let K_=class extends y_{constructor(t){super("add_2_flt_any",$e,ot,Qw,t),this.dependencies=["Flt"],this.hash=hi($e,ri,li)}transform2(t,e,r,n){const s=this.$,i=uh(r,s);if(e.isZero())return[q,i];if(i.equals(r))return[T,n];return Zw(s.add(e,i),n)}};const z_=new class{create(t){return new K_(t)}};let Q_=class extends y_{constructor(t){super("add_2_flt_flt",$e,ot,ot,t),this.dependencies=["Flt"],this.hash=hi($e,ri,ri)}transform2(t,e,r,n){return[q,n.lhs.add(n.rhs)]}};const Z_=new class{create(t){return new Q_(t)}};let G_=class extends y_{constructor(t){super("add_2_flt_rat",$e,ot,te,t),this.dependencies=["Flt"],this.hash=hi($e,ri,ii)}transform2(t,e,r){const n=e.toNumber(),s=r.toNumber();return[q,J(n+s)]}};const H_=new class{create(t){return new G_(t)}};function V_(t){return t instanceof Ae}class j_{constructor(t){}get key(){return Ae.ONE.name}get hash(){return ci}get name(){return"UomExtension"}get dependencies(){return["Uom"]}valueOf(t,e){throw new Error("Method not implemented.")}isImag(t){return!1}isKind(t){return V_(t)}isMinusOne(t){return!1}isOne(t){return t.isOne()}isReal(t){return!1}isScalar(t){return!0}isZero(){return!1}subst(t,e,r){return V_(e)&&t.equals(e)?r:t}toInfixString(t){return t.toInfixString()}toLatexString(t){return t.toInfixString()}toListString(t){return t.toListString()}evaluate(t,e){return this.transform(u(t,e))}transform(t){return V_(t)?[A,t]:[T,t]}}const W_=new Oi((function(t){return new j_(t)}));let J_=class extends y_{constructor(t){super("add_2_flt_uom",$e,ot,V_,t),this.dependencies=["Flt","Uom"],this.hash=hi($e,ri,ci)}transform2(t,e,r,n){throw new TypeError(this.$.toInfixString(n))}};const X_=new class{create(t){return new J_(t)}};let Y_=class extends y_{constructor(t){super("add_2_imu_flt",$e,ht,ot,t),this.phases=P,this.dependencies=["Flt","Imu"],this.hash=di($e,Ie,ri)}transform2(t,e,r){return[q,c(t,r,e)]}};const tx=new class{create(t){return new Y_(t)}};function ex(t){return c(t.opr,t.rhs,t.lhs)}function rx(t,e,r){return function(n){return kp(t)(n)&&e(n.lhs)&&r(n.rhs)}}let nx=class extends y_{constructor(t){super("add_2_mul_2_any_imu_sym",$e,x_(h,rx(ke,Qw,ht)),ie,t),this.hash=di($e,ke,ai)}transform2(t,e,r,n){return[q,ex(n)]}};const sx=new class{create(t){return new nx(t)}};function ix(t){return Rp(t)&&te(t.lhs)}function ox(t,e){const r=t.rhs,n=e.rhs;return!!r.equals(n)}let ax=class extends v_{constructor(t){super("add_2_mul_2_rat_X_mul_2_rat_X",$e,x_(h,ix),x_(h,ix),ox,t),this.hash=mi($e,ke,ke)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.lhs,a=s.add(o),u=n.valueOf(c(ke,a,i));return[q,u]}};const ux=new class{create(t){return new ax(t)}};function cx(t,e){return kh(t.rhs,e)>0}let lx=class extends v_{constructor(t){super("add_2_mul_2_rat_zzz_aaa",$e,x_(h,S_),ie,cx,t),this.hash=di($e,ke,ai)}transform2(t,e,r,n){return[q,ex(n)]}};const fx=new class{create(t){return new lx(t)}};let hx=class extends y_{constructor(t){super("add_2_pow_2_any_any_mul_2_any_any",$e,x_(h,Am),x_(h,Rp),t),this.hash=mi($e,Ie,ke)}transform2(t,e,r,n){return[T,n]}};const px=new class{create(t){return new hx(t)}};let dx=class extends y_{constructor(t){super("add_2_rat_blade",$e,te,Z,t),this.hash=hi($e,ii,Ys)}transform2(t,e,r,n){return e.isZero()?[q,r]:[A,n]}};const mx=new class{create(t){return new dx(t)}};let gx=class extends y_{constructor(t){super("add_rat_flt",$e,te,ot,t),this.dependencies=["Flt"],this.hash=hi($e,ii,ri)}transform2(t,e,r){const n=e.toNumber(),s=r.toNumber();return[q,J(n+s)]}};const wx=new class{create(t){return new gx(t)}};let _x=class extends y_{constructor(t){super("add_2_rat_rat",$e,te,te,t),this.hash=hi($e,ii,ii)}transform2(t,e,r){return[q,e.add(r)]}};const xx=new class{create(t){return new _x(t)}};let yx=class extends y_{constructor(t){super("add_2_rat_sym",$e,te,ie,t),this.hash=hi($e,ii,ai)}isScalar(t){const e=t.lhs,r=t.rhs;return this.$.isScalar(e)&&this.$.isScalar(r)}isReal(t){const e=t.lhs,r=t.rhs;return this.$.is_real(e)&&this.$.is_real(r)}transform2(t,e,r,n){return e.isZero()?[q,r]:[A,n]}};const vx=new class{create(t){return new yx(t)}};let bx=class extends y_{constructor(t){super("add_2_rat_uom",$e,te,V_,t),this.hash=hi($e,ii,ci)}transform2(t,e,r,n){throw new TypeError(this.$.toInfixString(n))}};const Ox=new class{create(t){return new bx(t)}};let Ex=class extends y_{constructor(t){super("add_2_sym_rat",$e,ie,te,t),this.hash=hi($e,ai,ii)}transform2(t,e,r){if(r.isZero())return[q,e];{const n=this.$;return[q,n.valueOf(c(t,r,e))]}}};const Sx=new class{create(t){return new Ex(t)}};let Tx=class extends y_{constructor(t){super("add_2_sym_sym",$e,ie,ie,t),this.hash=hi($e,ai,ai)}transform2(t,e,r,n){switch(kh(e,r)){case S:return[q,c(t,r,e)];case O:return[A,n];default:return e.equals(r)?[q,c(ke.clone(t.pos,t.end),Ct,e)]:[A,n]}}};const qx=new class{create(t){return new Tx(t)}};function Ax(t,e){return"-"===gw(t)?`-${_w(t,e)}`:_w(t,e)}function Mx(t,e,r){return t.sameDimensions(e)?t.map((function(t,n){return r.add(t,e.elem(n))})):l}class Nx{constructor(t){this.$=t}get key(){return ui}get hash(){return ui}get name(){return"TensorExtension"}isImag(t){return!1}isKind(t){return t instanceof y}isMinusOne(t){return!1}isOne(t){return!1}isReal(t){return!1}isScalar(){return!1}isZero(t,e){return t.everyElement((function(t){return e.is_zero(t)}))}subst(t,e,r,n){if(v(e)&&t.equals(e))return r;const s=t.mapElements((t=>Ip(t,e,r,n)));return function(t,e,r){const n=t.length;for(let s=0;s<n;s++)if(!r.equals(t[s],e[s]))return!1;return!0}(t.copyElements(),s,n)?t:t.withElements(s)}toInfixString(t,e){return Ax(t,e)}toLatexString(t,e){return Ax(t,e)}toListString(t,e){return Ax(t,e)}evaluate(t,e){return this.transform(u(t,e))}transform(t){const e=this.$;if(this.isKind(t)){const r=t.mapElements((function(t){return e.valueOf(t)})),n=t.withElements(r);return[!n.equals(t)?q:T,n]}return[T,t]}valueOf(t,e){const r=t.mapElements((function(t){return e.valueOf(t)}));return t.withElements(r)}}const $x=new Oi((function(t){return new Nx(t)}));let Lx=class extends y_{constructor(t){super("add_2_tensor_tensor",$e,v,v,t),this.hash=hi($e,ui,ui)}transform2(t,e,r){const n=this.$;return[q,Mx(e,r,n)]}};const kx=new class{create(t){return new Lx(t)}};let Rx=class extends y_{constructor(t){super("add_2_uom_flt",$e,V_,ot,t),this.dependencies=["Flt","Uom"],this.hash=hi($e,ci,ri)}transform2(t,e,r,n){throw new TypeError(this.$.toInfixString(n))}};const Ix=new class{create(t){return new Rx(t)}};let Px=class extends y_{constructor(t){super("add_2_uom_rat",$e,V_,te,t),this.dependencies=["Uom"],this.hash=hi($e,ci,ii)}transform2(t,e,r,n){throw new TypeError(this.$.toInfixString(n))}};const Fx=new class{create(t){return new Px(t)}};function Ux(t,e){return e.lhs.isMinusOne()&&t.equalsSym(e.rhs)}let Cx=class extends v_{constructor(t){super("add_2_xxx_mul_2_rm1_xxx",$e,ie,x_(h,S_),Ux,t),this.hash=pi($e,ai,ke)}transform2(t,e,r,n){return[q,Jt]}};const Dx=new class{create(t){return new Cx(t)}};function Bx(t,e){const r=[],n=t.argList,s=n.map(e.valueOf);if(s.equals(n)){const t=[...s],n=t.some((t=>ot(t)&&t.isZero()));for(const s of t)Kx(r,n?uh(s,e):e.valueOf(s));return function(t,e){t.forEach((function(t){}));const r=e.compareFn($e);for(let n=0;n<10&&!(t.length<2);n++){let n=0;const s=function(t,e){if(ee(t)&&ee(e))return n=1,E;const s=vh(t),i=vh(e);if(v(s)&&v(i)){if(s.ndim<i.ndim)return O;if(s.ndim>i.ndim)return S;const t=s.ndim;for(let e=0;e<t;e++){if(s.dim(e)<i.dim(e))return O;if(s.dim(e)>i.dim(e))return S}return n=1,E}if(Ph(s)&&Ph(i)){switch(ph(Uh(s),Uh(i))){case O:return O;case S:return S;default:switch(r(bh(s,Z),bh(i,Z))){case O:return O;case S:return S;case E:return n=1,E}}}const o=r(s,i);return o===E&&(n=1),o};if(t.sort(s),0===n)break;zx(t,e)}switch(t.length){case 0:return Jt;case 1:return t[0];default:return t.unshift($e),c(...t)}}(r,e)}return e.valueOf(u(t.car,s))}function Kx(t,e){Uf(e)?t.push(...e.tail()):ee(e)&&e.isZero()||t.push(e)}function zx(t,e){let r=0;for(;r<t.length-1;){let n=t[r],s=t[r+1];if(v(n)&&v(s)){const i=Mx(n,s,e);p(i)||(t.splice(r,2,i),r--),r++;continue}if(v(n)||v(s)){r++;continue}if(ee(n)&&ee(s)){const i=Ld(n,s);Qx(i,e)?2===t.length?t.splice(r,2,i):t.splice(r,2):t.splice(r,2,i),r--,r++;continue}if(ee(n)||ee(s)){r++;continue}let i=Ut,o=Ut,a=0;if(Cf(n)&&(n=m(n),a=1,ee(d(n))&&(i=d(n),n=m(n),p(m(n))&&(n=d(n),a=0))),Cf(s)&&(s=m(s),ee(d(s))&&(o=d(s),s=m(s),p(m(s))&&(s=d(s)))),!n.equals(s)){r++;continue}if(i=Ld(i,o),Qx(i,e)){t.splice(r,2),r--,r++;continue}const c=a?u(ke,n):n;t.splice(r,2,e.multiply(i,c)),r--,r++}}function Qx(t,e){return function(t){return ee(t)&&t.isZero()}(t)||function(t,e){return v(t)&&e.is_zero(t)}(t,e)}class Zx extends Fw{constructor(t){super("add_varargs",ur,t),this.hash=_i(this.opr)}transform(t){const e=Bx(t,this.$);return[e.equals(t)?T:q,((t,e)=>e)(0,e)]}}const Gx=new class{create(t){return new Zx(t)}};function Hx(t,e){if(!py(t))return Nd(Fr,t);const r=t.copyElements();return r.every((t=>ee(t)))?function(t,e){const r=t.dim(0),n=function(t,e,r){let n=Ut;for(let s=0;s<e-1;s++){if(r.equals(jx(t,e,s,s),Jt)){let i=0;for(i=s+1;i<e&&r.equals(jx(t,e,i,s),Jt);i++);if(i===e){n=Jt;break}for(let r=s;r<e;r++){const n=jx(t,e,s,r);Wx(t,e,s,r,jx(t,e,i,r)),Wx(t,e,i,r,n)}n=r.negate(n)}n=r.multiply(n,jx(t,e,s,s));for(let n=s+1;n<e;n++){const i=r.negate(Mp(jx(t,e,n,s),jx(t,e,s,s),r));Wx(t,e,n,s,Jt);for(let o=s+1;o<e;o++){Wx(t,e,n,o,r.add(r.multiply(jx(t,e,s,o),i),jx(t,e,n,o)))}}}return r.multiply(n,jx(t,e,e-1,e-1))}(t.copyElements(),r,e);return n}(t,e):Vx(r,t.dim(0),e)}function Vx(t,e,r){if(0===e)return Ut;let n=0;const s=[];for(let t=0;t<e;t++)s[t]=t,s[t+e]=0,s[t+e+e]=1;let i=1,o=Jt;for(;;){let a=Ft(i);for(let n=0;n<e;n++){const i=e*s[n]+n;a=r.multiply(a,t[i])}o=r.add(o,a);let u=e-1,c=0,l=!1;for(;;)if(n=s[e+u]+s[e+e+u],n<0)s[e+e+u]=-s[e+e+u],u--;else{if(n!==u+1)break;if(0===u){l=!0;break}c++,s[e+e+u]=-s[e+e+u],u--}if(l)break;const f=s[u-s[e+u]+c];s[u-s[e+u]+c]=s[u-n+c],s[u-n+c]=f,s[e+u]=n,i=1===i?-1:1}return o}function jx(t,e,r,n){return t[e*r+n]}function Wx(t,e,r,n,s){t[e*r+n]=s}function Jx(t,e){if(h(t)&&Zf(t))return t.argList;if(Hf(t))return t;if(e.isExpanding()&&zf(t)){const r=(h(t)?t.tail():[]).map((function(t){return Jx(t,e)}));for(let t=r.length-1;t>0;t--)r[t-1]=e.inner(r[t],r[t-1]);return r[0]}if(!py(t))return c(pn,t);if(Gf(t))return function(t,e){const r=t.dim(0),n=new Array(r*r);n.fill(Jt);for(let t=0;t<r;t++)n[t*r+t]=Ut;const s=function(t,e,r,n){for(let s=0;s<r;s++){if(n.equals(e[r*s+s],Jt)){let i=0;for(i=s+1;i<r&&n.equals(e[r*i+s],Jt);i++);i===r&&er("inverse of singular matrix");for(let n=0;n<r;n++){let o=e[r*s+n];e[r*s+n]=e[r*i+n],e[r*i+n]=o,o=t[r*s+n],t[r*s+n]=t[r*i+n],t[r*i+n]=o}}const i=e[r*s+s];for(let o=0;o<r;o++)o>s&&(e[r*s+o]=Mp(e[r*s+o],i,n)),t[r*s+o]=Mp(t[r*s+o],i,n);for(let i=0;i<r;i++){if(i===s)continue;const o=e[r*i+s];for(let a=0;a<r;a++)a>s&&(e[r*i+a]=n.subtract(e[r*i+a],n.multiply(e[r*s+a],o))),t[r*i+a]=n.subtract(t[r*i+a],n.multiply(t[r*s+a],o))}}return t}(n,t.copyElements(),r,e);return new y([r,r],s)}(t,e);const r=Hx(t,e);return e.is_zero(r)&&er("inverse of singular matrix"),Mp(wy(t,e),r,e)}function Xx(t,e){return ot(t)||te(t)?e.is_zero(t)?Ut:Jt:Df(t)?c(Cr,Jf(t)):qd(t)?c(Cr,e.negate(t)):((qd(t)||h(t)&&Uf(t)&&qd(Jf(t)))&&(t=e.negate(t)),c(Cr,t))}function Yx(t,e,r){return function(t,e,r){const n=vf(e);if(ot(t)&&!isNaN(n)){return J(function(t,e){throw new Error("Not implemented")}(0,t.d))}if(r.is_zero(t)&&r.is_zero(e))return Ut;if(r.is_zero(t)&&!isNaN(n))return Jt;if(te(e)&&Zs(e.b,2)){if(Zs(e.a,1)){const e=r.getNativeDirective($.evaluatingAsFloat)?J(2/Math.PI):Mp(Ct,Os,r);return r.multiply(r.power(Mp(e,t,r),Xt),Lm(t,r))}if(Zs(e.a,-1)){const e=r.getNativeDirective($.evaluatingAsFloat)?J(2/Math.PI):Mp(Ct,Os,r);return r.multiply(r.power(Mp(e,t,r),Xt),Nm(t,r))}const n=Ft(Qs(e.a));return r.subtract(r.multiply(r.multiply(Mp(Ct,t,r),e.sub(n)),Yx(t,r.subtract(e,n),r)),Yx(t,r.subtract(e,Ct.mul(n)),r))}if(qd(t))return r.multiply(r.multiply(r.power(r.negate(t),e),r.power(t,r.negate(e))),Nd(_r,r.negate(t),e));if(qd(e))return r.multiply(r.power(jt,e),Nd(_r,t,r.negate(e)));return Nd(_r,t,e)}(t,e,r)}function ty(t,e,r){return function(t,e,r){const n=vf(e);if(ot(t)&&!isNaN(n)){return J(function(t,e){throw new Error("Not implemented")}(0,t.d))}if(qd(e))return r.multiply(r.power(jt,e),Nd(xr,t,r.negate(e)));return Nd(xr,t,e)}(t,e,r)}function ey(t,e){if(d(t).equals(pr))return Jf(t);if(ot(t)){let e=Math.cosh(t.d);return Math.abs(e)<1e-10&&(e=0),J(e)}return e.is_zero(t)?Ut:c(kr,t)}function ry(t,e,r){return function(t,e,r){const n=vf(e);if(n<0||isNaN(n))return Nd(un,t,e);if(ie(t))return ny(n,t,r);return r.valueOf(Ip(ny(n,bs,r),bs,t,r))}(t,e,r)}function ny(t,e,r){let n=Jt,s=Ut;for(let i=0;i<t;i++){const t=n;n=s,s=r.multiply(r.subtract(r.multiply(e,n),r.multiply(Ft(i),t)),Ct)}return s}let sy=class extends Uw{constructor(t){super("sgn_any",Kn,Qw,t),this.hash=gi(this.opr,li)}isKind(t){return!!super.isKind(t)&&!ot(t)}transform1(t,e){return[q,oy(e,this.$)]}};const iy=new class{create(t){return new sy(t)}};function oy(t,e){return Mp(t,zm(t,e),e)}function ay(t,e){if(d(t).equals(mr))return Jf(t);if(ot(t)){let e=Math.sinh(t.d);return Math.abs(e)<1e-10&&(e=0),J(e)}return e.is_zero(t)?Jt:Nd(Zn,t)}function uy(t,e){if(jf(t))return Ut;if(te(t)&&t.isOne())return Jt;if(ot(t)&&t.isOne())return Y;if(Wh(t)){const r=uy(e.negate(t),e),n=e.multiply(ft,ar.Pi(e));return e.add(r,n)}return ot(t)?J(Math.log(t.d)):te(t)&&t.isFraction()?e.subtract(uy(Sm(t,e),e),uy(dm(t,e),e)):Df(t)?e.multiply(th(t),uy(Jf(t),e)):Cf(t)?t.tail().map((function(t){return uy(t,e)})).reduce((function(t,r){return e.add(t,r)}),Jt):Nd(_n,t)}function cy(t,e,r){const n=Jf(t),s=th(t),i=Mp(s,n,r),o=hy(n,e,r),a=uy(n,r),u=hy(s,e,r);return r.multiply(r.add(r.multiply(i,o),r.multiply(a,u)),t)}function ly(t,e,r){const n=jh(t)-1,s=[];for(let i=0;i<n;i++){const o=[];let a=m(t);for(let t=0;t<n;t++){const n=d(a);i===t?o.push(hy(n,e,r)):o.push(n),a=m(a)}s.push(Dd(o,r))}return Pd(s,r)}function fy(t,e,r){if(ie(e))return function(t,e,r){if(t.equals(e))return Ut;if(ie(t))return t.equals(Ke)||t.equals(ze)?Jt:c(Qm,t,e);if(!h(t))return Jt;if(Ff(t))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(n,oy(Jf(t),r))}(t,e,r);if(Uf(t))return function(t,e,r){const n=h(t)?t.tail().map((t=>hy(t,e,r))):[];return Pd(n,r)}(t,e,r);const n=d(t);if(n.equals(xn))return ly(t,e,r);if(n.equals(An))return cy(t,e,r);if(n.equals(Qm))return function(t,e,r){const n=hy(Jf(t),e,r);if(d(n).equals(Qm)){const e=th(n),s=th(t),i=Jf(n);return r.compareFn($e)(e,s)<0?c(Qm,c(Qm,i,e),s):c(Qm,c(Qm,i,s),e)}return hy(n,th(t),r)}(t,e,r);if(n.equals(_n))return function(t,e,r){const n=hy(Jf(t),e,r);return Mp(n,Jf(t),r)}(t,e,r);if(n.equals(Qn))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(n,Nm(Jf(t),r))}(t,e,r);if(n.equals(Lr))return function(t,e,r){const n=hy(Jf(t),e,r);return r.negate(r.multiply(n,Lm(Jf(t),r)))}(t,e,r);if(n.equals(Wn))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(n,r.power(Nm(Jf(t),r),Ft(-2)))}(t,e,r);if(n.equals(dr))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(n,r.power(r.subtract(Ut,r.power(Jf(t),Ct)),Lf(-1,2)))}(t,e,r);if(n.equals(hr))return function(t,e,r){const n=hy(Jf(t),e,r);return r.negate(r.multiply(n,r.power(r.subtract(Ut,r.power(Jf(t),Ct)),Lf(-1,2))))}(t,e,r);if(n.equals(gr))return function(t,e,r){const n=hy(Jf(t),e,r),s=Ap(r.add(Ut,r.power(Jf(t),Ct)),r);return Pm(r.multiply(n,s),r)}(t,e,r);if(n.equals(Zn))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(n,ey(Jf(t),r))}(t,e,r);if(n.equals(kr))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(n,ay(Jf(t),r))}(t,e,r);if(n.equals(Jn))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(n,r.power(ey(Jf(t),r),Ft(-2)))}(t,e,r);if(n.equals(mr))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(n,r.power(r.add(r.power(Jf(t),Ct),Ut),Lf(-1,2)))}(t,e,r);if(n.equals(pr))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(n,r.power(r.add(r.power(Jf(t),Ct),jt),Lf(-1,2)))}(t,e,r);if(n.equals(wr))return function(t,e,r){const n=hy(Jf(t),e,r),s=Ap(r.subtract(Ut,r.power(Jf(t),Ct)),r);return r.multiply(n,s)}(t,e,r);if(n.equals(Kn))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(r.multiply(n,Xx(Jf(t),r)),Ct)}(t,e,r);if(n.equals(un))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(r.multiply(n,r.multiply(Ct,th(t))),ry(Jf(t),r.add(th(t),jt),r))}(t,e,r);if(n.equals(Gr))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(r.multiply(r.multiply(Sd(r.multiply(r.power(Jf(t),Ct),jt),r),r.power(ar.Pi(r),Lf(-1,2))),Ct),n)}(t,e,r);if(n.equals(Hr))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(r.multiply(r.multiply(Sd(r.multiply(r.power(Jf(t),Ct),jt),r),r.power(ar.Pi(r),Lf(-1,2))),Ft(-2)),n)}(t,e,r);if(n.equals(_r))return function(t,e,r){if(r.is_zero(th(t)))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(r.multiply(n,Yx(Jf(t),Ut,r)),jt)}(t,e,r);return function(t,e,r){const n=hy(Jf(t),e,r),s=r.add(th(t),jt),i=r.multiply(th(t),jt),o=Yx(Jf(t),s,r),a=Mp(i,Jf(t),r),u=Yx(Jf(t),th(t),r),c=r.multiply(a,u),l=r.add(o,c);return r.multiply(n,l)}(t,e,r)}(t,e,r);if(n.equals(xr))return function(t,e,r){if(r.is_zero(th(t)))return function(t,e,r){const n=hy(Jf(t),e,r);return r.multiply(r.multiply(n,Yx(Jf(t),Ut,r)),jt)}(t,e,r);return function(t,e,r){const n=hy(Jf(t),e,r),s=r.add(th(t),jt),i=r.multiply(th(t),jt),o=Mp(i,Jf(t),r),a=ty(Jf(t),th(t),r),u=ty(Jf(t),s,r),c=r.multiply(o,a),l=r.add(u,c);return r.multiply(n,l)}(t,e,r)}(t,e,r);if(d(t).equals(hn)&&th(t).equals(e))return Jf(t);return function(t,e,r){const n=t.argList;return l===n||n.contains(e),c(Qm,t,e)}(t,e)}(t,e,r);const n=Ip(t,e,bs,r);return Ip(hy(n,bs,r),bs,e,r)}function hy(t,e,r){if(ee(e))throw new Ai("undefined function");return v(t)?v(e)?function(t,e,r){if(t.ndim+1>=Cs)return Nd(Qm,t,e);const n=t.copyDimensions();n.push(e.dim(0));const s=t.nelem,i=e.nelem,o=new Array(s*i);for(let n=0;n<s;n++)for(let s=0;s<i;s++)o[n*i+s]=hy(t.elem(n),e.elem(s),r);return new y(n,o)}(t,e,r):function(t,e,r){const n=t.mapElements((t=>hy(t,e,r)));return t.withElements(n)}(t,e,r):v(e)?function(t,e,r){const n=[e.dim(0)],s=e.mapElements((e=>hy(t,e,r)));return new y(n,s)}(t,e,r):fy(t,e,r)}function py(t){return v(t)&&dy(t)}function dy(t){return 2===t.ndim&&t.dim(0)===t.dim(1)}function my(t,e){return vf(e.valueOf(t))}function gy(t,e,r,n){const s=t.dim(0),i=[];for(let n=0;n<s;n++)for(let o=0;o<s;o++)n!==e&&o!==r&&i.push(t.elem(s*n+o));const o=Vx(i,s-1,n);return(e+r)%2?n.negate(o):o}function wy(t,e){const r=function(t,e){if(dy(t))return t.dim(0);throw new Error(`tensor => ${e.toInfixString(t)} MUST be a square matrix. ${t} ndim=${t.ndim}`)}(t,e),n=new Array(t.nelem);for(let s=0;s<r;s++)for(let i=0;i<r;i++)n[r*i+s]=gy(t,s,i,e);return t.withElements(n)}let _y=class extends Uw{constructor(t){super("adj",cr,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){const n=function(t,e){const r=d(t.cdr),n=e.valueOf(r);if(v(n))return wy(n,e);throw new Error("adj argument MUST be a tensor.")}(r,this.$);return[!n.equals(r)?q:T,n]}};const xy=new class{create(t){return new _y(t)}};function yy(t,e,r){if(Z(t)){return t.extractGrade(e)}if(ie(t))return 0===e?t:Jt;if(ot(t))return 0===e?t:Jt;if(Si(t))return 0===e?t:Jt;if(h(t)&&Rp(t)){const n=t.lhs,s=t.rhs;if(r.isScalar(n))return r.multiply(n,yy(s,e,r));if(r.isScalar(s))return r.multiply(yy(n,e,r),s);throw new Error(`extractGrade   ${n} * ${s}`)}throw new Error(`extractGrade(arg => ${t}, grade => ${e}) function not implemented.`)}function vy(t,e,r){return r.isOne(e)?t:u(ke,c(t,e))}class by{constructor(t,e){this.dimensions=t,this.$=e}get"ε"(){return J(1e-6)}get one(){return Ut}get zero(){return Jt}abs(){throw new Error("abs Method not implemented.")}add(t,e){if(this.$.isOne(t)){if(this.$.isOne(e))return Ct;throw new Error("add Method not implemented.")}throw new Error("add Method not implemented.")}sub(t,e){throw new Error("sub Method not implemented.")}eq(t,e){throw new Error("eq Method not implemented.")}ne(t,e){throw new Error("ne Method not implemented.")}le(t,e){throw new Error("le Method not implemented.")}lt(t,e){throw new Error("lt Method not implemented.")}ge(t,e){throw new Error("ge Method not implemented.")}gt(t,e){throw new Error("gt Method not implemented.")}max(t,e){throw new Error("max Method not implemented.")}min(t,e){throw new Error("min Method not implemented.")}mul(t,e){return this.$.multiply(t,e)}div(t,e){throw new Error("div Method not implemented.")}neg(t){if(te(t))return t.neg();throw new Error(`neg ${t} Method not implemented.`)}asString(t){throw new Error("asString Method not implemented.")}cos(t){throw new Error("cos Method not implemented.")}isField(t){if(te(t))return!0;if(ot(t))return!0;if(fg(t))return!1;throw new Error("isField method not implemented.")}isOne(t){throw new Error("isOne Method not implemented.")}isZero(t){return this.$.is_zero(t)}sin(t){throw new Error("sin Method not implemented.")}sqrt(t){throw new Error("sqrt Method not implemented.")}isDimension(t){throw new Error("isDimension Method not implemented.")}dim(t){throw new Error("dim Method not implemented.")}sum(t){if(1===t.length){const e=t[0],r=e.weight,n=e.blade;return this.$.multiply(r,n)}if(2===t.length){const e=vy(t[0].blade,t[0].weight,this.$),r=vy(t[1].blade,t[1].weight,this.$);return u($e,c(e,r))}throw new Error(`sum of ${t.length} terms Method not implemented.`)}extractGrade(t,e){return yy(t,e,this.$)}treeAdd(t,e){throw new Error("treeAdd Method not implemented.")}treeLco(t,e){if(fg(t)&&fg(e))return t.__lshift__(e);throw new Error(`treeLco(lhs=${t}, rhs=${e}) Method not implemented.`)}treeMul(t,e){throw new Error("treeMul Method not implemented.")}treeScp(t,e){throw new Error("treeScp Method not implemented.")}treeSqrt(t){throw new Error("treeSqrt Method not implemented.")}treeZero(){return Jt}scalarCoordinate(t){throw new Error("scalarCoordinate Method not implemented.")}bladeToTree(t){return t}weightToTree(t){return t}}let Oy=class extends y_{constructor(t){super("algebra_2_tensor_tensor",B("algebra"),v,v,t),this.dependencies=["Blade"],this.hash=hi(B("algebra"),ui,ui)}transform2(t,e,r){const n=this.$,s=function(t){if(v(t))return t.mapElements((function(t){if(ie(t))return t;if(ee(t))return t;if(yf(t))return t;throw new Error(`${t} must be an integer.`)}));throw new Error("must be a tensor.")}(e),i=function(t,e,r){const n=bg(t,new by(t.length,r),e),s=t.length,i=[t.length],o=new Array(s);for(let t=0;t<s;t++)o[t]=n.unit(t);return new y(i,o)}(s,function(t){if(v(t))return t.mapElements((function(t){if(se(t))return t.str;throw new Error("must be a string.")}));throw new Error("must be a tensor.")}(r),n);return[q,i]}};const Ey=new class{create(t){return new Oy(t)}};function Sy(t,e){return function(t,e){if(d(t).equals(Lr))return Jf(t);if(ot(t))return J(Math.acos(t.d));if(xp(t)||Cf(t)&&gp(d(m(t)),1,2)&&d(d(m(m(t)))).equals(An)&&mp(d(m(d(m(m(t))))),2)&&gp(d(m(m(d(m(m(t)))))),1,2))return e.getNativeDirective($.evaluatingAsFloat)?J(Math.PI/4):e.multiply(Lf(1,4),Os);if(yp(t)||Cf(t)&&gp(d(m(t)),-1,2)&&d(d(m(m(t)))).equals(An)&&mp(d(m(d(m(m(t))))),2)&&gp(d(m(m(d(m(m(t)))))),1,2))return e.getNativeDirective($.evaluatingAsFloat)?J(3*Math.PI/4):e.multiply(Lf(3,4),Os);if(vp(t))return e.getNativeDirective($.evaluatingAsFloat)?J(Math.PI/6):e.multiply(Lf(1,6),Os);if(bp(t))return e.getNativeDirective($.evaluatingAsFloat)?J(5*Math.PI/6):e.multiply(Lf(5,6),Os);if(!te(t))return Nd(hr,t);switch(vf(e.multiply(t,Ct))){case-2:return e.getNativeDirective($.evaluatingAsFloat)?rt:Os;case-1:return e.getNativeDirective($.evaluatingAsFloat)?J(2*Math.PI/3):e.multiply(Lf(2,3),Os);case 0:return e.getNativeDirective($.evaluatingAsFloat)?J(Math.PI/2):e.multiply(Xt,Os);case 1:return e.getNativeDirective($.evaluatingAsFloat)?J(Math.PI/3):e.multiply(Yt,Os);case 2:return e.getNativeDirective($.evaluatingAsFloat)?Y:Jt;default:return Nd(hr,t)}}(e.valueOf(Jf(t)),e)}let Ty=class extends Fw{constructor(t){super("arccos",hr,t),this.hash=_i(this.opr)}transform(t){const e=Sy(t,this.$);return[!e.equals(t)?q:A,e]}};const qy=new class{create(t){return new Ty(t)}};function Ay(t,e){return function(t,e){if(d(t).equals(kr))return Jf(t);if(ot(t)){let{d:e}=t;return e<1&&er("arccosh function argument is less than 1.0"),e=Math.log(e+Math.sqrt(e*e-1)),J(e)}if(e.isOne(t))return Jt;return Nd(pr,t)}(e.valueOf(Jf(t)),e)}let My=class extends Fw{constructor(t){super("arccosh",pr,t),this.hash=_i(this.opr)}transform(t){const e=Ay(t,this.$);return[!e.equals(t)?q:A,e]}};const Ny=new class{create(t){return new My(t)}};function $y(t,e){if(h(t)&&(h(r=t)&&If(r,Be)))return d(t.cdr);var r;if(ot(t))return J(Math.asin(t.d));if(xp(t)||Cf(t)&&gp(d(m(t)),1,2)&&d(d(m(m(t)))).equals(An)&&mp(d(m(d(m(m(t))))),2)&&gp(d(m(m(d(m(m(t)))))),1,2))return e.multiply(Lf(1,4),Os);if(yp(t)||Cf(t)&&gp(d(m(t)),-1,2)&&d(d(m(m(t)))).equals(An)&&mp(d(m(d(m(m(t))))),2)&&gp(d(m(m(d(m(m(t)))))),1,2))return e.getNativeDirective($.evaluatingAsFloat)?J(-Math.PI/4):e.multiply(Lf(-1,4),Os);if(vp(t))return e.getNativeDirective($.evaluatingAsFloat)?J(Math.PI/3):e.multiply(Yt,Os);if(bp(t))return e.getNativeDirective($.evaluatingAsFloat)?J(-Math.PI/3):e.multiply(Lf(-1,3),Os);if(!te(t))return Nd(dr,t);switch(vf(t.mul(Ct))){case-2:return e.getNativeDirective($.evaluatingAsFloat)?J(-Math.PI/2):e.multiply(Lf(-1,2),Os);case-1:return e.getNativeDirective($.evaluatingAsFloat)?J(-Math.PI/6):e.multiply(Lf(-1,6),Os);case 0:return e.getNativeDirective($.evaluatingAsFloat)?Y:Jt;case 1:return e.getNativeDirective($.evaluatingAsFloat)?J(Math.PI/6):e.multiply(Lf(1,6),Os);case 2:return e.getNativeDirective($.evaluatingAsFloat)?J(Math.PI/2):e.multiply(Xt,Os);default:return Nd(dr,t)}}let Ly=class extends Fw{constructor(t){super("arcsin",dr,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){return $y(e.valueOf(Jf(t)),e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const ky=new class{create(t){return new Ly(t)}};let Ry=class extends Uw{constructor(t){super("arcsinh",mr,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){const n=function(t,e){if(d(t).equals(Zn))return Jf(t);if(ot(t)){let{d:e}=t;return e=Math.log(e+Math.sqrt(e*e+1)),J(e)}return e.is_zero(t)?Jt:Nd(mr,t)}(e,this.$);return[!n.equals(r)?q:T,n]}};const Iy=new class{create(t){return new Ry(t)}};function Py(t,e){const r=t.argList.head;return function(t,e){if(d(t).equals(Wn))return Jf(t);if(ot(t))return J(Math.atan(t.d));if(e.is_zero(t))return Jt;if(qd(t))return e.negate(e.arctan(e.negate(t)));if(t.contains(Qn)&&t.contains(Lr)){const r=Sm(t,e),n=dm(t,e);if(d(r).equals(Qn)&&d(n).equals(Lr)&&e.equals(Jf(r),Jf(n)))return Jf(r)}if(Df(t)&&mp(Jf(t),3)&&gp(th(t),-1,2)||Cf(t)&&gp(d(m(t)),1,3)&&d(d(m(m(t)))).equals(An)&&mp(d(m(d(m(m(t))))),3)&&gp(d(m(m(d(m(m(t)))))),1,2))return e.multiply(Lf(1,6),e.getNativeDirective($.evaluatingAsFloat)?rt:Os);if(mp(t,1))return e.multiply(Lf(1,4),ar.Pi(e));if(Df(t)&&mp(Jf(t),3)&&gp(th(t),1,2))return e.multiply(Yt,ar.Pi(e));return Nd(gr,t)}(e.valueOf(r),e)}let Fy=class extends Fw{constructor(t){super("arctan",gr,t),this.hash=_i(this.opr)}transform(t){const e=Py(t,this.$);return[!e.equals(t)?q:A,e]}};const Uy=new class{create(t){return new Fy(t)}};function Cy(t,e){return function(t,e){if(d(t).equals(Jn))return Jf(t);if(ot(t)){let{d:e}=t;if(e<-1||e>1)throw new Error("arctanh function argument is not in the interval [-1,1]");return e=Math.log((1+e)/(1-e))/2,J(e)}if(e.is_zero(t))return Jt;return Nd(wr,t)}(e.valueOf(Jf(t)),e)}let Dy=class extends Fw{constructor(t){super("arctanh",wr,t),this.hash=_i(this.opr)}transform(t){const e=Cy(t,this.$);return[!e.equals(t)?q:A,e]}};const By=new class{create(t){return new Dy(t)}},Ky=Q(F.arg),zy=Q(F.add);function Qy(t,e){const r=e.imag(t),n=e.real(t);if(e.is_zero(n)){if(e.is_zero(r))return new Vs(c(Ky,e.add(n,r)));{const t=qd(r)?Xt.neg():Xt,n=ar.Pi(e);return e.multiply(t,n)}}if(qd(n)){const t=ar.Pi(e);if(qd(r))return e.subtract(e.arctan(e.divide(r,n)),t);{const s=e.arctan(e.divide(r,n)),i=t;return e.add(s,i)}}return e.arctan(e.divide(r,n))}let Zy=class extends Cw{constructor(t){super(Ky,zy,t)}transform1(t,e,r){return[q,Qy(e,this.$)]}};const Gy=new class{create(t){return new Zy(t)}},Hy=Q(F.arg);let Vy=class extends Uw{constructor(t){super("arg_any",Hy,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){return[T,r]}};const jy=new class{create(t){return new Vy(t)}},Wy=Q(F.arg);let Jy=class extends Uw{constructor(t){super("arg_flt",Wy,ot,t),this.hash=gi(this.opr,ri)}transform1(t,e,r){return e.isZero()?[q,new Vs(r)]:e.isNegative()?[q,rt]:[q,Y]}};const Xy=new class{create(t){return new Jy(t)}},Yy=Q(F.arg),tv=Q(F.PI);let ev=class extends Uw{constructor(t){super("arg_imu",Yy,ht,t),this.hash=gi(this.opr,si)}transform1(t,e,r){return[q,this.$.divide(tv,Ct)]}};const rv=new class{create(t){return new ev(t)}},nv=Q(F.arg),sv=Q(F.multiply),iv=Q(F.PI);function ov(t,e){const r=e.divide(t,iv);return te(r)?e.multiply(av(r),iv):ot(r)?e.multiply(uv(r),iv):t}function av(t,e){return t.isOne()||t.isMinusOne()?t:t.pred().isPositive()?av(t.pred().pred()):t.succ().isNegative()?av(t.succ().succ()):t}function uv(t,e){return t.isOne()||t.isMinusOne()?t:t.sub(tt).isPositive()?uv(t.sub(tt).sub(tt)):t.add(tt).isNegative()?uv(t.add(tt).add(tt)):t}let cv=class extends Cw{constructor(t){super(nv,sv,t)}transform1(t,e,r){const n=this.$,s=ov(e.tail().map(n.arg).reduce(((t,e)=>n.add(t,e)),Jt),n);return[q,s]}};const lv=new class{create(t){return new cv(t)}},fv=Q(F.arg),hv=Q(F.pow);let pv=class extends Cw{constructor(t){super(fv,hv,t)}transform1(t,e){const r=this.$,n=Vp(e.lhs,e.rhs,r);return[q,n]}};const dv=new class{create(t){return new pv(t)}},mv=Q(F.arg),gv=Q(F.PI);let wv=class extends Uw{constructor(t){super("arg_rat",mv,te,t),this.hash=gi(this.opr,ii)}transform1(t,e,r){return e.isZero()?[q,new Vs(r)]:e.isNegative()?[q,gv]:[q,Jt]}};const _v=new class{create(t){return new wv(t)}},xv=Q(F.arg),yv=Q(F.E),vv=Q(F.PI);let bv=class extends Uw{constructor(t){super("arg_sym",xv,ie,t),this.hash=gi(this.opr,ai)}transform1(t,e,r){const n=this.$;return e.equalsSym(yv)||e.equalsSym(vv)?[q,Jt]:n.is_real(e)?[q,r]:[T,r]}};const Ov=new class{create(t){return new bv(t)}};function Ev(t,e){const r=nh(t);if(!ie(r))throw new Error("indexed assignment: expected a symbol name");const n=tr.tos;bf(e.valueOf(th(t)));const s=eh(t);h(s)&&Ef([...s].map((function(t){return e.valueOf(t)}))),function(t){t<3&&er("error in indexed assign");const e=tr.tos-t,r=tr.stack[e],n=tr.stack[e+1];v(n)||er("error in indexed assign: assigning to something that is not a tensor");const s=t-2;s>n.ndim&&er("error in indexed assign");let i=0;for(let t=0;t<s;t++){const r=vf(tr.stack[e+t+2]);(r<1||r>n.dim(t))&&er("error in indexed assign\n"),i=i*n.dim(t)+r-1}for(let t=s;t<n.ndim;t++)i=i*n.dim(t)+0;const o=n.copyDimensions(),a=n.copyElements();if(n.ndim===s)return v(r)&&er("error in indexed assign"),a[i]=r,rr(tr.tos-t),void bf(new y(o,a));v(r)||er("error in indexed assign"),n.ndim-s!==r.ndim&&er("error in indexed assign");for(let t=0;t<r.ndim;t++)o[s+t]!==r.dim(t)&&er("error in indexed assign");for(let t=0;t<r.nelem;t++)a[i+t]=r.elem(t);rr(tr.tos-t),bf(new y(o,a))}(tr.tos-n);const i=Of();return e.setSymbolValue(r,i),l}function Sv(t,e){const r=t.lhs;if(Yf(t).equals(fn))return Ev(t,e);if(h(r))return function(t,e){const r=Yf(t),n=eh(t);let s=th(t);ie(r)||er("function name?"),d(s).equals(Vr)&&(s=e.valueOf(Jf(s))),s=Nd(sn,s,n),e.setSymbolValue(r,s)}(t,e),l;ie(r)||er("symbol assignment: error in symbol");const n=e.valueOf(t.rhs);return e.setSymbolValue(r,n),l}let Tv=class extends y_{constructor(t){super("assign_any_any",Bn,Qw,Qw,t)}transform(t){const e=this.match(t);return e?this.transform2(e.opr,e.lhs,e.rhs,e):[T,t]}transform2(t,e,r,n){const s=this.$;return[q,Sv(n,s)]}};const qv=new class{create(t){return new Tv(t)}};let Av=class extends y_{constructor(t){super("assign_sym_any",Bn,ie,Qw,t),this.hash=hi(Bn,ai,li)}transform(t){const e=this.match(t);if(e){const t=this.$,[r,n]=t.transform(e.rhs);return N(r)?[q,t.valueOf(c(e.opr,e.lhs,n))]:this.transform2(e.opr,e.lhs,e.rhs,e)}return[T,t]}transform2(t,e,r,n){return this.$.setSymbolValue(e,r),[q,l]}};const Mv=new class{create(t){return new Av(t)}};let Nv=class extends Fw{constructor(t){super("besselj",_r,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){return Yx(e.valueOf(Jf(t)),e.valueOf(th(t)),e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const $v=new class{create(t){return new Nv(t)}};let Lv=class extends Fw{constructor(t){super("bessely",xr,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){return ty(e.valueOf(Jf(t)),e.valueOf(th(t)),e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const kv=new class{create(t){return new Lv(t)}};function Rv(t,e){const r=function(t,e,r){return function(t,e,r){if(!function(t,e,r){return(!ee(t)||!Ed(t,Jt))&&((!ee(e)||!Ed(e,Jt))&&!(ee(t)&&ee(e)&&Ed(t,e)))}(t,e))return Jt;return Mp(Mp(im(t),im(e),r),im(r.subtract(t,e)),r)}(t,e,r)}(e.valueOf(Jf(t)),e.valueOf(th(t)),e);return r}let Iv=class extends Fw{constructor(t){super("binomial",yr,t),this.hash=_i(this.opr)}transform(t){const e=Rv(t,this.$);return[!e.equals(t)?q:A,e]}};const Pv=new class{create(t){return new Iv(t)}};class Fv{constructor(t){}get key(){return V.name}get hash(){return ti}get name(){return"BooExtension"}evaluate(t,e,r){return this.transform(u(t,e),r)}transform(t,e){return t instanceof G?[A,t]:[T,t]}valueOf(t,e){return t}isImag(t){throw new Error("Boo Method not implemented.")}isKind(t){return t instanceof G}isMinusOne(t,e){throw new Error("Boo Method not implemented.")}isOne(t,e){throw new Error("Boo Method not implemented.")}isReal(t){throw new Error("Boo Method not implemented.")}isScalar(){throw new Error("Boo Method not implemented.")}isZero(t,e){return!1}subst(t,e,r,n){return t}toInfixString(t){return t.equals(V)?"true":"false"}toLatexString(t){return t.equals(V)?"true":"false"}toListString(t){return t.equals(V)?"#t":"#f"}}const Uv=new Oi((function(t){return new Fv(t)}));class Cv extends Uw{constructor(t){super("ceiling_cons",B("ceiling"),h,t)}transform1(t,e,r){return[T,r]}}const Dv=new class{create(t){return new Cv(t)}};class Bv extends Uw{constructor(t){super("ceiling_flt",B("ceiling"),ot,t)}transform1(t,e){return[q,J(Math.ceil(e.d))]}}const Kv=new class{create(t){return new Bv(t)}};class zv extends Uw{constructor(t){super("ceiling_rat",B("ceiling"),Si,t)}transform1(t,e){return[q,e.ceiling()]}}const Qv=new class{create(t){return new zv(t)}},Zv=Q(F.test_eq);function Gv(t){if(h(t)&&t.head.equals(Bn)){const e=t.argList,r=e.head,n=e.cdr.head;return c(Zv,r,n)}return t}function Hv(t,e){const r=e.valueOf(Gv(t));if(e.is_zero(r))return!1;if(Gf(r))return!0;const n=ah(r,e);if(e.is_zero(n))return!1;if(Gf(n))return!0;if(n.contains(ft)){const t=e.valueOf(Gv(Wd(n,e)));if(e.is_zero(t))return!1;if(Gf(t))return!0}return null}function Vv(t,e){const r=Hv(t.argList.head,e);if("boolean"==typeof r)return Ft(Number(r));if(r)throw new Error;return t}function jv(t,e){const r=t.cdr,n=function(t,e,r){if(!function(t,e){return!(ee(t)&&Lh(t,Jt)<0)&&(!(ee(e)&&Lh(e,Jt)<0)&&!(ee(t)&&ee(e)&&Lh(t,e)<0))}(t,e))return Jt;return Mp(Mp(im(t),im(e),r),im(r.subtract(t,e)),r)}(e.valueOf(d(r)),e.valueOf(Jf(r)),e);return n}let Wv=class extends Fw{constructor(t){super("choose",Or,t),this.hash=_i(this.opr)}transform(t){const e=jv(t,this.$);return[!e.equals(t)?q:A,e]}};const Jv=new class{create(t){return new Wv(t)}},Xv=Q(F.E),Yv=Q(F.pow);function tb(t,e){const r=c(Yv,Xv,e.multiply(t,ft));r.meta|=M;const n=c(Yv,Xv,e.multiply(e.negate(t),ft));return n.meta|=M,e.multiply(Xt,e.add(r,n))}function eb(t,e){const r=c(Ie,Ke,e.multiply(ft,t));r.meta|=M;const n=c(Ie,Ke,e.multiply(e.negate(ft),t));return n.meta|=M,e.subtract(e.multiply(Mp(r,ft,e),Xt),e.multiply(Mp(n,ft,e),Xt))}function rb(t,e){if(d(t).equals(Lr))return tb(Jf(t),e);if(d(t).equals(Qn))return eb(Jf(t),e);if(d(t).equals(Wn)){t=Jf(t);const r=Sd(e.multiply(ft,t),e),n=Sd(e.negate(e.multiply(ft,t)),e);return Mp(e.multiply(e.subtract(n,r),ft),e.add(r,n),e)}if(d(t).equals(kr))return t=Jf(t),e.multiply(e.add(Sd(t,e),Sd(e.negate(t),e)),Xt);if(d(t).equals(Zn))return t=Jf(t),e.multiply(e.subtract(Sd(t,e),Sd(e.negate(t),e)),Xt);if(d(t).equals(Jn))return t=Sd(e.multiply(Jf(t),Ct),e),Mp(e.subtract(t,Ut),e.add(t,Ut),e);if(h(t))return t.map((function(t){return rb(t,e)}));if(v(t)){const r=t.mapElements((function(t){return rb(t,e)}));return t.withElements(r)}return t}let nb=class extends Uw{constructor(t){super("circexp_any",Er,Qw,t),this.phases=L,this.hash=gi(this.opr,li)}transform1(t,e,r){const n=this.$;n.pushNativeDirective($.evaluatingTrigAsExp,!0);try{const t=rb(e,n),s=n.valueOf(t);return[!s.equals(r)?q:T,s]}finally{n.popNativeDirective()}}};const sb=new class{create(t){return new nb(t)}};let ib=class extends Uw{constructor(t){super("clock_any",qr,Qw,t),this.hash=gi(qr,li)}transform1(t,e,r){const n=this.$;if(n.isExpanding()){const t=cm(e,n);return[q,t]}return[T,r]}};const ob=new class{create(t){return new ib(t)}};let ab=class extends Fw{constructor(t){super("coeff",Ar,t),this.phases=P,this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(Jf(t));let n=e.valueOf(th(t)),s=e.valueOf(sh(t));return l.equals(s)&&(s=n,n=Ms),$p(Mp(r,e.power(n,s),e),n,e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const ub=new class{create(t){return new ab(t)}};let cb=class extends Fw{constructor(t){super("cofactor",Mr,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(Jf(t));py(r)||er("cofactor: 1st arg: square matrix expected");const n=r.dim(0),s=my(th(t),e);(s<1||s>n)&&er("cofactor: 2nd arg: row index expected");const i=my(sh(t),e);return(i<1||i>n)&&er("cofactor: 3rd arg: column index expected"),gy(r,s-1,i-1,e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const lb=new class{create(t){return new cb(t)}};let fb=class extends Fw{constructor(t){super("condense",Nr,t),this.phases=L,this.hash=_i(this.opr)}transform(t){const e=function(t,e){return Vd(e.valueOf(Jf(t)),e)}(t,this.$);e.meta|=M;return[!e.equals(t)?q:A,e]}};const hb=new class{create(t){return new fb(t)}},pb=Q(F.conj),db=Q(F.add);let mb=class extends Cw{constructor(t){super(pb,db,t)}transform1(t,e,r){const n=this.$,s=e.tail().map((function(t){return n.conj(t)}));return[q,n.valueOf(c(db,...s))]}};const gb=new class{create(t){return new mb(t)}},wb=B("conj");class _b extends Uw{constructor(t){super("conj_any",wb,Qw,t)}transform1(t,e,r){throw new Error(this.$.toInfixString(e))}}const xb=new class{create(t){return new _b(t)}};class yb extends Uw{constructor(t){super("conj_blade",wb,Z,t)}transform1(t,e){return[q,e.rev()]}}const vb=new class{create(t){return new yb(t)}};let bb=class extends Uw{constructor(t){super("conj_flt",wb,Mh,t)}transform1(t,e){return[q,e]}};const Ob=new class{create(t){return new bb(t)}};class Eb extends Uw{constructor(t){super("conj_imu",wb,ht,t)}transform1(t,e){return[q,c(ke,jt,e)]}}const Sb=new class{create(t){return new Eb(t)}};function Tb(t){return function(t){const e=t.opr;return!!ie(e)&&Fe.equalsSym(e)}(t)&&Lp(t)}class qb extends Uw{constructor(t){super("conj_inner",wb,x_(h,Tb),t)}transform1(t,e){return[q,c(e.opr,e.rhs,e.lhs)]}}const Ab=new class{create(t){return new qb(t)}};let Mb=class extends Uw{constructor(t){super("conj_mul_2_any_any",wb,x_(h,kp(ke)),t),this.hash=wi(wb,ke)}transform1(t,e,r){const n=this.$,s=e.opr,i=e.lhs,o=e.rhs;if(n.isExpanding()){if(n.isScalar(i)&&n.isScalar(o)){const t=n.valueOf(c(wb,i)),e=n.valueOf(c(wb,o)),r=c(s,t,e);return[q,r]}return[T,r]}return[A,r]}};const Nb=new class{create(t){return new Mb(t)}};class $b extends Uw{constructor(t){super("conj_rat",wb,te,t)}transform1(t,e){return[q,e]}}const Lb=new class{create(t){return new $b(t)}};class kb extends Uw{constructor(t){super("conj_sym",wb,ie,t)}transform1(t,e,r){return[q,e]}}const Rb=new class{create(t){return new kb(t)}};function Ib(t,e,r){return Pb(t,e,Jt,r)}function Pb(t,e,r,n){if(t.equals(e))return n.is_zero(r)?Ut:r;if(h(t)&&Df(t)){const s=th(t);return n.equals(Jf(t),e)&&ee(s)&&Lh(r,s)<0?s:r}return h(t)?t.tail().reduce((function(t,r){return Pb(r,e,t,n)}),r):r}function Fb(t,e){const r=t;let n=e.subtract(e.valueOf(Jf(t)),e.valueOf(th(t))),s=Hv(n,e);if(s)return Jt;if(null!=s&&!s)return Ut;const i=Pm(e.valueOf(Jf(t)),e),o=Pm(e.valueOf(th(t)),e);return n=e.subtract(i,o),s=Hv(n,e),s?Jt:null==s||s?r:Ut}function Ub(t,e){const r=t,n=zb(t,e);return null==n?r:n>=0?Ut:Jt}function Cb(t,e){const r=t,n=zb(t,e);return null==n?r:n>0?Ut:Jt}function Db(t,e){const r=t,n=zb(t,e);return null==n?r:n<=0?Ut:Jt}function Bb(t,e){const r=t,n=zb(t,e);return null==n?r:n<0?Ut:Jt}function Kb(t,e){const r=t;let n=m(r),s=!1;for(;h(n);){const t=Hv(d(n),e);if(null==t)s=!0,n=m(n);else if(t)n=m(n);else if(!t)return Jt}return s?r:Ut}function zb(t,e){let r=E;const n=Pm(e.valueOf(Jf(t)),e),s=Pm(e.valueOf(th(t)),e);let i=e.subtract(n,s);return te(i)||ot(i)||(i=e.valueOf(uh(i,e))),e.is_zero(i)?0:(r=te(i)?-1===Qs(i.a)?-1:1:ot(i)?i.d<0?-1:1:null,r)}class Qb{constructor(t){}get key(){return"Cons"}get hash(){return"Cons"}get name(){return"ConsExtension"}compareFactors(t,e,r){throw new Error("Cons Method not implemented.")}isImag(t,e){return!1}isKind(t){return!!h(t)}isMinusOne(t,e){throw new Error("Cons Method not implemented.")}isOne(t,e){throw new Error("Cons Method not implemented.")}isReal(t,e){return!1}isScalar(t,e){return!1}isZero(t,e){throw new Error("Cons Method not implemented.")}subst(t,e,r,n){throw new Error(`expr = ${t} oldExpr = ${e} newExpr = ${r}`)}toInfixString(t,e){return Ax(t,e)}toLatexString(t,e){return Ax(t,e)}toListString(t,e){let r="";r+="(",r+=e.toSExprString(t.car);let n=t.cdr;for(;h(n);)r+=" ",r+=e.toSExprString(n.car),n=n.cdr;return n!==l&&(r+=" . ",r+=e.toSExprString(n)),r+=")",r}evaluate(t,e,r){return this.transform(u(t,e),r)}transform(t,e){return[T,t]}valueOf(t,e){const r=function(t,e){return t},n=t.car;if(ie(n))return t;{const s=e.operatorFor(n);return p(t.cdr)?r(s.valueOf(n)):r(t)}}}const Zb=new Oi((function(t){return new Qb(t)}));function Gb(t,e){const r=e.valueOf(Jf(t));let n,s;l.equals(Xf(t))?(n=Ut,s=Ct):(n=e.valueOf(th(t)),s=e.valueOf(sh(t)));const i=function(t,e,r,n){const s=[],i=[];if(!v(t))return n.is_zero(t)||er("contract: tensor expected, 1st arg is not a tensor"),Jt;let o=vf(e),a=vf(r);const{ndim:u}=t;(o<1||o>u||a<1||a>u||o===a||t.dim(o-1)!==t.dim(a-1))&&er("contract: index out of range");o--,a--;const c=t.dim(o);let l=1;for(let e=0;e<u;e++)e!==o&&e!==a&&(l*=t.dim(e));const f=new Array(u-2),h=new Array(l);let p=0;for(let e=0;e<u;e++)e!==o&&e!==a&&(f[p++]=t.dim(e));const d=t.copyElements(),m=h;for(let e=0;e<u;e++)s[e]=0,i[e]=t.dim(e);for(let t=0;t<l;t++){let e=Jt;for(let t=0;t<c;t++){s[o]=t,s[a]=t;let r=0;for(let t=0;t<u;t++)r=r*i[t]+s[t];e=n.add(e,d[r])}m[t]=e;for(let t=u-1;t>=0;t--)if(t!==o&&t!==a){if(++s[t]<i[t])break;s[t]=0}}if(1===l)return m[0];return new y(f,h)}(r,n,s,e);return i}let Hb=class extends Fw{constructor(t){super("contract",$r,t),this.dependencies=[],this.hash=_i(this.opr)}transform(t){const e=Gb(t,this.$);return[!e.equals(t)?q:A,e]}};const Vb=new class{create(t){return new Hb(t)}};function jb(t,e){return function(r){return kp(t)(r)&&e(r.lhs)}}let Wb=class extends Uw{constructor(t){super("cos_add_2_any_any",Mm,x_(h,jb($e,Qw)),t),this.phases=L,this.hash=wi(Mm,$e)}transform1(t,e){const r=this.$,n=e.lhs,s=e.rhs,i=r.valueOf(c(Mm,n)),o=r.valueOf(c(Mm,s)),a=r.valueOf(c($m,n)),u=r.valueOf(c($m,s)),l=r.valueOf(c(ke,i,o)),f=r.valueOf(c(ke,a,u)),h=r.valueOf(c($e,l,r.negate(f)));return[q,h]}};const Jb=new class{create(t){return new Wb(t)}};function Xb(t,e,r){if(d(t).equals(hr))return[q,Jf(t)];if(ot(t)){let e=Math.cos(t.d);return Math.abs(e)<1e-10&&(e=0),[q,J(e)]}if(qd(t))return[q,r.valueOf(c(Lr,r.negate(t)))];if(d(t).equals(gr)){const e=r.add(Ut,r.power(Jf(t),Ct));return[q,r.power(e,Lf(-1,2))]}const n=vf(Mp(r.multiply(t,Ft(180)),ar.Pi(r),r));if(n<0||isNaN(n))return[T,e];switch(n%360){case 90:case 270:return[q,Jt];case 60:case 300:return[q,Xt];case 120:case 240:return[q,Lf(-1,2)];case 45:case 315:return[q,r.multiply(Xt,r.power(Ct,Xt))];case 135:case 225:return[q,r.multiply(Lf(-1,2),r.power(Ct,Xt))];case 30:case 330:return[q,r.multiply(Xt,r.power(Dt,Xt))];case 150:case 210:return[q,r.multiply(Lf(-1,2),r.power(Dt,Xt))];case 0:return[q,Ut];case 180:return[q,jt];default:return[T,e]}}function Yb(t,e){let r=0;return oh(t)?2:Cf(t)&&ee(Jf(t))&&oh(th(t))&&3===jh(t)?(r=vf(e.multiply(Jf(t),Ct)),isNaN(r)?0:(r=r<0?4- -r%4:1+(r-1)%4,r)):0}function tO(t,e,r){return Uf(t)?function(t,e,r){for(const e of t.tail())if(Yb(e,r)){const n=r.subtract(t,e);return[q,r.subtract(r.multiply(Nm(n,r),Nm(e,r)),r.multiply(Lm(n,r),Lm(e,r)))]}return Xb(t,e,r)}(t,e,r):Xb(t,e,r)}let eO=class extends Uw{constructor(t){super("cos_any",Mm,Qw,t),this.hash=gi(Mm,li)}transform1(t,e,r){return this.$.isExpanding()?tO(e,r,this.$):[T,r]}};const rO=new class{create(t){return new eO(t)}};let nO=class extends Uw{constructor(t){super("cos_hyp",Mm,ct,t),this.hash=gi(Mm,ni)}transform1(t,e){return[q,Ut]}};const sO=new class{create(t){return new nO(t)}};function iO(t,e){return function(r){return kp(t)(r)&&e(r.rhs)}}let oO=class extends Uw{constructor(t){super("cos_mul_2_any_imu",Mm,x_(h,iO(ke,ht)),t),this.hash=wi(Mm,ke)}transform1(t,e,r){const n=this.$,s=e.lhs;if(n.isExpanding()){const t=n.valueOf(c(kr,s));return[q,t]}return[A,r]}};const aO=new class{create(t){return new oO(t)}};let uO=class extends Uw{constructor(t){super("cos_sym",Mm,ie,t),this.hash=gi(Mm,ai)}isReal(t){return this.$.is_real(t.arg)}transform1(t,e,r){return tO(e,r,this.$)}};const cO=new class{create(t){return new uO(t)}};let lO=class extends Uw{constructor(t){super("cosh_sym",kr,ie,t),this.hash=gi(kr,ai)}isReal(t){return!0}transform1(t,e,r){return[A,r]}};const fO=new class{create(t){return new lO(t)}};let hO=class extends Fw{constructor(t){super("cosh",kr,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){return ey(e.valueOf(Jf(t)),e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const pO=new class{create(t){return new hO(t)}},dO=B("cross");let mO=class extends y_{constructor(t){super("cross_any_any",dO,Qw,Qw,t)}transform2(t,e,r,n){const s=this.$;if(Ph(e)){const n=Uh(e);if(!n.equals(e)){const i=bh(e,Z),o=s.valueOf(c(t,n,r)),a=s.valueOf(c(ke,i,o));return[q,a]}}if(Ph(r)){const n=Uh(r);if(!n.equals(r)){const i=bh(r,Z),o=s.valueOf(c(t,e,n)),a=s.valueOf(c(ke,o,i));return[q,a]}}return[T,n]}};const gO=new class{create(t){return new mO(t)}};let wO=class extends y_{constructor(t){super("cross_blade_blade",dO,Z,Z,t),this.dependencies=["Blade"],this.hash=hi(dO,Ys,Ys)}transform2(t,e,r,n){const s=this.$,i=s.valueOf(e.__wedge__(r));if(Z(i))return[q,s.valueOf(c(ke,jt,i.dual()))];if(Si(i))return[q,i];if(h(i)&&function(t){return Rp(t)&&Z(t.lhs)&&Si(t.rhs)}(i)){const t=i.lhs,e=i.rhs;return[q,s.valueOf(c(ke,jt.mul(e),t.dual()))]}if(h(i)&&C_(i)){const t=i.lhs,e=i.rhs;return[q,s.valueOf(c(ke,jt.mul(t),e.dual()))]}throw new Error(`${s.toSExprString(i)}`)}};const _O=new class{create(t){return new wO(t)}};function xO(t,e){return ir(yO,t,e)}function yO(t,e){const r=function(t,e){return t},n=ip(t,qs),s=ip(t,As),i=ip(t,Ms),o=ip(t,Ns),a=ip(t,$s);if(!n||s||i||o||a){if(n||!s||i||o||a){if(n||s||!i||o||a){if(n||s||i||!o||a){if(n||s||i||o||!a){if(h(t)&&!d(t).equals(nn)){const n=Nd(d(t),...t.tail().map((function(t){return xO(t,e)})));return r(n)}return r(t)}return r(bO(t,$s,e))}return r(bO(t,Ns,e))}return r(bO(t,Ms,e))}return r(bO(t,As,e))}return r(bO(t,qs,e))}function vO(t,e,r){return ip(t,e)?bO(t,e,r):h(t)?Nd(d(t),...t.tail().map((t=>vO(t,e,r)))):t}function bO(t,e,r){const n=Pp(t,e,r),s=[];for(let t=n.length-1;t>=0;t--){const i=OO(t,n[t],e,r);s.push(...i)}if(s.length>1)return u(ur,Nd(...s));if(s.length>0)return s[0];throw new Ai}function OO(t,e,r,n){if(n.is_zero(e))return[];if(0===t)return h(e)&&Uf(e)?e.tail():[e];const s=[];return Cf(e)?s.push(...e.tail()):mp(e,1)||s.push(e),1===t?s.push(r):s.push(Nd(An,r,Ft(t))),s.length>1?[Nd(xn,...s)]:s}function EO(t,e,r,n){if(t){if(!h(e))return[e]}else if(!e.contains(r))return[e];if(Uf(e))return function(t,e,r,n){let s=m(e);const i=[];for(;h(s);)(d(s).contains(r)||t)&&i.push(...EO(t,d(s),r,n)),s=m(s);const o=m(e),a=[...o].filter((t=>!t.contains(r)));if(a.length){const t=Pd(a,n);c=t,(u=i).length>0&&c.equals(u[u.length-1])||u.push(c),i.push(n.negate(t))}var u,c;return i}(t,e,r,n);if(Cf(e))return function(t,e,r,n){let s=m(e);const i=[];for(;h(s);)(d(s).contains(r)||t)&&i.push(...EO(t,d(s),r,n)),s=m(s);s=m(e);const o=[];for(;h(s);){const t=d(s);t.contains(r)||(o.length<1||!t.equals(o[o.length-1]))&&o.push(t),s=m(s)}o.length>0&&i.push(Dd(o,n));return i}(t,e,r,n);let s=m(e);const i=[];for(;h(s);)t&&i.push(d(s)),i.push(...EO(t,d(s),r,n)),s=m(s);return i}function SO(t,e,r,n,s){const i=function(t){return{METAA:t.getSymbolValue(xs),METAB:t.getSymbolValue(ys),METAX:t.getSymbolValue(vs)}}(s);s.setSymbolValue(vs,e);const o=EO(n,vO(t,e,s),e,s);let a=!1,u=l;if(n){if(!ee(t)){let e=Ip(r,ks,xs,s);e=Ip(e,Rs,ys,s);const i=Ip(e,Is,vs,s),c=d(i);u=Jf(i);const f=Xf(i);if(TO([Ut,...o],n,t,c,f,s))a=!0;else{const e=[];let i=t;for(h(i)&&(e.push(d(t)),i=m(t));h(i);){const t=d(i);i=m(i);const[o,u]=SO(t,l,r,n,s);a=a||u,e.push(o)}0!==e.length&&(u=Nd(...e))}}}else for(const e of Array.from(r))if(e){const r=Eo(e),i=Jf(r);u=th(r);const c=rh(r);if(TO([Ut,...o],n,t,i,c,s)){a=!0;break}}const c=a?s.valueOf(u):n?t:l;return function(t,e){e.setSymbolValue(vs,t.METAX),e.setSymbolValue(ys,t.METAB),e.setSymbolValue(xs,t.METAA)}(i,s),[c,a]}function TO(t,e,r,n,s,i){for(const o of t){i.setSymbolValue(xs,o);for(const o of t){i.setSymbolValue(ys,o);let t=s;for(;h(t);){const e=i.valueOf(t.car);if(i.is_zero(e))break;t=t.cdr}if(h(t))continue;const a=e?sr((function(t){return i.valueOf(t)}),n,i):i.valueOf(n);if(i.is_zero(i.subtract(r,a)))return!0}}return!1}function qO(t,e,r){let n;return n=Uf(t)?function(t,e,r){t=m(t);let n=qO(d(t),e,r);h(t)&&(n=t.tail().reduce(((t,n)=>r.add(t,qO(n,e,r))),n));return n}(t,e,r):Cf(t)?function(t,e,r){const[n,s]=function(t,e,r){let n=Ut,s=n;if(!h(t=m(t)))return[n,s];for(const i of t)i.contains(e)?s=r.multiply(s,i):n=r.multiply(n,i);return[n,s]}(t,e,r);return r.multiply(n,AO(s,e,r))}(t,e,r):AO(t,e,r),n.contains(hn)&&er("integral: sorry, could not find a solution"),r.valueOf(Pm(n,r))}function AO(t,e,r){const n=NO(t,e,r).toFixed(6),s=LO[n];if(!s)return Nd(hn,t,e);const[i,o]=SO(t,e,s,!1,r);return l===i?Nd(hn,t,e):i}const MO={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916};function NO(t,e,r){if(ie(t))return ie(e)&&t.equals(e)?MO.x:MO.constant;if(h(t)){const n=t.car;return n.equals(ur)?function(t,e,r){const n={};for(;h(t);){const s=d(t);t=m(t);let i=0;i=s.contains(e)?NO(s,e,r):MO.constant,n[i.toFixed(6)]=!0}let s=0;for(const t of Object.keys(n||{}))s+=Number(t);return s}(m(t),e,r):n.equals(xn)?function(t,e,r){let n=1;h(t)&&[...t].forEach((t=>{t.contains(e)&&(n*=NO(t,e,r))}));return n}(m(t),e,r):n.equals(An)?$O(Jf(t),th(t),e,r):n.equals(jr)?$O(Sd(Ut,r),Jf(t),e,r):n.equals(Hn)?$O(Jf(t),J(.5),e,r):function(t,e,r){if(!Jf(t).contains(e))return MO.constant;const n=t.car;if(ie(n)){const s=NO(d(t.cdr),e,r),i=n.key(),o=MO[i];if(!o)throw new Error("Unsupported function "+i);return Math.pow(o,s)}throw new Error("is_sym(car(u)) MUST be true.")}(t,e,r)}return MO.constant}function $O(t,e,r,n){let s=MO.constant,i=MO.constexp;if(t.contains(r)&&(s=NO(t,r,n)),e.contains(r))i=NO(e,r,n);else{if(s===MO.constant)return MO.constant;Yh(e)?i=-1:wp(e)?i=.5:_p(e)?i=-.5:gp(e,2,1)?i=2:gp(e,-2,1)&&(i=-2)}return Math.pow(s,i)}const LO={1.144166:["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x**a,x**(a+1)/(a+1))"],1.095727:["f(x**(-2),-x**(-1))"],1.023118:["f(x**(-1/2),2*x**(1/2))"],.977405:["f(x**(1/2),2/3*x**(3/2))"],"0.955320":["f(x,x**2/2)"],.912636:["f(x**2,x**3/3)"],1.137302:["f(exp(a*x),1/a*exp(a*x))","f(a**x,a**x/log(a),or(not(number(a)),a>0))"],1.326774:["f(exp(a*x+b),1/a*exp(a*x+b))"],1.080259:["f(x*exp(a*x**2),exp(a*x**2)/(2*a))"],1.260228:["f(x*exp(a*x**2+b),exp(a*x**2+b)/(2*a))"],1.451902:["f(log(a*x),x*log(a*x)-x)"],.486192:["f(1/(a+x**2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x**2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x**2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x**2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],.697274:["f(1/sqrt(a-x**2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x**2),log(x+sqrt(a+x**2)))","f(1/sqrt(x**2+a),log(x+sqrt(x**2+a)))"],.476307:["f(1/(a+b*x),1/b*log(a+b*x))"],.226868:["f(1/(a+b*x)**2,-1/(b*(a+b*x)))"],2.904531:["f(1/(a+b*x)**3,-1/(2*b)*1/(a+b*x)**2)"],.455026:["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],.216732:["f(x/(a+b*x)**2,1/b**2*(log(a+b*x)+a/(a+b*x)))"],.434695:["f(x**2/(a+b*x),1/b**2*(1/2*(a+b*x)**2-2*a*(a+b*x)+a**2*log(a+b*x)))"],.207048:["f(x**2/(a+b*x)**2,1/b**3*(a+b*x-2*a*log(a+b*x)-a**2/(a+b*x)))"],2.650781:["f(x**2/(a+b*x)**3,1/b**3*(log(a+b*x)+2*a/(a+b*x)-1/2*a**2/(a+b*x)**2))"],.498584:["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],.237479:["f(1/x*1/(a+b*x)**2,1/a*1/(a+b*x)-1/a**2*log((a+b*x)/x))"],3.040375:["f(1/x*1/(a+b*x)**3,1/a**3*(1/2*((2*a+b*x)/(a+b*x))**2+log(x/(a+b*x))))"],.521902:["f(1/x**2*1/(a+b*x),-1/(a*x)+b/a**2*log((a+b*x)/x))"],.446014:["f(1/x**3*1/(a+b*x),(2*b*x-a)/(2*a**2*x**2)+b**2/a**3*log(x/(a+b*x)))"],.248586:["f(1/x**2*1/(a+b*x)**2,-(a+2*b*x)/(a**2*x*(a+b*x))+2*b/a**3*log((a+b*x)/x))"],.464469:["f(x/(a+b*x**2),1/2*1/b*log(a+b*x**2))"],.443716:["f(x**2/(a+b*x**2),x/b-a/b*integral(1/(a+b*x**2),x))"],.236382:["f(1/(a+b*x**2)**2,x/(2*a*(a+b*x**2))+1/2*1/a*integral(1/(a+b*x**2),x))"],.508931:["f(1/x*1/(a+b*x**2),1/2*1/a*log(x**2/(a+b*x**2)))"],.532733:["f(1/x**2*1/(a+b*x**2),-1/(a*x)-b/a*integral(1/(a+b*x**2),x))"],.480638:["f(1/(a+b*x**3),1/3*1/a*(a/b)**(1/3)*(1/2*log(((a/b)**(1/3)+x)**3/(a+b*x**3))+sqrt(3)*arctan((2*x-(a/b)**(1/3))*(a/b)**(-1/3)/sqrt(3))))"],.438648:["f(x**2/(a+b*x**3),1/3*1/b*log(a+b*x**3))"],.459164:["f(x/(a+b*x**4),1/2*sqrt(b/a)/b*arctan(x**2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x**4),1/4*sqrt(-b/a)/b*log((x**2-sqrt(-a/b))/(x**2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x**3/(a+b*x**4),1/4*1/b*log(a+b*x**4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)**3))"],1.384221:["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)**3)/15/b**2)"],1.322374:["f(x**2*sqrt(a+b*x),2*(8*a**2-12*a*b*x+15*b**2*x**2)*sqrt((a+b*x)**3)/105/b**3)"],1.516728:["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],1.587665:["f(sqrt(a+b*x)/x**2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],.659314:["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b**2)"],.629856:["f(x**2/sqrt(a+b*x),2/15*(8*a**2-4*a*b*x+3*b**2*x**2)*sqrt(a+b*x)/b**3)"],.722428:["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],.756216:["f(1/x**2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],1.434156:["f(sqrt(x**2+a),1/2*(x*sqrt(x**2+a)+a*log(x+sqrt(x**2+a))))","f(sqrt(a-x**2),1/2*(x*sqrt(a-x**2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x**2+b),x*sqrt(a*x**2+b)/2+b*log(x*sqrt(a)+sqrt(a*x**2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x**2+b),x*sqrt(a*x**2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],.729886:["f(1/x*1/sqrt(x**2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x**2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x**2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x**2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x**2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x**2+a)/x,sqrt(x**2+a)-sqrt(a)*log((sqrt(a)+sqrt(x**2+a))/x),or(not(number(a)),a>0))","f(sqrt(x**2+a)/x,sqrt(x**2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x**2)/x,sqrt(a-x**2)-sqrt(a)*log((sqrt(a)+sqrt(a-x**2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x**2+a),sqrt(x**2+a))","f(x/sqrt(a-x**2),-sqrt(a-x**2))"],1.370077:["f(x*sqrt(x**2+a),1/3*sqrt((x**2+a)**3))","f(x*sqrt(a-x**2),-1/3*sqrt((a-x**2)**3))"],1.730087:["f(sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),1/4*(x*sqrt((x**2+a**(1/3))**3)+3/2*a**(1/3)*x*sqrt(x**2+a**(1/3))+3/2*a**(2/3)*log(x+sqrt(x**2+a**(1/3)))))","f(sqrt(-a+x**6-3*a**(1/3)*x**4+3*a**(2/3)*x**2),1/4*(x*sqrt((x**2-a**(1/3))**3)-3/2*a**(1/3)*x*sqrt(x**2-a**(1/3))+3/2*a**(2/3)*log(x+sqrt(x**2-a**(1/3)))))"],.578006:["f(1/sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),x/a**(1/3)/sqrt(x**2+a**(1/3)))"],"0.552180":["f(x/sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),-1/sqrt(x**2+a**(1/3)))"],1.652787:["f(x*sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),1/5*sqrt((x**2+a**(1/3))**5))"],1.308862:["f(x**2*sqrt(x**2+a),1/4*x*sqrt((x**2+a)**3)-1/8*a*x*sqrt(x**2+a)-1/8*a**2*log(x+sqrt(x**2+a)))","f(x**2*sqrt(a-x**2),-x/4*sqrt((a-x**2)**3)+1/8*a*(x*sqrt(a-x**2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],1.342944:["f(x**3*sqrt(x**2+a),(1/5*x**2-2/15*a)*sqrt((x**2+a)**3),and(number(a),a>0))","f(x**3*sqrt(x**2+a),sqrt((x**2+a)**5)/5-a*sqrt((x**2+a)**3)/3,and(number(a),a<0))","f(x**3*sqrt(a-x**2),(-1/5*x**2-2/15*a)*sqrt((a-x**2)**3),or(not(number(a)),a>0))","f(sqrt(a-x**2)/x**3,-1/2*sqrt(a-x**2)/x**2+1/2*log((sqrt(a)+sqrt(a-x**2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x**2)/x**4,-1/3*sqrt((a-x**2)**3)/a/x**3,or(not(number(a)),a>0))"],.636358:["f(x**2/sqrt(x**2+a),1/2*x*sqrt(x**2+a)-1/2*a*log(x+sqrt(x**2+a)))","f(x**2/sqrt(a-x**2),-x/2*sqrt(a-x**2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],.652928:["f(x**3/sqrt(x**2+a),1/3*sqrt((x**2+a)**3)-a*sqrt(x**2+a))","f(1/x**3*1/sqrt(x**2+a),-1/2*sqrt(x**2+a)/a/x**2+1/2*log((sqrt(a)+sqrt(x**2+a))/x)/a**(3/2),or(not(number(a)),a>0))","f(1/x**3*1/sqrt(x**2-a),1/2*sqrt(x**2-a)/a/x**2+1/2*1/(a**(3/2))*arcsec(x/(a**(1/2))),or(not(number(a)),a>0))"],.764022:["f(1/x**2*1/sqrt(x**2+a),-sqrt(x**2+a)/a/x)","f(1/x**2*1/sqrt(a-x**2),-sqrt(a-x**2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x**2*sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),1/6*x*sqrt((x**2+a**(1/3))**5)-1/24*a**(1/3)*x*sqrt((x**2+a**(1/3))**3)-1/16*a**(2/3)*x*sqrt(x**2+a**(1/3))-1/16*a*log(x+sqrt(x**2+a**(1/3))),or(not(number(a)),a>0))","f(x**2*sqrt(-a-3*a**(1/3)*x**4+3*a**(2/3)*x**2+x**6),1/6*x*sqrt((x**2-a**(1/3))**5)+1/24*a**(1/3)*x*sqrt((x**2-a**(1/3))**3)-1/16*a**(2/3)*x*sqrt(x**2-a**(1/3))+1/16*a*log(x+sqrt(x**2-a**(1/3))),or(not(number(a)),a>0))"],1.620055:["f(x**3*sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),1/7*sqrt((x**2+a**(1/3))**7)-1/5*a**(1/3)*sqrt((x**2+a**(1/3))**5),or(not(number(a)),a>0))","f(x**3*sqrt(-a-3*a**(1/3)*x**4+3*a**(2/3)*x**2+x**6),1/7*sqrt((x**2-a**(1/3))**7)+1/5*a**(1/3)*sqrt((x**2-a**(1/3))**5),or(not(number(a)),a>0))"],.332117:["f(1/(x-a)/sqrt(x**2-a**2),-sqrt(x**2-a**2)/a/(x-a))","f(1/(x+a)/sqrt(x**2-a**2),sqrt(x**2-a**2)/a/(x+a))"],1.571443:["f(sqrt(a-x**2)/x**2,-sqrt(a-x**2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],1.690994:["f(sin(a*x),-cos(a*x)/a)"],1.055979:["f(cos(a*x),sin(a*x)/a)"],1.116714:["f(tan(a*x),-log(cos(a*x))/a)"],.895484:["f(1/tan(a*x),log(sin(a*x))/a)"],.946989:["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],.591368:["f(1/sin(a*x),log(tan(a*x/2))/a)"],2.859462:["f(sin(a*x)**2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)**3,-cos(a*x)*(sin(a*x)**2+2)/(3*a))","f(sin(a*x)**4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],1.115091:["f(cos(a*x)**2,x/2+sin(2*a*x)/(4*a))"],1.081452:["f(cos(a*x)**3,sin(a*x)*(cos(a*x)**2+2)/(3*a))","f(cos(a*x)**4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],.349716:["f(1/sin(a*x)**2,-1/(a*tan(a*x)))"],.896788:["f(1/cos(a*x)**2,tan(a*x)/a)"],1.785654:["f(sin(a*x)*cos(a*x),sin(a*x)**2/(2*a))"],"3.188560":["f(sin(a*x)**2*cos(a*x)**2,-sin(4*a*x)/(32*a)+x/8)"],1.516463:["f(sin(a*x)/cos(a*x)**2,1/(a*cos(a*x)))"],2.707879:["f(sin(a*x)**2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],.369293:["f(cos(a*x)/sin(a*x)**2,-1/(a*sin(a*x)))"],.560019:["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],.530332:["f(1/(sin(a*x)*cos(a*x)**2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],.331177:["f(1/(sin(a*x)**2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],.313621:["f(1/(sin(a*x)**2*cos(a*x)**2),-2/(a*tan(2*a*x)))"],3.172365:["f(sin(a+b*x),-cos(a+b*x)/b)"],1.127162:["f(cos(a+b*x),sin(a+b*x)/b)"],.352714:["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b**2-a**2)*log((a*tan(x/2)+b-sqrt(b**2-a**2))/(a*tan(x/2)+b+sqrt(b**2-a**2))),b**2-a**2)"],.454515:["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b**2-a**2)*log((sqrt(b**2-a**2)*tan(x/2)+a+b)/(sqrt(b**2-a**2)*tan(x/2)-a-b)),b**2-a**2)"],1.615441:["f(x*sin(a*x),sin(a*x)/a**2-x*cos(a*x)/a)"],1.543263:["f(x**2*sin(a*x),2*x*sin(a*x)/a**2-(a**2*x**2-2)*cos(a*x)/a**3)"],1.008798:["f(x*cos(a*x),cos(a*x)/a**2+x*sin(a*x)/a)"],.963724:["f(x**2*cos(a*x),2*x*cos(a*x)/a**2+(a**2*x**2-2)*sin(a*x)/a**3)"],1.611938:["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a**2*x**2)/a)"],1.791033:["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a**2*x**2)/a)"],1.123599:["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a**2*x**2)/a)"],1.387031:["f(x*log(a*x),x**2*log(a*x)/2-x**2/4)"],1.325058:["f(x**2*log(a*x),x**3*log(a*x)/3-1/9*x**3)"],2.108018:["f(log(x)**2,x*log(x)**2-2*x*log(x)+2*x)"],.403214:["f(1/x*1/(a+log(x)),log(a+log(x)))"],2.269268:["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],2.486498:["f(log(a*x+b)/x**2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],1.769733:["f(sinh(x),cosh(x))"],1.883858:["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],1.690661:["f(x*sinh(x),x*cosh(x)-sinh(x))"],1.799688:["f(x*cosh(x),x*sinh(x)-cosh(x))"],3.131954:["f(sinh(x)**2,sinh(2*x)/4-x/2)"],2.579685:["f(tanh(x)**2,x-tanh(x))"],3.548923:["f(cosh(x)**2,sinh(2*x)/4+x/2)"],1.058866:["f(x**3*exp(a*x**2),exp(a*x**2)*(x**2/a-1/(a**2))/2)"],"1.235270":["f(x**3*exp(a*x**2+b),exp(a*x**2)*exp(b)*(x**2/a-1/(a**2))/2)"],1.130783:["f(exp(a*x**2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],1.078698:["f(erf(a*x),x*erf(a*x)+exp(-a**2*x**2)/a/sqrt(pi))"],"2.573650":["f(x**2*(1-x**2)**(3/2),(x*sqrt(1-x**2)*(-8*x**4+14*x**2-3)+3*arcsin(x))/48)","f(x**2*(1-x**2)**(5/2),(x*sqrt(1-x**2)*(48*x**6-136*x**4+118*x**2-15)+15*arcsin(x))/384)"],2.640666:["f(x**4*(1-x**2)**(3/2),(-x*sqrt(1-x**2)*(16*x**6-24*x**4+2*x**2+3)+3*arcsin(x))/128)"],1.086487:["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a**2))"],1.267493:["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a**2))"],1.037943:["f(x**2*exp(a*x),exp(a*x)*(a**2*x**2-2*a*x+2)/(a**3))"],1.210862:["f(x**2*exp(a*x+b),exp(a*x+b)*(a**2*x**2-2*a*x+2)/(a**3))"],"1.064970":["f(x**3*exp(a*x),exp(a*x)*x**3/a-3/a*integral(x**2*exp(a*x),x))"],1.242392:["f(x**3*exp(a*x+b),exp(a*x+b)*x**3/a-3/a*integral(x**2*exp(a*x+b),x))"]};let kO=class extends Fw{constructor(t){super("defint",Rr,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){let r=e.valueOf(Jf(t)),n=Xf(t);for(;h(n);){const t=e.valueOf(d(n));n=m(n);const s=e.valueOf(d(n));n=m(n);const i=e.valueOf(d(n));n=m(n),r=qO(r,t,e);const o=e.valueOf(Ip(r,t,i,e)),a=e.valueOf(Ip(r,t,s,e));r=e.subtract(o,a)}return r}(t,this.$);return[!e.equals(t)?q:A,e]}};const RO=new class{create(t){return new kO(t)}};let IO=class extends Fw{constructor(t){super("degree",Ir,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(th(t)),n=e.valueOf(Jf(r));return Ib(n,l.equals(r)?Vh(n):r,e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const PO=new class{create(t){return new IO(t)}};let FO=class extends Fw{constructor(t){super("denominator",Pr,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){return dm(e.valueOf(Jf(t)),e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const UO=new class{create(t){return new FO(t)}};let CO=class extends y_{constructor(t){super("derivative_2_mul_any",Qm,x_(h,kp(ke)),ie,t),this.hash=di(Qm,ke,li)}transform2(t,e,r,n){const s=ly(e,r,this.$);return[!s.equals(n)?q:T,s]}};const DO=new class{create(t){return new CO(t)}};let BO=class extends y_{constructor(t){super("derivative_2_pow_any",Qm,x_(h,kp(Ie)),Qw,t),this.hash=di(Qm,Ie,li)}transform2(t,e,r,n){const s=cy(e,r,this.$);return[!s.equals(n)?q:T,s]}};const KO=new class{create(t){return new BO(t)}};function zO(t,e){let r,n,s=e.valueOf(d(t.cdr)),i=m(t.cdr);const o=e.valueOf(d(i));for(l.equals(o)?(r=Vh(s),n=l):ee(o)?(r=Vh(s),n=o):(r=o,i=m(i),n=e.valueOf(d(i)));;){let t;if(ee(n)){if(t=vf(n),isNaN(t))throw new Error("nth derivative: check n")}else t=1;let o=s;if(t>=0)for(let n=0;n<t;n++)o=hy(o,r,e);else{t=-t;for(let n=0;n<t;n++)o=qO(o,r,e)}if(s=o,l===n)break;if(ee(n)){if(i=m(i),n=e.valueOf(d(i)),l===n)break;ee(n)||(r=n,i=m(i),n=e.valueOf(d(i)))}else r=n,i=m(i),n=e.valueOf(d(i))}return s}let QO=class extends Fw{constructor(t){super("derivative",Qm,t),this.hash=_i(this.opr)}transform(t){const e=zO(t,this.$);return[!e.equals(t)?q:A,e]}};const ZO=new class{create(t){return new QO(t)}};let GO=class extends Fw{constructor(t,e,r,n){super(t,e,n),this.oprNew=r}transform(t){if(h(t)&&function(t,e){const r=e.opr;return!!ie(r)&&t.equalsSym(r)}(this.opr,t)){const e=this.$;if(p(e.getSymbolValue(this.opr))){const r=c(this.oprNew,...t.tail());return[q,e.valueOf(r)]}return[T,t]}return[T,t]}};const HO=new class{constructor(t,e,r){this.name=t,this.opr=e,this.oprNew=r}create(t){return new GO(this.name,this.opr,this.oprNew,t)}}("d_to_derivative",B("d"),Qm);let VO=class extends Uw{constructor(t){super("determinant",Fr,Qw,t),this.hash=gi(Fr,li)}transform1(t,e,r){const n=function(t,e){return Hx(e.valueOf(Jf(t)),e)}(r,this.$);return[!n.equals(r)?q:T,n]}};const jO=new class{create(t){return new VO(t)}};let WO=class extends Fw{constructor(t){super("dim",Ur,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(Jf(t)),n=h(Xf(t))?my(th(t),e):1;return v(r)?n<1||n>r.ndim?t:Ft(r.dim(n-1)):Ut}(t,this.$);return[!e.equals(t)?q:A,e]}};const JO=new class{create(t){return new WO(t)}};let XO=class extends Fw{constructor(t){super("dirac",Cr,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){return Xx(e.valueOf(Jf(t)),e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const YO=new class{create(t){return new XO(t)}};class tE extends y_{constructor(t,e,r){super(`${e} left-distributive over ${r}`,e,Qw,function(t){return function(e){return h(e)&&If(e,t)}}(r),t),this.phases=L,this.hash=pi(e,li,r)}transform2(t,e,r,n){const s=this.$,i=r.opr,o=e,a=r.tail().map((function(e){return s.valueOf(c(t,o,e))})),u=s.valueOf(c(i,...a));return[q,u]}}class eE extends y_{constructor(t,e,r){super(`${e} right-distributive over ${r}`,e,function(t){return function(e){return h(e)&&If(e,t)}}(r),Qw,t),this.phases=L,this.hash=di(e,r,li)}transform2(t,e,r,n){const s=this.$,i=e.opr,o=r,a=e.tail().map((function(e){return s.valueOf(c(t,e,o))})),u=s.valueOf(c(i,...a));return[q,u]}}class rE{constructor(t,e){this.upper=t,this.lower=e}create(t){return new tE(t,this.upper,this.lower)}}class nE{constructor(t,e){this.upper=t,this.lower=e}create(t){return new eE(t,this.upper,this.lower)}}function sE(t,e){return new rE(t,e)}function iE(t,e){return new nE(t,e)}function oE(t,e){const r=aE(t,e),n=r.length;return new y([n],function(t,e){const r=t.map((function(t,e){return{value:t,index:e}}));r.sort((function(t,r){const n=e.compareFn(ke)(t.value,r.value);return e.isScalar(t.value)||e.isScalar(r.value)?n:t.index-r.index}));const n=r.map((function(t){return t.value}));return n}(r,e))}function aE(t,e){const r=[];if(ee(t))r.push(...Em(vf(t)));else if(h(t)&&Uf(t))r.push(...function(t,e){const r=h(t)?t.tail().reduce((function(t,r){return Kd(t,r,e)})):d(t),n=[];let s=r;if(e.isOne(s))return n.push(t,Ut),n;if(ee(s))n.push(...Em(vf(s)));else if(Cf(s)){const t=m(s);ee(d(t))?n.push(...Em(vf(d(t)))):n.push(d(t),Ut),h(t)&&t.tail().forEach((t=>n.push(t,Ut)))}else n.push(s,Ut);s=Ap(s,e);const i=h(t)?t.tail().reduce(((t,r)=>e.add(t,e.multiply(s,r))),Jt):m(t);return n.push(i,Ut),n}(t,e));else if(Cf(t)){if(ee(d(t=m(t)))&&(r.push(...Em(vf(d(t)))),t=m(t)),h(t)){const e=[...t].map((t=>Df(t)?[Jf(t),th(t)]:[t,Ut]));r.push(...e.flat())}}else Df(t)?r.push(Jf(t),th(t)):r.push(t,Ut);const n=r.length;return r.push(Ut),uE(r,0,n,e),r.slice(n)}function uE(t,e,r,n){const s=t.pop();if(e===r)return void t.push(s);const i=t[e+0],o=vf(t[e+1]);if(!isNaN(o))for(let u=0;u<=Math.abs(o);u++)t.push(n.multiply(s,n.power(i,Ft(((a=o)<0?-1:a>0?1:0)*u)))),uE(t,e+2,r,n);var a}let cE=class extends Fw{constructor(t){super("divisors",Dr,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){return oE(e.valueOf(Jf(t)),e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const lE=new class{create(t){return new cE(t)}};let fE=class extends Fw{constructor(t){super("do",Br,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){let r=d(t),n=m(t);for(;h(n);)r=e.valueOf(d(n)),n=m(n);return r}(t,this.$);return[!e.equals(t)?q:A,e]}};const hE=new class{create(t){return new fE(t)}};let pE=0;const dE=[],mE=[];function gE(t,e){return function(t,e){const{arg:r,invalid:n}=_E(t,e);if(n)return c(Qr,n);const[s,i]=xE(Qr,r);return s}(t,e)}function wE(t,e){return function(t,e){const{arg:r,invalid:n}=_E(t,e);if(n)return c(Zr,n);const[s,i]=xE(Zr,r);return i}(t,e)}function _E(t,e){if(!v(t=e.valueOf(uh(e.valueOf(Jf(t)),e))))return{invalid:t};2===t.ndim&&t.dim(0)===t.dim(1)||er("eigen: argument is not a square matrix"),pE=t.dim(0),function(t){for(let e=0;e<pE;e++)for(let r=0;r<pE;r++)if(!ot(t.elem(pE*e+r)))return!1;return!0}(t)||er("eigen: matrix is not numerical");for(let e=0;e<pE-1;e++)for(let r=e+1;r<pE;r++){const n=t.elem(pE*e+r),s=t.elem(pE*r+e);Math.abs(n.d-s.d)>1e-10&&er("eigen: matrix is not symmetrical")}return{arg:t}}function xE(t,e){for(let t=0;t<pE*pE;t++)dE[t]=0;for(let t=0;t<pE*pE;t++)mE[t]=0;for(let t=0;t<pE;t++){dE[pE*t+t]=e.elem(pE*t+t).d;for(let r=t+1;r<pE;r++)dE[pE*t+r]=e.elem(pE*t+r).d,dE[pE*r+t]=e.elem(pE*t+r).d}for(let t=0;t<pE;t++){mE[pE*t+t]=1;for(let e=t+1;e<pE;e++)mE[pE*t+e]=0,mE[pE*e+t]=0}let r=0;for(r=0;r<100&&0!==yE();r++);const n=e.copyDimensions(),s=e.copyElements();if(t.equals(zr)||t.equals(Qr))for(let t=0;t<pE;t++)for(let e=0;e<pE;e++)s[pE*t+e]=J(dE[pE*t+e]);const i=e.copyDimensions(),o=e.copyElements();if(t.equals(zr)||t.equals(Zr))for(let t=0;t<pE;t++)for(let e=0;e<pE;e++)o[pE*t+e]=J(mE[pE*t+e]);return[new y(n,s),new y(i,o)]}function yE(){let t=0;for(let e=0;e<pE-1;e++)for(let r=e+1;r<pE;r++)0!==dE[pE*e+r]&&(vE(e,r),t++);return t}function vE(t,e){const r=.5*(dE[pE*t+t]-dE[pE*e+e])/dE[pE*t+e];let n=1/(Math.abs(r)+Math.sqrt(r*r+1));r<0&&(n=-n);const s=1/Math.sqrt(n*n+1),i=n*s;for(let r=0;r<pE;r++){const n=dE[pE*t+r],o=dE[pE*e+r];dE[pE*t+r]=s*n+i*o,dE[pE*e+r]=s*o-i*n}for(let r=0;r<pE;r++){const n=dE[pE*r+t],o=dE[pE*r+e];dE[pE*r+t]=s*n+i*o,dE[pE*r+e]=s*o-i*n}for(let r=0;r<pE;r++){const n=mE[pE*t+r],o=mE[pE*e+r];mE[pE*t+r]=s*n+i*o,mE[pE*e+r]=s*o-i*n}dE[pE*t+e]=0,dE[pE*e+t]=0}let bE=class extends Fw{constructor(t){super("eigenval",Qr,t),this.hash=_i(this.opr)}transform(t){const e=gE(t,this.$);return[!e.equals(t)?q:A,e]}};const OE=new class{create(t){return new bE(t)}};let EE=class extends Fw{constructor(t){super("eigenvec",Zr,t),this.hash=_i(this.opr)}transform(t){const e=wE(t,this.$);return[!e.equals(t)?q:A,e]}};const SE=new class{create(t){return new EE(t)}};let TE=class extends Fw{constructor(t){super("eigen",zr,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const{arg:r}=_E(t,e);r||er("eigen: argument is not a square matrix");const[n,s]=xE(zr,r);return e.setSymbolValue(B("D"),n),e.setSymbolValue(B("Q"),s),l}(t,this.$);return[!e.equals(t)?q:A,e]}};const qE=new class{create(t){return new TE(t)}};function AE(t){if(0===t)return 1;const e=Math.abs(t),r=1/(1+.5*e),n=r*Math.exp(-e*e-1.26551223+r*(1.00002368+r*(.37409196+r*(.09678418+r*(r*(.27886807+r*(r*(1.48851587+r*(.17087277*r-.82215223))-1.13520398))-.18628806)))));return t>=0?n:2-n}let ME=class extends Fw{constructor(t){super("erf",Gr,t),this.hash=_i(this.opr)}transform(t){const e=this.$,r=function(t,e){if(ot(t))return J(1-AE(t.d));if(e.is_zero(t))return Jt;if(qd(t))return e.negate(c(Gr,e.negate(t)));return c(Gr,t)}(e.valueOf(Jf(t)),e);return[!r.equals(t)?q:A,r]}};const NE=new class{create(t){return new ME(t)}};let $E=class extends Fw{constructor(t){super("erfc",Hr,t),this.hash=_i(this.opr)}transform(t){const e=this.$,r=function(t,e){if(ot(t)){return J(AE(t.d))}if(e.is_zero(t))return Ut;return c(Hr,t)}(e.valueOf(Jf(t)),e);return[!r.equals(t)?q:A,r]}};const LE=new class{create(t){return new $E(t)}},kE="undefined";class RE{constructor(t){}get key(){return Gs}get name(){return"ErrExtension"}evaluate(t,e){return this.transform(u(t,e))}transform(t){return[t instanceof Vs?A:T,t]}valueOf(t,e){throw new Error("ErrExtension.valueOf Method not implemented.")}isImag(t){throw new Error("ErrExtension Method not implemented.")}isKind(t){return t instanceof Vs}isMinusOne(t,e){throw new Error("ErrExtension.isMinusOne Method not implemented.")}isOne(){return!1}isReal(t){throw new Error("ErrExtension.isReal Method not implemented.")}isScalar(t){return!1}isZero(){return!1}subst(t,e,r){return this.isKind(e)&&t.equals(e)?r:t}toInfixString(t,e){return kE}toLatexString(t,e){return kE}toListString(t,e){return kE}}const IE=new Oi((function(t){return new RE(t)}));let PE=class extends Fw{constructor(t){super("eval",Vr,t),this.hash=_i(this.opr)}transform(t){const e=this.$;let r=t,n=e.valueOf(Jf(r));for(r=Xf(r);h(r);){n=Ip(n,e.valueOf(d(r)),e.valueOf(Jf(r)),e),r=Xf(r)}return[q,e.valueOf(n)]}};const FE=new class{create(t){return new PE(t)}},UE=Q(F.E),CE=Q(F.exp),DE=Q(F.pow);class BE extends Uw{constructor(t){super("exp",CE,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){const n=this.$;return n.isExpanding()?[q,Fd(DE,UE,e,n)]:[T,r]}}const KE=new class{create(t){return new BE(t)}},zE=Q(F.add),QE=Q(F.exp),ZE=Q(F.multiply);let GE=class extends Cw{constructor(t){super(QE,zE,t)}transform1(t,e,r){const n=this.$;return[q,n.valueOf(u(ZE,e.argList.map(n.exp)))]}};const HE=new class{create(t){return new GE(t)}};class VE extends Uw{constructor(t){super("exp_flt",Jo,ot,t),this.hash=gi(this.opr,ii)}transform1(t,e){return[q,J(Math.exp(e.toNumber()))]}}const jE=new class{create(t){return new VE(t)}};class WE extends Uw{constructor(t){super("exp_rat",B("exp"),Si,t),this.hash=gi(this.opr,ii)}transform1(t,e){return e.isZero()?[q,Ut]:e.isOne()?[q,Ke]:[q,this.$.power(Ke,e)]}}const JE=new class{create(t){return new WE(t)}};function XE(t){const e=[];return Uf(t)?t.tail().forEach((t=>e.push(...YE(t)))):e.push(...YE(t)),e}function YE(t){return Cf(t)?t.tail():[t]}function tS(t,e,r,n){const s=Pp(t,r,n);let i=s.length-1;const o=Pp(e,r,n),a=o.length-1;let u=i-a,c=Jt;for(;u>=0;){const t=Mp(s[i],o[a],n);for(let e=0;e<=a;e++)s[u+e]=n.subtract(s[u+e],n.multiply(o[e],t));c=n.add(c,n.multiply(t,n.power(r,Ft(u)))),i--,u--}return c}function eS(t,e,r){if(v(t))return function(t,e,r){return t.map((function(t){return eS(t,e,r)}))}(t,e,r);if(Uf(t))return t.tail().reduce(((t,n)=>r.add(t,eS(n,e,r))),Jt);let n=Sm(t,r),s=dm(t,r);if([s,n]=function(t,e,r,n){const s=[...XE(t),...XE(e)];let i=0;for(let t=0;t<s.length;t++){const e=s[t];if(!Df(e))continue;if(!Jf(e).equals(r))continue;const n=vf(th(e));isNaN(n)||n<i&&(i=n)}if(0===i)return[t,e];return t=n.multiply(t,n.power(r,Ft(-i))),e=n.multiply(e,n.power(r,Ft(-i))),[t,e]}(s,n,e,r),(tp(n,r)||tp(s,r))&&(!ip(s,e)||tp(s,r)))return t;const i=tS(n,s,e,r);if(n=r.subtract(n,r.multiply(s,i)),r.is_zero(n))return i;s=r.factorize(s,e);const o=function(t,e,r){const n=[];Cf(t)?t.tail().forEach((s=>n.push(...rS(t,s,e,r)))):n.push(...rS(t,t,e,r));const s=n.length;if(1===s)return n[0];const i=[s,s],o=new Array(s*s);for(let t=0;t<s;t++)for(let i=0;i<s;i++){const a=r.power(e,Ft(t)),u=Np(n[i],a,r);o[s*t+i]=$p(u,e,r)}return new y(i,o)}(s,e,r);let a;if(n=function(t,e,r,n){if(!v(e))return t;const s=e.dim(0),i=[s],o=new Array(s);for(let e=0;e<s;e++){const s=Np(t,n.power(r,Ft(e)),n);o[e]=$p(s,r,n)}return new y(i,o)}(n,o,e,r),s=function(t,e,r,n){if(!v(e))return Ap(t,n);let s=[];Cf(t)?t.tail().forEach((t=>{s.push(...sS(t,r,n))})):s=sS(t,r,n);const i=s.length;return new y([i],s)}(s,o,e,r),v(o)){const t=ir(Jx,o,r);a=r.inner(r.inner(t,n),s)}else{const t=Np(n,o,r);a=r.multiply(t,s)}return r.add(a,i)}function rS(t,e,r,n){let s,i=0;if(!e.contains(r))return[];const o=or(nS,t,e,n);Df(e)?(i=vf(th(e)),s=Jf(e)):(i=1,s=e);const a=[],u=vf(Ib(s,r,n));for(let t=0;t<i;t++)for(let e=0;e<u;e++){const i=or(Ud,o,n.power(s,Ft(t)),n),u=or(Ud,i,n.power(r,Ft(e)),n);a.push(u)}return a}function nS(t,e,r){let n=Ut;if(Cf(t)){const s=[];t.tail().forEach((t=>{t.equals(e)||s.push(r.valueOf(t))})),n=Dd(s,r)}return n}function sS(t,e,r){let n=1;if(!t.contains(e))return[];Df(t)&&(n=vf(th(t)),t=Jf(t));const s=[],i=vf(Ib(t,e,r));for(let o=n;o>0;o--)for(let n=0;n<i;n++){const i=Ap(r.power(t,Ft(o)),r),a=r.power(e,Ft(n));s.push(r.multiply(i,a))}return s}let iS=class extends Fw{constructor(t){super("expand",Wr,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(Jf(t)),n=e.valueOf(th(t));return eS(r,l===n?Vh(r):n,e)}(t,this.$);return[e.equals(t)?T:q,e]}};const oS=new class{create(t){return new iS(t)}};let aS=class extends Fw{constructor(t){super("expcos",Jr,t),this.hash=_i(this.opr)}transform(t){const e=this.$;if(e.isExpanding()){const r=tb(e.valueOf(Jf(t)),e);return[!r.equals(t)?q:A,r]}return[T,t]}};const uS=new class{create(t){return new aS(t)}};let cS=class extends Fw{constructor(t){super("expsin",Xr,t),this.hash=_i(this.opr)}transform(t){const e=this.$;if(e.isExpanding()){const r=eb(e.valueOf(Jf(t)),e);return[!r.equals(t)?q:A,r]}return[T,t]}};const lS=new class{create(t){return new cS(t)}};function fS(t,e){const r=e.valueOf(Od(t,1)),n=e.valueOf(Od(t,2));let s=Om(r,l===n?Vh(r):n,e);const i=rh(t);return h(i)&&(s=[...i].reduce(((t,r)=>function(t,e,r){if(Cf(t)){const n=[];return t.tail().forEach((t=>bm(n,t,e,r))),Bd(n,r)}const n=[];return bm(n,t,e,r),n[0]}(t,e.valueOf(r),e)),s)),s}let hS=class extends Fw{constructor(t){super("factor",Yr,t),this.hash=_i(this.opr)}transform(t){const e=fS(t,this.$);return[!e.equals(t)?q:A,e]}};const pS=new class{create(t){return new hS(t)}};let dS=class extends Fw{constructor(t){super("factorial",tn,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){return im(e.valueOf(Jf(t)))}(t,this.$);return[!e.equals(t)?q:A,e]}};const mS=new class{create(t){return new dS(t)}};let gS=class extends Fw{constructor(t){super("float",en,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){e.pushNativeDirective($.evaluatingAsFloat,!0);try{const r=Jf(t);jf(r),oh(r);const n=uh(e.valueOf(r),e);return e.valueOf(n)}finally{e.popNativeDirective()}}(t,this.$);return[e.equals(t)?T:q,e]}};const wS=new class{create(t){return new gS(t)}};function _S(t,e){const r=function(t,e){return function(t,e){if(!ee(t))return Nd(rn,t);if(ot(t))return J(Math.floor(t.d));if(yf(t))return t;let r=new Lt(mf(t.a,t.b),mt.one);Wh(t)&&(r=e.add(r,jt));return r}(t,e)}(e.valueOf(Jf(t)),e);return r}let xS=class extends Fw{constructor(t){super("floor",rn,t),this.hash=_i(this.opr)}transform(t){const e=_S(t,this.$);return[q,e]}};const yS=new class{create(t){return new xS(t)}};class vS extends Fw{constructor(t){super("for",nn,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=th(t);ie(r)||er("for: 2nd arg should be the variable to loop over");const n=my(sh(t),e);if(isNaN(n))return t;const s=my(ih(t),e);if(isNaN(s))return t;const i=e.getSymbolValue(r);try{for(let i=n;i<=s;i++)e.setSymbolValue(r,Ft(i)),e.valueOf(Jf(t))}finally{e.setSymbolValue(r,i)}return l}(t,this.$);return[!e.equals(t)?q:A,e]}}const bS=new class{create(t){return new vS(t)}};function OS(t,e){return function(t,e){if(te(t)&&Zs(t.a,1)&&Zs(t.b,2))return e.power(ar.Pi(e),Xt);if(te(t)&&Zs(t.a,3)&&Zs(t.b,2))return e.multiply(e.power(ar.Pi(e),Xt),Xt);if(qd(t))return Mp(e.multiply(ar.Pi(e),jt),e.multiply(e.multiply(Lm(e.multiply(ar.Pi(e),t),e),t),OS(e.negate(t),e)),e);if(Uf(t))return function(t,e){const r=m(t);if(te(d(r))&&Zs(d(r).a,1)&&Zs(d(r).b,1))return e.multiply(Jf(r),OS(Jf(r),e));if(te(d(r))&&Zs(d(r).a,-1)&&Zs(d(r).b,1))return Mp(OS(Jf(r),e),e.add(Jf(r),jt),e);return c(on,t)}(t,e);return c(on,t)}(t,e)}let ES=class extends Fw{constructor(t){super("gamma",on,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){return OS(e.valueOf(Jf(t)),e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const SS=new class{create(t){return new ES(t)}};let TS=class extends Fw{constructor(t){super("gcd",an,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){t=m(t);let r=e.valueOf(d(t));return h(t)&&(r=t.tail().reduce(((t,r)=>Kd(t,e.valueOf(r),e)),r)),r}(t,this.$);return[!e.equals(t)?q:A,e]}};const qS=new class{create(t){return new TS(t)}};let AS=class{constructor(t,e,r,n,s){this.name=t,this.hash=e,this.sym=r,this.guardL=n,this.guardR=s}create(t){return new MS(this.name,this.hash,this.sym,this.guardL,this.guardR,t)}},MS=class extends y_{constructor(t,e,r,n,s,i){super(t,r,x_(h,rx(r,Qw,n)),s,i),this.name=t,this.hash=e}transform2(t,e,r){const n=e.lhs,s=e.rhs,i=r;return[q,c(t,c(e.opr,n,i),s)]}};function NS(t,e,r,n,s){return new AS(t,e,r,s,n)}let $S=class extends Fw{constructor(t){super("hermite",un,t),this.hash=_i(this.opr)}transform(t){const e=this.$;if(e.isExpanding()){const r=function(t,e){return ry(e.valueOf(Od(t,1)),e.valueOf(Od(t,2)),e)}(t,e);return[!r.equals(t)?q:A,r]}return[T,t]}};const LS=new class{create(t){return new $S(t)}};function kS(t,e){return function(t,e){const r=vf(t);if(r<2)return c(cn,t);const n=[r,r],s=new Array(r*r);for(let t=0;t<r;t++)for(let n=0;n<r;n++)s[t*r+n]=Ap(Ft(t+n+1),e);return new y(n,s)}(e.valueOf(Jf(t)),e)}let RS=class extends Fw{constructor(t){super("hilbert",cn,t),this.dependencies=[],this.hash=_i(this.opr)}transform(t){const e=kS(t,this.$);return[!e.equals(t)?q:A,e]}};const IS=new class{create(t){return new RS(t)}};class PS{constructor(t){}get key(){return ut.name}get hash(){return ni}get name(){return"HypExtension"}evaluate(t,e){return this.transform(u(t,e))}transform(t){return[t instanceof at?A:T,t]}valueOf(t,e){throw new Error("Hyp Method not implemented.")}isImag(t){return!1}isKind(t){return t instanceof at}isMinusOne(){return!1}isOne(){return!1}isReal(t){return!1}isScalar(t){return!0}isZero(){return!1}subst(t,e,r){return this.isKind(e)&&t.equals(e)?r:t}toInfixString(t,e){throw new Error("HypExtension.toInfixString Method not implemented.")}toLatexString(t,e){throw new Error("HypExtension.toLatexString Method not implemented.")}toListString(t){return t.printname}}const FS=new Oi((function(t){return new PS(t)})),US=Q(F.add),CS=Q(F.imag);let DS=class extends Cw{constructor(t){super(CS,US,t)}transform1(t,e,r){const n=this.$,s=e.argList.map((function(t){return n.valueOf(c(CS,t))}));return[T,n.valueOf(u(US,s))]}};const BS=new class{create(t){return new DS(t)}};let KS=class extends Uw{constructor(t){super("imag",ln,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){return[T,r]}};const zS=new class{create(t){return new KS(t)}},QS=Q(F.imag);let ZS=class extends Cw{constructor(t){super(QS,gr,t)}isKind(t){if(super.isKind(t)){return te(t.argList.head.argList.head)}return!1}transform1(t,e){return[q,Jt]}};const GS=new class{create(t){return new ZS(t)}},HS=Q(F.cos),VS=Q(F.imag);let jS=class extends Cw{constructor(t){super(VS,HS,t)}transform1(t,e,r){const n=this.$,s=e.argList.head;return n.is_real(s)?[q,Ut]:[T,r]}};const WS=new class{create(t){return new jS(t)}},JS=Q(F.exp),XS=Q(F.imag);let YS=class extends Cw{constructor(t){super(XS,JS,t)}transform1(t,e,r){const n=this.$,s=e.argList.head;return n.is_real(s)?[q,Jt]:[T,r]}};const tT=new class{create(t){return new YS(t)}},eT=Q(F.imag);let rT=class extends Uw{constructor(t){super("imag_flt",eT,ot,t),this.hash=gi(this.opr,ri)}transform1(t,e,r){return[T,Y]}};const nT=new class{create(t){return new rT(t)}},sT=Q(F.imag);let iT=class extends Uw{constructor(t){super("imag_imu",sT,ht,t),this.hash=gi(this.opr,si)}transform1(t,e,r){return[q,Ut]}};const oT=new class{create(t){return new iT(t)}},aT=Q(F.imag),uT=Q(F.log);let cT=class extends Cw{constructor(t){super(aT,uT,t)}isKind(t){if(super.isKind(t)){return te(t.argList.head.argList.head)}return!1}transform1(t,e){const r=this.$,n=e.argList.head;if(te(n)){if(n.isZero())return[q,new Vs(e)];if(n.isNegative())throw new Error(r.toInfixString(n));return[q,Jt]}throw new Error(r.toInfixString(n))}};const lT=new class{create(t){return new cT(t)}},fT=Q(F.imag),hT=Q(F.multiply);let pT=class extends Cw{constructor(t){super(fT,hT,t)}transform1(t,e,r){const n=this.$,s=[],i=[];[...e.argList].forEach((function(t){n.is_real(t)?s.push(t):i.push(t)}));const o=mT(s,n),a=mT(i,n);if(a.equals(e))return[T,r];const u=n.valueOf(c(fT,a)),l=n.valueOf(c(hT,o,u));return[q,l]}};const dT=new class{create(t){return new pT(t)}};function mT(t,e){return t.length>1?e.valueOf(c(hT,...t)):1===t.length?e.valueOf(t[0]):Ut}const gT=Q(F.real),wT=Q(F.multiply),_T=Q(F.imag);let xT=class extends Cw{constructor(t){super(_T,wT,t)}isKind(t){if(super.isKind(t)){return 1===wh(t.argList.head,ht)}return!1}transform1(t,e){const r=bh(e,ht),n=this.$.valueOf(c(gT,r));return[q,n]}};const yT=new class{create(t){return new xT(t)}},vT=Q(F.pow),bT=Q(F.imag);let OT=class extends Cw{constructor(t){super(bT,vT,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return jf(r)&&te(n)}return!1}transform1(t,e,r){return[q,Jt]}};const ET=new class{create(t){return new OT(t)}},ST=Q(F.pow),TT=Q(F.imag);let qT=class extends Cw{constructor(t){super(TT,ST,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return jf(r)&&ie(n)}return!1}transform1(t,e,r){const n=this.$,s=Mi(e.rhs);return n.is_real(s)?[q,Jt]:[T,r]}};const AT=new class{create(t){return new qT(t)}};function MT(t){if(te(t))return t;throw new Ai(`Expecting a Rat but got expression ${t}.`)}const NT=Q(F.PI),$T=Q(F.pow),LT=Q(F.imag);let kT=class extends Cw{constructor(t){super(LT,$T,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return te(r)&&te(n)}return!1}transform1(t,e,r){const n=this.$,s=MT(e.lhs);if(s.isMinusOne()){const t=MT(e.rhs);return[q,n.sin(n.multiply(t,NT))]}return s.isPositive()?[q,Jt]:[q,r]}};const RT=new class{create(t){return new kT(t)}},IT=Q(F.imag);let PT=class extends Uw{constructor(t){super("imag_rat",IT,te,t),this.hash=gi(this.opr,ii)}transform1(t,e,r){return[T,Jt]}};const FT=new class{create(t){return new PT(t)}},UT=Q(F.sin),CT=Q(F.imag);let DT=class extends Cw{constructor(t){super(CT,UT,t)}transform1(t,e,r){const n=this.$,s=e.argList.head;return n.is_real(s)?[q,Jt]:[T,r]}};const BT=new class{create(t){return new DT(t)}},KT=Q(F.imag);let zT=class extends Uw{constructor(t){super("imag_sym",KT,ie,t),this.hash=gi(this.opr,ai)}transform1(t,e,r){return this.$.is_real(e)?[T,Jt]:[T,r]}};const QT=new class{create(t){return new zT(t)}};class ZT{constructor(t){this.$=t}get key(){return ft.name}get hash(){return si}get name(){return"ImuExtension"}isImag(t){return!0}isKind(t){return ft.equals(t)}isMinusOne(t){return!1}isOne(t){return!1}isNil(t){return!1}isReal(t){return!1}isScalar(t){return!0}isZero(t){return!1}subst(t,e,r){return t.equals(e)?r:t}toInfixString(t){return"i"}toLatexString(t){return"\\imath"}toListString(t){return this.$.getSymbolPrintName(Ve)}evaluate(t,e){return[A,u(t,e)]}transform(t){return[A,t]}valueOf(t){return t}}const GT=new class{create(t){return new ZT(t)}};function HT(t,e){if(e>0){const r=t.argList;return h(r)?HT(r,e-1):r}return t}function VT(t,e){const r=t.ndim,n=e.length;if(n>r)throw new Error("too many indices for tensor");let s=0;for(let r=0;r<n;r++){const n=vf(e[r]);if(n<1||n>t.dim(r))throw new Error("index out of range");s=s*t.dim(r)+n-1}if(r===n)return t.elem(s);s=t.sliceDimensions(n).reduce(((t,e)=>t*e),s);const i=t.sliceDimensions(n).reduce(((t,e)=>t*e),1),o=t.sliceDimensions(n),a=new Array(i);for(let e=0;e<i;e++)a[e]=t.elem(s+e);return new y(o,a)}function jT(t,e){const r=e.valueOf(Od(t,1));return v(r)?function(t,e,r){if(p(e))return t;if(h(e)){const n=[];let s=e;for(;h(s);){const t=s.car,e=r.valueOf(t);if(n.push(e),!ep(e))throw new Error("index with something other than an integer");s=s.cdr}return VT(t,n)}if(te(e))return VT(t,[e]);throw new Error}(r,HT(t,2),e):t}let WT=class extends Fw{constructor(t){super("index_varargs",fn,t),this.hash=_i(this.opr)}transform(t){const e=jT(t,this.$);return[!e.equals(t)?q:A,e]}};const JT=new class{create(t){return new WT(t)}};class XT extends y_{constructor(t){super("inner_extension",Fe,Qw,Qw,t),this.hash=hi(Fe,li,li)}transform2(t,e,r,n){const s=this.$,i=(t,e)=>e;if(Ph(e)&&Ph(r)){if(Z(e)&&Z(r))return[T,i(0,n)];{const n=Uh(e),o=bh(e,Z),a=Uh(r),u=bh(r,Z),l=s.valueOf(c(t,o,u)),f=s.valueOf(c(t,n,a)),h=s.valueOf(c(ke,l,f));return[q,i(0,h)]}}{const t=s.valueOf(c(ke,e,r));return[T,i(0,t)]}}}const YT=new class{create(t){return new XT(t)}};let tq=class extends y_{constructor(t){super("inner_2_any_imu",Fe,Qw,ht,t),this.hash=hi(Fe,li,si)}transform2(t,e,r){const n=this.$,s=e,i=r,o=n.valueOf(c(t,Ut,s)),a=n.valueOf(c(ke,o,i));return[q,a]}};const eq=new class{create(t){return new tq(t)}};let rq=class extends y_{constructor(t){super("inner_2_any_rat",Fe,Qw,te,t),this.hash=hi(Fe,li,ii)}transform2(t,e,r,n){return r.isOne()?[q,e]:[q,c(ke.clone(t.pos,t.end),e,r)]}};const nq=new class{create(t){return new rq(t)}};let sq=class extends y_{constructor(t){super("inner_2_any_real",Fe,Qw,function(t){return function(e){return!t.isOne(e)&&t.is_real(e)}}(t),t)}transform2(t,e,r,n){const s=this.$,i=s.valueOf(Nd(t,e,Ut)),o=s.valueOf(Nd(ke,i,r));return[q,o]}};const iq=new class{create(t){return new sq(t)}};let oq=class extends y_{constructor(t){super("inner_2_blade_blade",Fe,Z,Z,t),this.hash=hi(Fe,Ys,Ys)}transform2(t,e,r){return[q,this.$.valueOf(e.scp(r))]}};const aq=new class{create(t){return new oq(t)}};let uq=class extends y_{constructor(t){super("inner_2_imu_any",Fe,ht,Qw,t),this.hash=hi(Fe,si,li)}transform2(t,e,r){const n=this.$,s=e,i=r,o=n.negate(s),a=n.valueOf(c(t,Ut,i)),u=n.valueOf(c(ke,o,a));return[q,u]}};const cq=new class{create(t){return new uq(t)}};let lq=class extends y_{constructor(t){super("inner_2_imu_imu",Fe,ht,ht,t),this.hash=hi(Fe,si,si)}transform2(t,e,r){return[q,Ut]}};const fq=new class{create(t){return new lq(t)}};let hq=class extends y_{constructor(t){super("inner_2_imu_rat",Fe,ht,te,t),this.hash=di(Fe,Ie,ii)}transform2(t,e,r){const n=this.$;return[q,n.negate(c(ke.clone(t.pos,t.end),e,r))]}};const pq=new class{create(t){return new hq(t)}};let dq=class extends y_{constructor(t){super("inner_2_num_num",Fe,ee,ee,t),this.hash=hi(Fe,ii,ii)}transform2(t,e,r){return[q,$d(e,r)]}};const mq=new class{create(t){return new dq(t)}};let gq=class extends y_{constructor(t){super("inner_2_rat_any",Fe,te,Qw,t),this.hash=hi(Fe,ii,li)}transform2(t,e,r,n){return e.isOne()?[q,r]:[q,c(ke.clone(t.pos,t.end),e,r)]}};const wq=new class{create(t){return new gq(t)}};let _q=class extends y_{constructor(t){super("inner_2_rat_imu",Fe,te,ht,t),this.hash=hi(Fe,ii,si)}transform2(t,e,r){return[q,c(ke.clone(t.pos,t.end),e,r)]}};const xq=new class{create(t){return new _q(t)}};let yq=class extends y_{constructor(t){super("inner_2_rat_sym",Fe,te,ie,t),this.hash=hi(Fe,ii,ai)}transform2(t,e,r){return[q,c(ke.clone(t.pos,t.end),e,r)]}};const vq=new class{create(t){return new yq(t)}};let bq=class extends y_{constructor(t){super("inner_2_real_any",Fe,function(t){return function(e){return!t.isOne(e)&&t.is_real(e)}}(t),Qw,t),this.phases=L}transform2(t,e,r,n){const s=this.$,i=s.valueOf(c(t,Ut,r)),o=s.valueOf(c(ke,e,i));return[q,o]}};const Oq=new class{create(t){return new bq(t)}};let Eq=class extends y_{constructor(t){super("inner_2_sym_sym",Fe,ie,ie,t),this.hash=hi(Fe,ai,ai)}isScalar(){return!0}isZero(t){return!1}transform2(t,e,r,n){const s=this.$;return[q,s.valueOf(c(ke.clone(t.pos,t.end),e,r))]}};const Sq=new class{create(t){return new Eq(t)}};function Tq(t){return function(e){return t.isScalar(e)}}let qq=class extends y_{constructor(t){super("inner_2_vec_scalar",Fe,Z,Tq(t),t)}transform2(t,e,r,n){return[q,Jt]}};const Aq=new class{create(t){return new qq(t)}};let Mq=class extends Fw{constructor(t){super("integral_varargs",hn,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){let r,n,s=0,i=m(t),o=e.valueOf(d(i));i=m(i);const a=e.valueOf(d(i));for(l===a?(r=Vh(o),n=l):ee(a)?(r=Vh(o),n=a):(r=a,i=m(i),n=e.valueOf(d(i)));;){ee(n)?(s=vf(n),isNaN(s)&&er("nth integral: check n")):s=1;let t=o;if(s>=0)for(let n=0;n<s;n++)t=qO(t,r,e);else{s=-s;for(let n=0;n<s;n++)t=hy(t,r,e)}if(o=t,l===n)break;if(ee(n)){if(i=m(i),n=e.valueOf(d(i)),l===n)break;ee(n)||(r=n,i=m(i),n=e.valueOf(d(i)))}else r=n,i=m(i),n=e.valueOf(d(i))}return o}(t,this.$);return[!e.equals(t)?q:A,e]}};const Nq=new class{create(t){return new Mq(t)}};let $q=class extends Uw{constructor(t){super("inv_any",Ue,Qw,t),this.hash=gi(Ue,li)}transform1(t,e,r){const n=Jx(e,this.$);return[!n.equals(r)?q:T,n]}};const Lq=new class{create(t){return new $q(t)}},kq=Q(F.inverse);let Rq=class extends Cw{constructor(t){super(kq,kq,t)}transform1(t,e,r){const n=e.argList.head;return[q,n]}};const Iq=new class{create(t){return new Rq(t)}},Pq=Q(F.is_complex);let Fq=class extends Uw{constructor(t){super("is_complex_any",Pq,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){return[T,r]}};const Uq=new class{create(t){return new Fq(t)}},Cq=Q(F.is_complex);let Dq=class extends Uw{constructor(t){super("is_complex_sym",Cq,ie,t),this.hash=gi(this.opr,ai)}transform1(t,e){const r=this.$.getSymbolProps(e);return[q,H(r.complex)]}};const Bq=new class{create(t){return new Dq(t)}};function Kq(t,e){return function(t){if(e=t,te(e)&&Zs(e.b,1)&&1===Qs(e.a)&&gm(t.a))return Ut;var e;return Jt}(e.valueOf(Jf(t)))}let zq=class extends Fw{constructor(t){super("isprime",dn,t),this.hash=_i(this.opr)}transform(t){const e=Kq(t,this.$);return[!e.equals(t)?q:A,e]}};const Qq=new class{create(t){return new zq(t)}},Zq=Q(F.pow),Gq=Q(F.is_real);let Hq=class extends Cw{constructor(t){super(Gq,Zq,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head.rhs;return te(e)&&e.isMinusOne()}return!1}transform1(t,e,r){const n=this.$,s=e.lhs;return[q,H(n.is_real(s))]}};const Vq=new class{create(t){return new Hq(t)}},jq=Q(F.abs),Wq=Q(F.is_real);let Jq=class extends Cw{constructor(t){super(Wq,jq,t)}transform1(t,e,r){return[q,V]}};const Xq=new class{create(t){return new Jq(t)}},Yq=Q(F.add),tA=Q(F.is_real);class eA extends Cw{constructor(t){super(tA,Yq,t)}transform1(t,e){const r=this.$;return[...e.argList].every((function(t){return r.is_real(t)}))?[q,V]:[q,j]}}const rA=new class{create(t){return new eA(t)}};class nA extends Uw{constructor(t){super("is_real_any",Fn,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){return[q,j]}}const sA=new class{create(t){return new nA(t)}},iA=Q(F.is_real),oA=Q(F.cos);class aA extends Cw{constructor(t){super(iA,oA,t)}transform1(t,e){const r=this.$,n=e.argList.head;return[q,H(r.is_real(n))]}}const uA=new class{create(t){return new aA(t)}};class cA extends Uw{constructor(t){super(`${Fn.text}(expr: ${ri}) => ${ti}`,Fn,ot,t),this.hash=gi(this.opr,ri)}transform1(t,e){return[q,V]}}const lA=new class{create(t){return new cA(t)}};class fA extends Cw{constructor(t){super(Fn,ln,t)}transform1(t,e){return[q,V]}}const hA=new class{create(t){return new fA(t)}};class pA extends Uw{constructor(t){super(`${Fn.text}(expr: ${si}) => ${ti}`,Fn,ht,t),this.hash=gi(this.opr,si)}transform1(t,e){return[q,j]}}const dA=new class{create(t){return new pA(t)}};class mA extends Cw{constructor(t,e){super(Fn,t,e)}transform1(t,e){const r=this.$;return[...e.argList].every((function(t){return r.is_real(t)}))?[q,V]:[q,j]}}const gA=new class{create(t){return new mA(ke,t)}},wA=Q(F.pow),_A=Q(F.is_real);let xA=class extends Cw{constructor(t){super(_A,wA,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return jf(r)&&ie(n)}return!1}transform1(t,e,r){const n=this.$,s=Mi(e.rhs);return n.is_real(s)?[q,V]:[q,j]}};const yA=new class{create(t){return new xA(t)}},vA=Q(F.pow),bA=Q(F.is_real);class OA extends Cw{constructor(t){super(bA,vA,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return ht(r)&&te(n)}return!1}transform1(t,e,r){const n=MT(e.rhs),s=n.numer();return n.denom().isOne()&&s.div(Bt).isInteger()?[q,V]:[q,j]}}const EA=new class{create(t){return new OA(t)}},SA=Q(F.PI),TA=Q(F.pow),qA=Q(F.is_real);let AA=class extends Cw{constructor(t){super(qA,TA,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return te(r)&&te(n)}return!1}transform1(t,e,r){const n=this.$,s=MT(e.lhs);if(s.isMinusOne()){const t=MT(e.rhs),r=n.sin(n.multiply(t,SA));return n.is_zero(r)?[q,V]:[q,j]}return s.isPositive()?[q,V]:[q,j]}};const MA=new class{create(t){return new AA(t)}},NA=Q(F.pow),$A=Q(F.is_real);let LA=class extends Cw{constructor(t){super($A,NA,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return ie(r)&&te(n)}return!1}transform1(t,e,r){const n=this.$,s=Mi(e.lhs),i=MT(e.rhs),o=i.numer(),a=i.denom();return n.is_real(s)?o.div(Ct).isInteger()?a.isOne()?[q,V]:[q,j]:o.isMinusOne()&&a.isOne()?[q,H(n.is_real(s))]:[q,j]:[q,j]}};const kA=new class{create(t){return new LA(t)}};class RA extends Uw{constructor(t){super("is_real_rat",Fn,te,t),this.hash=gi(this.opr,ii)}transform1(t,e){return[q,V]}}const IA=new class{create(t){return new RA(t)}};let PA=class extends Cw{constructor(t){super(Fn,Pn,t)}transform1(t,e){return[q,V]}};const FA=new class{create(t){return new PA(t)}};class UA extends Cw{constructor(t){super(Fn,$m,t)}transform1(t,e){const r=this.$,n=e.argList.head;return[q,H(r.is_real(n))]}}const CA=new class{create(t){return new UA(t)}};let DA=class{constructor(t){this.predicate=t}create(t){return new BA(this.predicate,t)}};class BA extends Uw{constructor(t,e){super(`${t.text}(sym: ${ai}) => ${ti}`,t,ie,e),this.hash=gi(this.opr,ai)}transform1(t,e){const r=this.$.getSymbolProps(e);return[q,H(r.real)]}}const KA=Q(F.is_zero);class zA extends Uw{constructor(t){super("iszero_any",KA,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){return[T,r]}}const QA=new class{create(t){return new zA(t)}};const ZA=Q(F.is_zero);class GA extends Uw{constructor(t){super("iszero_rat",ZA,te,t),this.hash=gi(this.opr,ii)}transform1(t,e){return[q,e.isZero()?V:j]}}const HA=new class{create(t){return new GA(t)}};function VA(t,e){const r=e.valueOf(Jf(t)),n=e.valueOf(th(t)),s=e.valueOf(sh(t));return function(t,e,r,n){const s=vf(e);if(s<0||isNaN(s))return Nd(mn,t,e,r);if(ie(t))return jA(s,t,r,n);return n.valueOf(Ip(jA(s,bs,r,n),bs,t,n))}(r,n,l===s?Jt:s,e)}function jA(t,e,r,n){let s=Jt,i=Ut;for(let o=0;o<t;o++){const t=Mp(n.subtract(n.multiply(n.add(n.subtract(Ft(2*o+1),e),r),i),n.multiply(n.add(Ft(o),r),s)),Ft(o+1),n);s=i,i=t}return i}let WA=class extends Fw{constructor(t){super("laguerre",mn,t),this.hash=_i(this.opr)}transform(t){const e=VA(t,this.$);return[!e.equals(t)?q:A,e]}};const JA=new class{create(t){return new WA(t)}};function XA(t,e,r){return or(YA,t,e,r)}function YA(t,e,r){const n=Mp(Kd(t,e,r),t,r);return Ap(Mp(n,e,r),r)}let tM=class extends Fw{constructor(t){super("lcm",gn,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){t=m(t);let r=e.valueOf(d(t));return h(t)&&(r=t.tail().reduce(((t,r)=>XA(t,e.valueOf(r),e)),r)),r}(t,this.$);return[!e.equals(t)?q:A,e]}};const eM=new class{create(t){return new tM(t)}};let rM=class extends y_{constructor(t){super("lco_2_any_any",Ce,Qw,Qw,t)}isKind(t){if(super.isKind(t)){const e=t.lhs,r=t.rhs;return!Z(e)||!Z(r)}return!1}transform2(t,e,r,n){const s=this.$;if(Cf(e)&&Ph(e)){const t=Uh(e),n=bh(e,Z),i=s.valueOf(c(Ce,t,r)),o=s.valueOf(c(ke,n,i));return[q,o]}if(Cf(r)&&Ph(r)){const t=Uh(r),n=bh(r,Z),i=s.valueOf(c(Ce,e,t)),o=s.valueOf(c(ke,n,i));return[q,o]}return[T,n]}};const nM=new class{create(t){return new rM(t)}};let sM=class extends y_{constructor(t){super("lco_2_blade_blade",Ce,Z,Z,t),this.hash=hi(this.opr,Ys,Ys)}transform2(t,e,r){return[q,this.$.valueOf(e.__lshift__(r))]}};const iM=new class{create(t){return new sM(t)}};function oM(t,e){return e.power(t,Ct)}function aM(t,e){const r=e.valueOf(Jf(t)),n=e.valueOf(th(t)),s=e.valueOf(sh(t));return function(t,e,r,n){return function(t,e,r,n){const s=vf(e),i=vf(r);if(s<0||isNaN(s)||i<0||isNaN(i))return Nd(wn,t,e,r);let o;if(ie(t))o=uM(s,i,t,n);else{const e=uM(s,i,bs,n);o=n.valueOf(Ip(e,bs,t,n))}return o=function(t,e,r,n){if(0===e)return;let s=n.subtract(Ut,oM(r,n));d(r).equals(Lr)?s=oM(Lm(Jf(r),n),n):d(r).equals(Qn)&&(s=oM(Nm(Jf(r),n),n));let i=n.multiply(t,n.power(s,n.multiply(Ft(e),Xt)));e%2&&(i=n.negate(i));return i}(o,i,t,n)||o,o}(t,e,r,n)}(r,n,l===s?Jt:s,e)}function uM(t,e,r,n){let s=Jt,i=Ut;for(let e=0;e<t;e++){const t=Mp(n.subtract(n.multiply(n.multiply(Ft(2*e+1),r),i),n.multiply(Ft(e),s)),Ft(e+1),n);s=i,i=t}for(let t=0;t<e;t++)i=hy(i,r,n);return i}let cM=class extends Fw{constructor(t){super("legendre",wn,t),this.hash=_i(this.opr)}transform(t){const e=aM(t,this.$);return[!e.equals(t)?q:A,e]}};const lM=new class{create(t){return new cM(t)}};let fM=class extends Fw{constructor(t){super("log",_n,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){return uy(e.valueOf(Jf(t)),e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const hM=new class{create(t){return new fM(t)}},pM=Q(F.mod);function dM(t,e){const r=e.valueOf(th(t));return function(t,e,r){r.is_zero(e)&&er("mod function: divide by zero");if(!ee(t)||!ee(e))return c(pM,t,e);if(ot(t)){const e=vf(t);isNaN(e)&&er("mod function: cannot convert float value to integer"),t=Ft(e)}if(ot(e)){const t=vf(e);isNaN(t)&&er("mod function: cannot convert float value to integer"),e=Ft(t)}yf(t)&&yf(e)||er("mod function: integer arguments expected");return new Lt(gf(t.a,e.a),mt.one)}(e.valueOf(Jf(t)),r,e)}const mM=Q(F.mod);let gM=class extends Fw{constructor(t){super("mod",mM,t),this.hash=_i(this.opr)}transform(t){const e=dM(t,this.$);return[!e.equals(t)?q:A,e]}};const wM=new class{create(t){return new gM(t)}};let _M=class extends y_{constructor(t,e){super("mul_2_any_flt",e,Qw,ot,t),this.dependencies=[],this.hash=hi(e,li,ri)}isKind(t){if(super.isKind(t)){return t.rhs.isZero()}return!1}transform2(t,e,r){if(r.isZero())return[q,r];throw new Error}};const xM=new class{constructor(t){this.opr=t}create(t){return new _M(t,this.opr)}}(ke);let yM=class extends y_{constructor(t,e){super("mul_2_any_rat",e,Qw,te,t),this.dependencies=[],this.hash=hi(e,li,ii)}isKind(t){if(super.isKind(t)){const e=t.rhs;return e.isZero()||e.isOne()}return!1}transform2(t,e,r,n){return r.isOne()?[q,e]:r.isZero()?[q,Jt]:[T,n]}};const vM=new class{constructor(t){this.opr=t}create(t){return new yM(t,this.opr)}}(ke);let bM=class extends y_{constructor(t){super("mul_2_blade_blade",ke,Z,Z,t),this.hash=hi(ke,Ys,Ys)}transform2(t,e,r){const n=this.$;return[q,n.valueOf(e.mul(r))]}};const OM=new class{create(t){return new bM(t)}};let EM=class extends y_{constructor(t){super("mul_2_blade_rat",ke,Z,te,t),this.dependencies=["Blade"],this.hash=hi(ke,Ys,ii)}transform2(t,e,r){const n=this.$;return[q,n.valueOf(Nd(t,r,e))]}};const SM=new class{create(t){return new EM(t)}};let TM=class extends y_{constructor(t,e){super("mul_2_flt_any",e,ot,Qw,t),this.dependencies=[],this.hash=hi(e,ri,li)}isKind(t){if(super.isKind(t)){return t.lhs.isZero()}return!1}transform2(t,e,r,n){return e.isZero()?[q,e]:[T,n]}};const qM=new class{constructor(t){this.opr=t}create(t){return new TM(t,this.opr)}}(ke);const AM=new class{create(t){return new MM(t)}};let MM=class extends y_{constructor(t){super("mul_2_flt_flt",ke,ot,ot,t),this.dependencies=["Flt"],this.hash=hi(ke,ri,ri)}transform2(t,e,r){return[q,e.mul(r)]}},NM=class extends y_{constructor(t){super("mul_2_flt_imu",ke,Mh,ht,t),this.dependencies=["Flt","Imu"],this.hash=hi(ke,ri,si)}transform2(t,e,r,n){return e.isZero()?[q,e]:e.isOne()?[T,n]:[A,n]}};const $M=new class{create(t){return new NM(t)}};function LM(t){return Rp(t)&&ot(t.lhs)}let kM=class extends y_{constructor(t){super("mul_2_flt_mul_2_flt_any",ke,Mh,x_(h,LM),t),this.dependencies=["Flt"],this.hash=pi(ke,ri,ke)}transform2(t,e,r){const n=this.$,s=e,i=r.lhs,o=s.mul(i),a=r.rhs,u=n.valueOf(Nd(ke,o,a));return[q,u]}};const RM=new class{create(t){return new kM(t)}};let IM=class extends y_{constructor(t){super("mul_2_flt_rat",ke,ot,te,t),this.dependencies=["Flt"],this.hash=hi(ke,ri,ii)}transform2(t,e,r){return[q,J(e.toNumber()*r.toNumber())]}};const PM=new class{create(t){return new IM(t)}};let FM=class extends y_{constructor(t){super("mul_2_flt_uom",ke,Mh,V_,t),this.dependencies=["Flt","Uom"],this.hash=hi(ke,ri,ci)}transform2(t,e,r,n){return e.isZero()?[q,e]:e.isOne()?[q,r]:[A,n]}};const UM=new class{create(t){return new FM(t)}};let CM=class extends y_{constructor(t){super("mul_2_hyp_rat",ke,ct,te,t),this.hash=hi(ke,ni,ii)}isScalar(t){return this.$.isScalar(t.lhs)}transform2(t,e,r){return r.isZero()?[q,Jt]:r.isOne()?[q,e]:[q,Nd(t,r,e)]}};const DM=new class{create(t){return new CM(t)}};let BM=class extends y_{constructor(t){super("mul_2_hyp_sym",ke,ct,ie,t),this.dependencies=[],this.hash=hi(ke,ni,ai)}transform2(t,e,r){const n=this.$;return[q,n.valueOf(Nd(t,r,e))]}};const KM=new class{create(t){return new BM(t)}};let zM=class extends y_{constructor(t){super("mul_2_imu_flt",ke,ht,Mh,t),this.dependencies=["Flt","Imu"],this.hash=hi(ke,si,ri)}isKind(t){if(super.isKind(t)){return!!t.rhs.isZero()}return!1}transform2(t,e,r){return[q,r]}};const QM=new class{create(t){return new zM(t)}};let ZM=class extends y_{constructor(t){super("mul_2_imu_imu",ke,ht,ht,t),this.dependencies=["Imu"],this.hash=hi(ke,si,si)}transform2(t,e,r){return[q,jt]}};const GM=new class{create(t){return new ZM(t)}};function HM(t){return Rp(t)&&h(t.rhs)}let VM=class extends v_{constructor(t){super("mul_2_mul_2_any_cons_sym",ke,x_(h,HM),ie,function(t){return function(e,r){const n=e.rhs.opr;return!(!ie(n)||!n.equalsSym(Qm))&&t.isScalar(r)}}(t),t),this.hash=di(ke,ke,ai)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r,a=n.valueOf(c(ke,s,o)),u=n.valueOf(c(ke,a,i));return[q,u]}};const jM=new class{create(t){return new VM(t)}};function WM(t,e){const r=t.rhs.lhs,n=e.lhs;return r.equalsSym(n)}const JM=Qw,XM=x_(h,rx(Ie,ie,te)),YM=x_(h,rx(ke,JM,XM)),tN=x_(h,rx(Ie,ie,te));let eN=class extends v_{constructor(t){super("mul_2_mul_2_any_pow_2_xxx_any_pow_2_xxx_any",ke,YM,tN,WM,t),this.hash=mi(ke,ke,Ie)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs.lhs,o=e.rhs.rhs,a=r.rhs,u=n.valueOf(Nd($e,o,a)),c=n.valueOf(Nd(Ie,i,u)),l=n.valueOf(Nd(t,s,c));return[q,l]}};const rN=new class{create(t){return new eN(t)}};function nN(t){return Rp(t)&&ie(t.rhs)}let sN=class extends y_{constructor(t){super("mul_2_mul_2_any_sym_imu",ke,x_(h,nN),ht,t),this.hash=di(ke,ke,si)}isImag(t){const e=this.$,r=t.lhs.lhs;return e.is_real(r)}transform2(t,e,r,n){const s=this.$,i=e.lhs,o=e.rhs,a=r;if(s.compareFn(t)(o,a)===S){const t=s.valueOf(c(ke,i,a)),e=s.valueOf(c(ke,t,o));return[q,e]}return[T,n]}};const iN=new class{create(t){return new sN(t)}};function oN(t){return Rp(t)&&ht(t.lhs)}let aN=class extends y_{constructor(t){super("mul_2_mul_2_any_sym_mul_2_imu_sym",ke,x_(h,nN),x_(h,oN),t),this.hash=mi(ke,ke,ke)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.lhs,a=r.rhs,u=n.valueOf(c(ke,s,o)),l=n.valueOf(c(ke,i,a)),f=n.valueOf(c(ke,u,l));return[q,f]}};const uN=new class{create(t){return new aN(t)}};const cN=x_(h,kp(ke)),lN=x_(h,iO(Ie,te));function fN(t,e){const r=t.rhs,n=e.lhs;return r.equals(n)}let hN=class extends v_{constructor(t){super("mul_2_mul_2_any_X_pow_2_X_rat",ke,cN,lN,fN,t),this.hash=mi(ke,ke,Ie)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.rhs,a=n.valueOf(c(r.opr,i,o.succ())),u=n.valueOf(c(ke,s,a));return[q,u]}};const pN=new class{create(t){return new hN(t)}};const dN=x_(h,kp(ke)),mN=x_(h,kp(Ie));let gN=class extends v_{constructor(t){super("mul_2_mul_2_any_Z_pow_2_A_any",ke,dN,mN,function(t){return function(e,r){const n=e.rhs,s=r.lhs;return ie(n)&&ie(s)&&t.compareFn(ke)(n,s)>0}}(t),t),this.hash=mi(ke,ke,Ie)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.lhs,a=r.rhs,u=c(r.opr,o,a),l=n.valueOf(u),f=c(e.opr,s,l),h=c(t,n.valueOf(f),i),p=n.valueOf(h);return[q,p]}};const wN=new class{create(t){return new gN(t)}};let _N=class extends y_{constructor(t){super("mul_2_mul_2_rat_any_mul_2_rat_any",ke,x_(h,ix),x_(h,ix),t),this.hash=mi(ke,ke,ke)}transform2(t,e,r,n){const s=this.$,i=e.lhs,o=e.rhs,a=r.lhs,u=r.rhs,l=s.valueOf(c(r.opr,o,u)),f=s.valueOf(c(t,i.mul(a),l));return[q,f]}};const xN=new class{create(t){return new _N(t)}};let yN=class extends y_{constructor(t){super("mul_2_mul_2_sym_imu_sym",ke,x_(h,rx(ke,ie,ht)),ie,t),this.hash=di(ke,ke,ai)}transform2(t,e,r,n){const s=this.$,i=e.lhs,o=e.rhs,a=r;if(s.compareFn(t)(o,a)===S){const e=s.valueOf(c(t,i,a)),r=s.valueOf(c(ke,e,o));return[q,r]}return[T,n]}};const vN=new class{create(t){return new yN(t)}};function bN(t){return Am(t)&&ie(t.lhs)}function ON(t,e){const r=t.lhs,n=e.lhs;return r.equalsSym(n)}const EN=x_(h,bN),SN=x_(h,bN);let TN=class extends v_{constructor(t){super("mul_2_pow_2_xxx_any_pow_2_xxx_any",ke,EN,SN,ON,t),this.hash=mi(ke,Ie,Ie)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.rhs,a=n.valueOf(Nd($e,i,o)),u=n.valueOf(Nd(Ie,s,a));return[q,u]}};const qN=new class{create(t){return new TN(t)}};function AN(t){return Am(t)&&ie(t.lhs)&&te(t.rhs)}function MN(t,e){const r=e;return t.lhs.equalsSym(r)}let NN=class extends v_{constructor(t){super("mul_2_pow_2_xxx_rat_xxx",ke,x_(h,AN),ie,MN,t),this.hash=di(ke,Ie,ai)}transform2(t,e,r,n){const s=this.$,i=e.lhs,o=e.rhs.succ(),a=s.valueOf(Nd(Ie,i,o));return[q,a]}};const $N=new class{create(t){return new NN(t)}};let LN=class extends y_{constructor(t){super("mul_2_rat_any",ke,te,Qw,t),this.hash=hi(ke,ii,li)}isKind(t){if(super.isKind(t)){const e=t.lhs;return e.isZero()||e.isOne()}return!1}isImag(t){return this.$.is_imag(t.rhs)}isReal(t){return this.$.is_real(t.rhs)}isScalar(t){return this.$.isScalar(t.rhs)}transform2(t,e,r,n){return function(t,e,r){return t.isZero()?[q,t]:t.isOne()?[q,e]:[T,r]}(e,r,n)}};const kN=new class{create(t){return new LN(t)}};let RN=class extends y_{constructor(t){super("mul_2_rat_blade",ke,te,Z,t),this.dependencies=["Blade"],this.hash=hi(ke,ii,Ys)}isScalar(t){return!1}transform2(t,e,r,n){return e.isZero()?[q,Jt]:e.isOne()?[q,r]:[A,n]}};const IN=new class{create(t){return new RN(t)}};let PN=class extends y_{constructor(t){super("mul_2_rat_flt",ke,te,ot,t),this.dependencies=["Flt"],this.hash=hi(ke,ii,ri)}transform2(t,e,r){return[q,J(e.toNumber()*r.toNumber())]}};const FN=new class{create(t){return new PN(t)}};let UN=class extends y_{constructor(t){super("mul_2_rat_rat",ke,te,te,t),this.hash=hi(ke,ii,ii)}transform2(t,e,r,n){return[q,e.mul(r)]}};const CN=new class{create(t){return new UN(t)}};let DN=class extends y_{constructor(t){super("mul_2_rat_sym",ke,te,ie,t),this.hash=hi(ke,ii,ai)}isKind(t){if(super.isKind(t)){const e=t.lhs;return e.isZero()||e.isOne()}return!1}isReal(t){return this.$.is_real(t.rhs)}isImag(t){return this.$.is_imag(t.rhs)}isScalar(t){return this.$.isScalar(t.rhs)}transform2(t,e,r,n){return e.isZero()?[q,Jt]:e.isOne()?[q,r]:[A,n]}};const BN=new class{create(t){return new DN(t)}};let KN=class extends y_{constructor(t){super("mul_2_rat_tensor",ke,te,v,t),this.hash=hi(ke,ii,ui)}transform2(t,e,r){const n=this.$;if(e.isZero())return[q,Jt];if(e.isOne())return[q,r];const s=r.map((function(t){return n.multiply(e,t)}));return[q,s]}};const zN=new class{create(t){return new KN(t)}};let QN=class extends v_{constructor(t){super("mul_2_sym_blade",ke,ie,Z,function(t){return function(e,r){return t.isScalar(e)}}(t),t),this.dependencies=["Blade"],this.hash=hi(ke,ai,Ys)}transform2(t,e,r,n){return[A,n]}};const ZN=new class{create(t){return new QN(t)}};let GN=class extends y_{constructor(t){super("mul_2_sym_imu",ke,ie,ht,t),this.hash=pi(ke,ai,Ie)}isImag(t){return!0}isReal(t){return!1}isScalar(t){return this.$.isScalar(t.lhs)}transform2(t,e,r,n){const s=this.$;return s.compareFn(t)(e,r)===S?[q,s.valueOf(Nd(t,r,e))]:[T,n]}};const HN=new class{create(t){return new GN(t)}};const VN=new class{create(t){return new jN(t)}};let jN=class extends y_{constructor(t){super("mul_2_sym_mul_2_rat_any",ke,ie,x_(h,ix),t),this.hash=pi(ke,ai,ke)}transform2(t,e,r,n){const s=this.$,i=e,o=r.lhs,a=r.rhs;if(s.compareFn(t)(i,o)===S){const e=s.valueOf(Nd(r.opr,i,a)),n=s.valueOf(Nd(t,o,e));return[q,n]}return[T,n]}},WN=class extends y_{constructor(t){super("mul_2_sym_num",ke,ie,ee,t),this.hash="(* Sym Num)"}isScalar(t){return this.$.isScalar(t.lhs)}transform2(t,e,r){return r.isZero()?[q,Jt]:r.isOne()?[q,e]:[q,Nd(t,r,e)]}};const JN=new class{create(t){return new WN(t)}};let XN=class extends y_{constructor(t){super("mul_2_sym_rat",ke,ie,te,t),this.hash=hi(ke,ai,ii)}isScalar(t){return this.$.isScalar(t.lhs)}transform2(t,e,r){return r.isZero()?[q,Jt]:r.isOne()?[q,e]:[q,Nd(t,r,e)]}};const YN=new class{create(t){return new XN(t)}};let t$=class extends v_{constructor(t){super("mul_2_sym_tensor",ke,ie,v,function(t){return function(e,r){return t.isScalar(e)}}(t),t),this.dependencies=[],this.hash=hi(ke,ai,ui)}transform2(t,e,r){const n=this.$,s=r.map((function(t){return n.multiply(e,t)}));return[q,s]}};const e$=new class{create(t){return new t$(t)}};let r$=class extends v_{constructor(t){super("mul_2_tensor_any",ke,v,Qw,(function(t,e){return!0}),t),this.dependencies=[],this.hash=hi(ke,ui,li)}transform2(t,e,r){const n=this.$,s=e.map((function(t){return n.multiply(t,r)}));return[q,s]}};const n$=new class{create(t){return new r$(t)}};let s$=class extends v_{constructor(t){super("mul_2_tensor_sym",ke,v,ie,function(t){return function(e,r){return t.isScalar(r)}}(t),t),this.dependencies=[],this.hash=hi(ke,ui,ai)}transform2(t,e,r){const n=this.$,s=e.map((function(t){return n.multiply(t,r)}));return[q,s]}};const i$=new class{create(t){return new s$(t)}};function o$(t,e,r){const n=t.dim(t.ndim-1);n!==e.dim(0)&&er("inner: tensor dimension check");const s=t.ndim+e.ndim-2;s>Cs&&er("inner: rank of result exceeds maximum");const i=t.sliceDimensions(0,t.ndim-1).reduce(((t,e)=>t*e),1),o=e.sliceDimensions(1).reduce(((t,e)=>t*e),1),a=Sp(i*o,Jt);for(let s=0;s<i;s++)for(let i=0;i<n;i++)if(!r.is_zero(t.elem(s*n+i)))for(let u=0;u<o;u++)a[s*o+u]=r.add(r.multiply(t.elem(s*n+i),e.elem(i*o+u)),a[s*o+u]);if(0===s)return a[0];{const r=[...t.sliceDimensions(0,t.ndim-1),...e.sliceDimensions(1,e.ndim)];return new y(r,a)}}let a$=class extends v_{constructor(t){super("mul_2_tensor_tensor",ke,v,v,(function(t,e){return!0}),t),this.dependencies=[],this.hash=hi(ke,ui,ui)}transform2(t,e,r){const n=this.$;return[q,o$(e,r,n)]}};const u$=new class{create(t){return new a$(t)}};let c$=class extends y_{constructor(t){super("mul_2_uom_flt",ke,Me,ot,t),this.dependencies=["Flt","Uom"],this.hash=hi(ke,ci,ri)}isScalar(t){return!0}transform2(t,e,r){return r.isZero()?[q,Jt]:r.isOne()?[q,e]:[q,Nd(t,r,e)]}};const l$=new class{create(t){return new c$(t)}};let f$=class extends y_{constructor(t){super("mul_2_uom_rat",ke,Me,te,t),this.dependencies=["Uom"],this.hash=hi(ke,ci,ii)}isScalar(t){return!0}transform2(t,e,r){return r.isZero()?[q,Jt]:r.isOne()?[q,e]:[q,Nd(t,r,e)]}};const h$=new class{create(t){return new f$(t)}};let p$=class extends y_{constructor(t){super("mul_2_uom_uom",ke,V_,V_,t),this.dependencies=["Uom"],this.hash=hi(ke,ci,ci)}transform2(t,e,r){return[q,e.mul(r)]}};const d$=new class{create(t){return new p$(t)}};function m$(t){return Am(t)&&te(t.rhs)}function g$(t,e){const r=t,n=e.lhs;return!(!ie(r)&&!ct(r))&&r.equals(n)}let w$=class extends v_{constructor(t){super("mul_2_X_pow_2_X_rat",ke,Qw,x_(h,m$),g$,t),this.hash=pi(ke,li,Ie)}transform2(t,e,r){const n=this.$,s=e,i=r.rhs,o=Nd(r.opr,s,i.succ()),a=n.valueOf(o);return[q,a]}};const _$=new class{create(t){return new w$(t)}};function x$(t,e,r){if(ee(t)&&ee(e))return $d(t,e);if(te(t)&&t.isZero())return t;if(te(e)&&e.isZero())return e;if(r.isExpanding()&&Uf(t))return t.tail().reduce(((t,n)=>r.add(t,x$(n,e,r))),Jt);if(r.isExpanding()&&Uf(e))return e.tail().reduce(((e,n)=>r.add(e,x$(t,n,r))),Jt);const n=r.compareFn(ke);if(Ph(t)&&Ph(e)){const n=Uh(t),s=Uh(e),i=n.mul(s),o=bh(t,Z),a=bh(e,Z);return r.multiply(r.multiply(o,a),i)}if(Me(t)&&Me(e))return t.mul(e);if(!v(t)&&v(e))return r.multiply(t,e);if(v(t)&&!v(e))return r.multiply(t,e);let s=Cf(t)?t.cdr:c(t),i=Cf(e)?e.cdr:c(e);const o=[],a=d(s),l=d(i);for(ee(a)&&ee(l)?(o.push($d(a,l)),s=s.cdr,i=i.cdr):ee(a)?(o.push(a),s=s.cdr):ee(l)?(o.push(l),i=i.cdr):o.push(Ut);h(s)&&h(i);){const t=s.car,e=i.car;if(d(t).equals(En)&&d(e).equals(En)){o.push(u(En,v$(m(t),m(e)))),s=s.cdr,i=i.cdr;continue}const[a,c]=y$(t),[l,f]=y$(e);if(a.equals(l))O$(o,l,c,f,r),s=s.cdr,i=i.cdr;else switch(n(t,e)){case O:o.push(t),s=s.cdr;break;case S:o.push(e),i=i.cdr;break;default:throw new Error(`${Rw(a,r)} ${Rw(c,r)} ${Rw(l,r)} ${Rw(f,r)}`)}}if(h(s)&&o.push(...s),h(i)&&o.push(...i),r.isExpanding())for(let t=0;t<o.length;t++)if(Uf(o[t]))return b$(o,r);const f=o.length;if(1===f){return E$(o.pop())}const p=o[0];if(te(p)&&p.isOne()){if(2===f){return E$(o.pop())}o.splice(0,1),o.sort(n);return c(ke,...o)}return u(ke,c(...o))}function y$(t,e){if(Df(t)){const e=t.cdr;return[d(e),Jf(e)]}return[t,Ut]}function v$(t,e){const r=[];return h(t)&&r.push(...t),h(e)&&r.push(...e),c(...r)}function b$(t,e){if(1===t.length)return t[0];if(0===t.length)return Ut;let r=t[0];for(let n=1;n<t.length;n++)r=x$(r,t[n],e);return r}function O$(t,e,r,n,s){const i=s.power(e,s.add(r,n));if(ee(i))t[0]=$d(S$(t[0]),i);else if(Cf(i)){const e=Jf(i);if(ee(e)&&p(rh(i))){const r=S$(t[0]),n=e;t[0]=$d(r,n),t.push(th(i))}else t.push(i)}else t.push(i)}function E$(t){if(void 0===t)throw new Error;return t}function S$(t){if(ee(t))return t;throw new Error}class T$ extends Fw{constructor(t){super("mul_varargs",ke,t),this.hash=_i(this.opr)}isScalar(t){const e=this.$;return[...t.argList].every((t=>e.isScalar(t)))}transform(t){const e=function(t,e){const r=t.argList,n=r.map(e.valueOf);if(n.equals(r)){if(p(n))return Ut;{const t=n.car,r=n.cdr;return h(r)?[...r].reduce(((t,r)=>x$(t,r,e)),t):t}}return e.valueOf(u(t.car,n))}(t,this.$);return[e.equals(t)?T:q,((t,e)=>e)(0,e)]}}const q$=new class{create(t){return new T$(t)}};class A${constructor(t){this.$=t}get key(){return l.name}get hash(){return fi}get name(){return"NilExtension"}isImag(t){throw new Error}isKind(t){return l.equals(t)}isMinusOne(t){throw new Error}isOne(t){return!1}isNil(t){throw new Error}isReal(t){throw new Error}isScalar(t){throw new Error}isZero(t){return!1}subst(t,e,r){return t.equals(e)?r:t}toInfixString(t){return"nil"}toLatexString(t){return"nil"}toListString(t){return"()"}evaluate(t){return this.transform(u(l,t))}transform(t){return l.equals(t)?[A,l]:[T,t]}valueOf(t){return l}}const M$=new class{create(t){return new A$(t)}};let N$=class extends Fw{constructor(t){super("not",yn,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=t,n=Hv(Jf(t),e);return null==n?r:n?Jt:Ut}(t,this.$);return[!e.equals(t)?q:A,e]}};const $$=new class{create(t){return new N$(t)}};let L$=class extends Fw{constructor(t){super("number",bn,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(Jf(t));return Si(r)||Mh(r)?Ut:Jt}(t,this.$);return[!e.equals(t)?q:A,e]}};const k$=new class{create(t){return new L$(t)}};let R$=class extends Fw{constructor(t){super("numerator",On,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){return Sm(e.valueOf(Jf(t)),e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const I$=new class{create(t){return new R$(t)}};let P$=class extends Fw{constructor(t){super("or",Sn,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=t;let n=m(r),s=!1;for(;h(n);){const t=Hv(d(n),e);if(null==t)s=!0,n=m(n);else{if(t)return Ut;t||(n=m(n))}}return s?r:Jt}(t,this.$);return[!e.equals(t)?q:A,e]}};const F$=new class{create(t){return new P$(t)}};let U$=class extends y_{constructor(t,e){super("outer_2_any_any",t,Qw,Qw,e),this.hash=hi(this.opr,li,li)}isKind(t){if(super.isKind(t)){const e=t.lhs,r=t.rhs;return!Cf(e)&&!Cf(r)}return!1}transform2(t,e,r,n){return[T,n]}};const C$=new class{constructor(t){this.opr=t}create(t){return new U$(this.opr,t)}}(Pe);function D$(t){const e=Tq(t);return function(t){return h(t)&&Rp(t)&&e(t.lhs)}}let B$=class extends y_{constructor(t){super("outer_2_any_mul_2_scalar_any",Pe,Qw,D$(t),t),this.hash=hi(this.opr,li,li)}isKind(t){if(super.isKind(t)){return!Cf(t.lhs)}return!1}transform2(t,e,r){const n=this.$,s=e,i=r.lhs,o=r.rhs,a=n.valueOf(c(t,s,o)),u=n.valueOf(c(r.opr,i,a));return[q,u]}};const K$=new class{create(t){return new B$(t)}};class z$ extends y_{constructor(t){super("outer_2_blade_blade",Pe,Z,Z,t),this.dependencies=["Blade"],this.hash=hi(Pe,Ys,Ys)}transform2(t,e,r){return[q,e.__wedge__(r)]}}const Q$=new class{create(t){return new z$(t)}};let Z$=class extends y_{constructor(t){super("outer_2_mul_2_scalar_any_any",Pe,D$(t),Qw,t),this.hash=hi(this.opr,li,li)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r,a=n.valueOf(c(Pe,i,o)),u=n.valueOf(c(ke,s,a));return[q,u]}};const G$=new class{create(t){return new Z$(t)}};let H$=class extends y_{constructor(t){super("outer_2_sym_sym",Pe,ie,ie,t),this.dependencies=["Vector"],this.hash=hi(Pe,ai,ai)}transform2(t,e,r,n){return[A,n]}};const V$=new class{create(t){return new H$(t)}};function j$(t,e,r){t.ndim+e.ndim>Cs&&er("outer: rank of result exceeds maximum");const n=[...t.copyDimensions(),...e.copyDimensions()],s=[];let i=0;for(let n=0;n<t.nelem;n++)for(let o=0;o<e.nelem;o++)s[i++]=r.multiply(t.elem(n),e.elem(o));return new y(n,s)}let W$=class extends y_{constructor(t){super("outer_2_tensor_tensor",Pe,v,v,t),this.dependencies=[],this.hash=hi(Pe,ui,ui)}transform2(t,e,r){const n=this.$;return[q,j$(e,r,n)]}};const J$=new class{create(t){return new W$(t)}};function X$(t,e){return jf(t)}let Y$=class extends v_{constructor(t){super("pow_2_e_any",Ie,ie,Qw,X$,t),this.hash=hi(this.opr,ai,li)}isImag(t){return!1}isReal(t){return!0}isScalar(t){return!0}transform2(t,e,r,n){const s=this.$;if(s.getNativeDirective($.evaluatingAsPolar));else if(s.getNativeDirective($.evaluatingTrigAsExp));else{if(s.isExpanding()){if(ht(r)){const t=c(Mm,Ut),e=c(Be,Ut),r=c(ke,ft,e);return[q,c($e,t,r)]}if(h(r)&&Rp(r)){const t=r.lhs,e=r.rhs;if(ht(t)){if(oh(e))return[q,jt];if(s.is_real(e)){const t=c(Mm,e),r=c(Be,e),n=c(ke,ft,r);return[q,c($e,t,n)]}}if(s.is_real(t)&&ht(e)){if((n.meta&M)===M)return[T,n];{const e=s.valueOf(c(Mm,t)),r=s.valueOf(c(Be,t)),n=s.valueOf(c(ke,r,ft));return[q,s.valueOf(c($e,e,n))]}}if(h(t)&&jb(ke,Si)(t)&&s.is_real(t.rhs)&&ht(e)){const e=c(Mm,t),r=c(Be,t),n=c(ke,r,ft);return[q,c($e,e,n)]}if(h(e)&&If(e,Q(F.log))){const r=t,n=e.argList.head;return[q,s.valueOf(c(Ie,n,r))]}}if(h(r)&&gh(r)){if(1===wh(r,ht)){const t=function(t,e){const r=t,n=e.valueOf(c(ke,r,ft));return e.valueOf(c(ke,n,jt))}(r,s);return[q,tL(t,s)]}}}if(s.isFactoring())return[q,c(Jo,r)]}return[T,n]}};function tL(t,e){const r=e.valueOf(c(Mm,t)),n=e.valueOf(c(Be,t)),s=e.valueOf(c(ke,ft,n));return e.valueOf(c($e,r,s))}const eL=new class{create(t){return new Y$(t)}},rL=Q(F.log),nL=Q(F.pow);function sL(t,e){if(jf(t)){if(h(e)){const t=e.head;return ie(t)&&t.equalsSym(rL)}return!1}return!1}let iL=class extends v_{constructor(t){super("pow_2_e_log",nL,ie,h,sL,t),this.hash=hi(this.opr,ai,li)}transform2(t,e,r,n){const s=r.argList.head;return[q,s]}};const oL=new class{create(t){return new iL(t)}};function aL(t,e){return jf(t)&&Si(e)}let uL=class extends v_{constructor(t){super("pow_2_e_rat",Ie,ie,Si,aL,t),this.hash=hi(this.opr,ai,li)}transform2(t,e,r,n){return r.isZero()?[T,Ut]:[T,n]}};const cL=new class{create(t){return new uL(t)}};let lL=class extends y_{constructor(t){super("pow_2_imu_rat",Ie,ht,Si,t),this.hash=hi(Ie,si,ii)}isScalar(){return!0}transform2(t,e,r,n){const s=this.$;return r.isTwo()?[q,jt]:r.isMinusOne()?[q,s.negate(ft)]:[T,n]}};const fL=new class{create(t){return new lL(t)}};const hL=x_(h,rx(Ie,jf,x_(h,S_))),pL=Si;function dL(t,e){const r=e;return t.rhs.lhs.isTwo()&&r.isHalf()}let mL=class extends v_{constructor(t){super("pow_2_pow_2_e_any_rat",Ie,hL,pL,dL,t),this.hash=di(this.opr,Ie,li)}transform2(t,e,r,n){const s=this.$,i=e.rhs.rhs,o=e.lhs,a=s.valueOf(c(Ie,o,i));return[q,a]}};const gL=new class{create(t){return new mL(t)}};class wL extends Uw{constructor(t){super("pred_any",B("pred"),Qw,t),this.name="pred_any",this.hash=gi(this.opr,li)}transform1(t,e,r){return[T,r]}}const _L=new class{create(t){return new wL(t)}};class xL extends Uw{constructor(t){super("pred_rat",B("pred"),te,t),this.hash=gi(this.opr,ii)}transform1(t,e){return[q,e.pred()]}}const yL=new class{create(t){return new xL(t)}};function vL(t,e){const r=tr.codeGen,n=tr.printMode;tr.codeGen=!1,tr.setPrintMode(Xe);try{let r=mw(t,e);return r=r.replace(/_/g,"\\_"),r}finally{tr.codeGen=r,tr.setPrintMode(n)}}class bL{constructor(t,e){this.keyword=t,this.$=e}isImag(t){throw new Error("Keyword Symbol Method not implemented.")}isKind(t){return!!ie(t)&&t.equalsSym(this.keyword)}isMinusOne(t){throw new Error("Keyword.isMinusOne Symbol Method not implemented.")}isOne(t){throw new Error("Keyword.isOne Symbol Method not implemented.")}isReal(t){throw new Error("Keyword.isReal Symbol Method not implemented.")}isScalar(t){throw new Error("Keyword.isScalar Symbol Method not implemented.")}isZero(t){throw new Error("Keyword.isZero Symbol Method not implemented.")}subst(t,e,r){throw new Error("Keyword.subst Symbol Method not implemented.")}toInfixString(t){return t.text}toLatexString(t){throw new Error("Keyword.toLatexString Symbol Method not implemented.")}toListString(t){return this.keyword.key()}evaluate(t,e){return this.transform(u(t,e))}transform(t){throw new Error("Keyword.transform Symbol Method not implemented.")}valueOf(t){throw new Error("Keyword.valueOf Symbol Method not implemented.")}}const OL=B("Sym");class EL extends bL{constructor(t,e,r){super(B(t),r),this.printMode=e}get key(){return OL.name}get hash(){return ai}get name(){return this.keyword.text}transform(t){if(ie(t)&&t.equalsSym(this.keyword)){const t=this.$,e=this.printMode(),r=tr.printMode;tr.setPrintMode(e);try{const r=function(t,e,r){switch(e){case We:return $g(t,r);case Xe:return vL(t,r);case Je:return Rw(t,r);case je:return Iw(t,r);case Ye:return sw(t,r);default:throw new Error(e)}}(t.getSymbolValue(Zm),e,t);return this.$.getPrintHandler().print(r),fw(r,lw(e),t),[q,l]}finally{tr.setPrintMode(r)}}return[T,t]}}let SL=class{constructor(t,e){this.keyword=t,this.printMode=e}create(t){return new EL(this.keyword,this.printMode,t)}};function TL(t,e){return new SL(t,e)}class qL extends Uw{constructor(t,e,r){super(t,B(t),Qw,r),this.printMode=e,this.hash=gi(this.opr,li)}transform1(t,e){const r=this.$,n=c(e);if(h(n)){const t=function(t,e,r){const n=[];let s=t;for(;h(s);){const t=r.valueOf(s.car),i=e;tr.setPrintMode(e);try{if(e===Je){const s=mw(t,r);n.push(s),fw(s,lw(e),r)}else if(e===Xe){const s=mw(t,r);n.push(s),fw(s,lw(e),r)}else if(e===We){const s=$g(t,r);n.push(s),fw(s,lw(e),r)}else if(e===je){const s=mw(t,r);n.push(s),fw(s,lw(e),r)}else if(e===Ye){const s=sw(t,r);n.push(s),fw(s,lw(e),r)}}finally{tr.setPrintMode(i)}s=s.argList}return n}(n,this.printMode(),r);this.$.getPrintHandler().print(...t)}return[q,l]}}let AL=class{constructor(t,e){this.opr=t,this.printMode=e}create(t){return new qL(this.opr,this.printMode,t)}};function ML(t,e){return new AL(t,e)}let NL=class extends Fw{constructor(t){super("product",$n,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=Jf(t),n=th(t);ie(n)||er("sum: 2nd arg?");const s=my(sh(t),e);if(isNaN(s))return t;const i=my(ih(t),e);if(isNaN(i))return t;const o=e.getSymbolValue(n);let a=Ut;for(let t=s;t<=i;t++){e.setSymbolValue(n,Ft(t));const s=e.valueOf(r);a=e.multiply(a,s)}return e.setSymbolValue(n,o),a}(t,this.$);return[!e.equals(t)?q:A,e]}};const $L=new class{create(t){return new NL(t)}};function LL(t){return Jf(t)}let kL=class extends Fw{constructor(t){super("quotient",kn,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(Jf(t)),n=e.valueOf(th(t)),s=e.valueOf(sh(t));return p(s)?tS(r,n,Ms,e):tS(r,n,s,e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const RL=new class{create(t){return new kL(t)}};let IL=class extends Fw{constructor(t){super("rank",Rn,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(t.argList.car);return v(r)?Ft(r.rank):Jt}(t,this.$);return[q,e]}};const PL=new class{create(t){return new IL(t)}};let FL=class extends Fw{constructor(t){super("rationalize",In,t),this.phases=I,this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=Jf(t);return lm(e.valueOf(r),e)}(t,this.$);return[e.equals(t)?T:A,e]}};const UL=new class{create(t){return new FL(t)}};let CL=class extends y_{constructor(t){super("rco_2_any_any",De,Qw,Qw,t),this.hash=hi(De,li,li)}transform2(t,e,r,n){return[T,n]}};const DL=new class{create(t){return new CL(t)}};let BL=class extends y_{constructor(t){super("rco_2_any_mul_2_scalar_any",De,Qw,D$(t),t),this.hash=pi(De,li,ke)}transform2(t,e,r){const n=this.$,s=e,i=r.lhs,o=r.rhs,a=n.valueOf(c(t,s,o)),u=n.valueOf(c(r.opr,i,a));return[q,u]}};const KL=new class{create(t){return new BL(t)}};let zL=class extends y_{constructor(t){super("rco_2_blade_blade",De,Z,Z,t),this.hash=hi(De,Ys,Ys)}transform2(t,e,r){return[q,e.__rshift__(r)]}};const QL=new class{create(t){return new zL(t)}};let ZL=class extends y_{constructor(t){super("rco_2_mul_2_scalar_any_any",De,D$(t),Qw,t),this.hash=di(De,ke,li)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r,a=n.valueOf(c(t,i,o)),u=n.valueOf(c(e.opr,s,a));return[q,u]}};const GL=new class{create(t){return new ZL(t)}},HL=Q(F.add),VL=Q(F.real);let jL=class extends Cw{constructor(t){super(VL,HL,t)}transform1(t,e,r){const n=this.$,s=e.argList.map((function(t){return n.valueOf(c(VL,t))})),i=n.valueOf(u(HL,s));return[T,i]}};const WL=new class{create(t){return new jL(t)}};let JL=class extends Uw{constructor(t){super("real",Pn,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){return[T,r]}};const XL=new class{create(t){return new JL(t)}},YL=Q(F.cos),tk=Q(F.real);let ek=class extends Cw{constructor(t){super(tk,YL,t)}transform1(t,e,r){const n=this.$,s=e.argList.head;return n.is_real(s)?[q,e]:[T,r]}};const rk=new class{create(t){return new ek(t)}},nk=Q(F.exp),sk=Q(F.real);let ik=class extends Cw{constructor(t){super(sk,nk,t)}transform1(t,e,r){const n=this.$,s=e.argList.head;return n.is_real(s)?[q,e]:[T,r]}};const ok=new class{create(t){return new ik(t)}},ak=Q(F.real);let uk=class extends Uw{constructor(t){super("real_flt",ak,ot,t),this.hash=gi(this.opr,ri)}transform1(t,e,r){return[T,e]}};const ck=new class{create(t){return new uk(t)}},lk=Q(F.imag),fk=Q(F.real);let hk=class extends Cw{constructor(t){super(fk,lk,t)}transform1(t,e,r){return[q,e]}};const pk=new class{create(t){return new hk(t)}};let dk=class extends Uw{constructor(t){super("real",Pn,ht,t),this.hash=gi(this.opr,si)}transform1(t,e,r){return[q,Jt]}};const mk=new class{create(t){return new dk(t)}},gk=Q(F.real),wk=Q(F.log);let _k=class extends Cw{constructor(t){super(gk,wk,t)}isKind(t){if(super.isKind(t)){return ht(t.argList.head.argList.head)}return!1}transform1(t,e){return[q,Jt]}};const xk=new class{create(t){return new _k(t)}},yk=Q(F.real),vk=Q(F.log);let bk=class extends Cw{constructor(t){super(yk,vk,t)}isKind(t){if(super.isKind(t)){return te(t.argList.head.argList.head)}return!1}transform1(t,e){const r=this.$,n=e.argList.head;if(te(n)){if(n.isZero())return[q,new Vs(e)];if(n.isNegative())throw new Error(r.toInfixString(n));return[q,e]}throw new Error(r.toInfixString(n))}};const Ok=new class{create(t){return new bk(t)}},Ek=Q(F.add),Sk=Q(F.exp),Tk=Q(F.imag),qk=Q(F.pow),Ak=Q(F.real),Mk=Q(F.multiply);function Nk(t,e){return t.length>1?e.valueOf(c(Mk,...t)):1===t.length?e.valueOf(t[0]):Ut}let $k=class extends Cw{constructor(t){super(Ak,Mk,t)}transform1(t,e,r){const n=this.$,s=wh(e,ht);if(s>0){const t=bh(e,ht);switch(s%4){case 0:return[q,n.real(t)];case 1:return[q,n.negate(n.imag(t))];case 2:return[q,n.negate(n.real(t))];case 3:return[q,n.imag(t)];default:throw new Error(`${s}`)}}const i=[],o=[];[...e.argList].forEach((function(t){if(n.is_real(t))i.push(t);else if(ie(t)){const e=c(Ak,t),r=c(Tk,t),n=c(Mk,ft,r),s=c(Ek,e,n);o.push(s)}else if(t.equals(ft))o.push(t);else if(Df(t)){const e=t.lhs,r=t.rhs;if(te(r)&&r.isMinusOne()){const t=n.conj(e),r=n.valueOf(c(Mk,t,e)),s=n.valueOf(c(qk,r,jt)),i=n.valueOf(c(Mk,t,s));o.push(i)}else{const t=Qp(e,r,n),s=Vp(e,r,n),a=n.valueOf(c(Mk,ft,s)),u=n.valueOf(c(Sk,a));i.push(t),o.push(u)}}else{if(!h(t)||!ie(t.opr))throw new Error(n.toSExprString(t));o.push(t)}}));const a=Nk(i,n),u=Nk(o,n);if(u.equals(e))return[T,r];const l=n.valueOf(c(Ak,u)),f=n.valueOf(c(Mk,a,l));return[q,f]}};const Lk=new class{create(t){return new $k(t)}},kk=Q(F.PI),Rk=Q(F.pow),Ik=Q(F.real);let Pk=class extends Cw{constructor(t){super(Ik,Rk,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return te(r)&&te(n)}return!1}transform1(t,e,r){const n=this.$,s=MT(e.lhs);if(s.isMinusOne()){const t=MT(e.rhs);return[q,n.cos(n.multiply(t,kk))]}return s.isPositive()?[q,e]:[q,r]}};const Fk=new class{create(t){return new Pk(t)}};let Uk=class extends Uw{constructor(t){super("real_rat",Pn,te,t),this.hash=gi(this.opr,ii)}transform1(t,e,r){return[T,e]}};const Ck=new class{create(t){return new Uk(t)}},Dk=Q(F.real);let Bk=class extends Cw{constructor(t){super(Dk,Dk,t)}transform1(t,e,r){return[q,e]}};const Kk=new class{create(t){return new Bk(t)}};let zk=class extends Uw{constructor(t){super("real",Pn,ie,t),this.hash=gi(this.opr,ai)}transform1(t,e,r){return this.$.is_real(e)?[T,e]:[T,r]}};const Qk=new class{create(t){return new zk(t)}},Zk=t=>!te(t),Gk=Q(F.rect),Hk=Q(F.multiply);let Vk=class extends Cw{constructor(t){super(Gk,Hk,t)}isKind(t){if(super.isKind(t)){return 1==wh(t.argList.head,te)}return!1}transform1(t,e,r){const n=this.$,s=MT(bh(e,Zk)),i=bh(e,te),o=n.valueOf(c(Gk,i)),a=n.valueOf(c(Hk,s,o));return[q,a]}};const jk=new class{create(t){return new Vk(t)}},Wk=Q(F.rect),Jk=Q(F.pow);let Xk=class extends Cw{constructor(t){super(Wk,Jk,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return!!jf(r)&&!(!h(n)||1!=wh(n,ht))}return!1}transform1(t,e,r){return[q,r]}};const Yk=new class{create(t){return new Xk(t)}};let tR=class extends Fw{constructor(t){super("roots_varargs",Dn,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=Jf(t);let n;if(d(r).equals(Jd)||d(r).equals(Bn))n=e.subtract(e.valueOf(Jf(r)),e.valueOf(th(r)));else{const t=e.valueOf(r);n=d(t).equals(Jd)||d(t).equals(Bn)?e.subtract(e.valueOf(Jf(t)),e.valueOf(th(t))):t}const s=e.valueOf(th(t)),i=l===s?Vh(n):s;if(ip(n,i))return Yd(n,i,e);er("roots: 1st argument is not a polynomial in the variable "+e.toInfixString(i))}(t,this.$);return[!e.equals(t)?q:A,e]}};const eR=new class{create(t){return new tR(t)}};function rR(t,e){return function(t,e){if(!ee(t))return Nd(Un,t);if(ot(t))return J(Math.round(t.d));if(yf(t))return t;const r=uh(t,e);return ot(r)?Ft(Math.round(r.d)):r}(e.valueOf(Jf(t)),e)}let nR=class extends Fw{constructor(t){super("round",Un,t),this.hash=_i(this.opr)}transform(t){const e=rR(t,this.$);return[q,e]}};const sR=new class{create(t){return new nR(t)}};class iR extends bL{constructor(t){super(Zm,t)}get key(){return OL.name}get hash(){return ai}get name(){return"ScriptLast"}evaluate(t){return this.transform(u(Zm,t))}transform(t){return this.isKind(t)?[q,this.$.getSymbolValue(Zm)]:[T,t]}}const oR=new class{create(t){return new iR(t)}};class aR extends Uw{constructor(t){super("sgn_flt",Kn,ot,t),this.hash=gi(this.opr,ri)}transform1(t,e){return[q,cR(e)]}}const uR=new class{create(t){return new aR(t)}};function cR(t){return t.d>0?Ut:0===t.d?Jt:jt}class lR extends Uw{constructor(t){super("sgn_rat",Kn,te,t),this.hash=gi(this.opr,ii)}transform1(t,e){return[q,hR(e)]}}const fR=new class{create(t){return new lR(t)}};function hR(t){const e=df(t.a,t.b);return e.isNegative()?jt:e.isZero()?Jt:Ut}function pR(t,e){return function(t,e){if(!v(t))return e.is_zero(t)||er("transpose: tensor expected, 1st arg is not a tensor"),Jt;const{ndim:r}=t,n=new Array(r),s=[r];for(let e=0;e<r;e++)n[e]=Ft(t.dim(e));return new y(s,n)}(e.valueOf(Jf(t)),e)}let dR=class extends Fw{constructor(t){super("shape",Gn,t),this.hash=_i(this.opr)}transform(t){const e=pR(t,this.$);return[!e.equals(t)?q:A,e]}};const mR=new class{create(t){return new dR(t)}};function gR(t,e){const r=function(t,e){if(0===tr.userSimplificationsInListForm.length||t.contains(hn))return t;let r=sr((function(t){return e.valueOf(t)}),t,e),n=!0,s=0;for(;n&&s<Fs;){n=!1,s++;for(const t of Array.from(tr.userSimplificationsInListForm)){let s=!0,i=0;for(;s&&i<Us;)i++,[r,s]=SO(r,l,t,!0,e),s&&(n=!0);i===Us&&er(`maximum application of single transformation rule exceeded: ${e.toInfixString(t)}`)}}s===Fs&&er("maximum application of all transformation rules exceeded ");return r}(Jf(t),e);return Pm(e.valueOf(r),e)}let wR=class extends Fw{constructor(t){super("simplify_varargs",zn,t),this.hash=_i(this.opr)}transform(t){const e=gR(t,this.$);return[!e.equals(t)?q:A,e]}};const _R=new class{create(t){return new wR(t)}};function xR(t){return Rp(t)&&Z(t.lhs)}let yR=class extends y_{constructor(t){super("simplify_mul_2_blade_mul_2_blade_any",ke,Z,x_(h,xR),t),this.hash=pi(ke,Ys,ke)}transform2(t,e,r){const n=this.$,s=e,i=r.lhs,o=s.mul(i),a=r.rhs,u=n.valueOf(Nd(ke,o,a));return[q,u]}};const vR=new class{create(t){return new yR(t)}};let bR=class extends Uw{constructor(t){super("sin_add_2_any_any",$m,x_(h,jb($e,Qw)),t),this.phases=L,this.hash=wi($m,$e)}transform1(t,e){const r=this.$,n=e.lhs,s=e.rhs,i=r.valueOf(c($m,n)),o=r.valueOf(c(Mm,s)),a=r.valueOf(c(Mm,n)),u=r.valueOf(c($m,s)),l=r.valueOf(c(ke,i,o)),f=r.valueOf(c(ke,a,u)),h=r.valueOf(c($e,l,f));return[q,h]}};const OR=new class{create(t){return new bR(t)}};function ER(t,e,r){return Uf(t)?function(t,e,r){let n=m(t);for(;h(n);){const e=d(n);if(Yb(e,r)){const n=r.subtract(t,e);return[q,r.add(r.multiply(Lm(n,r),Nm(e,r)),r.multiply(Nm(n,r),Lm(e,r)))]}n=m(n)}return SR(t,e,r)}(t,e,r):SR(t,e,r)}function SR(t,e,r){if(d(t).equals(dr))return[q,Jf(t)];if(ot(t)){let e=Math.sin(t.d);return Math.abs(e)<1e-10&&(e=0),[q,J(e)]}if(qd(t))return[q,r.negate(Lm(r.negate(t),r))];if(d(t).equals(gr))return[q,r.multiply(Jf(t),r.power(r.add(Ut,r.power(Jf(t),Ct)),Lf(-1,2)))];const n=vf(Mp(r.multiply(t,Ft(180)),ar.Pi(r),r));if(n<0||isNaN(n))return[T,e];switch(n%360){case 0:case 180:return[q,Jt];case 30:case 150:return[q,Xt];case 210:case 330:return[q,Lf(-1,2)];case 45:case 135:return[q,r.multiply(Xt,r.power(Ct,Xt))];case 225:case 315:return[q,r.multiply(Lf(-1,2),r.power(Ct,Xt))];case 60:case 120:return[q,r.multiply(Xt,r.power(Dt,Xt))];case 240:case 300:return[q,r.multiply(Lf(-1,2),r.power(Dt,Xt))];case 90:return[q,Ut];case 270:return[q,jt];default:return[T,e]}}let TR=class extends Uw{constructor(t){super("sin_any",$m,Qw,t),this.hash=gi($m,li)}transform1(t,e,r){const n=this.$;return n.isExpanding()?ER(e,r,n):[T,r]}};const qR=new class{create(t){return new TR(t)}};let AR=class extends Uw{constructor(t){super("sin_hyp",$m,ct,t),this.hash=gi($m,ni)}transform1(t,e){return[q,e]}};const MR=new class{create(t){return new AR(t)}};let NR=class extends Uw{constructor(t){super("sin_mul_2_any_imu",$m,x_(h,iO(ke,ht)),t),this.hash=wi($m,ke)}transform1(t,e,r){const n=this.$,s=e.lhs,i=e.rhs;if(n.isExpanding()){const t=n.valueOf(c(Zn,s)),e=n.valueOf(c(ke,t,i));return[q,e]}return[A,r]}};const $R=new class{create(t){return new NR(t)}};let LR=class extends Uw{constructor(t){super("sin_sym",$m,ie,t),this.hash=gi($m,ai)}isReal(t){return this.$.is_real(t.arg)}transform1(t,e,r){return ER(e,r,this.$)}};const kR=new class{create(t){return new LR(t)}};let RR=class extends Uw{constructor(t){super("sinh",Zn,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){const n=ay(e,this.$);return[!n.equals(r)?q:T,n]}};const IR=new class{create(t){return new RR(t)}};let PR=class extends Uw{constructor(t){super("sinh_flt",Zn,ot,t),this.dependencies=["Flt"],this.hash=gi(this.opr,ri)}isReal(t){return!0}transform1(t,e,r){const n=Math.sinh(e.d);return Math.abs(n)<1e-10?[q,Y]:[q,J(n)]}};const FR=new class{create(t){return new PR(t)}};let UR=class extends Uw{constructor(t){super("sinh_rat",Zn,te,t),this.hash=gi(this.opr,ii)}isReal(t){return!0}transform1(t,e,r){return e.isZero()?[q,Jt]:[A,r]}};const CR=new class{create(t){return new UR(t)}};let DR=class extends Uw{constructor(t){super("sinh_sym",Zn,ie,t),this.hash=gi(this.opr,ai)}isReal(t){return!0}transform1(t,e,r){return[A,r]}};const BR=new class{create(t){return new DR(t)}};class KR extends Uw{constructor(t){super("sqrt_1_any",jw,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e){return[q,this.$.valueOf(c(Ie,e,Xt))]}}const zR=new class{create(t){return new KR(t)}};class QR extends Uw{constructor(t){super("sqrt_1_rat",jw,te,t),this.hash=gi(jw,ii)}transform1(t,e){return[q,this.$.valueOf(Nd(Ie,e,Xt))]}}const ZR=new class{create(t){return new QR(t)}},GR=B("st");const HR=x_(h,rx($e,Qw,ct));let VR=class extends Uw{constructor(t){super("st_add_2_any_hyp",GR,HR,t),this.phases=L,this.hash=wi(GR,$e)}transform1(t,e){const r=this.$,n=e.lhs,s=r.valueOf(c(GR,n));return[q,s]}};const jR=new class{create(t){return new VR(t)}};let WR=class extends Uw{constructor(t){super("st_any",GR,Qw,t),this.hash=gi(GR,li)}transform1(t,e,r){return this.$.is_real(e)?[q,e]:[T,r]}};const JR=new class{create(t){return new WR(t)}};const XR=x_(h,rx(ke,te,Qw));let YR=class extends Uw{constructor(t){super("st_mul_2_rat_any",GR,XR,t),this.phases=L,this.hash=wi(GR,ke)}transform1(t,e){const r=this.$,n=e.lhs,s=e.rhs,i=r.valueOf(c(t,s)),o=r.valueOf(c(e.opr,n,i));return[q,o]}};const tI=new class{create(t){return new YR(t)}};let eI=class extends Uw{constructor(t){super("st_rat",GR,Si,t),this.hash=gi(GR,li)}transform1(t,e){return[q,e]}};const rI=new class{create(t){return new eI(t)}};let nI=class extends Uw{constructor(t){super("st_sym",GR,ie,t),this.hash=gi(GR,li)}transform1(t,e){return[q,e]}};const sI=new class{create(t){return new nI(t)}};let iI=class extends Fw{constructor(t){super("subst",Vn,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(Jf(t)),n=e.valueOf(th(t)),s=e.valueOf(sh(t));return e.valueOf(Ip(s,n,r,e))}(t,this.$);return[!e.equals(t)?q:A,e]}};const oI=new class{create(t){return new iI(t)}};class aI extends Uw{constructor(t){super("succ_any",B("succ"),Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){return[T,r]}}const uI=new class{create(t){return new aI(t)}};class cI extends Uw{constructor(t){super("succ_rat",B("succ"),te,t),this.hash=gi(this.opr,ii)}transform1(t,e,r){return[q,e.succ()]}}const lI=new class{create(t){return new cI(t)}};function fI(t,e){const r=function(t,e){const r=Jf(t),n=th(t);ie(n)||er("sum: 2nd arg?");const s=my(sh(t),e);if(isNaN(s))return t;const i=my(ih(t),e);if(isNaN(i))return t;const o=e.getSymbolValue(n);let a=Jt;try{for(let t=s;t<=i;t++)e.setSymbolValue(n,Ft(t)),a=e.add(a,e.valueOf(r))}finally{e.setSymbolValue(n,o)}return a}(t,e);return r}let hI=class extends Fw{constructor(t){super("sum",jn,t),this.hash=_i(this.opr)}transform(t){const e=fI(t,this.$);return[!e.equals(t)?q:A,e]}};const pI=new class{create(t){return new hI(t)}};class dI{constructor(t){this.$=t}get key(){return OL.name}get hash(){return ai}get name(){return"SymExtension"}valueOf(t,e){if(oh(t)&&e.getNativeDirective($.evaluatingAsFloat))return rt;const r=e.getSymbolValue(t);return l===r?t:t!==r?e.valueOf(r):t}isImag(t,e){return!1}isKind(t){return!!ie(t)}isMinusOne(t,e){return!1}isOne(t,e){return!1}isReal(t,e){return e.is_real(t)}isScalar(t,e){return!0}isZero(){return!1}subst(t,e,r){return ie(e)&&t.equals(e)?r:t}toInfixString(t){return t.key()}toLatexString(t){return t.key()}toListString(t){const e=this.$.getSymbolPrintName(t);return e||t.key()}evaluate(t,e){return this.transform(u(t,e))}transform(t){if(ie(t)){return function(t,e){const r=e.getSymbolValue(t);return p(r)||t.equals(r)?[T,t]:[q,r]}(t,this.$)}return[T,t]}}const mI=new Oi((function(t){return new dI(t)}));class gI{constructor(t){this.$=t}get key(){return OL.name}get hash(){return ai}get name(){return"SymMathAdd"}isImag(t){throw new Error("SymMathAdd Method not implemented.")}isKind(t){return!!ie(t)&&$e.equalsSym(t)}isMinusOne(t){throw new Error("SymMathAdd Method not implemented.")}isOne(t){throw new Error("SymMathAdd Method not implemented.")}isReal(t){throw new Error("SymMathAdd Method not implemented.")}isScalar(t){throw new Error("SymMathAdd Method not implemented.")}isZero(t){throw new Error("SymMathAdd Method not implemented.")}subst(t,e,r){return t.equals(e)?r:t}toInfixString(){return"+"}toLatexString(){return"+"}toListString(){return this.$.getSymbolPrintName($e)}evaluate(t,e){return this.transform(u(t,e))}transform(t){return ie(t)&&$e.equalsSym(t)?[A,t]:[T,t]}valueOf(t){return t}}const wI=new class{create(t){return new gI(t)}};class _I{constructor(t){this.$=t}get key(){return OL.name}get hash(){return ai}get name(){return"SymMathMul"}evaluate(t,e){return this.transform(u(t,e))}transform(t){return[this.isKind(t)?A:T,t]}isImag(t){throw new Error("SymMathMul Method not implemented.")}isKind(t){return ie(t)&&ke.equals(t)}isMinusOne(t){throw new Error("SymMathMul Method not implemented.")}isOne(t){throw new Error("SymMathMul Method not implemented.")}isReal(t){throw new Error("SymMathMul Method not implemented.")}isScalar(t){throw new Error("SymMathMul Method not implemented.")}isZero(t){throw new Error("SymMathMul Method not implemented.")}subst(t,e,r){return t.equals(e)?r:t}toInfixString(t){return"*"}toLatexString(t){return"*"}toListString(t){return this.$.getSymbolPrintName(ke)}valueOf(t){return Mi(this.transform(t)[1])}}const xI=new class{create(t){return new _I(t)}};class yI{constructor(t){this.$=t}get key(){return OL.name}get hash(){return ai}get name(){return"SymMathPi"}evaluate(t,e){return this.transform(u(t,e))}transform(t){return[this.isKind(t)?A:T,t]}isImag(){return!1}isKind(t){return oh(t)}isMinusOne(){return!1}isOne(){return!1}isReal(){return!0}isScalar(){return!0}isZero(){return!1}subst(t,e,r){return t.equals(e)?r:t}toInfixString(t){return this.$.getSymbolPrintName(ze)}toLatexString(t){return"\\pi"}toListString(t){return this.$.getSymbolPrintName(ze)}valueOf(t){return Mi(this.transform(t)[1])}}const vI=new class{create(t){return new yI(t)}},bI=Q(F.pow);class OI{constructor(t){this.$=t}get key(){return OL.name}get hash(){return ai}get name(){return"SymMathPow"}evaluate(t,e){return this.transform(u(t,e))}transform(t){return[this.isKind(t)?A:T,t]}isImag(t){throw new Error("SymMathPow Method not implemented.")}isKind(t){return ie(t)&&bI.equals(t)}isMinusOne(t){throw new Error("SymMathPow Method not implemented.")}isOne(t){throw new Error("SymMathPow Method not implemented.")}isReal(t){throw new Error("SymMathPow Method not implemented.")}isScalar(t){throw new Error("SymMathPow Method not implemented.")}isZero(t){throw new Error("SymMathPow Method not implemented.")}subst(t,e,r){return t.equals(e)?r:t}toInfixString(t){return this.$.getNativeDirective($.useCaretForExponentiation)?"^":"**"}toLatexString(t){return" ^ "}toListString(t){return this.$.getSymbolPrintName(bI)}valueOf(t){return Mi(this.transform(t)[1])}}const EI=new class{create(t){return new OI(t)}};function SI(t,e){return TI(e.valueOf(Jf(t)),e)}function TI(t,e){if(d(t).equals(gr))return Jf(t);if(ot(t)){let e=Math.tan(t.d);return Math.abs(e)<1e-10&&(e=0),J(e)}if(qd(t))return e.negate(TI(e.negate(t),e));const r=vf(Mp(e.multiply(t,Ft(180)),ar.Pi(e),e));if(r<0||isNaN(r))return Nd(Wn,t);switch(r%360){case 0:case 180:return Jt;case 30:case 210:return e.multiply(Yt,e.power(Dt,Xt));case 150:case 330:return e.multiply(Lf(-1,3),e.power(Dt,Xt));case 45:case 225:return Ut;case 135:case 315:return jt;case 60:case 240:return e.power(Dt,Xt);case 120:case 300:return e.negate(e.power(Dt,Xt));default:return Nd(Wn,t)}}let qI=class extends Fw{constructor(t){super("tan",Wn,t),this.hash=_i(this.opr)}transform(t){const e=this.$;if(e.isExpanding()){const r=SI(t,e);return[!r.equals(t)?q:A,r]}return[T,t]}};const AI=new class{create(t){return new qI(t)}};function MI(t,e){return function(t,e){if(d(t).equals(wr))return Jf(t);if(ot(t)){let e=Math.tanh(t.d);return Math.abs(e)<1e-10&&(e=0),J(e)}if(e.is_zero(t))return Jt;return c(Jn,t)}(e.valueOf(Jf(t)),e)}let NI=class extends Fw{constructor(t){super("tanh",Jn,t),this.hash=_i(this.opr)}transform(t){const e=MI(t,this.$);return[!e.equals(t)?q:A,e]}};const $I=new class{create(t){return new NI(t)}},LI=Q(F.PI),kI=Q(F.tau);let RI=class extends Uw{constructor(t){super("tau_any",kI,Qw,t)}transform1(t,e,r){const n=this.$.multiply(Ct,LI),s=this.$.multiply(n,e);return[q,s]}};const II=new class{create(t){return new RI(t)}};function PI(t,e){t=m(t);const r=e.valueOf(d(t));t=m(t);let n=e.valueOf(d(t));const s=l===n?Vh(tr.stack[tr.tos-1]):n;t=m(t),n=e.valueOf(d(t));const i=l===n?Ft(24):n;t=m(t),n=e.valueOf(d(t));return function(t,e,r,n,s){const i=vf(r);if(isNaN(i))return Nd(Xn,t,e,r,n);const o=s.subtract(e,n);let a=t,u=Ut,c=s.valueOf(Ip(a,e,n,s));for(let t=1;t<=i&&(a=hy(a,e,s),!s.is_zero(a));t++){u=s.multiply(u,o);const r=s.valueOf(Ip(a,e,n,s)),i=Mp(s.multiply(r,u),im(Ft(t)),s);c=s.add(c,i)}return c}(r,s,i,l===n?Jt:n,e)}let FI=class extends Fw{constructor(t){super("taylor",Xn,t),this.hash=_i(this.opr)}transform(t){const e=PI(t,this.$);return[!e.equals(t)?q:A,e]}};const UI=new class{create(t){return new FI(t)}},CI=Q(F.test_eq);let DI=class extends y_{constructor(t){super("testeq_sym_rat",CI,ie,te,t),this.hash=hi(CI,ai,ii)}transform2(t,e,r,n){return[q,j]}};const BI=new class{create(t){return new DI(t)}};let KI=class extends y_{constructor(t){super("testgt_mul_2_any_any_rat",He,x_(h,Rp),te,t),this.hash=di(He,ke,ii)}transform2(t,e,r,n){if(r.isNegative())return[q,j];if(r.isZero()){const t=this.$,r=e.lhs,n=e.rhs,s=t.valueOf(c(Ge,r,Jt)),i=t.valueOf(c(Ge,n,Jt)),o=t.valueOf(c(He,r,Jt)),a=t.valueOf(c(He,n,Jt));if(W(s)&&W(o)&&W(i)&&W(a)){const t=o.isTrue()&&a.isTrue()||s.isTrue()&&i.isTrue();return[q,t?V:j]}return[q,j]}return[q,j]}};const zI=new class{create(t){return new KI(t)}};let QI=class extends y_{constructor(t){super("testgt_rat_rat",He,te,te,t),this.hash=hi(He,ii,ii)}transform2(t,e,r){return[q,e.compare(r)>0?V:j]}};const ZI=new class{create(t){return new QI(t)}};let GI=class extends y_{constructor(t){super("testgt_sym_rat",He,ie,te,t),this.hash=hi(He,ai,ii)}transform2(t,e,r,n){return r.isNegative()||r.isZero()?[q,V]:[q,j]}};const HI=new class{create(t){return new GI(t)}};let VI=class extends y_{constructor(t){super("testlt_flt_rat",Ge,Mh,te,t),this.hash=hi(Ge,ri,ii)}transform2(t,e,r){return[q,Lh(e,r)<0?V:j]}};const jI=new class{create(t){return new VI(t)}};let WI=class extends y_{constructor(t){super("testlt_mul_2_any_any_rat",Ge,x_(h,Rp),te,t),this.hash=di(Ge,ke,ii)}transform2(t,e,r,n){if(r.isNegative())return[q,j];if(r.isZero()){const t=this.$,r=e.lhs,n=e.rhs,s=t.valueOf(c(Ge,r,Jt)),i=t.valueOf(c(Ge,n,Jt)),o=t.valueOf(c(He,r,Jt)),a=t.valueOf(c(He,n,Jt));if(W(s)&&W(o)&&W(i)&&W(a)){const t=s.isTrue()&&a.isTrue()||o.isTrue()&&i.isTrue();return[q,t?V:j]}return[q,j]}return[q,j]}};const JI=new class{create(t){return new WI(t)}};let XI=class extends y_{constructor(t){super("testlt_rat_rat",Ge,te,te,t),this.hash=hi(Ge,ii,ii)}transform2(t,e,r){return[q,e.compare(r)<0?V:j]}};const YI=new class{create(t){return new XI(t)}};let tP=class extends y_{constructor(t){super("testlt_sym_rat",Ge,ie,te,t),this.hash=hi(Ge,ai,ii)}transform2(t,e,r,n){return r.isNegative()||r.isZero(),[q,j]}};const eP=new class{create(t){return new tP(t)}};let rP=class extends Fw{constructor(t){super("transpose",ss,t),this.hash=_i(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(Jf(t));let n=Ut,s=Ct;return l!==Xf(t)&&(n=e.valueOf(th(t)),s=e.valueOf(sh(t))),Im(r,n,s,e)}(t,this.$);return[!e.equals(t)?q:A,e]}};const nP=new class{create(t){return new rP(t)}};function sP(t){return function(e){return If(e,t)&&function(t){return 2===t.length}(e)}}const iP=x_(h,sP(Mm)),oP=x_(h,sP(Mm)),aP=x_(h,rx(ke,iP,oP)),uP=te,cP=x_(h,sP($m)),lP=x_(h,rx(ke,uP,cP)),fP=x_(h,sP($m)),hP=x_(h,rx(ke,lP,fP));function pP(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.lhs,i=e.lhs.rhs.arg,o=e.rhs.arg;return s.isMinusOne()&&r.equals(i)&&n.equals(o)}let dP=class extends v_{constructor(t){super("add_2_mul_2_cos_cos_mul_2_mul_2_rat_sin_sin",$e,aP,hP,pP,t),this.phases=k,this.hash=mi($e,ke,ke)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=n.lhs.rhs.arg,a=s.valueOf(c($e,i,o)),u=s.valueOf(c(Mm,a));return[q,u]}};const mP=new class{create(t){return new dP(t)}};const gP=x_(h,rx(ke,x_(h,sP(Mm)),x_(h,sP(Mm)))),wP=x_(h,rx(ke,x_(h,sP($m)),x_(h,sP($m))));function _P(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.arg,i=e.rhs.arg;return r.equals(s)&&n.equals(i)}let xP=class extends v_{constructor(t){super("add_2_mul_2_sin_cos_mul_2_cos_sin",$e,gP,wP,_P,t),this.phases=k,this.hash=mi($e,ke,ke)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=n.lhs.rhs.arg,a=s.valueOf(c($e,i,s.negate(o))),u=s.valueOf(c(Mm,a));return[q,u]}};const yP=new class{create(t){return new xP(t)}};const vP=x_(h,rx(ke,x_(h,sP(Mm)),x_(h,sP($m)))),bP=x_(h,rx(ke,x_(h,sP(Mm)),x_(h,sP($m))));function OP(t,e){const r=t.rhs.arg,n=t.lhs.arg,s=e.lhs.arg,i=e.rhs.arg;return r.equals(s)&&n.equals(i)}let EP=class extends v_{constructor(t){super("add_2_mul_2_cos_sin_mul_2_cos_sin_factoring",$e,vP,bP,OP,t),this.phases=k,this.hash=mi($e,ke,ke)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=n.lhs.rhs.arg,a=s.valueOf(c($e,i,o)),u=s.valueOf(c($m,a));return[q,u]}};const SP=new class{create(t){return new EP(t)}};function TP(t){return function(t){const e=t.opr;return!!ie(e)&&Pe.equalsSym(e)}(t)&&Lp(t)}function qP(t){if(Am(t)){return rp(t.rhs)}return!1}function AP(t){let e=t;const r=[];for(;h(e);){if(!Rp(e)){if(qP(e)){const t=e.lhs,n=e.rhs;r.push(c(Ie,t,n.pred())),e=t}break}r.push(e.rhs),e=e.lhs}for(;r.length>1;){const t=r.pop(),e=r.pop(),n=c(ke,t,e);r.push(n)}return r.length>0?[e,r[0],!0]:[e,Ut,!1]}function MP(t,e){if(Z(t.rhs)&&Z(e.rhs))switch(ph(t.rhs,e.rhs)){case S:return S;case O:return O;default:return DP(t.lhs,e.lhs)}const[r,n,s]=AP(t),[i,o,a]=AP(e);if(!s&&!a)return E;switch(DP(r,i)){case S:return S;case O:return O;default:return DP(n,o)}}function NP(t,e){if(ie(t)){if(ie(e))return kh(t,e);throw p(e),new Error}throw p(t)?(ie(e)||p(e),new Error):new Error}const $P=0,LP=1,kP=2,RP=3,IP=4,PP=5,FP=6,UP=7,CP=8;function DP(t,e){if(t.equals(e))return E;if(h(t)){if(Rp(t)){if(h(e))return Rp(e)?MP(t,e):(Tb(e),NP(t.car,e.car));if(te(e))return S;if(ie(e))return E;throw new Error(`lhs: Multiply = ${t}, rhs = ${e}`)}if(Am(t)){if(h(e))return Rp(e)||Am(e)?MP(t,e):Tb(e)?S:E;if(ie(e))return S;throw new Error(`lhs: Power = ${t}, rhs = ${e}`)}if(Tb(t)){if(h(e)){if(Rp(e))return O;if(TP(e))return O;if(Tb(e))return E;if(Am(e))return O;throw ot(e)?new Error(`lhs: Inner = ${t}, rhs: Flt = ${e}`):new Error(`lhs: Inner = ${t}, rhs: Cons = ${e}`)}return E}if(TP(t)){if(h(e)){if(Tb(e))return S;throw new Error(`lhs: Outer = ${t}, rhs: Cons = ${e}`)}if(te(e))return S;throw new Error(`lhs: Outer = ${t}, rhs = ${e}`)}if(h(e))return DP(t.opr,e.opr);if(ie(e))return S;throw new Error(`lhs: Cons = ${t}, rhs = ${e}`)}if(te(t)){if(h(e)){if(TP(e))return O;if(Rp(e))return O}if(te(e))return t.compare(e);if(ie(e))return O;throw new Error(`lhs: Rat = ${t}, rhs = ${e}`)}if(ot(t)){if(h(e))return O;if(ot(e))return t.compare(e);throw new Error(`lhs: Flt = ${t}, rhs = ${e}`)}if(ie(t)){if(te(e))return S;if(ie(e))return kh(t,e);if(ct(e))return O;if(Z(e))return O;if(h(e)){if(Rp(e))return function(t){const[e,r]=AP(t);ht(e)}(e),O;if(Am(e)){if(ht(e))return O;throw new Error(`lhs: Sym = ${t}, rhs: Power = ${e}`)}return O}throw new Error(`lhs: Sym = ${t}, rhs = ${e}`)}if(ct(t)){if(ie(e))return S;throw new Error(`lhs: Hyp = ${t}, rhs = ${e} group(rhs)=${function(t){if(te(t))return LP;if(ot(t))return LP;if(ie(t))return kP;if(h(t))return PP;if(ct(t))return IP;if(ht(t))return FP;if(Z(t))return UP;if(v(t))return RP;if(Me(t))return CP;if(p(t))return $P;throw new Error(`group() of ${t}`)}(e)}`)}throw new Error(`lhs = ${t}, rhs = ${e}`)}const BP=x_(h,rx(ke,x_(h,sP(Mm)),x_(h,sP($m)))),KP=x_(h,rx(ke,x_(h,sP(Mm)),x_(h,sP($m))));function zP(t,e){const r=t.rhs.arg,n=t.lhs.arg,s=e.lhs.arg,i=e.rhs.arg;return r.equals(s)&&n.equals(i)&&DP(n,r)>0}let QP=class extends v_{constructor(t){super("add_2_mul_2_cos_sin_mul_2_cos_sin_ordering",$e,BP,KP,zP,t),this.phases=P,this.hash=mi($e,ke,ke)}transform2(t,e,r,n){const s=this.$,i=c(t,n.rhs,n.lhs),o=s.valueOf(i);return[q,o]}};const ZP=new class{create(t){return new QP(t)}};const GP=x_(h,sP(Mm)),HP=x_(h,sP($m)),VP=x_(h,rx(ke,GP,HP)),jP=te,WP=x_(h,sP(Mm)),JP=x_(h,rx(ke,jP,WP)),XP=x_(h,sP($m)),YP=x_(h,rx(ke,JP,XP));function tF(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.lhs,i=e.lhs.rhs.arg,o=e.rhs.arg;return s.isMinusOne()&&n.equals(i)&&r.equals(o)}let eF=class extends v_{constructor(t){super("add_2_mul_2_cos_sin_mul_2_mul_2_rat_cos_sin_factoring",$e,VP,YP,tF,t),this.phases=k,this.hash=mi($e,ke,ke)}transform2(t,e,r,n){const s=this.$,i=n.lhs.rhs.arg,o=n.lhs.lhs.arg,a=s.valueOf(c($e,i,s.negate(o))),u=s.valueOf(c($m,a));return[q,u]}};const rF=new class{create(t){return new eF(t)}};const nF=x_(h,sP(Mm)),sF=x_(h,sP($m)),iF=x_(h,rx(ke,nF,sF)),oF=te,aF=x_(h,sP(Mm)),uF=x_(h,rx(ke,oF,aF)),cF=x_(h,sP($m)),lF=x_(h,rx(ke,uF,cF));function fF(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.lhs,i=e.lhs.rhs.arg,o=e.rhs.arg;return s.isMinusOne()&&n.equals(i)&&r.equals(o)&&DP(r,n)>0}let hF=class extends v_{constructor(t){super("add_2_mul_2_cos_sin_mul_2_mul_2_rat_cos_sin_ordering",$e,iF,lF,fF,t),this.phases=P,this.hash=mi($e,ke,ke)}transform2(t,e,r,n){const s=this.$,i=c(t,n.rhs,n.lhs),o=s.valueOf(i);return[q,o]}};const pF=new class{create(t){return new hF(t)}};const dF=x_(h,sP(Mm)),mF=x_(h,sP($m)),gF=x_(h,rx(ke,dF,mF)),wF=te,_F=x_(h,sP($m)),xF=x_(h,rx(ke,wF,_F)),yF=x_(h,sP(Mm)),vF=x_(h,rx(ke,xF,yF));function bF(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.lhs,i=e.lhs.rhs.arg,o=e.rhs.arg;return s.isMinusOne()&&r.equals(i)&&n.equals(o)}let OF=class extends v_{constructor(t){super("add_2_mul_2_cos_sin_mul_2_mul_2_rat_sin_cos",$e,gF,vF,bF,t),this.phases=k,this.hash=mi($e,ke,ke)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=n.lhs.rhs.arg,a=s.valueOf(c($e,o,s.negate(i))),u=s.valueOf(c($m,a));return[q,u]}};const EF=new class{create(t){return new OF(t)}};const SF=te,TF=x_(h,sP(Mm)),qF=x_(h,rx(ke,SF,TF)),AF=x_(h,sP($m)),MF=x_(h,rx(ke,qF,AF)),NF=x_(h,sP(Mm)),$F=x_(h,sP($m)),LF=x_(h,rx(ke,NF,$F));function kF(t,e){const r=t.lhs.lhs,n=t.lhs.rhs.arg,s=t.rhs.arg,i=e.rhs.arg,o=e.lhs.arg;return r.isMinusOne()&&n.equals(i)&&s.equals(o)}let RF=class extends v_{constructor(t){super("add_2_mul_2_rat_cos_sin_mul_2_mul_2_cos_sin_factoring",$e,MF,LF,kF,t),this.phases=k,this.hash=mi($e,ke,ke)}transform2(t,e,r,n){const s=this.$,i=n.rhs.rhs.arg,o=n.rhs.lhs.arg,a=s.valueOf(c($e,i,s.negate(o))),u=s.valueOf(c($m,a));return[q,u]}};const IF=new class{create(t){return new RF(t)}};const PF=x_(h,rx(ke,x_(h,sP($m)),x_(h,sP(Mm)))),FF=x_(h,rx(ke,x_(h,sP(Mm)),x_(h,sP($m))));function UF(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.arg,i=e.rhs.arg;return r.equals(s)&&n.equals(i)}let CF=class extends v_{constructor(t){super("add_2_mul_2_sin_cos_mul_2_cos_sin",$e,PF,FF,UF,t),this.phases=k,this.hash=mi($e,ke,ke)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=n.lhs.rhs.arg,a=s.valueOf(c($e,i,o)),u=s.valueOf(c($m,a));return[q,u]}};const DF=new class{create(t){return new CF(t)}};const BF=x_(h,sP($m)),KF=x_(h,sP(Mm)),zF=x_(h,rx(ke,BF,KF)),QF=te,ZF=x_(h,sP(Mm)),GF=x_(h,rx(ke,QF,ZF)),HF=x_(h,sP($m)),VF=x_(h,rx(ke,GF,HF));function jF(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.lhs,i=e.lhs.rhs.arg,o=e.rhs.arg;return s.isMinusOne()&&r.equals(i)&&n.equals(o)}let WF=class extends v_{constructor(t){super("add_2_mul_2_sin_cos_mul_2_mul_2_rat_cos_sin",$e,zF,VF,jF,t),this.phases=k,this.hash=mi($e,ke,ke)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=s.negate(n.lhs.rhs.arg),a=s.valueOf(c($e,i,o)),u=s.valueOf(c($m,a));return[q,u]}};const JF=new class{create(t){return new WF(t)}};const XF=x_(h,sP($m)),YF=x_(h,sP(Mm)),tU=x_(h,rx(ke,XF,YF)),eU=x_(h,sP(Mm)),rU=x_(h,sP($m)),nU=x_(h,rx(ke,eU,rU)),sU=x_(h,rx(ke,te,nU));function iU(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs,i=e.rhs.lhs.arg,o=e.rhs.rhs.arg;return s.isMinusOne()&&r.equals(i)&&n.equals(o)}let oU=class extends v_{constructor(t){super("add_2_mul_2_sin_cos_mul_2_rat_mul_2_cos_sin",$e,tU,sU,iU,t),this.phases=k,this.hash=mi($e,ke,ke)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=s.negate(n.lhs.rhs.arg),a=s.valueOf(c($e,i,o)),u=s.valueOf(c($m,a));return[q,u]}};const aU=new class{create(t){return new oU(t)}};const uU=x_(h,rx(Ie,x_(h,sP(Mm)),te)),cU=x_(h,rx(Ie,x_(h,sP($m)),te));function lU(t,e){const r=t.lhs.arg,n=t.rhs,s=e.lhs.arg,i=e.rhs;return r.equals(s)&&n.isTwo()&&i.isTwo()}let fU=class extends v_{constructor(t){super("add_2_pow_2_cos_rat_pow_2_sin_rat",$e,uU,cU,lU,t),this.phases=k,this.hash=mi($e,Ie,Ie)}transform2(t,e,r,n){return[q,Ut]}};const hU=new class{create(t){return new fU(t)}};let pU=class extends y_{constructor(t,e,r,n,s){super(t,e,x_(h,sP(r)),x_(h,sP(n)),s),this.hash=mi(e,r,n)}transform2(t,e,r,n){const s=this.$;return[q,s.valueOf(Nd(t,n.rhs,n.lhs))]}};const dU=new class{constructor(t,e,r,n){this.name=t,this.opr=e,this.lhs=r,this.rhs=n}create(t){return new pU(this.name,this.opr,this.lhs,this.rhs,t)}}("mul_2_sin_cos",ke,$m,Mm);let mU=class extends Uw{constructor(t){super("typeof_any",B("typeof"),Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){return[T,r]}};const gU=new class{create(t){return new mU(t)}},wU=B("Blade");let _U=class extends Uw{constructor(t){super("typeof_blade",B("typeof"),fg,t),this.dependencies=["Blade"],this.hash=gi(this.opr,Ys)}transform1(t,e,r){return[q,wU]}};const xU=new class{create(t){return new _U(t)}},yU=B("Tensor");class vU extends Uw{constructor(t){super("typeof_tensor",B("typeof"),v,t),this.dependencies=[],this.hash=gi(this.opr,ui)}transform1(t,e,r){return[q,yU]}}const bU=new class{create(t){return new vU(t)}};let OU=class extends Uw{constructor(t){super("unit",is,Qw,t),this.hash=gi(this.opr,li)}transform1(t,e,r){return function(t,e,r){const n=my(Jf(e),r);if(isNaN(n))return[T,e];if(n<1)return[T,e];const s=[n,n],i=Tp(n,Ut,Jt),o=new y(s,i);return[q,o]}(0,r,this.$)}};const EU=new class{create(t){return new OU(t)}};class SU extends Uw{constructor(t){super("uom_1_str",B("uom"),Sh,t),this.hash=gi(B("uom"),oi)}transform1(t,e){return[q,Ne(e.str)]}}const TU=new class{create(t){return new SU(t)}};function qU(t,e){return function(t,e){const r=Array(Cs).fill(0);let n=1,s=0;for(const i of t.tail()){const t=my(i,e);if(t<1||isNaN(t))return Jt;n*=t,r[s++]=t}if(0===s)return Jt;const i=new Array(s);for(let t=0;t<s;t++)i[t]=r[t];const o=Sp(n,Jt);return new y(i,o)}(t,e)}let AU=class extends Fw{constructor(t){super("zero",os,t),this.hash=_i(this.opr)}transform(t){const e=qU(t,this.$);return[!e.equals(t)?q:A,e]}};const MU=new class{create(t){return new AU(t)}};function NU(t,e){let r=0;if(!Cf(t))return 0;if(e.equals(Jf(t),ft))return oh(th(t))?3!==jh(t)?0:2:0;if(!ee(Jf(t)))return 0;if(!e.equals(th(t),ft))return 0;if(!oh(sh(t)))return 0;if(4!==jh(t))return 0;let n=vf(e.multiply(Jf(t),Ct));if(isNaN(n))return 0;switch(n<1&&(r=1,n=-n),n%4){case 0:n=1;break;case 1:n=r?4:3;break;case 2:n=2;break;case 3:n=r?3:4}return n}function $U(t,e,r){const n=jh(e)-1,s=[];let i=m(e);for(let e=0;e<n;e++){for(let n=0;n<=t;n++)s[e*(t+1)+n]=r.power(d(i),Ft(n));i=m(i)}const o=[];for(let t=0;t<n;t++)o[t]=0;return LU(n,t,o,0,t,s,im(Ft(t)),Jt,r)}function LU(t,e,r,n,s,i,o,a,u){if(n<t-1){for(let c=0;c<=s;c++)r[n]=c,a=LU(t,e,r,n+1,s-c,i,o,a,u);return a}r[n]=s;let c=o;for(let e=0;e<t;e++)c=Mp(c,im(Ft(r[e])),u);for(let n=0;n<t;n++)c=u.multiply(c,i[n*(e+1)+r[n]]);return u.add(a,c)}function kU(t,e,r){const n=Mf(e),s=r.subtract(e,n);let i;r.is_zero(s)||(i=Nd(An,t,s));const o=vf(n);if(isNaN(o)){const e=Nd(An,t,n);return i?[i,e]:[e]}if(0===o)return[i];const a=function(t,e){let r=_f(t.a,Math.abs(e)),n=_f(t.b,Math.abs(e));if(e<0){const t=r;r=n,n=t,r=qf(r,n),n=Af(n,1)}return new Lt(r,n)}(t,o);return i?[i,a]:[a]}function RU(t,e,r){const n=function(t,e){return t};if(t.isOne()||e.isZero())return n(Ut);if(t.isMinusOne()&&e.isHalf())return n(ft);if(r.is_zero(t)){if(Wh(e))throw new Error(`divide by zero for base => ${t} and exponent => ${e}`);return n(Jt)}if(e.isOne())return n(t);let s,i,o=0;if(yf(e)){if(o=vf(e),isNaN(o))return n(Nd(An,t,e));if(s=_f(t.a,Math.abs(o)),i=_f(t.b,Math.abs(o)),o<0){const t=s;s=i,i=t,s=qf(s,i),i=function(t){return t.isNegative()?t.multiply(mt(-1)):t}(i)}return n(new Lt(s,i))}if(Yh(t))return n(function(t,e){if(yf(t))return t.a.isOdd()?jt:Ut;let r=Mf(t);Wh(t)&&(r=r.add(jt));const n=e.subtract(t,r);let s=Nd(An,jt,n);r.a.isOdd()&&(s=e.negate(s));return s}(e,r));if(Wh(t))return n(r.multiply(RU(r.negate(t),e,r),RU(jt,e,r)));if(!yf(t)){const s=t.numer(),i=t.denom(),o=e,a=RU(s,o,r),u=RU(i,o.neg(),r);return n(r.multiply(a,u))}if(xf(t.a))return n(function(t,e,r){const n=Em(vf(t)),s=n,i=s.length;for(let t=0;t<i;t+=2)s.push(...kU(n[t],r.multiply(s[t+1],e),r));return Dd(s.slice(i),r)}(t,e,r));if(!xf(e.a)||!xf(e.b))return n(Nd(An,t,e));const{a:a,b:u}=e;return s=function(t,e){t=t.abs(),0===e&&er("root index is zero");let r=0;for(;t.shiftRight(r).toJSNumber()>0;)r++;if(0===r)return Tf(0);r=Math.floor((r-1)/e);const n=Math.floor(r/32+1);let s=mt(n);for(let t=0;t<n;t++)s=s.and(mt(1).shiftLeft(t).not());for(;r>=0;){switch(s=s.or(mt(1).shiftLeft(r)),wm(_f(s,e),t)){case 0:return s;case 1:s=s.and(mt(1).shiftLeft(r).not())}r--}return 0}(t.a,u.toJSNumber()),0===s?n(Nd(An,t,e)):(i=_f(s,a),n(e.a.isNegative()?new Lt(mt.one,i):new Lt(i,mt.one)))}function IU(t,e,r){if(void 0===t)throw new Error("base must be defined.");if(void 0===e)throw new Error("expo must be defined.");const n=function(t,e){return t};if(r.equals(t,Ut)||r.is_zero(e)){return n(r.getNativeDirective($.evaluatingAsFloat)?tt:Ut)}if(r.equals(e,Ut))return n(t);if(Yh(t)&&Yh(e)){return n(r.negate(r.getNativeDirective($.evaluatingAsFloat)?tt:Ut))}if(Yh(t)&&wp(e))return r.getNativeDirective($.evaluatingAsClock)?c(An,t,e):n(ft);if(Yh(t)&&_p(e)){if(r.getNativeDirective($.evaluatingAsClock))return c(An,t,e);return n(r.negate(ft))}if(Yh(t)&&!ot(t)&&te(e)&&!yf(e)&&Jh(e)&&!r.getNativeDirective($.evaluatingAsFloat)){if(e.numer().compare(e.denom())<0)return n(c(An,t,e));{const s=c(xn,t,c(An,t,Lf(e.a.mod(e.b),e.b)));return n(r.valueOf(s))}}if(te(t)&&te(e)){return n(RU(t,e,r))}if(ee(t)&&ee(e)){const s=function(t,e,r){if(0===t&&e<0)throw new Error("divide by zero");if(t>=0||e%1==0)return J(Math.pow(t,e));const n=Math.pow(Math.abs(t),e),s=Math.PI*e;let i=0,o=0;return e%.5==0?(i=0,o=Math.sin(s)):(i=Math.cos(s),o=Math.sin(s)),r.add(J(i*n),r.multiply(J(o*n),ft))}(kf(t),kf(e),r);return n(s)}if(v(t)){const s=function(t,e,r){const n=t.ndim-1;if(t.dim(0)!==t.dim(n))return Nd(An,t,e);let s=vf(e);if(isNaN(s))return Nd(An,t,e);if(0===s){if(2!==t.ndim)throw new Error("power(tensor,0) with tensor rank not equal to 2");s=t.dim(0);const e=[s,s],r=Tp(s,Ut,Jt);return new y(e,r)}let i=t;s<0&&(s=-s,i=Jx(i,r));let o=i;for(let t=1;t<s&&(o=r.inner(o,i),!r.is_zero(o));t++);return o}(t,e,r);return n(s)}if(V_(t)){if(te(e)){const r=ge.valueOf(e.a.toJSNumber(),e.b.toJSNumber());return n(t.pow(r))}if(ot(e)){const r=ge.valueOf(e.d,1);return n(t.pow(r))}}if(h(t)&&Ff(t)&&pp(e)&&!r.is_zero(r.getSymbolValue(ms))){return n(r.power(Jf(t),e))}if(jf(t)&&d(e).equals(_n)){return n(Jf(e))}if(jf(t)&&ot(e)){return n(J(Math.exp(e.d)))}if(jf(t)&&e.contains(ft)&&e.contains(Os)&&!r.getNativeDirective($.evaluatingAsPolar)){const s=Rm(c(An,t,e),r);if(!s.contains(Os))return n(s)}if(r.isExpanding()&&Cf(t)&&yf(e)){const s=t.cdr;if(h(s)){const t=s.car;let i=r.power(t,e);if(h(s)){i=s.tail().reduce(((t,n)=>r.multiply(t,r.power(n,e))),i)}return n(i)}if(p(s))return n(Ut)}let s=!1;const i=Jf(t);if(ee(i)&&(s=Lh(i,Jt)===S),Df(t)&&(yf(e)||s)){return n(r.power(Jf(t),r.multiply(th(t),e)))}let o=!1;if(pp(th(t))){tp(r.multiply(th(t),e),r)&&(o=!0)}if(Df(t)&&o){if(r.isFactoring()){return n(zm(Jf(t),r))}return n(c(An,t,e))}if(r.isExpanding()&&Uf(t)&&ee(e)){const s=function(t){const e=jh(t)-1,r=[];let n=m(t);for(let t=0;t<e;t++)r.push(d(n)),n=m(n);return r}(t).every((function(t){return r.is_real(t)})),i=vf(e);if(i>1&&!isNaN(i)&&s){return n($U(i,t,r))}}if(1===tr.trigmode&&d(t).equals(Qn)&&pp(e)){return n(r.power(r.subtract(Ut,r.power(Nm(Jf(t),r),Ct)),r.multiply(e,Xt)))}if(2===tr.trigmode&&d(t).equals(Lr)&&pp(e)){return n(r.power(r.subtract(Ut,r.power(Lm(Jf(t),r),Ct)),r.multiply(e,Xt)))}if(hp(t)){if(yf(e)){const s=Cp(t,r);let i=Mp(s,r.multiply(s,t),r);return tp(e,r)||(i=r.power(i,r.negate(e))),n(i)}if(ee(e)){const s=r.getNativeDirective($.evaluatingAsFloat)||function(t,e){return Uf(t)&&3===jh(t)&&ot(Jf(t))&&lp(th(t),e)||lp(t,e)}(t,r)&&ot(e)?J(Math.PI):Os;let i=r.multiply(r.power(zm(t,r),e),r.power(jt,r.divide(r.multiply(r.arg(t),e),s)));return i.contains(gr)&&(i=c(An,t,e)),n(i)}}const a=function(t,e){let r=NU(t,e);switch(r){case 0:break;case 1:return Ut;case 2:return jt;case 3:return ft;case 4:return e.negate(ft)}if(Uf(t)){let n,s=m(t);for(;h(s)&&(r=NU(d(s),e),!r);)s=m(s);switch(r){case 0:return;case 1:n=Ut;break;case 2:n=jt;break;case 3:n=ft;break;case 4:n=e.negate(ft)}return e.multiply(n,Sd(e.subtract(t,d(s)),e))}}(e,r);return n(void 0!==a?a:c(An,t,e))}function PU(t,e){const r=t.argList,n=r.car,s=r.cdr.car,i=e.valueOf(n),o=e.valueOf(s);return i.equals(n)&&o.equals(s)?IU(i,o,e):e.valueOf(c(Ie,i,o))}function FU(t,e,r,n,s,i){const o=tr.tos,a=tr.tos;Ef(aE(t[e],i));const u=tr.tos-a,c=tr.tos;Ef(aE(t[0],i));const l=tr.tos-c;for(let r=0;r<u;r++)for(let u=0;u<l;u++){n=tr.stack[a+r],s=tr.stack[c+u];const l=i.negate(Mp(s,n,i)),[f]=DU(l,t,e,i);if(i.is_zero(f))return rr(o),[!0,n,s];s=i.negate(s);const h=i.negate(l),[p]=DU(h,t,e,i);if(i.is_zero(p))return rr(o),[!0,n,s]}return rr(o),[!1,n,s]}function UU(t,e,r,n){let s,i,o;if(r<=2)return[!1,s];const a=tr.tos;if(s=Rm(n.power(jt,Lf(2,3)),n),i=s,bf(i),[o]=DU(i,e,r,n),n.is_zero(o))return rr(a),[!0,s];if(s=Rm(n.power(Ut,Lf(2,3)),n),i=s,bf(i),[o]=DU(i,e,r,n),n.is_zero(o))return rr(a),[!0,s];for(let t=-10;t<=10;t++)for(let i=1;i<=5;i++){s=Rm(n.add(Ft(t),n.multiply(Ft(i),ft)),n);const o=s;bf(o);const[u]=DU(o,e,r,n);if(n.is_zero(u))return rr(a),[!0,s]}return rr(a),[!1,s]}function CU(t,e,r,n,s){let i=Jt;for(let o=n;o>0;o--){const n=Mp(r[o],t,s);r[o]=i,i=n,r[o-1]=s.subtract(r[o-1],s.multiply(i,e))}r[0]=i}function DU(t,e,r,n){let s=Jt;for(let i=r;i>=0;i--)s=n.add(n.multiply(s,t),e[i]);return[s]}var BU,KU;class zU extends x{constructor(t,e,n,s){super("Lambda",n,s),BU.set(this,void 0),KU.set(this,void 0),r(this,KU,t,"f"),r(this,BU,e,"f")}get hash(){return e(this,BU,"f")}evaluate(t,r){return e(this,KU,"f").call(this,t,r)}equals(t){return this===t||t instanceof zU}toString(){return"(lambda ...)"}}BU=new WeakMap,KU=new WeakMap;const QU=Object.freeze({antihermitian:!1,algebraic:!0,commutative:!0,complex:!0,extended_negative:!1,extended_nonnegative:!0,extended_nonpositive:!1,extended_nonzero:!0,extended_positive:!0,extended_real:!0,finite:!0,hermitian:!0,imaginary:!1,infinite:!1,integer:!1,irrational:!1,negative:!1,noninteger:!1,nonnegative:!0,nonpositive:!1,nonzero:!0,positive:!0,rational:!0,real:!0,transcendental:!1,zero:!1});function ZU(t,e){if(d(t).equals(Es)&&e.getSymbolValue(Es).equals(Es)){return zO(t,e)}const r=e.valueOf(d(t));ee(r)?er("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):v(r)?er("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):se(r)&&er("expected function, found string instead.");const n=d(m(r)),s=d(m(m(r))),i=m(t);if(!d(r).equals(sn)||r.equals(d(t))){const t=tr.tos;bf(r);let n=i;for(;h(n);)bf(e.valueOf(d(n))),n=m(n);return Sf(tr.tos-t),Of()}let o=s,a=i;const u=tr.tos;for(;h(o)&&h(a);)bf(d(o)),bf(d(a)),o=m(o),a=m(a);Sf(tr.tos-u);const c=Of();return bf(n),h(c)&&(bf(c),GU(e)),e.valueOf(Of())}function GU(t){let e=0;const r=Of();let n=Of();if(v(n))return e=function(t,e,r){let n=0;const s=t.mapElements((t=>(bf(t),bf(e),n+=GU(r),Of())));return bf(t.withElements(s)),n}(n,r,t),e;if(h(n)){const s=tr.tos;for(d(n).equals(d(r))?bf(Nd(Vr,d(m(r)))):bf(d(n)),n=m(n);h(n);)bf(d(n)),bf(r),e+=GU(t),n=m(n);return Sf(tr.tos-s),e}if(!ie(n))return bf(n),0;let s=r;for(;h(s);){if(n.equals(d(s)))return bf(Jf(s)),1;s=Xf(s)}return s=t.getSymbolValue(n),bf(s),n!==s&&(bf(r),e=GU(t),0===e&&(Of(),bf(n))),e}var HU,VU,jU,WU,JU,XU;class YU{constructor(){HU.set(this,[])}peek(){const t=e(this,HU,"f").length-1;return e(this,HU,"f")[t]}push(t){e(this,HU,"f").push(t)}pop(){const t=e(this,HU,"f").pop();if(t)return t;throw new Error}}HU=new WeakMap;class tC{constructor(){VU.set(this,new YU),e(this,VU,"f").push(function(){const t={};return eC(t,$.evaluatingAsClock,!1),eC(t,$.evaluatingAsFloat,!1),eC(t,$.evaluatingAsPolar,!1),eC(t,$.evaluatingTrigAsExp,!1),eC(t,$.expand,!0),eC(t,$.factor,!1),eC(t,$.keepZeroTermsInSums,!1),eC(t,$.renderFloatAsEcmaScript,!1),eC(t,$.useCaretForExponentiation,!1),Object.freeze(t)}())}push(t,r){const n=function(t){return{...t}}(e(this,VU,"f").peek());eC(n,t,r);const s=Object.freeze(n);e(this,VU,"f").push(s)}pop(){e(this,VU,"f").pop()}get(t){return e(this,VU,"f").peek()[t]}}function eC(t,e,r){switch(e){case $.expand:t[$.factor]=!r;break;case $.factor:t[$.expand]=!r}t[e]=r}VU=new WeakMap;class rC{print(...t){}}class nC{constructor(t,e){jU.set(this,void 0),WU.set(this,void 0),r(this,jU,t,"f"),r(this,WU,e,"f")}create(t){return new sC(e(this,jU,"f"),e(this,WU,"f"),t)}}jU=new WeakMap,WU=new WeakMap;class sC extends bL{constructor(t,e,n){super(t,n),JU.set(this,void 0),r(this,JU,e,"f")}get key(){return OL.name}get hash(){return ai}get name(){return this.keyword.text}transform(t){if(ie(t)&&t.equalsSym(this.keyword)){const t=this.$;return e(this,JU,"f").call(this,t),[q,l]}return[T,t]}}JU=new WeakMap;class iC{constructor(t,e,r){this.opr=t,this.hash=e,this.evaluator=r}create(t){return new oC(this.opr,this.hash,this.evaluator,t)}}class oC extends Fw{constructor(t,e,n,s){super(t.text,t,s),this.evaluator=n,XU.set(this,void 0),r(this,XU,e,"f")}get hash(){return e(this,XU,"f")}transform(t){const e=this.$,r=this.evaluator(t,e);return[r.equals(t)?T:q,((t,e)=>e)(0,r)]}}XU=new WeakMap;class aC{constructor(t,e){this.expr=t,this.$=e,this.name="unknown"}isImag(t){return!1}isKind(t){throw new Error("UnknownOperator.isKind Method not implemented.")}isMinusOne(t){throw new Error("UnknownOperator.isMinusOne Method not implemented.")}isOne(t){return!1}isReal(t){return!1}isScalar(t){throw new Error("UnknownOperator.isScalar Method not implemented.")}isZero(t){const e=sw(t,this.$);throw new Error(`UnknownOperator.isZero ${e} Method not implemented.`)}subst(t,e,r){throw new Error("UnknownOperator.subst Method not implemented.")}toInfixString(t){throw new Error(`${t.toString()} is not defined.`)}toLatexString(t){throw new Error(`${t.toString()} is not defined.`)}toListString(t){throw new Error(`${t.toString()} is not defined.`)}evaluate(t,e){throw new Error("UnknownOperator. Method not implemented.")}transform(t){throw new Error("UnknownOperator. Method not implemented.")}valueOf(t){throw new Error("UnknownOperator. Method not implemented.")}}const uC=Q(F.add),cC=Q(F.multiply),lC=Q(F.pow),fC=Q(F.is_complex),hC=Q(F.is_real);class pC{constructor(t){this.opr=t}compare(t,e,r){throw new Error(`(compare ${this.opr} ${t} ${e})`)}}function dC(t,e){if(Array.isArray(t)){for(const r of t)if(r.startsWith("~")){const t=r.substring(1);if(e.indexOf(t)>=0)return!1}else if(e.indexOf(r)<0)return!1;return!0}return!0}function mC(t,e,r){const n=[];for(const r of e)r.isKind(t)&&n.push(r);if(1===n.length)return n[0];if(n.length>0){return n[0]}}var gC;class wC{constructor(t){gC.set(this,[]),e(this,gC,"f").push(t)}peek(){return e(this,gC,"f")[0]}pop(){return e(this,gC,"f").pop()}push(t){e(this,gC,"f").push(t)}}gC=new WeakMap;class _C{constructor(){this.prints=[]}print(...t){this.prints.push(...t)}}function xC(t,e){const r=[],n=[],s=e.getPrintHandler(),i=new _C;e.setPrintHandler(i);try{const s=function(t,e){rr(0);const r=new wC(t);if(tr.trigmode=0,yC(hs,e)){e.pushNativeDirective($.expand,!0);try{r.push(vC(r.pop(),e,"expanding"))}finally{e.popNativeDirective()}}if(yC(ps,e)){e.pushNativeDirective($.factor,!0);try{r.push(vC(r.pop(),e,"factoring"))}finally{e.popNativeDirective()}}const n=r.pop();if(l!==n){if(r.push(n),e.isOne(e.getSymbolValue(ds))){let t=xO(r.pop(),e);t=vC(t,e),r.push(t)}!function(t,e,r,n){if((Ss.equals(t)||Ts.equals(t))&&ht(e))return;const s=n.getSymbolsInfo();for(const t of s){const e=t.sym;if(ht(t.value)){const t=Ip(r.pop(),ft,e,n);return void r.push(t)}}}(t,r.peek(),r,e)}else r.push(l);return function(t,e){p(t)||e.setSymbolValue(Zm,t)}(r.peek(),e),r.pop()}(t,e);return r.push(...i.prints),{value:s,prints:r,errors:n}}finally{e.setPrintHandler(s)}}function yC(t,e){const r=e.getSymbolValue(t);return!!p(r)||(!te(r)||!r.isZero())}function vC(t,e,r){const n=function(t,e){t.reset(q),t.reset(A);const[,r]=e.transform(t);return r}(t,e);return n}}}}));
//# sourceMappingURL=index.min.js.map
