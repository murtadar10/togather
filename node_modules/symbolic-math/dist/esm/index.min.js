function t(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}function e(t,e,r,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(t,r):s?s.value=r:e.set(t,r),r}var r,n,s;function i(t,e){return t&~e}class o{constructor(t,i,o,a,u){this.pos=a,this.end=u,r.set(this,void 0),n.set(this,void 0),s.set(this,void 0),e(this,r,i,"f"),e(this,n,o,"f"),e(this,s,t,"f")}get meta(){return t(this,s,"f")}set meta(t){e(this,s,t,"f")}get name(){return t(this,r,"f")?"Cons":"Nil"}get car(){return t(this,r,"f")?t(this,r,"f"):c}get cdr(){if(t(this,n,"f")){if(t(this,n,"f")instanceof o)return t(this,n,"f");throw new Error}return c}get argList(){return this.cdr}contains(e){return!(this!==e&&!this.equals(e))||!(!t(this,r,"f")||!t(this,n,"f"))&&(t(this,r,"f").contains(e)||t(this,n,"f").contains(e))}equals(t){return this===t||!!f(t)&&function(t,e){let r=t,n=e;for(;;){if(f(r)&&f(n)){if(r.car.equals(n.car)){r=r.cdr,n=n.cdr;continue}return!1}return!f(r)&&(!f(n)&&!!r.equals(n))}}(this,t)}isCons(){return!!t(this,r,"f")}isNil(){return!t(this,r,"f")}reset(e){this.meta=i(this.meta,e),t(this,r,"f")&&t(this,r,"f").reset(e),t(this,n,"f")&&t(this,n,"f").reset(e)}toString(){const e=t(this,r,"f"),s=t(this,n,"f");return e?`(${e} ${s})`:"()"}*[(r=new WeakMap,n=new WeakMap,s=new WeakMap,Symbol.iterator)](){let t=this;for(;f(t);)yield t.car,t=t.cdr}get head(){return this.car}tail(){if(this!==c){const e=t(this,n,"f");return e&&f(e)?[...e]:[]}throw new Error("tail property is not allowed for the empty list.")}map(t){if(this!==c){const e=this.car,r=this.cdr;return new o(0,t(e),f(r)?r.map(t):r)}return c}get length(){if(this!==c){const t=this.argList;return f(t)?t.length+1:1}return 0}get opr(){return this.item(0)}get arg(){return this.item(1)}get lhs(){return this.item(1)}get rhs(){return this.item(2)}item(t){if(t>=0&&this!==c){if(0===t)return this.car;{const e=this.argList;if(f(e))return e.item(t-1)}}throw new Error("index out of bounds.")}}function a(t,e){if(e instanceof o)return new o(0,t,e);throw new Error}function u(...t){let e=c;for(let r=t.length-1;r>=0;r--)e=new o(0,t[r],e);return e}const c=new o(0,void 0,void 0);function l(t){return!f(t)&&!h(t)}function f(t){return void 0!==t&&(t instanceof o&&!h(t))}function h(t){return t.equals(c)}function p(t){return f(t)?t.car:c}function d(t){return f(t)?t.cdr:c}var m,g,w;class _{constructor(t,e,r){this.name=t,this.pos=e,this.end=r,m.set(this,0)}reset(r){e(this,m,i(t(this,m,"f"),r),"f")}get meta(){return t(this,m,"f")}set meta(t){e(this,m,t,"f")}contains(t){return this.equals(t)}equals(t){throw new Error(`Atom(name=${this.name}).equals(other=${t}) Method not implemented.`)}isCons(){return!1}isNil(){return!1}}m=new WeakMap;class x extends _{constructor(t,r,n,s){super("Tensor",n,s),g.set(this,void 0),w.set(this,void 0),e(this,g,t,"f"),e(this,w,r,"f")}get rank(){for(const e of t(this,w,"f"))if(y(e))return t(this,g,"f").length+e.rank;return t(this,g,"f").length}get ndim(){return t(this,g,"f").length}get nelem(){return t(this,w,"f").length}contains(t){return!!this.equals(t)||this.someElements((function(e){return e.contains(t)}))}copyDimensions(){return[...t(this,g,"f")]}copyElements(){return[...t(this,w,"f")]}dim(e){if(e<0)throw new Error("n must be greater than or equal to zero.");if(e>t(this,g,"f").length-1)throw new Error("n + 1 must be less than ndim.");return t(this,g,"f")[e]}elem(e){return t(this,w,"f")[e]}equals(e){return!!(e instanceof x&&function(t,e){if(t.length===e.length){for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1}(t(this,g,"f"),t(e,g,"f"))&&function(t,e){if(t.length===e.length){for(let r=0;r<t.length;r++)if(!t[r].equals(e[r]))return!1;return!0}return!1}(t(this,w,"f"),t(e,w,"f")))}everyElement(e){return t(this,w,"f").every(e)}filterElements(e){return t(this,w,"f").filter(e)}map(e){return this.withElements(t(this,w,"f").map(e))}mapElements(e){return t(this,w,"f").map(e)}isCons(){return!1}isNil(){return!1}sameDimensions(e){return this.ndim===e.ndim&&t(this,g,"f").every(((t,r)=>t===e.dim(r)))}sliceDimensions(e,r){return t(this,g,"f").slice(e,r)}someElements(e){return t(this,w,"f").some(e)}toInfixString(){return"<tensor>"}toListString(){return"<tensor>"}toString(){return`${this.name}(ndim=${this.ndim}, dim=[${t(this,g,"f")}], elems=[${t(this,w,"f").map((function(t){return`${t}`})).join(",")}])`}withElements(e){return new x(t(this,g,"f"),e)}}function y(t){return t instanceof x}function v(t){if(t.length>0){const e=[t.length],r=[];let n=!1;for(let s=0;s<t.length;s++){const i=t[s];if(y(i)){const t=i;if(n);else{for(let r=0;r<t.ndim;r++)e[r+1]=t.dim(r);n=!0}for(let e=0;e<t.nelem;e++)r.push(t.elem(e))}else r.push(i)}return new x(e,r)}return new x([0],[])}g=new WeakMap,w=new WeakMap;const b=-1,O=0,E=1,S=0,q=1,T=2,M=4;function A(t){return(t&q)===q}var N;!function(t){t[t.expand=0]="expand",t[t.evaluatingAsFloat=1]="evaluatingAsFloat",t[t.evaluatingAsPolar=2]="evaluatingAsPolar",t[t.evaluatingAsClock=3]="evaluatingAsClock",t[t.evaluatingTrigAsExp=4]="evaluatingTrigAsExp",t[t.keepZeroTermsInSums=5]="keepZeroTermsInSums",t[t.factor=6]="factor",t[t.renderFloatAsEcmaScript=7]="renderFloatAsEcmaScript",t[t.useCaretForExponentiation=8]="useCaretForExponentiation"}(N||(N={}));const $=1,L=2,k=[$,L],R=$|L,I=$|L;var P,F;!function(t){t[t.E=0]="E",t[t.IMU=1]="IMU",t[t.MASH=2]="MASH",t[t.NIL=3]="NIL",t[t.PI=4]="PI",t[t.abs=5]="abs",t[t.add=6]="add",t[t.arctan=7]="arctan",t[t.arg=8]="arg",t[t.conj=9]="conj",t[t.cos=10]="cos",t[t.divide=11]="divide",t[t.exp=12]="exp",t[t.imag=13]="imag",t[t.inner=14]="inner",t[t.inverse=15]="inverse",t[t.is_complex=16]="is_complex",t[t.is_real=17]="is_real",t[t.is_zero=18]="is_zero",t[t.lco=19]="lco",t[t.log=20]="log",t[t.mod=21]="mod",t[t.multiply=22]="multiply",t[t.outer=23]="outer",t[t.pow=24]="pow",t[t.real=25]="real",t[t.rect=26]="rect",t[t.rco=27]="rco",t[t.sin=28]="sin",t[t.spread=29]="spread",t[t.subtract=30]="subtract",t[t.succ=31]="succ",t[t.tau=32]="tau",t[t.test_eq=33]="test_eq",t[t.test_ge=34]="test_ge",t[t.test_gt=35]="test_gt",t[t.test_le=36]="test_le",t[t.test_lt=37]="test_lt",t[t.test_ne=38]="test_ne"}(P||(P={}));const U=Math.random(),C=new Map;function D(t,e,r){const n=C.get(t);if(n)return n;const s=new B(U,t,e,r);return C.set(t,s),s}class B extends _{constructor(t,r,n,s){if(super("Sym",n,s),F.set(this,void 0),e(this,F,r,"f"),t!==U)throw new Error("Sym instances must be created using the create_sym function.")}compare(e){return r=t(this,F,"f"),n=t(e,F,"f"),r===n?0:r>n?1:-1;var r,n}contains(t){return t instanceof B&&this.equalsSym(t)}clone(e,r){return D(t(this,F,"f"),e,r)}equals(t){return t instanceof B&&this.equalsSym(t)}equalsSym(e){return this===e||t(this,F,"f")===t(e,F,"f")}key(){return t(this,F,"f")}get text(){return t(this,F,"f")}toString(){return t(this,F,"f")}}F=new WeakMap;const K=new Map;function z(t){const e=K.get(t);if(e)return e;{const e=function(t){switch(t){case P.E:return D("E");case P.IMU:return D("IMU");case P.MASH:return D("MASH");case P.NIL:return D("NIL");case P.PI:return D("PI");case P.abs:return D("abs");case P.add:return D("add");case P.arctan:return D("arctan");case P.arg:return D("arg");case P.conj:return D("conj");case P.cos:return D("cos");case P.divide:return D("/");case P.exp:return D("exp");case P.imag:return D("imag");case P.inner:return D("inner");case P.inverse:return D("inv");case P.is_complex:return D("iscomplex");case P.is_real:return D("isreal");case P.is_zero:return D("iszero");case P.lco:return D("<<");case P.log:return D("log");case P.mod:return D("mod");case P.multiply:return D("*");case P.outer:return D("outer");case P.pow:return D("pow");case P.real:return D("real");case P.rect:return D("rect");case P.rco:return D(">>");case P.sin:return D("sin");case P.spread:return D("...");case P.subtract:return D("-");case P.succ:return D("succ");case P.tau:return D("tau");case P.test_eq:return D("==");case P.test_ge:return D(">=");case P.test_gt:return D(">");case P.test_le:return D("<=");case P.test_lt:return D("<");case P.test_ne:return D("!=");default:throw new Error(`${t}`)}}(t);return K.set(t,e),e}}function Q(t){if("object"==typeof t){return"Blade"===t.name}return!1}class Z extends _{constructor(t,e,r){super("Boo",e,r),this.b=t}equals(t){return this===t||t instanceof Z&&this.equalsBoo(t)}equalsBoo(t){return this.b===t.b}isTrue(){return this.b}toString(){return this.b?`${this.name}(true)`:`${this.name}(false)`}static valueOf(t){return t?H:V}}function G(t){return Z.valueOf(t)}const H=new Z(!0),V=new Z(!1);function j(t){return t instanceof Z}function W(t,e,r){return t===X.d?X:t===Y.d?Y:t===nt.d?nt:t===tt.d?tt:t===st.d?st:new J(t,e,r)}class J extends _{constructor(t,e,r){super("Flt",e,r),this.d=t}abs(){return this.d>=0?this:this.neg()}add(t){return W(this.d+t.d)}compare(t){return this.d>t.d?1:this.d<t.d?-1:0}equals(t){return this===t||t instanceof J&&this.equalsFlt(t)}equalsFlt(t){return this.d===t.d}inv(){return new J(1/this.d,this.pos,this.end)}isNegative(){return this.d<0}isMinusOne(){return-1===this.d}isOne(){return 1===this.d}isPositive(){return this.d>0}isZero(){return 0===this.d}mul(t){return W(this.d*t.d)}neg(){return W(-this.d)}sub(t){return W(this.d-t.d)}toInfixString(){return`${this.d}`}toListString(){return`${this.d}`}toNumber(){return this.d}toString(){return`${this.name}(${this.d})`}}const X=new J(0),Y=new J(1),tt=new J(2),et=new J(Math.PI);new J(1e-6);const rt=new J(Math.E),nt=new J(-1),st=new J(-2);function it(t){return t instanceof J}class ot extends _{constructor(t,e,r){super("Hyp",e,r),this.printname=t}equals(t){return t instanceof ot&&this.equalsHyp(t)}equalsHyp(t){return this===t||this.printname===t.printname}toInfixString(){throw new Error("Hyp Method not implemented.")}toListString(){throw new Error("Hyp Method not implemented.")}toString(){return`${this.name}()`}}function at(t){return new ot(t)}const ut=new ot("ε"),ct=new ot("δ");function lt(t){return t instanceof ot}class ft extends _{constructor(t,e){super("Imu",t,e)}equals(t){return this===t||t instanceof ft}toString(){return"i"}}const ht=new ft;function pt(t){return t instanceof ft}var dt,mt,gt={};dt={get exports(){return gt},set exports(t){gt=t}},mt=function(t){var e=1e7,r=7,n=9007199254740992,s=h(n),i="0123456789abcdefghijklmnopqrstuvwxyz",o="function"==typeof BigInt;function a(t,e,r,n){return void 0===t?a[0]:void 0===e||10==+e&&!r?W(t):Z(t,e,r,n)}function u(t,e){this.value=t,this.sign=e,this.isSmall=!1}function c(t){this.value=t,this.sign=t<0,this.isSmall=!0}function l(t){this.value=t}function f(t){return-n<t&&t<n}function h(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function p(t){d(t);var r=t.length;if(r<4&&N(t,s)<0)switch(r){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function d(t){for(var e=t.length;0===t[--e];);t.length=e+1}function m(t){for(var e=new Array(t),r=-1;++r<t;)e[r]=0;return e}function g(t){return t>0?Math.floor(t):Math.ceil(t)}function w(t,r){var n,s,i=t.length,o=r.length,a=new Array(i),u=0,c=e;for(s=0;s<o;s++)u=(n=t[s]+r[s]+u)>=c?1:0,a[s]=n-u*c;for(;s<i;)u=(n=t[s]+u)===c?1:0,a[s++]=n-u*c;return u>0&&a.push(u),a}function _(t,e){return t.length>=e.length?w(t,e):w(e,t)}function x(t,r){var n,s,i=t.length,o=new Array(i),a=e;for(s=0;s<i;s++)n=t[s]-a+r,r=Math.floor(n/a),o[s]=n-r*a,r+=1;for(;r>0;)o[s++]=r%a,r=Math.floor(r/a);return o}function y(t,r){var n,s,i=t.length,o=r.length,a=new Array(i),u=0,c=e;for(n=0;n<o;n++)(s=t[n]-u-r[n])<0?(s+=c,u=1):u=0,a[n]=s;for(n=o;n<i;n++){if(!((s=t[n]-u)<0)){a[n++]=s;break}s+=c,a[n]=s}for(;n<i;n++)a[n]=t[n];return d(a),a}function v(t,r,n){var s,i,o=t.length,a=new Array(o),l=-r,f=e;for(s=0;s<o;s++)i=t[s]+l,l=Math.floor(i/f),i%=f,a[s]=i<0?i+f:i;return"number"==typeof(a=p(a))?(n&&(a=-a),new c(a)):new u(a,n)}function b(t,r){var n,s,i,o,a=t.length,u=r.length,c=m(a+u),l=e;for(i=0;i<a;++i){o=t[i];for(var f=0;f<u;++f)n=o*r[f]+c[i+f],s=Math.floor(n/l),c[i+f]=n-s*l,c[i+f+1]+=s}return d(c),c}function O(t,r){var n,s,i=t.length,o=new Array(i),a=e,u=0;for(s=0;s<i;s++)n=t[s]*r+u,u=Math.floor(n/a),o[s]=n-u*a;for(;u>0;)o[s++]=u%a,u=Math.floor(u/a);return o}function E(t,e){for(var r=[];e-- >0;)r.push(0);return r.concat(t)}function S(t,e){var r=Math.max(t.length,e.length);if(r<=30)return b(t,e);r=Math.ceil(r/2);var n=t.slice(r),s=t.slice(0,r),i=e.slice(r),o=e.slice(0,r),a=S(s,o),u=S(n,i),c=S(_(s,n),_(o,i)),l=_(_(a,E(y(y(c,a),u),r)),E(u,2*r));return d(l),l}function q(t,r,n){return new u(t<e?O(r,t):b(r,h(t)),n)}function T(t){var r,n,s,i,o=t.length,a=m(o+o),u=e;for(s=0;s<o;s++){n=0-(i=t[s])*i;for(var c=s;c<o;c++)r=i*t[c]*2+a[s+c]+n,n=Math.floor(r/u),a[s+c]=r-n*u;a[s+o]=n}return d(a),a}function M(t,r){var n,s,i,o,a=t.length,u=m(a),c=e;for(i=0,n=a-1;n>=0;--n)i=(o=i*c+t[n])-(s=g(o/r))*r,u[n]=0|s;return[u,0|i]}function A(t,r){var n,s=W(r);if(o)return[new l(t.value/s.value),new l(t.value%s.value)];var i,f=t.value,w=s.value;if(0===w)throw new Error("Cannot divide by zero");if(t.isSmall)return s.isSmall?[new c(g(f/w)),new c(f%w)]:[a[0],t];if(s.isSmall){if(1===w)return[t,a[0]];if(-1==w)return[t.negate(),a[0]];var _=Math.abs(w);if(_<e){i=p((n=M(f,_))[0]);var x=n[1];return t.sign&&(x=-x),"number"==typeof i?(t.sign!==s.sign&&(i=-i),[new c(i),new c(x)]):[new u(i,t.sign!==s.sign),new c(x)]}w=h(_)}var v=N(f,w);if(-1===v)return[a[0],t];if(0===v)return[a[t.sign===s.sign?1:-1],a[0]];n=f.length+w.length<=200?function(t,r){var n,s,i,o,a,u,c,l=t.length,f=r.length,h=e,d=m(r.length),g=r[f-1],w=Math.ceil(h/(2*g)),_=O(t,w),x=O(r,w);for(_.length<=l&&_.push(0),x.push(0),g=x[f-1],s=l-f;s>=0;s--){for(n=h-1,_[s+f]!==g&&(n=Math.floor((_[s+f]*h+_[s+f-1])/g)),i=0,o=0,u=x.length,a=0;a<u;a++)i+=n*x[a],c=Math.floor(i/h),o+=_[s+a]-(i-c*h),i=c,o<0?(_[s+a]=o+h,o=-1):(_[s+a]=o,o=0);for(;0!==o;){for(n-=1,i=0,a=0;a<u;a++)(i+=_[s+a]-h+x[a])<0?(_[s+a]=i+h,i=0):(_[s+a]=i,i=1);o+=i}d[s]=n}return _=M(_,w)[0],[p(d),p(_)]}(f,w):function(t,r){for(var n,s,i,o,a,u=t.length,c=r.length,l=[],f=[],h=e;u;)if(f.unshift(t[--u]),d(f),N(f,r)<0)l.push(0);else{i=f[(s=f.length)-1]*h+f[s-2],o=r[c-1]*h+r[c-2],s>c&&(i=(i+1)*h),n=Math.ceil(i/o);do{if(N(a=O(r,n),f)<=0)break;n--}while(n);l.push(n),f=y(f,a)}return l.reverse(),[p(l),p(f)]}(f,w),i=n[0];var b=t.sign!==s.sign,E=n[1],S=t.sign;return"number"==typeof i?(b&&(i=-i),i=new c(i)):i=new u(i,b),"number"==typeof E?(S&&(E=-E),E=new c(E)):E=new u(E,S),[i,E]}function N(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var r=t.length-1;r>=0;r--)if(t[r]!==e[r])return t[r]>e[r]?1:-1;return 0}function $(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function L(t,e){for(var r,n,s,i=t.prev(),o=i,a=0;o.isEven();)o=o.divide(2),a++;t:for(n=0;n<e.length;n++)if(!t.lesser(e[n])&&!(s=mt(e[n]).modPow(o,t)).isUnit()&&!s.equals(i)){for(r=a-1;0!=r;r--){if((s=s.square().mod(t)).isUnit())return!1;if(s.equals(i))continue t}return!1}return!0}u.prototype=Object.create(a.prototype),c.prototype=Object.create(a.prototype),l.prototype=Object.create(a.prototype),u.prototype.add=function(t){var e=W(t);if(this.sign!==e.sign)return this.subtract(e.negate());var r=this.value,n=e.value;return e.isSmall?new u(x(r,Math.abs(n)),this.sign):new u(_(r,n),this.sign)},u.prototype.plus=u.prototype.add,c.prototype.add=function(t){var e=W(t),r=this.value;if(r<0!==e.sign)return this.subtract(e.negate());var n=e.value;if(e.isSmall){if(f(r+n))return new c(r+n);n=h(Math.abs(n))}return new u(x(n,Math.abs(r)),r<0)},c.prototype.plus=c.prototype.add,l.prototype.add=function(t){return new l(this.value+W(t).value)},l.prototype.plus=l.prototype.add,u.prototype.subtract=function(t){var e=W(t);if(this.sign!==e.sign)return this.add(e.negate());var r=this.value,n=e.value;return e.isSmall?v(r,Math.abs(n),this.sign):function(t,e,r){var n;return N(t,e)>=0?n=y(t,e):(n=y(e,t),r=!r),"number"==typeof(n=p(n))?(r&&(n=-n),new c(n)):new u(n,r)}(r,n,this.sign)},u.prototype.minus=u.prototype.subtract,c.prototype.subtract=function(t){var e=W(t),r=this.value;if(r<0!==e.sign)return this.add(e.negate());var n=e.value;return e.isSmall?new c(r-n):v(n,Math.abs(r),r>=0)},c.prototype.minus=c.prototype.subtract,l.prototype.subtract=function(t){return new l(this.value-W(t).value)},l.prototype.minus=l.prototype.subtract,u.prototype.negate=function(){return new u(this.value,!this.sign)},c.prototype.negate=function(){var t=this.sign,e=new c(-this.value);return e.sign=!t,e},l.prototype.negate=function(){return new l(-this.value)},u.prototype.abs=function(){return new u(this.value,!1)},c.prototype.abs=function(){return new c(Math.abs(this.value))},l.prototype.abs=function(){return new l(this.value>=0?this.value:-this.value)},u.prototype.multiply=function(t){var r,n,s,i=W(t),o=this.value,c=i.value,l=this.sign!==i.sign;if(i.isSmall){if(0===c)return a[0];if(1===c)return this;if(-1===c)return this.negate();if((r=Math.abs(c))<e)return new u(O(o,r),l);c=h(r)}return n=o.length,s=c.length,new u(-.012*n-.012*s+15e-6*n*s>0?S(o,c):b(o,c),l)},u.prototype.times=u.prototype.multiply,c.prototype._multiplyBySmall=function(t){return f(t.value*this.value)?new c(t.value*this.value):q(Math.abs(t.value),h(Math.abs(this.value)),this.sign!==t.sign)},u.prototype._multiplyBySmall=function(t){return 0===t.value?a[0]:1===t.value?this:-1===t.value?this.negate():q(Math.abs(t.value),this.value,this.sign!==t.sign)},c.prototype.multiply=function(t){return W(t)._multiplyBySmall(this)},c.prototype.times=c.prototype.multiply,l.prototype.multiply=function(t){return new l(this.value*W(t).value)},l.prototype.times=l.prototype.multiply,u.prototype.square=function(){return new u(T(this.value),!1)},c.prototype.square=function(){var t=this.value*this.value;return f(t)?new c(t):new u(T(h(Math.abs(this.value))),!1)},l.prototype.square=function(t){return new l(this.value*this.value)},u.prototype.divmod=function(t){var e=A(this,t);return{quotient:e[0],remainder:e[1]}},l.prototype.divmod=c.prototype.divmod=u.prototype.divmod,u.prototype.divide=function(t){return A(this,t)[0]},l.prototype.over=l.prototype.divide=function(t){return new l(this.value/W(t).value)},c.prototype.over=c.prototype.divide=u.prototype.over=u.prototype.divide,u.prototype.mod=function(t){return A(this,t)[1]},l.prototype.mod=l.prototype.remainder=function(t){return new l(this.value%W(t).value)},c.prototype.remainder=c.prototype.mod=u.prototype.remainder=u.prototype.mod,u.prototype.pow=function(t){var e,r,n,s=W(t),i=this.value,o=s.value;if(0===o)return a[1];if(0===i)return a[0];if(1===i)return a[1];if(-1===i)return s.isEven()?a[1]:a[-1];if(s.sign)return a[0];if(!s.isSmall)throw new Error("The exponent "+s.toString()+" is too large.");if(this.isSmall&&f(e=Math.pow(i,o)))return new c(g(e));for(r=this,n=a[1];!0&o&&(n=n.times(r),--o),0!==o;)o/=2,r=r.square();return n},c.prototype.pow=u.prototype.pow,l.prototype.pow=function(t){var e=W(t),r=this.value,n=e.value,s=BigInt(0),i=BigInt(1),o=BigInt(2);if(n===s)return a[1];if(r===s)return a[0];if(r===i)return a[1];if(r===BigInt(-1))return e.isEven()?a[1]:a[-1];if(e.isNegative())return new l(s);for(var u=this,c=a[1];(n&i)===i&&(c=c.times(u),--n),n!==s;)n/=o,u=u.square();return c},u.prototype.modPow=function(t,e){if(t=W(t),(e=W(e)).isZero())throw new Error("Cannot take modPow with modulus 0");var r=a[1],n=this.mod(e);for(t.isNegative()&&(t=t.multiply(a[-1]),n=n.modInv(e));t.isPositive();){if(n.isZero())return a[0];t.isOdd()&&(r=r.multiply(n).mod(e)),t=t.divide(2),n=n.square().mod(e)}return r},l.prototype.modPow=c.prototype.modPow=u.prototype.modPow,u.prototype.compareAbs=function(t){var e=W(t),r=this.value,n=e.value;return e.isSmall?1:N(r,n)},c.prototype.compareAbs=function(t){var e=W(t),r=Math.abs(this.value),n=e.value;return e.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},l.prototype.compareAbs=function(t){var e=this.value,r=W(t).value;return(e=e>=0?e:-e)===(r=r>=0?r:-r)?0:e>r?1:-1},u.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=W(t),r=this.value,n=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:N(r,n)*(this.sign?-1:1)},u.prototype.compareTo=u.prototype.compare,c.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=W(t),r=this.value,n=e.value;return e.isSmall?r==n?0:r>n?1:-1:r<0!==e.sign?r<0?-1:1:r<0?1:-1},c.prototype.compareTo=c.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,r=W(t).value;return e===r?0:e>r?1:-1},l.prototype.compareTo=l.prototype.compare,u.prototype.equals=function(t){return 0===this.compare(t)},l.prototype.eq=l.prototype.equals=c.prototype.eq=c.prototype.equals=u.prototype.eq=u.prototype.equals,u.prototype.notEquals=function(t){return 0!==this.compare(t)},l.prototype.neq=l.prototype.notEquals=c.prototype.neq=c.prototype.notEquals=u.prototype.neq=u.prototype.notEquals,u.prototype.greater=function(t){return this.compare(t)>0},l.prototype.gt=l.prototype.greater=c.prototype.gt=c.prototype.greater=u.prototype.gt=u.prototype.greater,u.prototype.lesser=function(t){return this.compare(t)<0},l.prototype.lt=l.prototype.lesser=c.prototype.lt=c.prototype.lesser=u.prototype.lt=u.prototype.lesser,u.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},l.prototype.geq=l.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals,u.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},l.prototype.leq=l.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals,u.prototype.isEven=function(){return 0==(1&this.value[0])},c.prototype.isEven=function(){return 0==(1&this.value)},l.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},u.prototype.isOdd=function(){return 1==(1&this.value[0])},c.prototype.isOdd=function(){return 1==(1&this.value)},l.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},u.prototype.isPositive=function(){return!this.sign},c.prototype.isPositive=function(){return this.value>0},l.prototype.isPositive=c.prototype.isPositive,u.prototype.isNegative=function(){return this.sign},c.prototype.isNegative=function(){return this.value<0},l.prototype.isNegative=c.prototype.isNegative,u.prototype.isUnit=function(){return!1},c.prototype.isUnit=function(){return 1===Math.abs(this.value)},l.prototype.isUnit=function(){return this.abs().value===BigInt(1)},u.prototype.isZero=function(){return!1},c.prototype.isZero=function(){return 0===this.value},l.prototype.isZero=function(){return this.value===BigInt(0)},u.prototype.isDivisibleBy=function(t){var e=W(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},l.prototype.isDivisibleBy=c.prototype.isDivisibleBy=u.prototype.isDivisibleBy,u.prototype.isPrime=function(e){var r=$(this);if(r!==t)return r;var n=this.abs(),s=n.bitLength();if(s<=64)return L(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var i=Math.log(2)*s.toJSNumber(),o=Math.ceil(!0===e?2*Math.pow(i,2):i),a=[],u=0;u<o;u++)a.push(mt(u+2));return L(n,a)},l.prototype.isPrime=c.prototype.isPrime=u.prototype.isPrime,u.prototype.isProbablePrime=function(e,r){var n=$(this);if(n!==t)return n;for(var s=this.abs(),i=e===t?5:e,o=[],a=0;a<i;a++)o.push(mt.randBetween(2,s.minus(2),r));return L(s,o)},l.prototype.isProbablePrime=c.prototype.isProbablePrime=u.prototype.isProbablePrime,u.prototype.modInv=function(t){for(var e,r,n,s=mt.zero,i=mt.one,o=W(t),a=this.abs();!a.isZero();)e=o.divide(a),r=s,n=o,s=i,o=a,i=r.subtract(e.multiply(i)),a=n.subtract(e.multiply(a));if(!o.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===s.compare(0)&&(s=s.add(t)),this.isNegative()?s.negate():s},l.prototype.modInv=c.prototype.modInv=u.prototype.modInv,u.prototype.next=function(){var t=this.value;return this.sign?v(t,1,this.sign):new u(x(t,1),this.sign)},c.prototype.next=function(){var t=this.value;return t+1<n?new c(t+1):new u(s,!1)},l.prototype.next=function(){return new l(this.value+BigInt(1))},u.prototype.prev=function(){var t=this.value;return this.sign?new u(x(t,1),!0):v(t,1,this.sign)},c.prototype.prev=function(){var t=this.value;return t-1>-n?new c(t-1):new u(s,!0)},l.prototype.prev=function(){return new l(this.value-BigInt(1))};for(var k=[1];2*k[k.length-1]<=e;)k.push(2*k[k.length-1]);var R=k.length,I=k[R-1];function P(t){return Math.abs(t)<=e}function F(t,e,r){e=W(e);for(var n=t.isNegative(),s=e.isNegative(),i=n?t.not():t,o=s?e.not():e,a=0,u=0,c=null,l=null,f=[];!i.isZero()||!o.isZero();)a=(c=A(i,I))[1].toJSNumber(),n&&(a=I-1-a),u=(l=A(o,I))[1].toJSNumber(),s&&(u=I-1-u),i=c[0],o=l[0],f.push(r(a,u));for(var h=0!==r(n?1:0,s?1:0)?mt(-1):mt(0),p=f.length-1;p>=0;p-=1)h=h.multiply(I).add(mt(f[p]));return h}u.prototype.shiftLeft=function(t){var e=W(t).toJSNumber();if(!P(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var r=this;if(r.isZero())return r;for(;e>=R;)r=r.multiply(I),e-=R-1;return r.multiply(k[e])},l.prototype.shiftLeft=c.prototype.shiftLeft=u.prototype.shiftLeft,u.prototype.shiftRight=function(t){var e,r=W(t).toJSNumber();if(!P(r))throw new Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=R;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(e=A(n,I))[1].isNegative()?e[0].prev():e[0],r-=R-1}return(e=A(n,k[r]))[1].isNegative()?e[0].prev():e[0]},l.prototype.shiftRight=c.prototype.shiftRight=u.prototype.shiftRight,u.prototype.not=function(){return this.negate().prev()},l.prototype.not=c.prototype.not=u.prototype.not,u.prototype.and=function(t){return F(this,t,(function(t,e){return t&e}))},l.prototype.and=c.prototype.and=u.prototype.and,u.prototype.or=function(t){return F(this,t,(function(t,e){return t|e}))},l.prototype.or=c.prototype.or=u.prototype.or,u.prototype.xor=function(t){return F(this,t,(function(t,e){return t^e}))},l.prototype.xor=c.prototype.xor=u.prototype.xor;var U=1<<30,C=(e&-e)*(e&-e)|U;function D(t){var r=t.value,n="number"==typeof r?r|U:"bigint"==typeof r?r|BigInt(U):r[0]+r[1]*e|C;return n&-n}function B(t,e){if(e.compareTo(t)<=0){var r=B(t,e.square(e)),n=r.p,s=r.e,i=n.multiply(e);return i.compareTo(t)<=0?{p:i,e:2*s+1}:{p:n,e:2*s}}return{p:mt(1),e:0}}function K(t,e){return t=W(t),e=W(e),t.greater(e)?t:e}function z(t,e){return t=W(t),e=W(e),t.lesser(e)?t:e}function Q(t,e){if(t=W(t).abs(),e=W(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var r,n,s=a[1];t.isEven()&&e.isEven();)r=z(D(t),D(e)),t=t.divide(r),e=e.divide(r),s=s.multiply(r);for(;t.isEven();)t=t.divide(D(t));do{for(;e.isEven();)e=e.divide(D(e));t.greater(e)&&(n=e,e=t,t=n),e=e.subtract(t)}while(!e.isZero());return s.isUnit()?t:t.multiply(s)}u.prototype.bitLength=function(){var t=this;return t.compareTo(mt(0))<0&&(t=t.negate().subtract(mt(1))),0===t.compareTo(mt(0))?mt(0):mt(B(t,mt(2)).e).add(mt(1))},l.prototype.bitLength=c.prototype.bitLength=u.prototype.bitLength;var Z=function(t,e,r,n){r=r||i,t=String(t),n||(t=t.toLowerCase(),r=r.toLowerCase());var s,o=t.length,a=Math.abs(e),u={};for(s=0;s<r.length;s++)u[r[s]]=s;for(s=0;s<o;s++)if("-"!==(f=t[s])&&f in u&&u[f]>=a){if("1"===f&&1===a)continue;throw new Error(f+" is not a valid digit in base "+e+".")}e=W(e);var c=[],l="-"===t[0];for(s=l?1:0;s<t.length;s++){var f;if((f=t[s])in u)c.push(W(u[f]));else{if("<"!==f)throw new Error(f+" is not a valid character");var h=s;do{s++}while(">"!==t[s]&&s<t.length);c.push(W(t.slice(h+1,s)))}}return G(c,e,l)};function G(t,e,r){var n,s=a[0],i=a[1];for(n=t.length-1;n>=0;n--)s=s.add(t[n].times(i)),i=i.times(e);return r?s.negate():s}function H(t,e){if((e=mt(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var n=!1;if(t.isNegative()&&e.isPositive()&&(n=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:n};for(var s,i=[],o=t;o.isNegative()||o.compareAbs(e)>=0;){s=o.divmod(e),o=s.quotient;var a=s.remainder;a.isNegative()&&(a=e.minus(a).abs(),o=o.next()),i.push(a.toJSNumber())}return i.push(o.toJSNumber()),{value:i.reverse(),isNegative:n}}function V(t,e,r){var n=H(t,e);return(n.isNegative?"-":"")+n.value.map((function(t){return function(t,e){return t<(e=e||i).length?e[t]:"<"+t+">"}(t,r)})).join("")}function j(t){if(f(+t)){var e=+t;if(e===g(e))return o?new l(BigInt(e)):new c(e);throw new Error("Invalid integer: "+t)}var n="-"===t[0];n&&(t=t.slice(1));var s=t.split(/e/i);if(s.length>2)throw new Error("Invalid integer: "+s.join("e"));if(2===s.length){var i=s[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==g(i)||!f(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var a=s[0],h=a.indexOf(".");if(h>=0&&(i-=a.length-h-1,a=a.slice(0,h)+a.slice(h+1)),i<0)throw new Error("Cannot include negative exponent part for integers");t=a+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(o)return new l(BigInt(n?"-"+t:t));for(var p=[],m=t.length,w=r,_=m-w;m>0;)p.push(+t.slice(_,m)),(_-=w)<0&&(_=0),m-=w;return d(p),new u(p,n)}function W(t){return"number"==typeof t?function(t){if(o)return new l(BigInt(t));if(f(t)){if(t!==g(t))throw new Error(t+" is not an integer.");return new c(t)}return j(t.toString())}(t):"string"==typeof t?j(t):"bigint"==typeof t?new l(t):t}u.prototype.toArray=function(t){return H(this,t)},c.prototype.toArray=function(t){return H(this,t)},l.prototype.toArray=function(t){return H(this,t)},u.prototype.toString=function(e,r){if(e===t&&(e=10),10!==e)return V(this,e,r);for(var n,s=this.value,i=s.length,o=String(s[--i]);--i>=0;)n=String(s[i]),o+="0000000".slice(n.length)+n;return(this.sign?"-":"")+o},c.prototype.toString=function(e,r){return e===t&&(e=10),10!=e?V(this,e,r):String(this.value)},l.prototype.toString=c.prototype.toString,l.prototype.toJSON=u.prototype.toJSON=c.prototype.toJSON=function(){return this.toString()},u.prototype.valueOf=function(){return parseInt(this.toString(),10)},u.prototype.toJSNumber=u.prototype.valueOf,c.prototype.valueOf=function(){return this.value},c.prototype.toJSNumber=c.prototype.valueOf,l.prototype.valueOf=l.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var J=0;J<1e3;J++)a[J]=W(J),J>0&&(a[-J]=W(-J));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=K,a.min=z,a.gcd=Q,a.lcm=function(t,e){return t=W(t).abs(),e=W(e).abs(),t.divide(Q(t,e)).multiply(e)},a.isInstance=function(t){return t instanceof u||t instanceof c||t instanceof l},a.randBetween=function(t,r,n){t=W(t),r=W(r);var s=n||Math.random,i=z(t,r),o=K(t,r).subtract(i).add(1);if(o.isSmall)return i.add(Math.floor(s()*o));for(var u=H(o,e).value,c=[],l=!0,f=0;f<u.length;f++){var h=l?u[f]+(f+1<u.length?u[f+1]/e:0):e,p=g(s()*h);c.push(p),p<u[f]&&(l=!1)}return i.add(a.fromArray(c,e,!1))},a.fromArray=function(t,e,r){return G(t.map(W),W(e||10),r)},a}(),dt.hasOwnProperty("exports")&&(dt.exports=mt);var wt=function(){function t(t,e){this.key=t,this.value=e,this.flag=!1,this.l=this,this.r=this,this.p=this}return t.prototype.toString=function(){return"".concat(this.flag?"red":"black"," ").concat(this.key)},t}(),_t=function(){function t(t,e,r,n){this.highKey=e,this.comp=n,this.N=0,this.lowNode=new wt(t,r),this.highNode=new wt(e,r);var s=new wt(null,r);this.head=new wt(t,r),this.head.l=s,this.head.r=s,this.head.p=this.head}return Object.defineProperty(t.prototype,"root",{get:function(){return this.head.r},set:function(t){this.head.r=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this.head.l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lowKey",{get:function(){return this.head.key},enumerable:!1,configurable:!0}),t.prototype.assertLegalKey=function(t,e){if(e(t,this.lowKey)<=0)throw new Error("key, ".concat(t,", must be greater than the low key, ").concat(this.lowKey,"."));if(e(t,this.highKey)>=0)throw new Error("key, ".concat(t,", must be less than the high key, ").concat(this.highKey,"."))},t.prototype.insert=function(t,e){var r=this.comp;this.assertLegalKey(t,r);var n=new wt(t,e);return function(t,e,r){var n=e.key,s=t.z,i=t.root;i.p=t.head;for(;i!==s;)i.l.p=i,i.r.p=i,i=r(n,i.key)<0?i.l:i.r;e.p=i.p,i.p===t.head?t.root=e:r(n,i.p.key)<0?i.p.l=e:i.p.r=e;e.l=s,e.r=s,e.p.flag?function(t,e){if(e.flag=!0,!e.p.flag)throw new Error("n.p must be red.");for(;e.flag;){var r=e.p;if(e===t.root)return void(t.root.flag=!1);if(r===t.root)return void(t.root.flag=!1);var n,s=r.p;if(!r.flag||s.flag)break;e=r===s.l?(n=s.r).flag?xt(r,s,n):e===r.r?yt(s):bt(s):(n=s.l).flag?xt(r,s,n):e===e.p.l?vt(s):Ot(s)}t.root.flag=!1}(t,e):e.flag=!0}(this,n,r),this.root.flag=!1,this.N+=1,n},t.prototype.glb=function(t){var e=this.comp;this.assertLegalKey(t,e);var r=this.lowNode,n=qt(this,this.root,t,e,r);return n!==r?n:null},t.prototype.lub=function(t){var e=this.comp;this.assertLegalKey(t,e);var r=this.highNode,n=Tt(this,this.root,t,e,r);return n!==r?n:null},t.prototype.search=function(t){var e=this.comp;this.assertLegalKey(t,e);var r=this.root;for(this.z.key=t;0!==e(t,r.key);)r=e(t,r.key)<0?r.l:r.r;return r.value},t.prototype.remove=function(t){var e=this.comp;this.assertLegalKey(t,e);var r=this.head,n=this.z,s=this.root,i=r;for(n.key=t;0!==e(t,s.key);)i=s,s=e(t,s.key)<0?s.l:s.r;var o=s;if(o.r===n)s=o.l;else if(o.r.l===n)(s=o.r).l=o.l;else{for(var a=o.r;a.l.l!==n;)a=a.l;s=a.l,a.l=s.r,s.l=o.l,s.r=o.r}e(t,i.key)<0?i.l=s:i.r=s},Object.defineProperty(t.prototype,"heightInvariant",{get:function(){return t=this.root,e=this.z,St(t,e)>=0;var t,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colorInvariant",{get:function(){return Et(this.root,this.head.flag,this.z)},enumerable:!1,configurable:!0}),t}();function xt(t,e,r){return t.flag=!1,e.flag=!0,r.flag=!1,e}function yt(t){var e=t.p,r=t,n=r.l,s=n.r,i=s.l,o=s.r;return n.flag=!1,s.l=n,n.p=s,s.r=r,r.p=s,n.r=i,i.p=n,r.l=o,o.p=r,e.r===t?e.r=s:e.l=s,s.p=e,s}function vt(t){var e=t.p,r=t,n=r.r,s=n.l,i=s.l,o=s.r;return n.flag=!1,s.l=r,r.p=s,s.r=n,n.p=s,r.r=i,i.p=r,n.l=o,o.p=n,e.r===t?e.r=s:e.l=s,s.p=e,s}function bt(t){var e=t.p,r=t,n=r.l,s=n.r;return n.l.flag=!1,n.r=r,r.p=n,r.l=s,s.p=r,e.r===t?e.r=n:e.l=n,n.p=e,n}function Ot(t){var e=t.p,r=t,n=r.r,s=n.l;return n.r.flag=!1,n.l=r,r.p=n,r.r=s,s.p=r,e.r===t?e.r=n:e.l=n,n.p=e,n}function Et(t,e,r){return t===r||(!e||!t.flag)&&(Et(t.l,t.flag,r)&&Et(t.r,t.flag,r))}function St(t,e){if(t===e)return 0;var r=St(t.l,e);if(r>=0){var n=St(t.r,e);if(n>=0&&n==n)return t.flag?r:r+1}return-1}function qt(t,e,r,n,s){return e===t.z?s:n(r,e.key)>=0?function(t,e,r){return r(t.key,e.key)>0?t:r(t.key,e.key)<0?e:t}(e,qt(t,e.r,r,n,s),n):qt(t,e.l,r,n,s)}function Tt(t,e,r,n,s){return e===t.z?s:n(r,e.key)<=0?function(t,e,r){return r(t.key,e.key)<0?t:r(t.key,e.key)>0?e:t}(e,Tt(t,e.l,r,n,s),n):Tt(t,e.r,r,n,s)}function Mt(t,e){return t.multiply(e)}function At(t,e){return t.divide(e)}function Nt(t,e){return gt.gcd(t,e)}function $t(t){return t.isZero()}function Lt(t,e){if(t.isPositive()){if(e.isNegative())return t.multiply(gt(-1))}else if(e.isPositive())return t.multiply(gt(-1));return t}class kt extends _{constructor(t,e,r,n){super("Rat",r,n),this.a=t,this.b=e}abs(){return((t=this.a).isPositive()?1:t.isZero()?0:-1)>=0?this:this.neg();var t}add(t){const e=function(t,e){return t.add(e)}(Mt(this.a,t.b),Mt(this.b,t.a));if($t(e))return Yt;const r=Mt(this.b,t.b),n=Lt(Nt(e,r),r),s=At(e,n),i=At(r,n);return new kt(s,i)}ceiling(){if(this.isInteger())return this;const t=new kt(At(this.a,this.b),gt.one);return this.isNegative()?t:t.succ()}compare(t){const e=Mt(this.a,t.b),r=Mt(this.b,t.a);return n=r,e.compare(n);var n}denom(){return new kt(gt(this.b),gt.one)}div(t){if(t.isZero())throw new Error("divide by zero");if(this.isZero())return this;const e=Mt(this.a,t.b),r=Mt(this.b,t.a),n=Lt(Nt(e,r),r);return new kt(At(e,n),At(r,n))}equals(t){return t instanceof kt&&this.equalsRat(t)}equalsRat(t){return this===t||0===this.compare(t)}gcd(t){const e=Nt(this.a,t.a),r=Nt(this.b,t.b);return new kt(function(t){return t.isPositive()?t:t.multiply(gt(-1))}(e),r)}inv(){const t=this.a,e=Lt(this.b,t),r=function(t,e){if(t.isPositive()){if(e<0)return t.multiply(gt(-1))}else if(e>0)return t.multiply(gt(-1));return t}(t,1);return new kt(e,r,this.pos,this.end)}isDenom(t){return this.b.equals(t)}isFraction(){return!this.isInteger()}isHalf(){return this.isNumer(1)&&this.isDenom(2)}isInteger(){return this.isDenom(1)}isIntegerNumber(t){return this.isNumer(t)&&this.isDenom(1)}isNegative(){return this.a.isNegative()}isNumer(t){return this.a.equals(t)}isMinusOne(){return this.isIntegerNumber(-1)}isOne(){return this.isIntegerNumber(1)}isPositive(){return this.a.isPositive()}isPositiveInteger(){return this.isPositive()&&this.isInteger()}isTwo(){return this.isIntegerNumber(2)}isZero(){return $t(this.a)}mul(t){if($t(this.a)||$t(t.a))return Yt;const e=Mt(this.a,t.a),r=Mt(this.b,t.b),n=Lt(Nt(e,r),r);return new kt(At(e,n),At(r,n))}neg(){return new kt(gt(this.a.multiply(gt.minusOne)),gt(this.b),this.pos,this.end)}numer(){return new kt(gt(this.a),gt.one)}pred(){return this.sub(Dt)}sub(t){return this.add(t.neg())}succ(){return this.add(Dt)}toInfixString(){return this.isFraction()?`${this.a.toString()}/${this.b.toString()}`:this.a.toString()}toListString(){return this.toInfixString()}toNumber(){const t=this.a.divmod(this.b);return t.quotient.toJSNumber()+t.remainder.toJSNumber()/this.b.toJSNumber()}toString(){const t=this.a.toString();if(this.isFraction()){const e=this.b.toString();return`${this.name}(${t},${e})`}return`${this.name}(${t})`}}const Rt=-129,It=128,Pt=new kt(gt(Rt),gt.one),Ft=new _t(Rt,It,Pt,(function(t,e){return t<e?-1:t>e?1:0}));for(let t=Rt+1;t<It;t++)Ft.insert(t,new kt(gt(t),gt.one));function Ut(t,e,r){return t<It&&t>Rt?Ft.search(t):new kt(gt(t),gt.one,e,r)}function Ct(t,e,r,n){return new kt(gt(t),gt(e),r,n)}const Dt=new kt(gt(1),gt.one),Bt=new kt(gt(2),gt.one),Kt=new kt(gt(3),gt.one),zt=new kt(gt(4),gt.one),Qt=new kt(gt(5),gt.one),Zt=new kt(gt(6),gt.one),Gt=new kt(gt(7),gt.one),Ht=new kt(gt(8),gt.one),Vt=new kt(gt(9),gt.one),jt=new kt(gt(10),gt.one),Wt=new kt(gt(11),gt.one),Jt=Dt.neg();Bt.neg(),Kt.neg();const Xt=zt.neg();Qt.neg(),Zt.neg(),Gt.neg(),Ht.neg(),Vt.neg(),jt.neg(),Wt.neg();const Yt=new kt(gt(0),gt.one),te=new kt(gt(1),gt(2));te.neg();const ee=new kt(gt(1),gt(3));function re(t){return t instanceof kt}function ne(t){return it(t)||re(t)}let se=class t extends _{constructor(t,e,r){super("Str",e,r),this.str=t}equals(e){return e instanceof t&&this.equalsStr(e)}equalsStr(t){return this===t||this.str===t.str}toInfixString(){return JSON.stringify(this.str)}toListString(){return JSON.stringify(this.str)}toString(){return`${this.name}(${this.str})`}};const ie=new se("");function oe(t){return new se(t)}function ae(t){return t instanceof se}function ue(t){return t instanceof B}function ce(t,e,r,n){if(!e){const e=r?r():"satisfy some condition",s=n?" in "+n():"";throw new Error(t+" must "+e+s+".")}}function le(){return"be a string"}function fe(t,e,r){return ce(t,"string"==typeof e,le,r),e}function he(t){fe("name",t);return{get message(){return"Method `"+t+"` is not supported."}}}function pe(){return"be an integer"}function de(t,e,r){var n;return ce(t,"number"==typeof(n=e)&&n%1==0,pe,r),e}function me(t){fe("name",t);return{get message(){return"Property `"+t+"` is readonly."}}}var ge,we;const _e=Math.random();class xe{constructor(t,r,n){if(ge.set(this,void 0),we.set(this,void 0),n!==_e)throw new Error("Use the static create method instead of the constructor");let s;de("n",t),de("d",r);if(0===r)throw new Error("denominator must not be zero");s=0===t?1:function(t,e){let r;for(t<0&&(t=-t),e<0&&(e=-e),e>t&&(r=t,t=e,e=r);;){if(0==(t%=e))return e;if(0==(e%=t))return t}}(Math.abs(t),Math.abs(r)),r<0&&(t=-t,r=-r),e(this,ge,t/s,"f"),e(this,we,r/s,"f")}get numer(){return t(this,ge,"f")}set numer(t){throw new Error(me("numer").message)}get denom(){return t(this,we,"f")}set denom(t){throw new Error(me("denom").message)}add(e){return xe.valueOf(t(this,ge,"f")*t(e,we,"f")+t(this,we,"f")*t(e,ge,"f"),t(this,we,"f")*t(e,we,"f"))}sub(e){return xe.valueOf(t(this,ge,"f")*t(e,we,"f")-t(this,we,"f")*t(e,ge,"f"),t(this,we,"f")*t(e,we,"f"))}mul(e){return xe.valueOf(t(this,ge,"f")*t(e,ge,"f"),t(this,we,"f")*t(e,we,"f"))}div(e){const r=t(this,ge,"f")*t(e,we,"f"),n=t(this,we,"f")*t(e,ge,"f");return 0===r?0===n?xe.valueOf(r,n):xe.ZERO:xe.valueOf(r,n)}isOne(){return 1===t(this,ge,"f")&&1===t(this,we,"f")}isZero(){return 0===t(this,ge,"f")&&1===t(this,we,"f")}hashCode(){return 37*this.numer+13*this.denom}inv(){return xe.valueOf(t(this,we,"f"),t(this,ge,"f"))}neg(){return xe.valueOf(-t(this,ge,"f"),t(this,we,"f"))}equals(e){return e instanceof xe&&t(this,ge,"f")*t(e,we,"f")==t(this,we,"f")*t(e,ge,"f")}toString(){return t(this,ge,"f")+"/"+t(this,we,"f")}__add__(t){return t instanceof xe?this.add(t):void 0}__radd__(t){return t instanceof xe?t.add(this):void 0}__sub__(t){return t instanceof xe?this.sub(t):void 0}__rsub__(t){return t instanceof xe?t.sub(this):void 0}__mul__(t){return t instanceof xe?this.mul(t):void 0}__rmul__(t){return t instanceof xe?t.mul(this):void 0}__div__(t){return t instanceof xe?this.div(t):void 0}__rdiv__(t){return t instanceof xe?t.div(this):void 0}__pos__(){return this}__neg__(){return this.neg()}static valueOf(t,e){if(0===t){if(0!==e)return xe.ZERO}else if(0===e);else{if(t===e)return xe.ONE;if(1===t){if(2===e)return xe.POS_01_02;if(3===e)return xe.POS_01_03;if(4===e)return xe.POS_01_04;if(5===e)return xe.POS_01_05;if(-3===e)return xe.NEG_01_03}else if(-1===t){if(1===e)return xe.NEG_01_01;if(3===e)return xe.NEG_01_03}else if(2===t){if(1===e)return xe.POS_02_01;if(3===e)return xe.POS_02_03}else if(-2===t){if(1===e)return xe.NEG_02_01}else if(3===t){if(1===e)return xe.POS_03_01}else if(-3===t){if(1===e)return xe.NEG_03_01}else if(4===t){if(1===e)return xe.POS_04_01}else if(5===t){if(1===e)return xe.POS_05_01}else if(6===t){if(1===e)return xe.POS_06_01}else if(7===t){if(1===e)return xe.POS_07_01}else if(8===t&&1===e)return xe.POS_08_01}return new xe(t,e,_e)}}ge=new WeakMap,we=new WeakMap,xe.POS_08_01=new xe(8,1,_e),xe.POS_07_01=new xe(7,1,_e),xe.POS_06_01=new xe(6,1,_e),xe.POS_05_01=new xe(5,1,_e),xe.POS_04_01=new xe(4,1,_e),xe.POS_03_01=new xe(3,1,_e),xe.POS_02_01=new xe(2,1,_e),xe.ONE=new xe(1,1,_e),xe.POS_01_02=new xe(1,2,_e),xe.POS_01_03=new xe(1,3,_e),xe.POS_01_04=new xe(1,4,_e),xe.POS_01_05=new xe(1,5,_e),xe.ZERO=new xe(0,1,_e),xe.NEG_01_03=new xe(-1,3,_e),xe.NEG_01_01=new xe(-1,1,_e),xe.NEG_02_01=new xe(-2,1,_e),xe.NEG_03_01=new xe(-3,1,_e),xe.POS_02_03=new xe(2,3,_e);const ye=xe.valueOf(0,1),ve=xe.valueOf(1,1),be=xe.valueOf(2,1),Oe=xe.valueOf(-1,1);function Ee(t,e){if(e instanceof xe)return e;throw new Error("Argument '"+e+"' must be a QQ")}class Se{constructor(t,e,r,n,s,i,o){if(this.M=t,this.L=e,this.T=r,this.Q=n,this.temperature=s,this.amount=i,this.intensity=o,Ee(0,t),Ee(0,e),Ee(0,r),Ee(0,n),Ee(0,s),Ee(0,i),Ee(0,o),7!==arguments.length)throw new Error("Expecting 7 arguments")}compatible(t){if(this.M.equals(t.M)&&this.L.equals(t.L)&&this.T.equals(t.T)&&this.Q.equals(t.Q)&&this.temperature.equals(t.temperature)&&this.amount.equals(t.amount)&&this.intensity.equals(t.intensity))return this;throw this.isOne()?t.isOne()?new Error:new Error("Dimensions must be equal (dimensionless, "+t+")"):t.isOne()?new Error("Dimensions must be equal ("+this+", dimensionless)"):new Error("Dimensions must be equal ("+this+", "+t+")")}mul(t){return new Se(this.M.add(t.M),this.L.add(t.L),this.T.add(t.T),this.Q.add(t.Q),this.temperature.add(t.temperature),this.amount.add(t.amount),this.intensity.add(t.intensity))}div(t){return new Se(this.M.sub(t.M),this.L.sub(t.L),this.T.sub(t.T),this.Q.sub(t.Q),this.temperature.sub(t.temperature),this.amount.sub(t.amount),this.intensity.sub(t.intensity))}equals(t){return this.M.equals(t.M)&&this.L.equals(t.L)&&this.T.equals(t.T)&&this.Q.equals(t.Q)&&this.temperature.equals(t.temperature)&&this.amount.equals(t.amount)&&this.intensity.equals(t.intensity)}pow(t){return new Se(this.M.mul(t),this.L.mul(t),this.T.mul(t),this.Q.mul(t),this.temperature.mul(t),this.amount.mul(t),this.intensity.mul(t))}sqrt(){return new Se(this.M.div(be),this.L.div(be),this.T.div(be),this.Q.div(be),this.temperature.div(be),this.amount.div(be),this.intensity.div(be))}isOne(){return this.M.isZero()&&this.L.isZero()&&this.T.isZero()&&this.Q.isZero()&&this.temperature.isZero()&&this.amount.isZero()&&this.intensity.isZero()}inv(){return new Se(this.M.neg(),this.L.neg(),this.T.neg(),this.Q.neg(),this.temperature.neg(),this.amount.neg(),this.intensity.neg())}neg(){throw new Error(he("neg").message)}toString(){const t=function(t,e){return 0===t.numer?null:1===t.denom?1===t.numer?""+e:e+" ** "+t.numer:e+" ** "+t};return[t(this.M,"mass"),t(this.L,"length"),t(this.T,"time"),t(this.Q,"charge"),t(this.temperature,"thermodynamic temperature"),t(this.amount,"amount of substance"),t(this.intensity,"luminous intensity")].filter((function(t){return"string"==typeof t})).join(" * ")}__add__(t){return t instanceof Se?this.compatible(t):void 0}__radd__(t){return t instanceof Se?t.compatible(this):void 0}__sub__(t){return t instanceof Se?this.compatible(t):void 0}__rsub__(t){return t instanceof Se?t.compatible(this):void 0}__mul__(t){return t instanceof Se?this.mul(t):void 0}__rmul__(t){return t instanceof Se?t.mul(this):void 0}__div__(t){return t instanceof Se?this.div(t):void 0}__rdiv__(t){return t instanceof Se?t.div(this):void 0}__pos__(){return this}__neg__(){return this}}function qe(t){fe("name",t);return{get message(){return`'${t}' method is not yet implemented.`}}}Se.ONE=new Se(ye,ye,ye,ye,ye,ye,ye),Se.MASS=new Se(ve,ye,ye,ye,ye,ye,ye),Se.LENGTH=new Se(ye,ve,ye,ye,ye,ye,ye),Se.TIME=new Se(ye,ye,ve,ye,ye,ye,ye),Se.CHARGE=new Se(ye,ye,ye,ve,ye,ye,ye),Se.CURRENT=new Se(ye,ye,Oe,ve,ye,ye,ye),Se.TEMPERATURE=new Se(ye,ye,ye,ye,ve,ye,ye),Se.AMOUNT=new Se(ye,ye,ye,ye,ye,ve,ye),Se.INTENSITY=new Se(ye,ye,ye,ye,ye,ye,ve);const Te=["kg","m","s","C","K","mol","cd"],Me=[[-1,1,-3,1,2,1,2,1,0,1,0,1,0,1],[-1,1,-2,1,1,1,2,1,0,1,0,1,0,1],[-1,1,-2,1,2,1,2,1,0,1,0,1,0,1],[-1,1,0,1,0,1,1,1,0,1,0,1,0,1],[0,1,-3,1,0,1,1,1,0,1,0,1,0,1],[0,1,2,1,-2,1,0,1,0,1,0,1,0,1],[0,1,0,1,-1,1,0,1,0,1,0,1,0,1],[0,1,0,1,-1,1,1,1,0,1,0,1,0,1],[0,1,1,1,-2,1,0,1,0,1,0,1,0,1],[0,1,1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,-1,1,-2,1,0,1,0,1,0,1,0,1],[1,1,-1,1,-1,1,0,1,0,1,0,1,0,1],[1,1,0,1,-3,1,0,1,0,1,0,1,0,1],[1,1,0,1,-2,1,0,1,0,1,0,1,0,1],[1,1,0,1,-1,1,-1,1,0,1,0,1,0,1],[1,1,1,1,-3,1,0,1,-1,1,0,1,0,1],[1,1,1,1,-2,1,-1,1,0,1,0,1,0,1],[1,1,1,1,-2,1,0,1,0,1,0,1,0,1],[1,1,1,1,0,1,-2,1,0,1,0,1,0,1],[1,1,2,1,-2,1,0,1,-1,1,0,1,0,1],[0,1,2,1,-2,1,0,1,-1,1,0,1,0,1],[1,1,2,1,-2,1,0,1,-1,1,-1,1,0,1],[1,1,2,1,-2,1,0,1,0,1,-1,1,0,1],[1,1,2,1,-2,1,0,1,0,1,0,1,0,1],[1,1,2,1,-1,1,0,1,0,1,0,1,0,1],[1,1,2,1,-3,1,0,1,0,1,0,1,0,1],[1,1,2,1,-2,1,-1,1,0,1,0,1,0,1],[1,1,2,1,-1,1,-2,1,0,1,0,1,0,1],[1,1,2,1,0,1,-2,1,0,1,0,1,0,1],[1,1,2,1,-1,1,-1,1,0,1,0,1,0,1]],Ae=[["F/m"],["S"],["F"],["C/kg"],["C/m ** 3"],["J/kg"],["Hz"],["A"],["m/s ** 2"],["m/s"],["kg·m/s"],["Pa"],["Pa·s"],["W/m ** 2"],["N/m"],["T"],["W/(m·K)"],["V/m"],["N"],["H/m"],["J/K"],["J/(kg·K)"],["J/(mol·K)"],["J/mol"],["J"],["J·s"],["W"],["V"],["Ω"],["H"],["Wb"]],Ne=function(t,e,r,n){const s=e.M,i=e.L,o=e.T,a=e.Q,u=e.temperature,c=e.amount,l=e.intensity;for(let t=0,e=Me.length;t<e;t++){const e=Me[t];if(s.numer===e[0]&&s.denom===e[1]&&i.numer===e[2]&&i.denom===e[3]&&o.numer===e[4]&&o.denom===e[5]&&a.numer===e[6]&&a.denom===e[7]&&u.numer===e[8]&&u.denom===e[9]&&c.numer===e[10]&&c.denom===e[11]&&l.numer===e[12]&&l.denom===e[13])return Ae[t][0]}return function(t,e,r,n){const s=function(t,e){return 0===t.numer?null:1===t.denom?1===t.numer?e:e+" ** "+t.numer:e+" ** "+t},i=[s(e.M,r[0]),s(e.L,r[1]),s(e.T,r[2]),s(e.Q,r[3]),s(e.temperature,r[4]),s(e.amount,r[5]),s(e.intensity,r[6])].filter((function(t){return"string"==typeof t})).join(" ");return n?i:i?"1"!==t?`${t} ${i}`:i:t}(t,e,r,n)};class $e extends _{constructor(t,e){if(super("Uom",0,0),this.dimensions=t,this.labels=e,7!==e.length)throw new Error("Expecting 7 elements in the labels array.")}compatible(t){if(t instanceof $e)return this.dimensions.compatible(t.dimensions),this;throw new Error("Illegal Argument for Unit.compatible: "+t)}equals(t){return t instanceof $e&&this.dimensions.equals(t.dimensions)}mul(t){return function(t,e){return new $e(t.dimensions.mul(e.dimensions),t.labels)}(this,t)}div(t){return function(t,e){return new $e(t.dimensions.div(e.dimensions),t.labels)}(this,t)}pattern(){const t=[];return t.push(this.dimensions.M.numer),t.push(this.dimensions.M.denom),t.push(this.dimensions.L.numer),t.push(this.dimensions.L.denom),t.push(this.dimensions.T.numer),t.push(this.dimensions.T.denom),t.push(this.dimensions.Q.numer),t.push(this.dimensions.Q.denom),t.push(this.dimensions.temperature.numer),t.push(this.dimensions.temperature.denom),t.push(this.dimensions.amount.numer),t.push(this.dimensions.amount.denom),t.push(this.dimensions.intensity.numer),t.push(this.dimensions.intensity.denom),JSON.stringify(t)}pow(t){return new $e(this.dimensions.pow(t),this.labels)}inv(){return new $e(this.dimensions.inv(),this.labels)}isOne(){return this.dimensions.isOne()}lerp(t,e){throw new Error(qe("lerp").message)}quad(){return new $e(this.dimensions.mul(this.dimensions),this.labels)}reflect(t){return this}rotate(t){return this}slerp(t,e){throw new Error(qe("slerp").message)}sqrt(){return new $e(this.dimensions.sqrt(),this.labels)}stress(t){throw new Error(he("stress").message)}toExponential(t,e){return Ne(Number(1).toExponential(t),this.dimensions,this.labels,e)}toFixed(t,e){return Ne(Number(1).toFixed(t),this.dimensions,this.labels,e)}toInfixString(){return Ne(Number(1).toString(10),this.dimensions,this.labels,!0)}toListString(){return Ne(Number(1).toString(10),this.dimensions,this.labels,!0)}toPrecision(t,e){return Ne(Number(1).toPrecision(t),this.dimensions,this.labels,e)}toString(t,e){return Ne(Number(1).toString(t),this.dimensions,this.labels,e)}static isOne(t){if(void 0===t)return!0;if(t instanceof $e)return t.isOne();throw new Error("isOne argument must be a Unit or undefined.")}static assertDimensionless(t){if(!$e.isOne(t))throw new Error("uom must be dimensionless.")}static compatible(t,e){if(t){if(e)return t.compatible(e);if(t.isOne())return;throw new Error(t+" is incompatible with 1")}if(e){if(e.isOne())return;throw new Error("1 is incompatible with "+e)}}static mul(t,e){return t?e?t.mul(e):$e.isOne(e)?t:void 0:$e.isOne(t)?e:void 0}static div(t,e){return t?e?t.div(e):t:e?e.inv():void 0}static sqrt(t){return void 0!==t?t.isOne()?void 0:new $e(t.dimensions.sqrt(),t.labels):void 0}}function Le(t){return t instanceof $e}function ke(t){switch(t){case"kilogram":return $e.KILOGRAM;case"meter":return $e.METER;case"second":return $e.SECOND;case"coulomb":return $e.COULOMB;case"ampere":return $e.AMPERE;case"kelvin":return $e.KELVIN;case"mole":return $e.MOLE;case"candela":return $e.CANDELA;default:throw new Error(`Unknown name ${t}`)}}$e.ZERO=new $e(Se.ONE,Te),$e.ONE=new $e(Se.ONE,Te),$e.KILOGRAM=new $e(Se.MASS,Te),$e.METER=new $e(Se.LENGTH,Te),$e.SECOND=new $e(Se.TIME,Te),$e.COULOMB=new $e(Se.CHARGE,Te),$e.AMPERE=new $e(Se.CURRENT,Te),$e.KELVIN=new $e(Se.TEMPERATURE,Te),$e.MOLE=new $e(Se.AMOUNT,Te),$e.CANDELA=new $e(Se.INTENSITY,Te);const Re=z(P.add),Ie=z(P.subtract),Pe=z(P.multiply),Fe=z(P.divide),Ue=z(P.pow),Ce=z(P.outer),De=z(P.inner),Be=z(P.inverse),Ke=z(P.lco),ze=z(P.rco),Qe=z(P.sin);z(P.succ),D("pred");const Ze=z(P.E),Ge=z(P.PI),He=D("component"),Ve=D("factorial");D("iszero");const je=z(P.test_lt),We=z(P.test_gt);z(P.test_le),D(":"),z(P.tau);const Je=z(P.IMU),Xe="PRINTMODE_LATEX",Ye="PRINTMODE_ASCII",tr="PRINTMODE_INFIX",er="PRINTMODE_HUMAN",rr="PRINTMODE_SEXPR";const nr=new class{constructor(){this.$test_flag=!1,this.$printMode=tr,this.recursionLevelNestedRadicalsRemoval=0,this.errorMessage="",this.symbolsDependencies={},this.symbolsHavingReassignments=[],this.symbolsInExpressionsWithoutAssignments=[],this.patternHasBeenFound=!1,this.tos=0,this.trigmode=0,this.stack=[],this.out_count=0,this.codeGen=!1,this.userSimplificationsInListForm=[],this.userSimplificationsInStringForm=[],this.imuToken="i"}get printMode(){return this.$printMode}setPrintMode(t){this.$printMode=t}get testFlag(){return this.$test_flag}setTestFlag(t){this.$test_flag=t}};function sr(t){nr.errorMessage+="Stop: ",nr.errorMessage+=t;const e=nr.errorMessage;throw nr.errorMessage="",ir(0),new Error(e)}function ir(t){if(nr.tos<=t)nr.tos=t;else for(;nr.tos>t;)nr.stack[nr.tos]=null,nr.tos--}function or(){ir(0)}function ar(t,e,r){r.pushNativeDirective(N.expand,!1);try{return t(e,r)}finally{r.popNativeDirective()}}function ur(t,e,r){r.pushNativeDirective(N.expand,!0);try{return t(e,r)}finally{r.popNativeDirective()}}function cr(t,e,r,n){n.pushNativeDirective(N.expand,!0);try{return t(e,r,n)}finally{n.popNativeDirective()}}class lr{static NegOne(t){return t.getNativeDirective(N.evaluatingAsFloat)?nt:Jt}static Pi(t){return t.getNativeDirective(N.evaluatingAsFloat)?et:Ge}}const fr=z(P.add),hr=D("adj");D("algebra");const pr=D("and"),dr=D("approxratio"),mr=D("arccos"),gr=D("arccosh"),wr=D("arcsin"),_r=D("arcsinh"),xr=D("arctan"),yr=D("arctanh");D("atomize");const vr=D("besselj"),br=D("bessely");D("binding");const Or=D("binomial"),Er=D("ceiling"),Sr=D("check"),qr=D("choose"),Tr=D("circexp"),Mr=D("clear"),Ar=D("clearall");D("clearpatterns");const Nr=D("clock"),$r=D("coeff"),Lr=D("cofactor");D("compare"),D("compare-factors"),D("compare-terms");const kr=D("condense"),Rr=D("contract"),Ir=D("cos"),Pr=D("cosh");D("decomp");const Fr=D("defint"),Ur=D("degree"),Cr=D("denominator"),Dr=D("det"),Br=D("dim"),Kr=D("dirac");D("divide");const zr=D("divisors"),Qr=D("do"),Zr=D("dot");D("draw"),D("dsolve");const Gr=D("eigen"),Hr=D("eigenval"),Vr=D("eigenvec");D("equal");const jr=D("erf"),Wr=D("erfc"),Jr=D("eval"),Xr=D("exp"),Yr=D("expand"),tn=D("expcos"),en=D("expsin"),rn=D("factor"),nn=Ve;D("factorpoly"),D("filter");const sn=D("float"),on=D("floor"),an=D("for"),un=D("function"),cn=D("gamma"),ln=D("gcd"),fn=D("hermite"),hn=D("hilbert");D("if");const pn=z(P.imag),dn=He,mn=D("integral"),gn=Be;D("invg"),D("isinteger");const wn=D("isprime"),_n=D("laguerre");D("laplace");const xn=D("lcm");D("lco"),D("leading");const yn=D("legendre"),vn=z(P.log);D("lookup");const bn=Pe,On=D("not"),En=D("nroots"),Sn=D("number"),qn=D("numerator"),Tn=D("operator"),Mn=D("or"),An=D("pattern");D("patternsinfo");const Nn=D("polar"),$n=Ue;D("prime");const Ln=D("printLeaveEAlone"),kn=D("printLeaveXAlone");D("print");const Rn=D("product"),In=D("quote"),Pn=D("quotient"),Fn=D("rank"),Un=D("rationalize");D("rco");const Cn=z(P.real),Dn=z(P.is_real),Bn=D("round"),Kn=z(P.rect),zn=D("roots"),Qn=D("="),Zn=D("sgn");D("silentpattern");const Gn=D("simplify"),Hn=Qe,Vn=D("sinh"),jn=D("shape"),Wn=D("sqrt");D("stop");const Jn=D("subst");D("-");const Xn=D("sum");D("symbolsinfo");const Yn=D("tan"),ts=D("tanh"),es=D("taylor"),rs=D("test"),ns=D("testge"),ss=D("testgt"),is=D("testle"),os=D("testlt"),as=D("transpose"),us=D("unit");D("uom");const cs=D("zero");D("lastPrint");const ls=D("lastAsciiPrint"),fs=D("lastInfixPrint"),hs=D("lastLatexPrint"),ps=D("lastSexprPrint"),ds=D("lastHumanPrint"),ms=D("autoexpand"),gs=D("autofactor"),ws=D("bake"),_s=D("assumeRealVariables");D("trace");const xs=D("forceFixedPrintout"),ys=D("maxFixedPrintoutDigits"),vs=6;D("$DRAWX");const bs=D("$METAA"),Os=D("$METAB"),Es=D("$METAX"),Ss=D("$SECRETX");D("version");const qs=Ge;D("a"),D("b"),D("c");const Ts=D("d"),Ms=D("i"),As=D("j");D("n"),D("r");const Ns=D("s"),$s=D("t"),Ls=D("x"),ks=D("y"),Rs=D("z"),Is=D("I"),Ps=D("a_"),Fs=D("b_"),Us=D("x_");D("$C1"),D("$C2"),D("$C3"),D("$C4"),D("$C5"),D("$C6");const Cs=1e4,Ds=5,Bs=10,Ks=24,zs=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"],Qs=function(){const t=[2];let e=3;for(;t.length<Cs;){let r=0;const n=Math.sqrt(e);for(;r<t.length&&t[r]<=n;){if(e%t[r]==0){r=-1;break}r++}-1!==r&&t.push(e),e+=2}return t[Cs]=0,t}(),Zs=7488,Gs=String.fromCharCode(183);function Hs(t){return t.isZero()?0:t.isPositive()?1:-1}function Vs(t,e){return t.equals(e)}const js="Err";var Ws;class Js extends _{constructor(t,r,n){super(js,r,n),Ws.set(this,void 0),e(this,Ws,t,"f")}get cause(){return t(this,Ws,"f")}equals(t){return this===t||t instanceof Js&&this.equalsErr(t)}equalsErr(t){return this.cause.equals(t.cause)}toString(){return`${js}(${t(this,Ws,"f").toString()})`}toInfixString(){throw new Error}toListString(){throw new Error}}function Xs(t){return t instanceof Js}Ws=new WeakMap;const Ys=0,ti=1,ei=2,ri="Blade",ni="Boo",si=js,ii="Flt",oi="Hyp",ai="Imu",ui="Rat",ci="Str",li="Sym",fi="Tensor",hi="Uom",pi="U",di="Nil";function mi(t,e,r){return`(${t.key()} ${e} ${r})`}function gi(t,e,r){return`(${t.key()} ${e} (${r.key()}))`}function wi(t,e,r){return`(${t.key()} (${e.key()}) ${r})`}function _i(t,e,r){return`(${t.key()} (${e.key()}) (${r.key()}))`}function xi(t,e){return`(${t.key()} ${e})`}function yi(t,e){return`(${t.key()} (${e.key()}))`}function vi(t){return`(${t.key()})`}function bi(t){const e=[],r=Ei(t,0);if(e.push(Oi(r)),r.kind===ti)3===r.parts.length&&(e.push(Oi({kind:ti,parts:[r.parts[0],r.parts[1],pi]})),e.push(Oi({kind:ti,parts:[r.parts[0],pi,r.parts[2]]})),e.push(Oi({kind:ti,parts:[r.parts[0],pi,pi]})),e.push(Oi({kind:ti,parts:[r.parts[0]]}))),2===r.parts.length&&(e.push(Oi({kind:ti,parts:[r.parts[0],pi]})),e.push(Oi({kind:ti,parts:[r.parts[0]]})));return e}function Oi(t){switch(t.kind){case ti:return`(${t.parts.join(" ")})`;case ei:return t.parts[0];default:return di}}function Ei(t,e){if(f(t)){if(0===e){if(3===t.length){const r=t.opr,n=t.lhs,s=t.rhs;return{kind:ti,parts:[Si(r),Oi(Ei(n,e+1)),Oi(Ei(s,e+1))]}}if(2===t.length){const r=t.opr,n=t.arg;return{kind:ti,parts:[Si(r),Oi(Ei(n,e+1))]}}if(ue(t.head))return{kind:ti,parts:[Si(t.head)]};if(re(t.head))return{kind:ti,parts:[Si(t.head)]};throw new Error(`${t}`)}return{kind:ti,parts:[Si(t.opr)]}}if(ue(t))return{kind:ei,parts:[li]};if(re(t))return{kind:ei,parts:[ui]};if(Q(t))return{kind:ei,parts:[ri]};if(pt(t))return{kind:ei,parts:[ai]};if(y(t))return{kind:ei,parts:[fi]};if(Le(t))return{kind:ei,parts:[hi]};if(it(t))return{kind:ei,parts:[ii]};if(h(t))return{kind:Ys,parts:[di]};if(ae(t))return{kind:ei,parts:[ci]};if(j(t))return{kind:ei,parts:[ni]};if(lt(t))return{kind:ei,parts:[oi]};if(Xs(t))return{kind:ei,parts:[si]};throw new Error(`hash_string(${t})`)}function Si(t){if(ue(t))return t.key();if(re(t))return t.name;throw new Error(`hash_arg(arg=${t})`)}class qi{constructor(t){this.extensionProvider=t}create(t){return new Ti(this.extensionProvider(t),t)}}class Ti{constructor(t,e){this.extension=t,this.$=e}get key(){return this.extension.key}get hash(){return this.extension.hash}get name(){return this.extension.name}get phases(){return this.extension.phases}get dependencies(){return this.extension.dependencies}isImag(t){return this.extension.isImag(t,this.$)}isKind(t){return this.extension.isKind(t,this.$)}isMinusOne(t){return this.extension.isMinusOne(t,this.$)}isOne(t){return this.extension.isOne(t,this.$)}isReal(t){return this.extension.isReal(t,this.$)}isScalar(t){return this.extension.isScalar(t,this.$)}isZero(t){return this.extension.isZero(t,this.$)}valueOf(t){return this.extension.transform(t,this.$)[1]}subst(t,e,r){return this.extension.subst(t,e,r,this.$)}toInfixString(t){return this.extension.toInfixString(t,this.$)}toLatexString(t){return this.extension.toLatexString(t,this.$)}toListString(t){return this.extension.toListString(t,this.$)}evaluate(t,e){return this.extension.evaluate(t,e,this.$)}transform(t){return this.extension.transform(t,this.$)}}function Mi(t){return t instanceof kt}class Ai{constructor(t){this.$=t}get key(){return Dt.name}get hash(){return ui}get name(){return"RatExtension"}isImag(t){return!1}isKind(t,e){return f(t)&&function(t){if(c===t)return!1;const e=t.cdr;return c===e}(t)?this.isKind(t.head,e):t instanceof kt}isMinusOne(t){return t.isMinusOne()}isOne(t){return t.isOne()}isReal(t){return!0}isScalar(t){return!0}isZero(t){return t.isZero()}subst(t,e,r){return Mi(e)&&t.equals(e)?r:t}toInfixString(t){return t.toInfixString()}toLatexString(t){return t.toInfixString()}toListString(t){return t.toListString()}evaluate(t,e){if(f(t))throw new Error(`The expr is really a Cons! ${t}`);return this.transform(a(t,e))}transform(t){return t instanceof kt?this.$.getNativeDirective(N.evaluatingAsFloat)?[q,W(t.toNumber())]:[T,t]:[S,t]}valueOf(t){return this.transform(t)[1]}}const Ni=new qi((function(t){return new Ai(t)}));class $i extends Error{constructor(t){super(t),this.name="SystemError",console.warn(t,(new Error).stack)}}function Li(t){if(ue(t))return t;throw new $i(`expr => ${t}`)}function ki(t,e){if(t===e)return t;throw new $i}function Ri(t,e){return t.clone(e.pos,e.end)}const Ii=function(t){let e=1001;return function(t){return{text:t,code:e++}}}(),Pi=Ii("Int"),Fi=Ii("Flt"),Ui=Ii("Sym"),Ci=Ii("Function"),Di=Ii("-"),Bi=Ii("NewLine"),Ki=Ii("+"),zi=Ii("Str"),Qi=Ii(">="),Zi=Ii(">>"),Gi=Ii("<="),Hi=Ii("<<"),Vi=Ii("<"),ji=Ii(">"),Wi=Ii("*"),Ji=Ii("/"),Xi=Ii("("),Yi=Ii(")"),to=Ii("·"),eo=Ii("=="),ro=Ii("!="),no=Ii(":"),so=Ii(":="),io=Ii("="),oo=Ii("**"),ao=Ii("^"),uo=Ii("|"),co=Ii("End"),lo=Ii(","),fo=Ii("["),ho=Ii("]");class po{parse(t,e,r){const n=parseFloat(t);return new J(n,e,r)}}class mo{parse(t,e,r){const n=t[0];if("+"===n){const n=gt(t.substring(1));return new kt(n,gt.one,e,r)}if("-"===n){const n=gt(t.substring(1));return new kt(n,gt.one,e,r).neg()}const s=gt(t);return new kt(s,gt.one,e,r)}}D("if"),D("nil"),D("false"),D("true"),D("undefined");const go=D(":=");function wo(t){return null!=t&&/^\d+$/.test(t)}function _o(t,e){if(wo(t.curr)||"."===t.curr){for(;wo(t.curr);)t.consumeChars(1);if("."===t.curr){for(t.consumeChars(1);wo(t.curr);)t.consumeChars(1);if(t.currEquals("e")&&("+"===t.next||"-"===t.next||wo(t.next)))for(t.consumeChars(2);wo(t.curr);)t.consumeChars(1);return e.flt(),!0}return e.int(),!0}return!1}function xo(t){return null!=t&&(function(t){return null!=t&&-1===t.search(/[^A-Za-z_]/)}(t)||wo(t))}let yo=class extends Error{constructor(t,e,r){super(`${t} in range [${e}, ${r}]`)}};var vo;const bo={fltParser:new po,intParser:new mo,strParser:new class{parse(t,e,r){const n=t.substring(1,t.length-1);return new se(n,e,r)}},symParser:new class{parse(t,e,r){return D(t,e,r)}},lexicon:{"+":z(P.add),"-":z(P.subtract),"*":z(P.multiply),"/":z(P.divide),"^":z(P.outer),"|":z(P.inner),">>":z(P.rco),"<<":z(P.lco),"**":z(P.pow),"<=":z(P.test_le),"<":z(P.test_lt),">=":z(P.test_ge),">":z(P.test_gt),"!=":z(P.test_ne),"==":z(P.test_eq),":=":go,"=":Qn,abs:z(P.abs),cos:z(P.cos),exp:z(P.exp),iscomplex:z(P.is_complex),isreal:z(P.is_real),sin:z(P.sin)},meta:{a:bs,b:Os,x:Es},parse_time_simplifications:!0};class Oo{constructor(t,r=0){this.sourceText=t,vo.set(this,void 0),this.meta_mode=!1,this.useCaretForExponentiation=!1,this.explicitAssocAdd=!1,this.explicitAssocMul=!1,e(this,vo,{txt:"",pos:0,end:r},"f"),this.newLine=!1,this.input_str=0,this.lastFoundSymbol=null,this.symbolsRightOfAssignment=[],this.symbolsLeftOfAssignment=[],this.isSymbolLeftOfAssignment=null,this.scanningParameters=[],this.functionInvokationsScanningStack=[],this.skipRootVariableToBeSolved=!1,this.assignmentFound=null}get code(){const e=t(this,vo,"f").code;if(e)return e;throw new Error}peek(e){return this.sourceText.slice(t(this,vo,"f").end,t(this,vo,"f").end+e)}read(e){return new Oo(this.sourceText,t(this,vo,"f").end+e)}get done(){return t(this,vo,"f").end===this.sourceText.length}get text(){return t(this,vo,"f").txt}get pos(){return t(this,vo,"f").pos}get end(){return t(this,vo,"f").end}get scanned(){return t(this,vo,"f").pos-this.input_str}get curr(){return this.sourceText[t(this,vo,"f").end]}get next(){return this.sourceText[t(this,vo,"f").end+1]}advance(){for(this.newLine=!1;this.get_token(),t(this,vo,"f").code===Bi;)this.newLine=!0}consumeChars(e){t(this,vo,"f").end+=e}currEquals(t){return this.curr===t}expect(t){if(this.code===t)return{pos:this.pos,end:this.end};this.scan_error(`${t.text} expected`)}tokenToFlt(){return bo.fltParser.parse(t(this,vo,"f").txt,t(this,vo,"f").pos,t(this,vo,"f").end)}tokenToInt(){return bo.intParser.parse(t(this,vo,"f").txt,t(this,vo,"f").pos,t(this,vo,"f").end)}tokenToStr(){return bo.strParser.parse(t(this,vo,"f").txt,t(this,vo,"f").pos,t(this,vo,"f").end)}tokenToSym(){const e=t(this,vo,"f").txt;if(this.meta_mode&&"string"==typeof t(this,vo,"f").txt){const t=bo.meta[e];if(t)return t}return bo.lexicon[e]?bo.lexicon[e].clone(t(this,vo,"f").pos,t(this,vo,"f").end):D(e,t(this,vo,"f").pos,t(this,vo,"f").end)}get_token(){for(;null!=(e=this.curr)&&(" "===e||"\t"===e||"\n"===e||"\v"===e||"\f"===e||"\r"===e);){if("\n"===this.curr||"\r"===this.curr)return t(this,vo,"f").code=Bi,void t(this,vo,"f").end++;t(this,vo,"f").end++}var e;if(t(this,vo,"f").pos=t(this,vo,"f").end,t(this,vo,"f").end===this.sourceText.length)return t(this,vo,"f").txt="",void(t(this,vo,"f").code=co);if(!_o(this,{flt:()=>{t(this,vo,"f").code=Fi,this.update_token_text(t(this,vo,"f").pos,t(this,vo,"f").end)},int:()=>{t(this,vo,"f").code=Pi,this.update_token_text(t(this,vo,"f").pos,t(this,vo,"f").end)}})){if(null==(r=this.curr)||-1!==r.search(/[^A-Za-z]/)){var r;if('"'===this.curr){for(t(this,vo,"f").end++;'"'!==this.curr;)t(this,vo,"f").end===this.sourceText.length-1&&(t(this,vo,"f").end++,this.scan_error("runaway string"),t(this,vo,"f").end--),t(this,vo,"f").end++;return t(this,vo,"f").end++,t(this,vo,"f").code=zi,void this.update_token_text(t(this,vo,"f").pos,t(this,vo,"f").end)}if("#"===this.curr||"-"===this.curr&&"-"===this.next){for(;this.curr&&!this.currEquals("\n")&&!this.currEquals("\r");)t(this,vo,"f").end++;return this.curr&&t(this,vo,"f").end++,void(t(this,vo,"f").code=Bi)}switch(this.curr){case"*":return"*"===this.next?(t(this,vo,"f").code=oo,t(this,vo,"f").txt="**",void(t(this,vo,"f").end+=2)):(t(this,vo,"f").txt="*",t(this,vo,"f").code=Wi,void(t(this,vo,"f").end+=1));case":":return"="===this.next?(t(this,vo,"f").code=so,t(this,vo,"f").txt=":=",void(t(this,vo,"f").end+=2)):(t(this,vo,"f").code=no,t(this,vo,"f").txt=":",void(t(this,vo,"f").end+=1));case"=":return"="===this.next?(t(this,vo,"f").code=eo,t(this,vo,"f").txt="==",void(t(this,vo,"f").end+=2)):(t(this,vo,"f").code=io,t(this,vo,"f").txt="=",void(t(this,vo,"f").end+=1));case">":switch(this.next){case"=":return t(this,vo,"f").code=Qi,t(this,vo,"f").txt=">=",void(t(this,vo,"f").end+=2);case">":return t(this,vo,"f").code=Zi,t(this,vo,"f").txt=">>",void(t(this,vo,"f").end+=2);default:return t(this,vo,"f").code=ji,t(this,vo,"f").txt=">",void(t(this,vo,"f").end+=1)}case"<":switch(this.next){case"=":return t(this,vo,"f").code=Gi,t(this,vo,"f").txt="<=",void(t(this,vo,"f").end+=2);case"<":return t(this,vo,"f").code=Hi,t(this,vo,"f").txt="<<",void(t(this,vo,"f").end+=2);default:return t(this,vo,"f").code=Vi,t(this,vo,"f").txt="<",void(t(this,vo,"f").end+=1)}case"!":if("="===this.next)return t(this,vo,"f").code=ro,t(this,vo,"f").txt="!=",void(t(this,vo,"f").end+=2);break;case"(":return this.next,t(this,vo,"f").code=Xi,t(this,vo,"f").txt="(",void(t(this,vo,"f").end+=1);case")":return this.next,t(this,vo,"f").code=Yi,t(this,vo,"f").txt=")",void(t(this,vo,"f").end+=1);case",":return this.next,t(this,vo,"f").code=lo,t(this,vo,"f").txt=",",void(t(this,vo,"f").end+=1);case"[":return this.next,t(this,vo,"f").code=fo,t(this,vo,"f").txt="[",void(t(this,vo,"f").end+=1);case"]":return this.next,t(this,vo,"f").code=ho,t(this,vo,"f").txt="]",void(t(this,vo,"f").end+=1)}if("+"===this.curr)return t(this,vo,"f").txt=this.curr,t(this,vo,"f").code=Ki,void(t(this,vo,"f").end+=1);if("-"===this.curr)return t(this,vo,"f").txt=this.curr,t(this,vo,"f").code=Di,void(t(this,vo,"f").end+=1);if("^"===this.curr)return t(this,vo,"f").txt=this.curr,t(this,vo,"f").code=ao,void(t(this,vo,"f").end+=1);if("|"===this.curr)return t(this,vo,"f").txt=this.curr,t(this,vo,"f").code=uo,void(t(this,vo,"f").end+=1);if("/"===this.curr)return t(this,vo,"f").txt=this.curr,t(this,vo,"f").code=Ji,void(t(this,vo,"f").end+=1);if("·"===this.curr)return t(this,vo,"f").txt=this.curr,t(this,vo,"f").code=to,void(t(this,vo,"f").end+=1);throw t(this,vo,"f").txt=this.sourceText[t(this,vo,"f").end++],new Error(`text = ${t(this,vo,"f").txt}`)}for(t(this,vo,"f").code=Ui,t(this,vo,"f").end++;xo(this.curr);)t(this,vo,"f").code=Ui,t(this,vo,"f").end++;this.update_token_text(t(this,vo,"f").pos,t(this,vo,"f").end)}}update_token_text(e,r){t(this,vo,"f").txt=this.sourceText.substring(e,r)}scan_error(e){for(nr.errorMessage="";this.input_str!==t(this,vo,"f").end&&("\n"!==this.sourceText[this.input_str]&&"\r"!==this.sourceText[this.input_str]||this.input_str+1!==t(this,vo,"f").end);)nr.errorMessage+=this.sourceText[this.input_str++];for(nr.errorMessage+=" ? ";this.sourceText[this.input_str]&&"\n"!==this.sourceText[this.input_str]&&"\r"!==this.sourceText[this.input_str];)nr.errorMessage+=this.sourceText[this.input_str++];throw nr.errorMessage+="\n",new yo(e,t(this,vo,"f").pos,t(this,vo,"f").end)}tokenCharCode(){const e=this.munge(t(this,vo,"f"));if("string"==typeof e)return e.charCodeAt(0)}munge(t){const e=t.code;return"object"==typeof e&&"number"==typeof e.code?e.code:t.txt}get parse_time_simplifications(){return bo.parse_time_simplifications}}function Eo(t){return re(t)||it(t)?t.inv():u(Ue.clone(t.pos,t.end),t,Jt)}function So(t){return re(t)||it(t)?t.neg():u(Pe.clone(t.pos,t.end),Jt,t)}function qo(t,e){const r=new Oo(t);if(r.lastFoundSymbol=null,r.symbolsRightOfAssignment=[],r.symbolsLeftOfAssignment=[],r.isSymbolLeftOfAssignment=!0,r.scanningParameters=[],r.functionInvokationsScanningStack=[""],r.assignmentFound=!1,r.useCaretForExponentiation=e.useCaretForExponentiation,r.explicitAssocAdd=e.explicitAssocAdd,r.explicitAssocMul=e.explicitAssocMul,r.advance(),r.code===co)return[0,c];const n=No(r);return r.assignmentFound||(nr.symbolsInExpressionsWithoutAssignments=nr.symbolsInExpressionsWithoutAssignments.concat(r.symbolsLeftOfAssignment)),[r.scanned,n]}function To(t){const e=new Oo(t);return e.meta_mode=!0,e.advance(),e.code===co?c:No(e)}function Mo(t){return t===so}function Ao(t){return Mo(t)||function(t){return t===io}(t)}function No(t){let e=$o(t);if(Ao(t.code)){const r=t.lastFoundSymbol;t.assignmentFound=!0,t.isSymbolLeftOfAssignment=!1;const{pos:n,end:s}=t.tokenToSym(),i=Mo(t.code);t.advance();let o=$o(t);if(i&&(o=u(In.clone(n,s),o)),e=u(Qn.clone(n,s),e,o),t.isSymbolLeftOfAssignment=!0,nr.codeGen){if(r){const e=t.symbolsRightOfAssignment.indexOf(r);-1!==e&&(t.symbolsRightOfAssignment.splice(e,1),nr.symbolsHavingReassignments.push(r))}if(r){null==nr.symbolsDependencies[r]&&(nr.symbolsDependencies[r]=[]);const e=nr.symbolsDependencies[r];for(const r of Array.from(t.symbolsRightOfAssignment))-1===e.indexOf(r)&&e.push(r)}t.symbolsRightOfAssignment=[]}}return e}function $o(t){const e=function(t,e){return t},r=ko(t);if(function(t){switch(t){case eo:case ro:case Gi:case Qi:case Vi:case ji:return!0;default:return!1}}(t.code)){const n=t.tokenToSym();t.advance();return e(u(n,r,ko(t)))}return e(r)}function Lo(t,e){if(e)return!1;switch(t){case Ki:case Di:return!0;default:return!1}}function ko(t){return t.explicitAssocAdd?function(t){const e=function(t,e){return t};let r=Po(t);for(;Lo(t.code,t.newLine);)switch(t.code){case Ki:{const e=Ri(z(P.add),t.tokenToSym());t.advance(),r=u(e,r,Po(t));break}default:{ki(t.code,Di);const e=Ri(z(P.add),t.tokenToSym());t.advance(),r=u(e,r,So(Po(t)));break}}return e(r)}(t):function(t){const e=[z(P.add)];switch(t.code){case Ki:t.advance(),e.push(Po(t));break;case Di:t.advance(),e.push(Ro(Po(t)));break;default:e.push(Po(t))}for(;!1===t.newLine&&(t.code===Ki||t.code===Di);)t.code===Ki?(t.advance(),e.push(Po(t))):(t.advance(),e.push(Ro(Po(t))));if(2===e.length)return e[1];return u(...e)}(t)}function Ro(t){return ne(t)?t.neg():u(Pe,t,Jt)}function Io(t,e){switch(t){case Wi:case Ji:return!0}return!1}function Po(t){return t.explicitAssocMul?function(t){const e=function(t,e){return t};let r=Uo(t);for(;Io(t.code,t.newLine);)switch(t.code){case Wi:{const e=Ri(Pe,t.tokenToSym());t.advance(),r=u(e,r,Uo(t));break}case Ji:if(Mi(r)&&r.isOne())t.advance(),r=Eo(Uo(t));else{const e=Ri(Pe,t.tokenToSym());t.advance(),r=u(e,r,Eo(Uo(t)))}break;default:throw new Error(`${JSON.stringify(t)}`)}return e(r)}(t):function(t){const e=[Uo(t)];for(;Io(t.code,t.newLine);)t.code===Wi?(t.advance(),e.push(Uo(t))):t.code===Ji?(Fo(e),t.advance(),e.push(Eo(Uo(t)))):e.push(Uo(t));if(0===e.length)return Dt;if(1==e.length)return e[0];return u(Pe,...e)}(t)}function Fo(t){if(t.length>0){const e=t[t.length-1];Mi(e)&&e.isOne()&&t.pop()}}function Uo(t){let e=Co(t);for(;r=t.code,n=t.newLine,s=t.useCaretForExponentiation,!n&&r===ao&&!s;){const r=Ri(Ce,t.tokenToSym());t.advance(),e=u(r,e,Co(t))}var r,n,s;return e}function Co(t){let e=Do(t);for(;r=t.code,!t.newLine&&(r===Hi||r===Zi||r===uo||r===to);)switch(t.code){case Hi:{const r=Ri(Ke,t.tokenToSym());t.advance(),e=u(r,e,Do(t));break}case Zi:{const r=Ri(ze,t.tokenToSym());t.advance(),e=u(r,e,Do(t));break}case uo:{const r=Ri(De,t.tokenToSym());t.advance(),e=u(r,e,Do(t));break}default:{t.expect(to);const r=Ri(De,t.tokenToSym());t.advance(),e=u(r,e,Do(t));break}}var r;return e}function Do(t){const e=[];for(e.push(Bo(t));r=t.code,n=t.newLine,s=t.useCaretForExponentiation,!n&&(s?r===ao:r===oo);)e.push(t.tokenToSym()),t.advance(),e.push(Bo(t));for(var r,n,s;e.length>0;){const t=e.pop();if(!(e.length>0))return t;{const r=Li(e.pop()),n=e.pop();e.push(u(Ri(Ue,r),n,t))}}throw new Error}function Bo(t){switch(t.code){case Ki:return t.advance(),Bo(t);case Di:return t.advance(),So(Bo(t));default:return function(t){const e=t.code;return e===Xi?Jo(t):function(t){const e=function(t){const e=t.code;if(e===Xi)return[!1,Jo(t)];if(e===Ui){if("true"===t.text){const e=new Z(!0,t.pos,t.end);return t.advance(),[!1,e]}if("false"===t.text){const e=new Z(!1,t.pos,t.end);return t.advance(),[!1,e]}return[!1,Ho(t)]}if(e===Ci)return[!1,jo(t)];if(e===fo)return[!1,Xo(t)];if(e===Pi)return[!0,zo(t)];if(e===Fi)return[!0,Ko(t)];if(e===zi)return[!1,Qo(t)];t.scan_error(`Unexpected token ${JSON.stringify(e.text)}`)}(t),r=e[0];let n=e[1];for(;t.code===fo||t.code===Xi&&!t.newLine&&!r;)t.code===fo?n=Zo(n,t):t.code===Xi&&(n=Wo(n,t));for(;"!"===t.text;)t.advance(),n=u(nn,n);for(;t.tokenCharCode()===Zs;)t.advance(),n=u(as,n);return n}(t)}(t)}}function Ko(t){const e=t.tokenToFlt();return t.advance(),e}function zo(t){const e=t.tokenToInt();return t.advance(),e}function Qo(t){const e=t.tokenToStr();return t.advance(),e}function Zo(t,e){e.expect(fo),e.advance();const r=[He,t];if(e.code!==ho)for(r.push(ko(e));e.code===lo;)e.advance(),r.push(ko(e));return e.expect(ho),e.advance(),u(...r)}function Go(t,e){if(-1===zs.indexOf(e)&&-1===t.symbolsRightOfAssignment.indexOf(e)&&-1===t.symbolsRightOfAssignment.indexOf("'"+e)&&!t.skipRootVariableToBeSolved){let r="";for(let e=1;e<t.functionInvokationsScanningStack.length;e++)""!==t.functionInvokationsScanningStack[e]&&(r+=t.functionInvokationsScanningStack[e]+"_"+e+"_");e=r+e,t.symbolsRightOfAssignment.push(e)}}function Ho(t){t.expect(Ui);const e=t.tokenToSym();return 0===t.scanningParameters.length?(t.lastFoundSymbol=t.text,t.isSymbolLeftOfAssignment&&function(t,e){if(-1===zs.indexOf(e)&&-1===t.symbolsLeftOfAssignment.indexOf(e)&&-1===t.symbolsLeftOfAssignment.indexOf("'"+e)&&!t.skipRootVariableToBeSolved){let r="";for(let e=1;e<t.functionInvokationsScanningStack.length;e++)""!==t.functionInvokationsScanningStack[e]&&(r+=t.functionInvokationsScanningStack[e]+"_"+e+"_");e=r+e,t.symbolsLeftOfAssignment.push(e)}}(t,t.text)):t.isSymbolLeftOfAssignment&&Go(t,"'"+t.text),t.isSymbolLeftOfAssignment||Go(t,t.text),t.advance(),e}function Vo(t){switch(t){case"defint":case"for":case"product":case"roots":case"sum":return!0;default:return!1}}function jo(t){t.expect(Ci);let e=1;const r=[t.tokenToSym()],n=t.text;Vo(n)&&t.functionInvokationsScanningStack.push(t.text),t.lastFoundSymbol=t.text,t.isSymbolLeftOfAssignment||Go(t,t.text),t.advance(),t.advance(),t.scanningParameters.push(!0);try{if(t.code!==Yi){for(r.push(No(t)),e++;t.code===lo;)t.advance(),2===e&&-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("roots")&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("roots_"+(t.functionInvokationsScanningStack.length-1)+"_"+t.text).test(e))),t.skipRootVariableToBeSolved=!0),2===e&&-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("sum")&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("sum_"+(t.functionInvokationsScanningStack.length-1)+"_"+t.text).test(e))),t.skipRootVariableToBeSolved=!0),2===e&&-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("product")&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("product_"+(t.functionInvokationsScanningStack.length-1)+"_"+t.text).test(e))),t.skipRootVariableToBeSolved=!0),2===e&&-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("for")&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("for_"+(t.functionInvokationsScanningStack.length-1)+"_"+t.text).test(e))),t.skipRootVariableToBeSolved=!0),-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("defint")&&(2===e||e>2&&(e-2)%3==0)&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("defint_"+(t.functionInvokationsScanningStack.length-1)+"_"+t.text).test(e))),t.skipRootVariableToBeSolved=!0),r.push(No(t)),t.skipRootVariableToBeSolved=!1,e++;2===e&&-1!==t.functionInvokationsScanningStack[t.functionInvokationsScanningStack.length-1].indexOf("roots")&&(t.symbolsRightOfAssignment=t.symbolsRightOfAssignment.filter((e=>!new RegExp("roots_"+(t.functionInvokationsScanningStack.length-1)+"_x").test(e))))}}finally{t.scanningParameters.pop()}for(let e=0;e<=t.symbolsRightOfAssignment.length;e++)null!=t.symbolsRightOfAssignment[e]&&("roots"===n&&(t.symbolsRightOfAssignment[e]=t.symbolsRightOfAssignment[e].replace(new RegExp("roots_"+(t.functionInvokationsScanningStack.length-1)+"_"),"")),"defint"===n&&(t.symbolsRightOfAssignment[e]=t.symbolsRightOfAssignment[e].replace(new RegExp("defint_"+(t.functionInvokationsScanningStack.length-1)+"_"),"")),"sum"===n&&(t.symbolsRightOfAssignment[e]=t.symbolsRightOfAssignment[e].replace(new RegExp("sum_"+(t.functionInvokationsScanningStack.length-1)+"_"),"")),"product"===n&&(t.symbolsRightOfAssignment[e]=t.symbolsRightOfAssignment[e].replace(new RegExp("product_"+(t.functionInvokationsScanningStack.length-1)+"_"),"")),"for"===n&&(t.symbolsRightOfAssignment[e]=t.symbolsRightOfAssignment[e].replace(new RegExp("for_"+(t.functionInvokationsScanningStack.length-1)+"_"),"")));return t.expect(Yi),t.advance(),Vo(n)&&t.functionInvokationsScanningStack.pop(),An.equals(D(n))&&(nr.patternHasBeenFound=!0),u(...r)}function Wo(t,e){e.expect(Xi);const r=[t];ki(e.code,Xi),e.advance(),e.scanningParameters.push(!0);try{if(e.code!==Yi)for(r.push(No(e));e.code===lo;)e.advance(),r.push(No(e))}finally{e.scanningParameters.pop()}return e.expect(Yi),e.advance(),u(...r)}function Jo(t){t.expect(Xi),t.advance();const e=No(t);return t.expect(Yi),t.advance(),e}function Xo(t){t.expect(fo),t.advance();const e=[No(t)];for(;t.code===lo;)t.advance(),e.push(No(t));const r=v(e);return t.expect(ho),t.advance(),r}function Yo(t,e,r){const n=function(t){return t?{useCaretForExponentiation:!!t.useCaretForExponentiation,explicitAssocAdd:!!t.explicitAssocAdd,explicitAssocMul:!!t.explicitAssocMul}:{useCaretForExponentiation:!1,explicitAssocAdd:!1,explicitAssocMul:!1}}(r),s=function(t){let e=t;return e=e.replace(new RegExp(String.fromCharCode(8901),"g"),Gs),e=e.replace(new RegExp(String.fromCharCode(8226),"g"),Gs),e=e.replace(new RegExp(String.fromCharCode(12539),"g"),Gs),e=e.replace(new RegExp(String.fromCharCode(55296),"g"),Gs),e=e.replace(new RegExp(String.fromCharCode(65381),"g"),Gs),e}(e);let i,o=0,a=0;const u=[],c=[];for(;;){try{nr.errorMessage="",[o,i]=qo(s.substring(a),{useCaretForExponentiation:n.useCaretForExponentiation,explicitAssocAdd:n.explicitAssocAdd,explicitAssocMul:n.explicitAssocMul}),o>0&&u.push(i)}catch(t){t instanceof Error?c.push(t):c.push(new Error(`${t}`)),or();break}if(0===o)break;if(o===e.length)break;a+=o}return{trees:u,errors:c}}vo=new WeakMap;const ta=z(P.exp),ea={};class ra{constructor(t){this.value=t}static get(t){return void 0===ea[t]?new se(t):ea[t]}}class na{constructor(){this.name="CommentMarker",this.meta=0}contains(t){return t instanceof na}equals(t){return t instanceof na}isCons(){return!1}isNil(){return!1}reset(t){this.meta=t}}class sa{constructor(){this.name="EOS",this.meta=0}contains(t){return t instanceof sa}equals(t){return t instanceof sa}isCons(){return!1}isNil(){return!1}reset(t){this.meta=t}}class ia{constructor(t,e){this.car=t,this.cdr=e,this.name="Pair",this.meta=0}contains(t){throw new Error("Method not implemented.")}equals(t){throw new Error("Method not implemented.")}isCons(){throw new Error("Method not implemented.")}isNil(){throw new Error("Method not implemented.")}reset(t){throw new Error("Method not implemented.")}toString(){return`Pair(${this.car} ${this.cdr})`}}var oa,aa,ua,ca,la,fa,ha,pa,da;const ma=new sa,ga=new na;class wa{constructor(t){this.chars=t,this.pos=0}get curr(){return this.chars[this.pos]}get next(){return this.chars[this.pos+1]}consumeChars(t){this.pos+=t}currEquals(t){return this.curr===t}}class _a{constructor(t){this.chars=t,oa.set(this,void 0)}get num(){if(t(this,oa,"f"))return t(this,oa,"f");throw new Error}flt(){e(this,oa,(new po).parse(this.chars,0,0),"f")}int(){e(this,oa,(new mo).parse(this.chars,0,0),"f")}}oa=new WeakMap;let xa=class{constructor(t,r){this.options=r,aa.add(this),ua.set(this,0),ca.set(this,[]),e(this,ca,function(t){const e=[];let r=null,n=0;for(;""!=t&&r!=t;)r=t,t=t.replace(/^\s*(;[^\r\n]*(\r|\n|$)|#;|#\||#\\[^\w]|#?(\(|\[|{)|\)|\]|}|'|`|,@|,|\+inf\.0|-inf\.0|\+nan\.0|"(\\(.|$)|[^"\\])*("|$)|[^\s()[\]{}]+)/,(function(t,r){const s=r;if("#|"==s)return n++,"";if(n>0){if(/(.*\|#)/.test(s)){if(n--,n<0)throw new Error("Found an extra comment terminator: `|#'");return s.substring(RegExp.$1.length,s.length)}return""}return";"!=s.charAt(0)&&(e[e.length]=s),""}));return e}(t),"f")}value(){return ya(t(this,aa,"m",la).call(this))}};function ya(t){if(t instanceof ia){return a(ya(t.car),ya(t.cdr))}return t}function va(t,e){return e&&e.lexicon&&e.lexicon[t]?e.lexicon[t]:D(t)}function ba(t,e){if(!t)throw new Error(e)}function Oa(t){ba(!1,t)}function Ea(t){return"number"==typeof t}function Sa(t){return ba(void 0!==t),Array.isArray(t.children)?t.children.length:0}function qa(t,e){return ba(void 0!==e&&e>=0),Ta(t)[e]}function Ta(t){if(ba(void 0!==t),t.children)return t.children;throw new Error("node does not have any children")}function Ma(t){return t.length-1}var Aa;ua=new WeakMap,ca=new WeakMap,aa=new WeakSet,la=function e(){let r=t(this,aa,"m",ha).call(this);if(r!==ga)return r;if(r=t(this,aa,"m",e).call(this),r===ma)throw new Error("Readable object not found after S expression comment.");return r=t(this,aa,"m",e).call(this),r},fa=function(r){var n,s;let i=c,o=i;for(;t(this,ua,"f")<t(this,ca,"f").length;){if(t(this,aa,"m",da).call(this,"Input stream terminated unexpectedly (in list)."),")"===t(this,ca,"f")[t(this,ua,"f")]||"]"===t(this,ca,"f")[t(this,ua,"f")]||"}"===t(this,ca,"f")[t(this,ua,"f")]){e(this,ua,(n=t(this,ua,"f"),++n),"f");break}if("."===t(this,ca,"f")[t(this,ua,"f")]){e(this,ua,(s=t(this,ua,"f"),++s),"f");const r=t(this,aa,"m",la).call(this);r!==ma&&i!==c&&(o.cdr=r)}else{const e=new ia(t(this,aa,"m",la).call(this),c);i===c?i=e:o.cdr=e,o=e}}return i},ha=function(){var r,n;if(t(this,ua,"f")>=t(this,ca,"f").length)return ma;const s=t(this,ca,"f")[(e(this,ua,(n=t(this,ua,"f"),r=n++,n),"f"),r)];if("#;"==s)return ga;const i="'"==s?"quote":"`"==s?"quasiquote":","==s?"unquote":",@"==s&&"unquote-splicing";if(i||"("==s||"#("==s||"["==s||"#["==s||"{"==s||"#{"==s)return i?new ia(va(i,this.options),new ia(t(this,aa,"m",la).call(this),c)):"("==s||"["==s||"{"==s?t(this,aa,"m",fa).call(this,s):t(this,aa,"m",pa).call(this,s);switch(s){case"+inf.0":return new J(1/0);case"-inf.0":return new J(-1/0);case"+nan.0":return new J(NaN)}if(/^#x[0-9a-z]+$/i.test(s))return Ut(new Number("0x"+s.substring(2,s.length)).valueOf());if(/^#d[0-9.]+$/i.test(s))return W(new Number(s.substring(2,s.length)).valueOf());{const t=new wa(s),e=new _a(s);if(_o(t,e))return e.num}if("#f"==s||"#F"==s)return Z.valueOf(!1);if("#t"==s||"#T"==s)return Z.valueOf(!0);if("#\\newline"==s.toLowerCase())return ra.get("\n");if("#\\space"==s.toLowerCase())return ra.get(" ");if("#\\tab"==s.toLowerCase())return ra.get("\t");if(/^#\\.$/.test(s))return ra.get(s.charAt(2));if(/^#\\x[a-zA-Z0-9]+$/.test(s)){const t=parseInt(s.slice(3),16);if(t>=55296&&t<=57343)throw new Error("Character in Unicode excluded range.");if(t>65535)throw new Error("Character literal out of range.");return ra.get(String.fromCharCode(t))}if(/^"(\\(.|$)|[^"\\])*"?$/.test(s)){const t=s.replace(/(\r?\n|\\n)/g,"\n").replace(/^"|\\(.|$)|"$/g,(function(t,e){return e||""}));return new se(t)}return va(s,this.options)},pa=function(r){var n;const s=[];for(;t(this,ua,"f")<t(this,ca,"f").length;){if(t(this,aa,"m",da).call(this,"Input stream terminated unexpectedly(in vector)"),")"==t(this,ca,"f")[t(this,ua,"f")]||"]"==t(this,ca,"f")[t(this,ua,"f")]||"}"==t(this,ca,"f")[t(this,ua,"f")]){e(this,ua,(n=t(this,ua,"f"),++n),"f");break}s[s.length]=t(this,aa,"m",la).call(this)}return u(...s)},da=function(r){for(var n;"#;"==t(this,ca,"f")[t(this,ua,"f")];)if(e(this,ua,(n=t(this,ua,"f"),++n),"f"),t(this,aa,"m",la).call(this)==ma||t(this,ua,"f")>=t(this,ca,"f").length)throw new Error(r)},function(t){t[t.T_ENDMARKER=0]="T_ENDMARKER",t[t.T_NAME=1]="T_NAME",t[t.T_NUMBER=2]="T_NUMBER",t[t.T_STRING=3]="T_STRING",t[t.T_NEWLINE=4]="T_NEWLINE",t[t.T_INDENT=5]="T_INDENT",t[t.T_DEDENT=6]="T_DEDENT",t[t.T_LPAR=7]="T_LPAR",t[t.T_RPAR=8]="T_RPAR",t[t.T_LSQB=9]="T_LSQB",t[t.T_RSQB=10]="T_RSQB",t[t.T_COLON=11]="T_COLON",t[t.T_COMMA=12]="T_COMMA",t[t.T_SEMI=13]="T_SEMI",t[t.T_PLUS=14]="T_PLUS",t[t.T_MINUS=15]="T_MINUS",t[t.T_STAR=16]="T_STAR",t[t.T_SLASH=17]="T_SLASH",t[t.T_VBAR=18]="T_VBAR",t[t.T_AMPER=19]="T_AMPER",t[t.T_LESS=20]="T_LESS",t[t.T_GREATER=21]="T_GREATER",t[t.T_EQUAL=22]="T_EQUAL",t[t.T_DOT=23]="T_DOT",t[t.T_PERCENT=24]="T_PERCENT",t[t.T_BACKQUOTE=25]="T_BACKQUOTE",t[t.T_LBRACE=26]="T_LBRACE",t[t.T_RBRACE=27]="T_RBRACE",t[t.T_EQEQUAL=28]="T_EQEQUAL",t[t.T_NOTEQUAL=29]="T_NOTEQUAL",t[t.T_LESSEQUAL=30]="T_LESSEQUAL",t[t.T_GREATEREQUAL=31]="T_GREATEREQUAL",t[t.T_TILDE=32]="T_TILDE",t[t.T_CIRCUMFLEX=33]="T_CIRCUMFLEX",t[t.T_LEFTSHIFT=34]="T_LEFTSHIFT",t[t.T_RIGHTSHIFT=35]="T_RIGHTSHIFT",t[t.T_DOUBLESTAR=36]="T_DOUBLESTAR",t[t.T_PLUSEQUAL=37]="T_PLUSEQUAL",t[t.T_MINEQUAL=38]="T_MINEQUAL",t[t.T_STAREQUAL=39]="T_STAREQUAL",t[t.T_SLASHEQUAL=40]="T_SLASHEQUAL",t[t.T_PERCENTEQUAL=41]="T_PERCENTEQUAL",t[t.T_AMPEREQUAL=42]="T_AMPEREQUAL",t[t.T_VBAREQUAL=43]="T_VBAREQUAL",t[t.T_CIRCUMFLEXEQUAL=44]="T_CIRCUMFLEXEQUAL",t[t.T_LEFTSHIFTEQUAL=45]="T_LEFTSHIFTEQUAL",t[t.T_RIGHTSHIFTEQUAL=46]="T_RIGHTSHIFTEQUAL",t[t.T_DOUBLESTAREQUAL=47]="T_DOUBLESTAREQUAL",t[t.T_DOUBLESLASH=48]="T_DOUBLESLASH",t[t.T_DOUBLESLASHEQUAL=49]="T_DOUBLESLASHEQUAL",t[t.T_AT=50]="T_AT",t[t.T_ATEQUAL=51]="T_ATEQUAL",t[t.T_OP=52]="T_OP",t[t.T_COMMENT=53]="T_COMMENT",t[t.T_NL=54]="T_NL",t[t.T_RARROW=55]="T_RARROW",t[t.T_AWAIT=56]="T_AWAIT",t[t.T_ASYNC=57]="T_ASYNC",t[t.T_ERRORTOKEN=58]="T_ERRORTOKEN",t[t.T_N_TOKENS=59]="T_N_TOKENS",t[t.T_NT_OFFSET=256]="T_NT_OFFSET"}(Aa||(Aa={}));const Na={"(":Aa.T_LPAR,")":Aa.T_RPAR,"[":Aa.T_LSQB,"]":Aa.T_RSQB,":":Aa.T_COLON,",":Aa.T_COMMA,";":Aa.T_SEMI,"+":Aa.T_PLUS,"-":Aa.T_MINUS,"*":Aa.T_STAR,"/":Aa.T_SLASH,"|":Aa.T_VBAR,"&":Aa.T_AMPER,"<":Aa.T_LESS,">":Aa.T_GREATER,"=":Aa.T_EQUAL,".":Aa.T_DOT,"%":Aa.T_PERCENT,"`":Aa.T_BACKQUOTE,"{":Aa.T_LBRACE,"}":Aa.T_RBRACE,"@":Aa.T_AT,"==":Aa.T_EQEQUAL,"!=":Aa.T_NOTEQUAL,"<>":Aa.T_NOTEQUAL,"<=":Aa.T_LESSEQUAL,">=":Aa.T_GREATEREQUAL,"~":Aa.T_TILDE,"^":Aa.T_CIRCUMFLEX,"<<":Aa.T_LEFTSHIFT,">>":Aa.T_RIGHTSHIFT,"**":Aa.T_DOUBLESTAR,"+=":Aa.T_PLUSEQUAL,"-=":Aa.T_MINEQUAL,"*=":Aa.T_STAREQUAL,"/=":Aa.T_SLASHEQUAL,"%=":Aa.T_PERCENTEQUAL,"&=":Aa.T_AMPEREQUAL,"|=":Aa.T_VBAREQUAL,"^=":Aa.T_CIRCUMFLEXEQUAL,"<<=":Aa.T_LEFTSHIFTEQUAL,">>=":Aa.T_RIGHTSHIFTEQUAL,"**=":Aa.T_DOUBLESTAREQUAL,"//":Aa.T_DOUBLESLASH,"//=":Aa.T_DOUBLESLASHEQUAL,"->":Aa.T_RARROW},$a=0,La=1,ka={sym:{AndExpr:257,ArithmeticExpr:258,AtomExpr:259,BitwiseAndExpr:260,BitwiseOrExpr:261,BitwiseXorExpr:262,ComparisonExpr:263,ExprList:264,ExprStmt:265,GeometricExpr:266,GlobalStmt:267,IfExpr:268,ImportList:269,ImportSpecifier:270,LambdaExpr:271,ModuleSpecifier:272,NonLocalStmt:273,NotExpr:274,OrExpr:275,PowerExpr:276,ShiftExpr:277,UnaryExpr:278,YieldExpr:279,annasign:280,arglist:281,argument:282,assert_stmt:283,augassign:284,break_stmt:285,classdef:286,comp_op:287,compound_stmt:288,continue_stmt:289,decorated:290,decorator:291,decorators:292,del_stmt:293,dictmaker:294,dotted_as_name:295,dotted_as_names:296,dotted_name:297,encoding_decl:298,eval_input:299,except_clause:300,exec_stmt:301,file_input:302,flow_stmt:303,for_stmt:304,fpdef:305,fplist:306,funcdef:307,gen_for:308,gen_if:309,gen_iter:310,if_stmt:311,import_from:312,import_name:313,import_stmt:314,list_for:315,list_if:316,list_iter:317,listmaker:318,old_LambdaExpr:319,old_test:320,parameters:321,pass_stmt:322,print_stmt:323,raise_stmt:324,return_stmt:325,simple_stmt:326,single_input:256,sliceop:327,small_stmt:328,stmt:329,subscript:330,subscriptlist:331,suite:332,testlist:333,testlist1:334,testlist_gexp:335,testlist_safe:336,trailer:337,try_stmt:338,varargslist:339,while_stmt:340,with_stmt:341,with_var:342,yield_stmt:343},number2symbol:{256:"single_input",257:"AndExpr",258:"ArithmeticExpr",259:"AtomExpr",260:"BitwiseAndExpr",261:"BitwiseOrExpr",262:"BitwiseXorExpr",263:"ComparisonExpr",264:"ExprList",265:"ExprStmt",266:"GeometricExpr",267:"GlobalStmt",268:"IfExpr",269:"ImportList",270:"ImportSpecifier",271:"LambdaExpr",272:"ModuleSpecifier",273:"NonLocalStmt",274:"NotExpr",275:"OrExpr",276:"PowerExpr",277:"ShiftExpr",278:"UnaryExpr",279:"YieldExpr",280:"annasign",281:"arglist",282:"argument",283:"assert_stmt",284:"augassign",285:"break_stmt",286:"classdef",287:"comp_op",288:"compound_stmt",289:"continue_stmt",290:"decorated",291:"decorator",292:"decorators",293:"del_stmt",294:"dictmaker",295:"dotted_as_name",296:"dotted_as_names",297:"dotted_name",298:"encoding_decl",299:"eval_input",300:"except_clause",301:"exec_stmt",302:"file_input",303:"flow_stmt",304:"for_stmt",305:"fpdef",306:"fplist",307:"funcdef",308:"gen_for",309:"gen_if",310:"gen_iter",311:"if_stmt",312:"import_from",313:"import_name",314:"import_stmt",315:"list_for",316:"list_if",317:"list_iter",318:"listmaker",319:"old_LambdaExpr",320:"old_test",321:"parameters",322:"pass_stmt",323:"print_stmt",324:"raise_stmt",325:"return_stmt",326:"simple_stmt",327:"sliceop",328:"small_stmt",329:"stmt",330:"subscript",331:"subscriptlist",332:"suite",333:"testlist",334:"testlist1",335:"testlist_gexp",336:"testlist_safe",337:"trailer",338:"try_stmt",339:"varargslist",340:"while_stmt",341:"with_stmt",342:"with_var",343:"yield_stmt"},dfas:{256:[[[[1,1],[2,1],[3,2]],[[0,1]],[[1,1]]],{1:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1,30:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1}],257:[[[[38,1]],[[39,0],[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],258:[[[[40,1]],[[5,0],[6,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],259:[[[[8,1],[9,2],[10,3],[11,4],[12,5],[13,5],[14,6]],[[41,7],[42,7],[43,5]],[[44,8],[45,5]],[[46,9],[47,5]],[[48,10]],[[0,5]],[[14,6],[0,6]],[[43,5]],[[45,5]],[[47,5]],[[11,5]]],{8:1,9:1,10:1,11:1,12:1,13:1,14:1}],260:[[[[49,1]],[[50,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],261:[[[[51,1]],[[52,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],262:[[[[53,1]],[[54,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],263:[[[[55,1]],[[56,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],264:[[[[55,1]],[[57,2],[0,1]],[[55,1],[0,2]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],265:[[[[58,1]],[[59,2],[60,3],[61,4],[0,1]],[[0,2]],[[41,2],[58,2]],[[41,5],[58,5]],[[61,4],[0,5]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],266:[[[[62,1]],[[63,0],[64,0],[65,0],[66,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],267:[[[[26,1]],[[12,2]],[[57,1],[0,2]]],{26:1}],268:[[[[67,1],[68,2]],[[30,3],[0,1]],[[0,2]],[[67,4]],[[69,5]],[[70,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],269:[[[[71,1]],[[57,2],[0,1]],[[71,1],[0,2]]],{12:1}],270:[[[[12,1]],[[72,2],[0,1]],[[12,3]],[[0,3]]],{12:1}],271:[[[[15,1]],[[73,2],[74,3]],[[74,3]],[[70,4]],[[0,4]]],{15:1}],272:[[[[14,1]],[[0,1]]],{14:1}],273:[[[[27,1]],[[12,2]],[[57,1],[0,2]]],{27:1}],274:[[[[4,1],[75,2]],[[38,2]],[[0,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],275:[[[[76,1]],[[77,0],[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],276:[[[[78,1]],[[79,1],[80,2],[0,1]],[[49,3]],[[0,3]]],{8:1,9:1,10:1,11:1,12:1,13:1,14:1}],277:[[[[81,1]],[[82,0],[83,0],[0,1]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],278:[[[[5,1],[6,1],[7,1],[84,2]],[[49,2]],[[0,2]]],{5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1}],279:[[[[23,1]],[[58,2],[0,1]],[[0,2]]],{23:1}],280:[[[[74,1]],[[70,2]],[[61,3],[0,2]],[[70,4]],[[0,4]]],{74:1}],281:[[[[85,1],[63,2],[80,3]],[[57,4],[0,1]],[[70,5]],[[70,6]],[[85,1],[63,2],[80,3],[0,4]],[[57,7],[0,5]],[[0,6]],[[85,5],[80,3]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,63:1,80:1}],282:[[[[70,1]],[[86,2],[61,3],[0,1]],[[0,2]],[[70,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],283:[[[[29,1]],[[70,2]],[[57,3],[0,2]],[[70,4]],[[0,4]]],{29:1}],284:[[[[87,1],[88,1],[89,1],[90,1],[91,1],[92,1],[93,1],[94,1],[95,1],[96,1],[97,1],[98,1]],[[0,1]]],{87:1,88:1,89:1,90:1,91:1,92:1,93:1,94:1,95:1,96:1,97:1,98:1}],285:[[[[19,1]],[[0,1]]],{19:1}],286:[[[[36,1]],[[12,2]],[[8,3],[74,4]],[[58,5],[43,6]],[[99,7]],[[43,6]],[[74,4]],[[0,7]]],{36:1}],287:[[[[100,1],[101,1],[102,1],[103,1],[104,1],[105,1],[105,1],[106,1],[4,2],[107,3]],[[0,1]],[[106,1]],[[4,1],[0,3]]],{4:1,100:1,101:1,102:1,103:1,104:1,105:1,106:1,107:1}],288:[[[[108,1],[109,1],[110,1],[111,1],[112,1],[113,1],[114,1],[115,1]],[[0,1]]],{30:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1}],289:[[[[20,1]],[[0,1]]],{20:1}],290:[[[[116,1]],[[114,2],[113,2]],[[0,2]]],{37:1}],291:[[[[37,1]],[[117,2]],[[8,3],[1,4]],[[118,5],[43,6]],[[0,4]],[[43,6]],[[1,4]]],{37:1}],292:[[[[119,1]],[[119,1],[0,1]]],{37:1}],293:[[[[17,1]],[[120,2]],[[0,2]]],{17:1}],294:[[[[70,1]],[[74,2]],[[70,3]],[[57,4],[0,3]],[[70,1],[0,4]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],295:[[[[117,1]],[[72,2],[0,1]],[[12,3]],[[0,3]]],{12:1}],296:[[[[121,1]],[[57,0],[0,1]]],{12:1}],297:[[[[12,1]],[[122,0],[0,1]]],{12:1}],298:[[[[12,1]],[[0,1]]],{12:1}],299:[[[[58,1]],[[1,1],[123,2]],[[0,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],300:[[[[124,1]],[[70,2],[0,1]],[[72,3],[57,3],[0,2]],[[70,4]],[[0,4]]],{124:1}],301:[[[[28,1]],[[55,2]],[[106,3],[0,2]],[[70,4]],[[57,5],[0,4]],[[70,6]],[[0,6]]],{28:1}],302:[[[[1,0],[125,0],[123,1]],[[0,1]]],{1:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1,30:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1,123:1}],303:[[[[126,1],[127,1],[128,1],[129,1],[130,1]],[[0,1]]],{19:1,20:1,21:1,22:1,23:1}],304:[[[[32,1]],[[120,2]],[[106,3]],[[58,4]],[[74,5]],[[99,6]],[[69,7],[0,6]],[[74,8]],[[99,9]],[[0,9]]],{32:1}],305:[[[[12,1],[8,2]],[[74,3],[0,1]],[[131,4]],[[70,5]],[[43,5]],[[0,5]]],{8:1,12:1}],306:[[[[132,1]],[[57,2],[0,1]],[[132,1],[0,2]]],{8:1,12:1}],307:[[[[35,1]],[[12,2]],[[133,3]],[[134,4],[74,5]],[[70,6]],[[99,7]],[[74,5]],[[0,7]]],{35:1}],308:[[[[32,1]],[[120,2]],[[106,3]],[[67,4]],[[135,5],[0,4]],[[0,5]]],{32:1}],309:[[[[30,1]],[[136,2]],[[135,3],[0,2]],[[0,3]]],{30:1}],310:[[[[86,1],[137,1]],[[0,1]]],{30:1,32:1}],311:[[[[30,1]],[[70,2]],[[74,3]],[[99,4]],[[138,1],[69,5],[0,4]],[[74,6]],[[99,7]],[[0,7]]],{30:1}],312:[[[[25,1]],[[139,2]],[[24,3]],[[63,4],[8,5],[140,4]],[[0,4]],[[140,6]],[[43,4]]],{25:1}],313:[[[[24,1]],[[141,2]],[[0,2]]],{24:1}],314:[[[[142,1],[143,1]],[[0,1]]],{24:1,25:1}],315:[[[[32,1]],[[120,2]],[[106,3]],[[144,4]],[[145,5],[0,4]],[[0,5]]],{32:1}],316:[[[[30,1]],[[136,2]],[[145,3],[0,2]],[[0,3]]],{30:1}],317:[[[[146,1],[147,1]],[[0,1]]],{30:1,32:1}],318:[[[[70,1]],[[146,2],[57,3],[0,1]],[[0,2]],[[70,4],[0,3]],[[57,3],[0,4]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],319:[[[[15,1]],[[73,2],[74,3]],[[74,3]],[[136,4]],[[0,4]]],{15:1}],320:[[[[67,1],[148,1]],[[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],321:[[[[8,1]],[[73,2],[43,3]],[[43,3]],[[0,3]]],{8:1}],322:[[[[18,1]],[[0,1]]],{18:1}],323:[[[[16,1]],[[70,2],[83,3],[0,1]],[[57,4],[0,2]],[[70,5]],[[70,2],[0,4]],[[57,6],[0,5]],[[70,7]],[[57,8],[0,7]],[[70,7],[0,8]]],{16:1}],324:[[[[22,1]],[[70,2],[0,1]],[[57,3],[0,2]],[[70,4]],[[57,5],[0,4]],[[70,6]],[[0,6]]],{22:1}],325:[[[[21,1]],[[58,2],[0,1]],[[0,2]]],{21:1}],326:[[[[149,1]],[[150,2],[1,3]],[[149,1],[1,3]],[[0,3]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1}],327:[[[[74,1]],[[70,2],[0,1]],[[0,2]]],{74:1}],328:[[[[151,1],[152,1],[153,1],[154,1],[155,1],[156,1],[157,1],[158,1],[159,1],[160,1]],[[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1}],329:[[[[2,1],[3,1]],[[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1,30:1,31:1,32:1,33:1,34:1,35:1,36:1,37:1}],330:[[[[122,1],[70,2],[74,3]],[[122,4]],[[74,3],[0,2]],[[70,5],[161,6],[0,3]],[[122,6]],[[161,6],[0,5]],[[0,6]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,74:1,122:1}],331:[[[[162,1]],[[57,2],[0,1]],[[162,1],[0,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,74:1,122:1}],332:[[[[2,1],[1,2]],[[0,1]],[[163,3]],[[125,4]],[[125,4],[164,1]]],{1:1,4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1,16:1,17:1,18:1,19:1,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:1,28:1,29:1}],333:[[[[70,1]],[[57,2],[0,1]],[[70,1],[0,2]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],334:[[[[70,1]],[[57,0],[0,1]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],335:[[[[70,1]],[[86,2],[57,3],[0,1]],[[0,2]],[[70,4],[0,3]],[[57,3],[0,4]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],336:[[[[136,1]],[[57,2],[0,1]],[[136,3]],[[57,4],[0,3]],[[136,3],[0,4]]],{4:1,5:1,6:1,7:1,8:1,9:1,10:1,11:1,12:1,13:1,14:1,15:1}],337:[[[[8,1],[9,2],[122,3]],[[118,4],[43,5]],[[165,6]],[[12,5]],[[43,5]],[[0,5]],[[45,5]]],{8:1,9:1,122:1}],338:[[[[33,1]],[[74,2]],[[99,3]],[[166,4],[167,5]],[[74,6]],[[74,7]],[[99,8]],[[99,9]],[[166,4],[69,10],[167,5],[0,8]],[[0,9]],[[74,11]],[[99,12]],[[167,5],[0,12]]],{33:1}],339:[[[[132,1],[63,2],[80,3]],[[61,4],[57,5],[0,1]],[[12,6]],[[12,7]],[[70,8]],[[132,1],[63,2],[80,3],[0,5]],[[57,9],[0,6]],[[0,7]],[[57,5],[0,8]],[[80,3]]],{8:1,12:1,63:1,80:1}],340:[[[[31,1]],[[70,2]],[[74,3]],[[99,4]],[[69,5],[0,4]],[[74,6]],[[99,7]],[[0,7]]],{31:1}],341:[[[[34,1]],[[70,2]],[[168,3],[74,4]],[[74,4]],[[99,5]],[[0,5]]],{34:1}],342:[[[[72,1]],[[55,2]],[[0,2]]],{72:1}],343:[[[[41,1]],[[0,1]]],{23:1}]},states:[[[[1,1],[2,1],[3,2]],[[0,1]],[[1,1]]],[[[38,1]],[[39,0],[0,1]]],[[[40,1]],[[5,0],[6,0],[0,1]]],[[[8,1],[9,2],[10,3],[11,4],[12,5],[13,5],[14,6]],[[41,7],[42,7],[43,5]],[[44,8],[45,5]],[[46,9],[47,5]],[[48,10]],[[0,5]],[[14,6],[0,6]],[[43,5]],[[45,5]],[[47,5]],[[11,5]]],[[[49,1]],[[50,0],[0,1]]],[[[51,1]],[[52,0],[0,1]]],[[[53,1]],[[54,0],[0,1]]],[[[55,1]],[[56,0],[0,1]]],[[[55,1]],[[57,2],[0,1]],[[55,1],[0,2]]],[[[58,1]],[[59,2],[60,3],[61,4],[0,1]],[[0,2]],[[41,2],[58,2]],[[41,5],[58,5]],[[61,4],[0,5]]],[[[62,1]],[[63,0],[64,0],[65,0],[66,0],[0,1]]],[[[26,1]],[[12,2]],[[57,1],[0,2]]],[[[67,1],[68,2]],[[30,3],[0,1]],[[0,2]],[[67,4]],[[69,5]],[[70,2]]],[[[71,1]],[[57,2],[0,1]],[[71,1],[0,2]]],[[[12,1]],[[72,2],[0,1]],[[12,3]],[[0,3]]],[[[15,1]],[[73,2],[74,3]],[[74,3]],[[70,4]],[[0,4]]],[[[14,1]],[[0,1]]],[[[27,1]],[[12,2]],[[57,1],[0,2]]],[[[4,1],[75,2]],[[38,2]],[[0,2]]],[[[76,1]],[[77,0],[0,1]]],[[[78,1]],[[79,1],[80,2],[0,1]],[[49,3]],[[0,3]]],[[[81,1]],[[82,0],[83,0],[0,1]]],[[[5,1],[6,1],[7,1],[84,2]],[[49,2]],[[0,2]]],[[[23,1]],[[58,2],[0,1]],[[0,2]]],[[[74,1]],[[70,2]],[[61,3],[0,2]],[[70,4]],[[0,4]]],[[[85,1],[63,2],[80,3]],[[57,4],[0,1]],[[70,5]],[[70,6]],[[85,1],[63,2],[80,3],[0,4]],[[57,7],[0,5]],[[0,6]],[[85,5],[80,3]]],[[[70,1]],[[86,2],[61,3],[0,1]],[[0,2]],[[70,2]]],[[[29,1]],[[70,2]],[[57,3],[0,2]],[[70,4]],[[0,4]]],[[[87,1],[88,1],[89,1],[90,1],[91,1],[92,1],[93,1],[94,1],[95,1],[96,1],[97,1],[98,1]],[[0,1]]],[[[19,1]],[[0,1]]],[[[36,1]],[[12,2]],[[8,3],[74,4]],[[58,5],[43,6]],[[99,7]],[[43,6]],[[74,4]],[[0,7]]],[[[100,1],[101,1],[102,1],[103,1],[104,1],[105,1],[105,1],[106,1],[4,2],[107,3]],[[0,1]],[[106,1]],[[4,1],[0,3]]],[[[108,1],[109,1],[110,1],[111,1],[112,1],[113,1],[114,1],[115,1]],[[0,1]]],[[[20,1]],[[0,1]]],[[[116,1]],[[114,2],[113,2]],[[0,2]]],[[[37,1]],[[117,2]],[[8,3],[1,4]],[[118,5],[43,6]],[[0,4]],[[43,6]],[[1,4]]],[[[119,1]],[[119,1],[0,1]]],[[[17,1]],[[120,2]],[[0,2]]],[[[70,1]],[[74,2]],[[70,3]],[[57,4],[0,3]],[[70,1],[0,4]]],[[[117,1]],[[72,2],[0,1]],[[12,3]],[[0,3]]],[[[121,1]],[[57,0],[0,1]]],[[[12,1]],[[122,0],[0,1]]],[[[12,1]],[[0,1]]],[[[58,1]],[[1,1],[123,2]],[[0,2]]],[[[124,1]],[[70,2],[0,1]],[[72,3],[57,3],[0,2]],[[70,4]],[[0,4]]],[[[28,1]],[[55,2]],[[106,3],[0,2]],[[70,4]],[[57,5],[0,4]],[[70,6]],[[0,6]]],[[[1,0],[125,0],[123,1]],[[0,1]]],[[[126,1],[127,1],[128,1],[129,1],[130,1]],[[0,1]]],[[[32,1]],[[120,2]],[[106,3]],[[58,4]],[[74,5]],[[99,6]],[[69,7],[0,6]],[[74,8]],[[99,9]],[[0,9]]],[[[12,1],[8,2]],[[74,3],[0,1]],[[131,4]],[[70,5]],[[43,5]],[[0,5]]],[[[132,1]],[[57,2],[0,1]],[[132,1],[0,2]]],[[[35,1]],[[12,2]],[[133,3]],[[134,4],[74,5]],[[70,6]],[[99,7]],[[74,5]],[[0,7]]],[[[32,1]],[[120,2]],[[106,3]],[[67,4]],[[135,5],[0,4]],[[0,5]]],[[[30,1]],[[136,2]],[[135,3],[0,2]],[[0,3]]],[[[86,1],[137,1]],[[0,1]]],[[[30,1]],[[70,2]],[[74,3]],[[99,4]],[[138,1],[69,5],[0,4]],[[74,6]],[[99,7]],[[0,7]]],[[[25,1]],[[139,2]],[[24,3]],[[63,4],[8,5],[140,4]],[[0,4]],[[140,6]],[[43,4]]],[[[24,1]],[[141,2]],[[0,2]]],[[[142,1],[143,1]],[[0,1]]],[[[32,1]],[[120,2]],[[106,3]],[[144,4]],[[145,5],[0,4]],[[0,5]]],[[[30,1]],[[136,2]],[[145,3],[0,2]],[[0,3]]],[[[146,1],[147,1]],[[0,1]]],[[[70,1]],[[146,2],[57,3],[0,1]],[[0,2]],[[70,4],[0,3]],[[57,3],[0,4]]],[[[15,1]],[[73,2],[74,3]],[[74,3]],[[136,4]],[[0,4]]],[[[67,1],[148,1]],[[0,1]]],[[[8,1]],[[73,2],[43,3]],[[43,3]],[[0,3]]],[[[18,1]],[[0,1]]],[[[16,1]],[[70,2],[83,3],[0,1]],[[57,4],[0,2]],[[70,5]],[[70,2],[0,4]],[[57,6],[0,5]],[[70,7]],[[57,8],[0,7]],[[70,7],[0,8]]],[[[22,1]],[[70,2],[0,1]],[[57,3],[0,2]],[[70,4]],[[57,5],[0,4]],[[70,6]],[[0,6]]],[[[21,1]],[[58,2],[0,1]],[[0,2]]],[[[149,1]],[[150,2],[1,3]],[[149,1],[1,3]],[[0,3]]],[[[74,1]],[[70,2],[0,1]],[[0,2]]],[[[151,1],[152,1],[153,1],[154,1],[155,1],[156,1],[157,1],[158,1],[159,1],[160,1]],[[0,1]]],[[[2,1],[3,1]],[[0,1]]],[[[122,1],[70,2],[74,3]],[[122,4]],[[74,3],[0,2]],[[70,5],[161,6],[0,3]],[[122,6]],[[161,6],[0,5]],[[0,6]]],[[[162,1]],[[57,2],[0,1]],[[162,1],[0,2]]],[[[2,1],[1,2]],[[0,1]],[[163,3]],[[125,4]],[[125,4],[164,1]]],[[[70,1]],[[57,2],[0,1]],[[70,1],[0,2]]],[[[70,1]],[[57,0],[0,1]]],[[[70,1]],[[86,2],[57,3],[0,1]],[[0,2]],[[70,4],[0,3]],[[57,3],[0,4]]],[[[136,1]],[[57,2],[0,1]],[[136,3]],[[57,4],[0,3]],[[136,3],[0,4]]],[[[8,1],[9,2],[122,3]],[[118,4],[43,5]],[[165,6]],[[12,5]],[[43,5]],[[0,5]],[[45,5]]],[[[33,1]],[[74,2]],[[99,3]],[[166,4],[167,5]],[[74,6]],[[74,7]],[[99,8]],[[99,9]],[[166,4],[69,10],[167,5],[0,8]],[[0,9]],[[74,11]],[[99,12]],[[167,5],[0,12]]],[[[132,1],[63,2],[80,3]],[[61,4],[57,5],[0,1]],[[12,6]],[[12,7]],[[70,8]],[[132,1],[63,2],[80,3],[0,5]],[[57,9],[0,6]],[[0,7]],[[57,5],[0,8]],[[80,3]]],[[[31,1]],[[70,2]],[[74,3]],[[99,4]],[[69,5],[0,4]],[[74,6]],[[99,7]],[[0,7]]],[[[34,1]],[[70,2]],[[168,3],[74,4]],[[74,4]],[[99,5]],[[0,5]]],[[[72,1]],[[55,2]],[[0,2]]],[[[41,1]],[[0,1]]]],labels:[[0,"EMPTY"],[4,null],[326,null],[288,null],[1,"not"],[14,null],[15,null],[32,null],[7,null],[9,null],[26,null],[25,null],[1,null],[2,null],[3,null],[1,"lambda"],[1,"print"],[1,"del"],[1,"pass"],[1,"break"],[1,"continue"],[1,"return"],[1,"raise"],[1,"yield"],[1,"import"],[1,"from"],[1,"global"],[1,"nonlocal"],[1,"exec"],[1,"assert"],[1,"if"],[1,"while"],[1,"for"],[1,"try"],[1,"with"],[1,"def"],[1,"class"],[50,null],[274,null],[1,"and"],[266,null],[279,null],[335,null],[8,null],[318,null],[10,null],[294,null],[27,null],[334,null],[278,null],[19,null],[262,null],[18,null],[260,null],[33,null],[258,null],[287,null],[12,null],[333,null],[280,null],[284,null],[22,null],[277,null],[16,null],[17,null],[24,null],[48,null],[275,null],[271,null],[1,"else"],[268,null],[270,null],[1,"as"],[339,null],[11,null],[263,null],[257,null],[1,"or"],[259,null],[337,null],[36,null],[261,null],[34,null],[35,null],[276,null],[282,null],[308,null],[37,null],[38,null],[39,null],[40,null],[41,null],[42,null],[43,null],[44,null],[45,null],[46,null],[47,null],[49,null],[332,null],[20,null],[21,null],[28,null],[31,null],[30,null],[29,null],[1,"in"],[1,"is"],[311,null],[340,null],[304,null],[338,null],[341,null],[307,null],[286,null],[290,null],[292,null],[297,null],[281,null],[291,null],[264,null],[295,null],[23,null],[0,null],[1,"except"],[329,null],[285,null],[289,null],[325,null],[324,null],[343,null],[306,null],[305,null],[321,null],[55,null],[310,null],[320,null],[309,null],[1,"elif"],[272,null],[269,null],[296,null],[313,null],[312,null],[336,null],[317,null],[315,null],[316,null],[319,null],[328,null],[13,null],[265,null],[323,null],[293,null],[322,null],[303,null],[314,null],[267,null],[273,null],[301,null],[283,null],[327,null],[330,null],[5,null],[6,null],[331,null],[300,null],[1,"finally"],[342,null]],keywords:{and:39,as:72,assert:29,break:19,class:36,continue:20,def:35,del:17,elif:138,else:69,except:124,exec:28,finally:167,for:32,from:25,global:26,if:30,import:24,in:106,is:107,lambda:15,nonlocal:27,not:4,or:77,pass:18,print:16,raise:22,return:21,try:33,while:31,with:34,yield:23},tokens:{0:123,1:12,2:13,3:14,4:1,5:163,6:164,7:8,8:43,9:9,10:45,11:74,12:57,13:150,14:5,15:6,16:63,17:64,18:52,19:50,20:100,21:101,22:61,23:122,24:65,25:11,26:10,27:47,28:102,29:105,30:104,31:103,32:7,33:54,34:82,35:83,36:80,37:87,38:88,39:89,40:90,41:91,42:92,43:93,44:94,45:95,46:96,47:97,48:66,49:98,50:37,55:134},start:256},Ra={};function Ia(t){const e=Ra[t];return e||ka.number2symbol[t]}Ra[Aa.T_AMPER]="T_AMPER",Ra[Aa.T_AMPEREQUAL]="T_AMPEREQUAL",Ra[Aa.T_AT]="T_AT",Ra[Aa.T_BACKQUOTE]="T_BACKQUOTE",Ra[Aa.T_CIRCUMFLEX]="T_CIRCUMFLEX",Ra[Aa.T_CIRCUMFLEXEQUAL]="T_CIRCUMFLEXEQUAL",Ra[Aa.T_COLON]="T_COLON",Ra[Aa.T_COMMA]="T_COMMA",Ra[Aa.T_COMMENT]="T_COMMENT",Ra[Aa.T_DEDENT]="T_DEDENT",Ra[Aa.T_DOT]="T_DOT",Ra[Aa.T_DOUBLESLASH]="T_DOUBLESLASH",Ra[Aa.T_DOUBLESLASHEQUAL]="T_DOUBLESLASHEQUAL",Ra[Aa.T_DOUBLESTAR]="T_DOUBLESTAR",Ra[Aa.T_DOUBLESTAREQUAL]="T_DOUBLESTAREQUAL",Ra[Aa.T_ENDMARKER]="T_ENDMARKER",Ra[Aa.T_EQEQUAL]="T_EQEQUAL",Ra[Aa.T_EQUAL]="T_EQUAL",Ra[Aa.T_ERRORTOKEN]="T_ERRORTOKEN",Ra[Aa.T_GREATER]="T_GREATER",Ra[Aa.T_GREATEREQUAL]="T_GREATEREQUAL",Ra[Aa.T_INDENT]="T_INDENT",Ra[Aa.T_LBRACE]="T_LBRACE",Ra[Aa.T_LEFTSHIFT]="T_LEFTSHIFT",Ra[Aa.T_LEFTSHIFTEQUAL]="T_LEFTSHIFTEQUAL",Ra[Aa.T_LESS]="T_LESS",Ra[Aa.T_LESSEQUAL]="T_LESSEQUAL",Ra[Aa.T_LPAR]="T_LPAR",Ra[Aa.T_LSQB]="T_LSQB",Ra[Aa.T_MINEQUAL]="T_MINEQUAL",Ra[Aa.T_MINUS]="T_MINUS",Ra[Aa.T_N_TOKENS]="T_N_TOKENS",Ra[Aa.T_NAME]="T_NAME",Ra[Aa.T_NEWLINE]="T_NEWLINE",Ra[Aa.T_NL]="T_NL",Ra[Aa.T_NOTEQUAL]="T_NOTEQUAL",Ra[Aa.T_NT_OFFSET]="T_NT_OFFSET",Ra[Aa.T_NUMBER]="T_NUMBER",Ra[Aa.T_OP]="T_OP",Ra[Aa.T_PERCENT]="T_PERCENT",Ra[Aa.T_PERCENTEQUAL]="T_PERCENTEQUAL",Ra[Aa.T_PLUS]="T_PLUS",Ra[Aa.T_PLUSEQUAL]="T_PLUSEQUAL",Ra[Aa.T_RARROW]="T_RARROW",Ra[Aa.T_RBRACE]="T_RBRACE",Ra[Aa.T_RIGHTSHIFT]="T_RIGHTSHIFT",Ra[Aa.T_RPAR]="T_RPAR",Ra[Aa.T_RSQB]="T_RSQB",Ra[Aa.T_SEMI]="T_SEMI",Ra[Aa.T_SLASH]="T_SLASH",Ra[Aa.T_SLASHEQUAL]="T_SLASHEQUAL",Ra[Aa.T_STAR]="T_STAR",Ra[Aa.T_STAREQUAL]="T_STAREQUAL",Ra[Aa.T_STRING]="T_STRING",Ra[Aa.T_TILDE]="T_TILDE",Ra[Aa.T_VBAR]="T_VBAR",Ra[Aa.T_VBAREQUAL]="T_VBAREQUAL";class Pa extends Error{constructor(t,e,r){super(t),this.lineNumber=e,this.columnNumber=r,ba(Ea(e),"lineNumber must be a number"),ba(Ea(r),"columnNumber must be a number")}}const Fa=Aa.T_COMMENT,Ua=Aa.T_DEDENT,Ca=Aa.T_ENDMARKER,Da=Aa.T_ERRORTOKEN,Ba=Aa.T_INDENT,Ka=Aa.T_NAME,za=Aa.T_NEWLINE,Qa=Aa.T_NL,Za=Aa.T_NUMBER,Ga=Aa.T_OP,Ha=Aa.T_STRING,Va=wu("0[bB][01]*","0[xX][\\da-fA-F]*[lL]?","0[oO]?[0-7]*[lL]?","[1-9]\\d*[lL]?"),ja="[eE][-+]?\\d+",Wa=wu("\\d+\\.\\d*","\\.\\d+")+function(t){return wu.apply(null,arguments)+"?"}(ja),Ja=wu(Wa,"\\d+"+ja),Xa=wu("\\d+[jJ]",Ja+"[jJ]"),Ya=wu(Xa,Ja,Va),tu=wu("[ubUB]?[rR]?'''",'[ubUB]?[rR]?"""'),eu=wu("\\*\\*=?",">>=?","<<=?","<>","!=","//=?","->","[+\\-*/%&|^=<>]=?","~"),ru=wu("\\r?\\n","[:;.,`@]"),nu=wu(eu,"[\\][(){}]",ru),su=wu("[uUbB]?[rR]?'[^\\n'\\\\]*(?:\\\\.[^\\n'\\\\]*)*"+wu("'","\\\\\\r?\\n"),'[uUbB]?[rR]?"[^\\n"\\\\]*(?:\\\\.[^\\n"\\\\]*)*'+wu('"',"\\\\\\r?\\n")),iu=wu("\\\\\\r?\\n","#[^\\r\\n]*",tu,"'{3}[^]*'{3}"),ou="^"+wu(iu,Ya,nu,su,"[a-zA-Z_]\\w*"),au=new RegExp(ou),uu=new RegExp("[^'\\\\]*(?:(?:\\\\.|'(?!''))[^'\\\\]*)*'''","g"),cu=new RegExp('[^"\\\\]*(?:(?:\\\\.|"(?!""))[^"\\\\]*)*"""',"g"),lu={"'":new RegExp("^[^'\\\\]*(?:\\\\.[^'\\\\]*)*'","g"),'"':new RegExp('^[^"\\\\]*(?:\\\\.[^"\\\\]*)*"',"g"),"'''":uu,'"""':cu,"r'''":uu,'r"""':cu,"u'''":uu,'u"""':cu,"b'''":uu,'b"""':cu,"ur'''":uu,'ur"""':cu,"br'''":uu,'br"""':cu,"R'''":uu,'R"""':cu,"U'''":uu,'U"""':cu,"B'''":uu,'B"""':cu,"uR'''":uu,'uR"""':cu,"Ur'''":uu,'Ur"""':cu,"UR'''":uu,'UR"""':cu,"bR'''":uu,'bR"""':cu,"Br'''":uu,'Br"""':cu,"BR'''":uu,'BR"""':cu,r:null,R:null,u:null,U:null,b:null,B:null},fu={"'''":!0,'"""':!0,"r'''":!0,'r"""':!0,"R'''":!0,'R"""':!0,"u'''":!0,'u"""':!0,"U'''":!0,'U"""':!0,"b'''":!0,'b"""':!0,"B'''":!0,'B"""':!0,"ur'''":!0,'ur"""':!0,"Ur'''":!0,'Ur"""':!0,"uR'''":!0,'uR"""':!0,"UR'''":!0,'UR"""':!0,"br'''":!0,'br"""':!0,"Br'''":!0,'Br"""':!0,"bR'''":!0,'bR"""':!0,"BR'''":!0,'BR"""':!0},hu={"'":!0,'"':!0,"r'":!0,'r"':!0,"R'":!0,'R"':!0,"u'":!0,'u"':!0,"U'":!0,'U"':!0,"b'":!0,'b"':!0,"B'":!0,'B"':!0,"ur'":!0,'ur"':!0,"Ur'":!0,'Ur"':!0,"uR'":!0,'uR"':!0,"UR'":!0,'UR"':!0,"br'":!0,'br"':!0,"Br'":!0,'Br"':!0,"bR'":!0,'bR"':!0,"BR'":!0,'BR"':!0},pu=0,du=1,mu="done";class gu{constructor(t,e){this.callback=e,this.begin=[-1,-1],this.end=[-1,-1],this.lnum=0,this.parenlev=0,this.strstart=[-1,-1],this.callback=e,this.continued=!1,this.contstr="",this.needcont=!1,this.contline=void 0,this.indents=[0],this.endprog=/.*/,this.interactive=t,this.doneFunc=function(){const t=this.begin,r=this.end;t[pu]=r[pu]=this.lnum,t[du]=r[du]=0;const n=this.indents.length;for(let s=1;s<n;++s)if(e(Ua,"",t,r,""))return mu;return e(Ca,"",t,r,"")?mu:"failed"}}generateTokens(t){let e,r,n;t||(t=""),this.lnum+=1;let s=0,i=t.length;const o=this.callback,a=this.begin;a[pu]=this.lnum;const u=this.end;if(u[pu]=this.lnum,this.contstr.length>0){if(!t)throw new Pa("EOF in multi-line string",this.strstart[pu],this.strstart[du]);if(this.endprog.lastIndex=0,e=this.endprog.test(t),!e)return this.needcont&&"\\\n"!==t.substring(t.length-2)&&"\\\r\n"!==t.substring(t.length-3)?(ba("string"==typeof this.contline),u[du]=t.length,o(Da,this.contstr+t,this.strstart,u,this.contline)?mu:(this.contstr="",this.contline=void 0,!1)):(this.contstr+=t,this.contline=this.contline+t,!1);if(s=n=this.endprog.lastIndex,u[du]=n,o(Ha,this.contstr+t.substring(0,n),this.strstart,u,this.contline+t))return mu;this.contstr="",this.needcont=!1,this.contline=void 0}else if(0!==this.parenlev||this.continued){if(!t)throw new Pa("EOF in multi-line statement",this.lnum,0);this.continued=!1}else{if(!t)return this.doneFunc();for(r=0;s<i;){const e=t.charAt(s);if(" "===e)r+=1;else if("\t"===e)r=8*(r/8+1);else{if("\f"!==e)break;r=0}s+=1}if(s===i)return this.doneFunc();if(-1!=="#\r\n".indexOf(t.charAt(s))){if("#"===t.charAt(s)){const e=function(t,e){let r;for(r=t.length;r>0&&-1!==e.indexOf(t.charAt(r-1));--r);return t.substring(0,r)}(t.substring(s),"\r\n"),r=s+e.length;return a[du]=s,u[du]=r,o(Fa,e,a,u,t)?mu:(a[du]=r,u[du]=t.length,!!o(Qa,t.substring(r),a,u,t)&&mu)}if(a[du]=s,u[du]=t.length,o(Qa,t.substring(s),a,u,t))return mu;if(!this.interactive)return!1}if(-1!=="'''".indexOf(t.charAt(s))){if("'"===t.charAt(s)){const e=t.substring(s),r=s+e.length;return a[du]=s,u[du]=r,o(Fa,e,a,u,t)?mu:(a[du]=r,u[du]=t.length,!!o(Qa,t.substring(r),a,u,t)&&mu)}if(a[du]=s,u[du]=t.length,o(Qa,t.substring(s),a,u,t))return mu;if(!this.interactive)return!1}if(r>this.indents[this.indents.length-1]&&(this.indents.push(r),a[du]=0,u[du]=s,o(Ba,t.substring(0,s),a,u,t)))return mu;for(;r<this.indents[this.indents.length-1];){if(!_u(this.indents,r))throw a[du]=0,u[du]=s,xu("unindent does not match any outer indentation level",a,u);if(this.indents.splice(this.indents.length-1,1),a[du]=s,u[du]=s,o(Ua,"",a,u,t))return mu}}for(;s<i;){let r=t.charAt(s);for(;" "===r||"\f"===r||"\t"===r;)s+=1,r=t.charAt(s);au.lastIndex=0;const i=au.exec(t.substring(s));if(i){const r=s;n=r+i[1].length,a[du]=r,u[du]=n,s=n;const c=t.substring(r,n),l=t.charAt(r);if(-1!=="0123456789".indexOf(l)||"."===l&&"."!==c){if(o(Za,c,a,u,t))return mu}else if("\r"===l||"\n"===l){let e=za;if(this.parenlev>0&&(e=Qa),o(e,c,a,u,t))return mu}else if("#"===l||"'''"===l){if(o(Fa,c,a,u,t))return mu}else if(fu.hasOwnProperty(c)){if(this.endprog=lu[c],this.endprog.lastIndex=0,e=this.endprog.test(t.substring(s)),!e)return this.strstart[pu]=this.lnum,this.strstart[du]=r,this.contstr=t.substring(r),this.contline=t,!1;{s=this.endprog.lastIndex+s;const e=t.substring(r,s);if(u[du]=s,o(Ha,e,a,u,t))return mu}}else if(hu.hasOwnProperty(l)||hu.hasOwnProperty(c.substring(0,2))||hu.hasOwnProperty(c.substring(0,3))){if("\n"===c[c.length-1])return this.endprog=lu[l]||lu[c[1]]||lu[c[2]],ba(this.endprog instanceof RegExp),this.contstr=t.substring(r),this.needcont=!0,this.contline=t,!1;if(o(Ha,c,a,u,t))return mu}else if(-1!=="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_".indexOf(l)){if(o(Ka,c,a,u,t))return mu}else if("\\"===l){if(u[du]=s,o(Qa,c,a,u,t))return mu;this.continued=!0}else if(-1!=="([{".indexOf(l)?this.parenlev+=1:-1!==")]}".indexOf(l)&&(this.parenlev-=1),o(Ga,c,a,u,t))return mu}else{if(a[du]=s,u[du]=s+1,o(Da,t.charAt(s),a,u,t))return mu;s+=1}}return!1}}function wu(t,e,r,n,s,i,o,a,u,c){return"("+Array.prototype.slice.call(arguments).join("|")+")"}function _u(t,e){let r=t.length;for(;r--;)if(t[r]===e)return!0;return!1}function xu(t,e,r,n){ba(Array.isArray(e),"begin must be an Array"),ba(Array.isArray(r),"end must be an Array");const s=new SyntaxError(t);return s.name="IndentationError",e&&(s.lineNumber=e[pu],s.columnNumber=e[du]),s}class yu{constructor(t,e){this.line=t,this.column=e}get row(){return this.line-1}toString(){return`[${this.line}, ${this.column}]`}}class vu extends SyntaxError{constructor(t){super(t),this.name="ParseError"}}class bu extends vu{constructor(t,e,r){super(`Unexpected ${t} at ${JSON.stringify([e[0],e[1]+1])}`),this.tokenName=t,this.name="UnexpectedTokenError",Array.isArray(e)&&(this.begin=new yu(e[0],e[1])),Array.isArray(r)&&(this.end=new yu(r[0],r[1]))}}function Ou(t,e,r){const n=new vu(t);return Array.isArray(e)&&(n.begin=new yu(e[0],e[1])),Array.isArray(r)&&(n.end=new yu(r[0],r[1])),n}class Eu{constructor(t,e){ba(t,"begin must be defined"),ba(e,"end must be defined"),this.begin=t,this.end=e}toString(){return`${this.begin} to ${this.end}`}}const Su=Aa.T_COMMENT,qu=Aa.T_ENDMARKER,Tu=Aa.T_NAME,Mu=Aa.T_NL,Au=Aa.T_NT_OFFSET,Nu=Aa.T_OP;class $u{constructor(t){this.stack=[],this.used_names={},this.grammar=t}setup(t){const e={type:t=t||this.grammar.start,range:null,value:null,children:[]},r={dfa:this.grammar.dfas[t][0],beginTokens:this.grammar.dfas[t][1],stateId:0,node:e};this.stack.push(r)}addtoken(t,e,r,n,s){const i=this.classify(t,e,r,n,s),o=this.stack,a=this.grammar,u=a.dfas,c=a.labels;t:for(;;){let a=o[o.length-1],l=a.dfa;const f=l[a.stateId];for(const h of f){const f=h[$a],p=h[La],d=c[f][0];if(i===f){this.shiftToken(t,e,p,r,n,s);let i=p,u=l[i];for(;1===u.length&&0===u[0][$a]&&u[0][La]===i;){this.popNonTerminal();const t=o.length;if(0===t)return!0;a=o[t-1],i=a.stateId,l=a.dfa,u=l[i]}return!1}if(Iu(d)){const t=u[d],e=t[0],o=t[1];if(o.hasOwnProperty(i)){this.pushNonTerminal(d,e,o,p,r,n,s);continue t}}}if(!Lu(f,[qu,a.stateId])){const t=Ia(a.stateId);throw new bu(t,r,n)}if(this.popNonTerminal(),0===o.length)throw Ou("too much input")}}classify(t,e,r,n,s){!function(t){ba(t<Au,"terminal symbols should be less than T_NT_OFFSET")}(t);const i=this.grammar;if(t===Tu){this.used_names[e]=!0;const t=i.keywords;if(t.hasOwnProperty(e)){return t[e]}}const o=i.tokens;let a;if(o.hasOwnProperty(t)&&(a=o[t]),!a)throw Ou("bad token",r,n);return a}shiftToken(t,e,r,n,s,i){const o=this.stack,a=o[o.length-1],u=a.node,c={type:t,value:e,range:new Eu(new yu(n[0],n[1]),new yu(s[0],s[1])),children:null};c&&u.children&&u.children.push(c),a.stateId=r}pushNonTerminal(t,e,r,n,s,i,o){const a=this.stack;a[a.length-1].stateId=n;const u=s?new yu(s[0],s[1]):null,c=i?new yu(i[0],i[1]):null,l={type:t,value:null,range:new Eu(u,c),children:[]};a.push({dfa:e,beginTokens:r,stateId:0,node:l})}popNonTerminal(){const t=this.stack,e=t.pop();if(e){const r=e.node;if(r){const e=t.length;if(0!==e){const n=t[e-1].node.children;n&&n.push(r)}else this.rootNode=r,r.used_names=this.used_names}}}}function Lu(t,e){let r=t.length;for(;r--;){const n=t[r];if(n[$a]===e[$a]&&n[La]===e[La])return!0}return!1}var ku;function Ru(t,e=ku.File){const r=function(t){void 0===t&&(t=ku.File);const e=new $u(ka);switch(t){case ku.File:e.setup(ka.sym.file_input);break;case ku.Eval:e.setup(ka.sym.eval_input);break;case ku.Single:e.setup(ka.sym.single_input);break;default:throw new Error("SourceKind must be one of File, Eval, or Single.")}const r=new gu(t===ku.Single,(function(t,r,n,s,i){return n[0],n[1],t===Su||t===Mu?(s[0],s[1],void r[r.length-1]):(t===Nu&&(t=Na[r]),!!e.addtoken(t,r,n,s,i)||void 0)}));return function(t){const n=r.generateTokens(t);if(n){if("done"!==n)throw Ou("incomplete input");return e.rootNode}return!1}}(e),n=function(t){const e=[];"\n"!==t.substr(Ma(t),1)&&(t+="\n");const r=t.split("\n"),n=r.length;for(let t=0;t<n;++t){const n=r[t]+(t===Ma(r)?"":"\n");e.push(n)}return e}(t);let s=!1;for(const t of n)s=r(t);return s}function Iu(t){return t>=Au}function Pu(t){return{text:t,value:parseFloat(t),isFloat:function(){return!0},isInt:function(){return!1},isLong:function(){return!1},toString:function(){return t}}}function Fu(t){return{value:t,isFloat:function(){return!1},isInt:function(){return!0},isLong:function(){return!1},toString:function(){return""+t}}}function Uu(t,e){return{text:t,radix:e,isFloat:function(){return!1},isInt:function(){return!1},isLong:function(){return!0},toString:function(){return t}}}!function(t){t[t.File=0]="File",t[t.Eval=1]="Eval",t[t.Single=2]="Single"}(ku||(ku={}));class Cu{}class Du{}class Bu{}class Ku{}class zu{}class Qu{}class Zu{}class Gu{}class Hu{}class Vu{}class ju{}class Wu{}class Ju{}class Xu{}class Yu{}class tc{}class ec{}class rc{}class nc{}class sc{}class ic{}class oc{}class ac{}class uc{}class cc{}class lc{}class fc{}class hc{}class pc{}class dc{}class mc{}class gc{}class wc{}class _c{}class xc{constructor(t,e){this.value=t,this.range=e,ba(void 0!==t,"value must be defined.")}}class yc{constructor(){}accept(t){throw new Error(`"Expression.accept" is not implemented. this=${JSON.stringify(this,null,2)}`)}}class vc{accept(t){throw new Error('"Statement.accept" is not implemented.')}}class bc extends vc{}class Oc{constructor(t){this.body=t}accept(t){t.module(this)}}class Ec extends vc{constructor(t,e,r,n,s,i){super(),this.range=i,this.name=t,this.args=e,this.body=r,this.decorator_list=s,this.returnType=n}accept(t){t.functionDef(this)}}class Sc{constructor(t,e){this.name=t,this.type=e||null}}class qc extends vc{constructor(t,e,r,n,s){super(),this.range=s,this.name=t,this.bases=e,this.body=r,this.decorator_list=n}accept(t){t.classDef(this)}}class Tc extends vc{constructor(t,e){super(),this.range=e,this.value=t}accept(t){t.returnStatement(this)}}class Mc extends vc{constructor(t,e){super(),this.range=e,this.targets=t}}class Ac extends vc{constructor(t,e,r,n,s){super(),this.range=r,this.eqRange=n,this.targets=t,this.value=e,s&&(this.type=s)}accept(t){t.assign(this)}}class Nc extends vc{constructor(t,e,r,n){super(),this.range=n,this.target=t,this.op=e,this.value=r}}class $c extends vc{constructor(t,e,r){super(),this.range=r,this.value=t,this.target=e}accept(t){t.annAssign(this)}}class Lc extends vc{constructor(t,e,r,n){super(),this.range=n,this.dest=t,this.values=e,this.nl=r}accept(t){t.print(this)}}class kc extends vc{constructor(t,e,r,n,s){super(),this.range=s,this.target=t,this.iter=e,this.body=r,this.orelse=n}accept(t){t.forStatement(this)}}class Rc extends bc{constructor(t,e,r,n){super(),this.range=n,this.test=t,this.body=e,this.orelse=r}}class Ic extends vc{constructor(t,e,r,n){super(),this.range=n,this.test=t,this.consequent=e,this.alternate=r}accept(t){t.ifStatement(this)}}class Pc extends vc{constructor(t,e,r,n){super(),this.range=n,this.context_expr=t,this.optional_vars=e,this.body=r}}class Fc extends vc{constructor(t,e,r,n){super(),this.range=n,this.type=t,this.inst=e,this.tback=r}}class Uc extends vc{constructor(t,e,r,n){super(),this.range=n,this.body=t,this.handlers=e,this.orelse=r}}class Cc extends vc{constructor(t,e,r){super(),this.range=r,this.body=t,this.finalbody=e}}class Dc extends vc{constructor(t,e,r){super(),this.range=r,this.test=t,this.msg=e}}class Bc extends vc{constructor(t,e){super(),this.range=e,this.names=t}}class Kc extends vc{constructor(t,e,r,n){super(),this.range=n,ba("string"==typeof t.value,"module must be a string."),ba(Array.isArray(e),"names must be an Array."),this.module=t,this.names=e,this.level=r}accept(t){t.importFrom(this)}}class zc extends vc{constructor(t,e,r,n){super(),this.range=n,this.body=t,this.globals=e,this.locals=r}}class Qc extends vc{constructor(t,e){super(),this.range=e,this.names=t}}class Zc extends vc{constructor(t,e){super(),this.range=e,this.names=t}}class Gc extends vc{constructor(t,e){super(),this.range=e,this.value=t}accept(t){t.expressionStatement(this)}}class Hc extends vc{constructor(t){super(),this.range=t}}class Vc extends vc{constructor(t){super(),this.range=t}}class jc extends vc{constructor(t){super(),this.range=t}}class Wc extends yc{constructor(t,e,r){super(),this.range=r,this.op=t,this.values=e}}class Jc extends yc{constructor(t,e,r,n){super(),this.range=n,this.lhs=t,this.op=e.op,this.opRange=e.range,this.rhs=r}accept(t){t.binOp(this)}}class Xc extends yc{constructor(t,e,r){super(),this.op=t,this.operand=e,this.range=r,ba(t===ac||t===uc||t===ic||t===oc,"op must be defined."),ba(!!e,"operand must be defined")}accept(t){t.unaryOp(this)}}let Yc=class extends yc{constructor(t,e,r){super(),this.range=r,this.args=t,this.body=e}};class tl extends yc{constructor(t,e,r,n){super(),this.range=n,this.test=t,this.body=e,this.orelse=r}}class el extends yc{constructor(t,e,r){super(),this.range=r,this.keys=t,this.values=e}accept(t){t.dict(this)}}class rl extends yc{constructor(t,e,r){super(),this.range=r,this.elt=t,this.generators=e}}class nl extends yc{constructor(t,e,r){super(),this.range=r,this.elt=t,this.generators=e}}class sl extends yc{constructor(t,e){super(),this.range=e,this.value=t}}class il extends yc{constructor(t,e,r,n){super(),this.range=n,this.left=t;for(const t of e)switch(t){case cc:case lc:case pc:case dc:case fc:case hc:case wc:case _c:case mc:case gc:break;default:throw new Error(`ops must only contain CompareOperator(s) but contains ${t}`)}this.ops=e,this.comparators=r}accept(t){t.compareExpression(this)}}class ol extends yc{constructor(t,e,r,n,s){super(),this.func=t,this.args=e,this.keywords=r,this.starargs=n,this.kwargs=s}accept(t){t.callExpression(this)}}class al extends yc{constructor(t){super(),this.n=t}accept(t){t.num(this)}}class ul extends yc{constructor(t){super(),this.s=t}accept(t){t.str(this)}}class cl extends yc{constructor(t,e,r,n){super(),this.range=n,this.value=t,this.attr=e,this.ctx=r}accept(t){t.attribute(this)}}class ll extends yc{constructor(t,e,r,n){super(),this.range=n,this.value=t,this.slice=e,this.ctx=r}accept(t){t.subscript(this)}}class fl extends yc{constructor(t,e){super(),this.id=t,this.ctx=e}accept(t){t.name(this)}}class hl extends yc{constructor(t,e,r){super(),this.range=r,this.elts=t,this.ctx=e}accept(t){t.list(this)}}class pl extends yc{constructor(t,e,r){super(),this.range=r,this.elts=t,this.ctx=e}}class dl{constructor(){}}class ml{constructor(t,e,r){this.lower=t,this.upper=e,this.step=r}}class gl{constructor(t){this.dims=t}}class wl{constructor(t){this.value=t}}class _l{constructor(t,e,r,n){this.range=n,this.target=t,this.iter=e,this.ifs=r}}class xl{constructor(t,e,r,n){this.range=n,this.type=t,this.name=e,this.body=r}}class yl{constructor(t,e,r,n){this.args=t,this.vararg=e,this.kwarg=r,this.defaults=n}}class vl{constructor(t,e){this.arg=t,this.value=e}}class bl{constructor(t,e){ba("string"==typeof t.value),ba("string"==typeof e||null===e),this.name=t,this.asname=e}toString(){return`${this.name.value} as ${this.asname}`}}Oc.prototype._astname="Module",Oc.prototype._fields=["body",function(t){return t.body}],yc.prototype._astname="Expression",yc.prototype._fields=["body",function(t){}],Ec.prototype._astname="FunctionDef",Ec.prototype._fields=["name",function(t){return t.name.value},"args",function(t){return t.args},"body",function(t){return t.body},"returnType",function(t){return t.returnType},"decorator_list",function(t){return t.decorator_list}],qc.prototype._astname="ClassDef",qc.prototype._fields=["name",function(t){return t.name.value},"bases",function(t){return t.bases},"body",function(t){return t.body},"decorator_list",function(t){return t.decorator_list}],Tc.prototype._astname="ReturnStatement",Tc.prototype._fields=["value",function(t){return t.value}],Mc.prototype._astname="DeleteStatement",Mc.prototype._fields=["targets",function(t){return t.targets}],Ac.prototype._astname="Assign",Ac.prototype._fields=["targets",function(t){return t.targets},"value",function(t){return t.value}],Nc.prototype._astname="AugAssign",Nc.prototype._fields=["target",function(t){return t.target},"op",function(t){return t.op},"value",function(t){return t.value}],$c.prototype._astname="AnnAssign",$c.prototype._fields=["target",function(t){return t.target},"type",function(t){return t.value}],Lc.prototype._astname="Print",Lc.prototype._fields=["dest",function(t){return t.dest},"values",function(t){return t.values},"nl",function(t){return t.nl}],kc.prototype._astname="ForStatement",kc.prototype._fields=["target",function(t){return t.target},"iter",function(t){return t.iter},"body",function(t){return t.body},"orelse",function(t){return t.orelse}],Rc.prototype._astname="WhileStatement",Rc.prototype._fields=["test",function(t){return t.test},"body",function(t){return t.body},"orelse",function(t){return t.orelse}],Ic.prototype._astname="IfStatement",Ic.prototype._fields=["test",function(t){return t.test},"consequent",function(t){return t.consequent},"alternate",function(t){return t.alternate}],Pc.prototype._astname="WithStatement",Pc.prototype._fields=["context_expr",function(t){return t.context_expr},"optional_vars",function(t){return t.optional_vars},"body",function(t){return t.body}],Fc.prototype._astname="Raise",Fc.prototype._fields=["type",function(t){return t.type},"inst",function(t){return t.inst},"tback",function(t){return t.tback}],Uc.prototype._astname="TryExcept",Uc.prototype._fields=["body",function(t){return t.body},"handlers",function(t){return t.handlers},"orelse",function(t){return t.orelse}],Cc.prototype._astname="TryFinally",Cc.prototype._fields=["body",function(t){return t.body},"finalbody",function(t){return t.finalbody}],Dc.prototype._astname="Assert",Dc.prototype._fields=["test",function(t){return t.test},"msg",function(t){return t.msg}],Bc.prototype._astname="Import",Bc.prototype._fields=["names",function(t){return t.names}],Kc.prototype._astname="ImportFrom",Kc.prototype._fields=["module",function(t){return t.module.value},"names",function(t){return t.names},"level",function(t){return t.level}],zc.prototype._astname="Exec",zc.prototype._fields=["body",function(t){return t.body},"globals",function(t){return t.globals},"locals",function(t){return t.locals}],Qc.prototype._astname="Global",Qc.prototype._fields=["names",function(t){return t.names}],Zc.prototype._astname="NonLocal",Zc.prototype._fields=["names",function(t){return t.names}],Gc.prototype._astname="ExpressionStatement",Gc.prototype._fields=["value",function(t){return t.value}],Hc.prototype._astname="Pass",Hc.prototype._fields=[],Vc.prototype._astname="BreakStatement",Vc.prototype._fields=[],jc.prototype._astname="ContinueStatement",jc.prototype._fields=[],Wc.prototype._astname="BoolOp",Wc.prototype._fields=["op",function(t){return t.op},"values",function(t){return t.values}],Jc.prototype._astname="BinOp",Jc.prototype._fields=["lhs",function(t){return t.lhs},"op",function(t){return t.op},"rhs",function(t){return t.rhs}],Xc.prototype._astname="UnaryOp",Xc.prototype._fields=["op",function(t){return t.op},"operand",function(t){return t.operand}],Yc.prototype._astname="Lambda",Yc.prototype._fields=["args",function(t){return t.args},"body",function(t){return t.body}],tl.prototype._astname="IfExp",tl.prototype._fields=["test",function(t){return t.test},"body",function(t){return t.body},"orelse",function(t){return t.orelse}],el.prototype._astname="Dict",el.prototype._fields=["keys",function(t){return t.keys},"values",function(t){return t.values}],rl.prototype._astname="ListComp",rl.prototype._fields=["elt",function(t){return t.elt},"generators",function(t){return t.generators}],nl.prototype._astname="GeneratorExp",nl.prototype._fields=["elt",function(t){return t.elt},"generators",function(t){return t.generators}],sl.prototype._astname="Yield",sl.prototype._fields=["value",function(t){return t.value}],il.prototype._astname="Compare",il.prototype._fields=["left",function(t){return t.left},"ops",function(t){return t.ops},"comparators",function(t){return t.comparators}],ol.prototype._astname="Call",ol.prototype._fields=["func",function(t){return t.func},"args",function(t){return t.args},"keywords",function(t){return t.keywords},"starargs",function(t){return t.starargs},"kwargs",function(t){return t.kwargs}],al.prototype._astname="Num",al.prototype._fields=["n",function(t){return t.n.value}],ul.prototype._astname="Str",ul.prototype._fields=["s",function(t){return t.s.value}],cl.prototype._astname="Attribute",cl.prototype._fields=["value",function(t){return t.value},"attr",function(t){return t.attr.value},"ctx",function(t){return t.ctx}],ll.prototype._astname="Subscript",ll.prototype._fields=["value",function(t){return t.value},"slice",function(t){return t.slice},"ctx",function(t){return t.ctx}],fl.prototype._astname="Name",fl.prototype._fields=["id",function(t){return t.id.value},"ctx",function(t){return t.ctx}],hl.prototype._astname="List",hl.prototype._fields=["elts",function(t){return t.elts},"ctx",function(t){return t.ctx}],pl.prototype._astname="Tuple",pl.prototype._fields=["elts",function(t){return t.elts},"ctx",function(t){return t.ctx}],Cu.prototype._astname="Load",Cu.prototype._isenum=!0,Du.prototype._astname="Store",Du.prototype._isenum=!0,Bu.prototype._astname="Del",Bu.prototype._isenum=!0,Ku.prototype._astname="AugLoad",Ku.prototype._isenum=!0,zu.prototype._astname="AugStore",zu.prototype._isenum=!0,Qu.prototype._astname="Param",Qu.prototype._isenum=!0,dl.prototype._astname="Ellipsis",dl.prototype._fields=[],ml.prototype._astname="Slice",ml.prototype._fields=["lower",function(t){return t.lower},"upper",function(t){return t.upper},"step",function(t){return t.step}],gl.prototype._astname="ExtSlice",gl.prototype._fields=["dims",function(t){return t.dims}],wl.prototype._astname="Index",wl.prototype._fields=["value",function(t){return t.value}],Zu.prototype._astname="And",Zu.prototype._isenum=!0,Gu.prototype._astname="Or",Gu.prototype._isenum=!0,Hu.prototype._astname="Add",Hu.prototype._isenum=!0,Vu.prototype._astname="Sub",Vu.prototype._isenum=!0,ju.prototype._astname="Mult",ju.prototype._isenum=!0,Wu.prototype._astname="Div",Wu.prototype._isenum=!0,Ju.prototype._astname="Mod",Ju.prototype._isenum=!0,Xu.prototype._astname="Pow",Xu.prototype._isenum=!0,Yu.prototype._astname="LShift",Yu.prototype._isenum=!0,tc.prototype._astname="RShift",tc.prototype._isenum=!0,ec.prototype._astname="BitOr",ec.prototype._isenum=!0,rc.prototype._astname="BitXor",rc.prototype._isenum=!0,nc.prototype._astname="BitAnd",nc.prototype._isenum=!0,sc.prototype._astname="FloorDiv",sc.prototype._isenum=!0,ic.prototype._astname="Invert",ic.prototype._isenum=!0,oc.prototype._astname="Not",oc.prototype._isenum=!0,ac.prototype._astname="UAdd",ac.prototype._isenum=!0,uc.prototype._astname="USub",uc.prototype._isenum=!0,cc.prototype._astname="Eq",cc.prototype._isenum=!0,lc.prototype._astname="NotEq",lc.prototype._isenum=!0,fc.prototype._astname="Lt",fc.prototype._isenum=!0,hc.prototype._astname="LtE",hc.prototype._isenum=!0,pc.prototype._astname="Gt",pc.prototype._isenum=!0,dc.prototype._astname="GtE",dc.prototype._isenum=!0,mc.prototype._astname="Is",mc.prototype._isenum=!0,gc.prototype._astname="IsNot",gc.prototype._isenum=!0,wc.prototype._astname="In",wc.prototype._isenum=!0,_c.prototype._astname="NotIn",_c.prototype._isenum=!0,_l.prototype._astname="Comprehension",_l.prototype._fields=["target",function(t){return t.target},"iter",function(t){return t.iter},"ifs",function(t){return t.ifs}],xl.prototype._astname="ExceptHandler",xl.prototype._fields=["type",function(t){return t.type},"name",function(t){return t.name},"body",function(t){return t.body}],yl.prototype._astname="Arguments",yl.prototype._fields=["args",function(t){return t.args},"vararg",function(t){return t.vararg},"kwarg",function(t){return t.kwarg},"defaults",function(t){return t.defaults}],vl.prototype._astname="Keyword",vl.prototype._fields=["arg",function(t){return t.arg.value},"value",function(t){return t.value}],Sc.prototype._astname="FunctionParamDef",Sc.prototype._fields=["name",function(t){return t.name},"type",function(t){return t.type}],bl.prototype._astname="Alias",bl.prototype._fields=["name",function(t){return t.name.value},"asname",function(t){return t.asname}];const Ol=ka.sym,El=Math.pow(2,53);function Sl(t,e){ba("string"==typeof t,"message must be a string"),ba(Ea(e.begin.line),"lineNumber must be a number");const r=new SyntaxError(t);return r.lineNumber=e.begin.line,r}class ql{constructor(t){this.c_encoding=t}}function Tl(t,e){t.type!==e&&Oa(`node must have type ${e} = ${Ia(e)}, but was ${t.type} = ${Ia(t.type)}.`)}function Ml(t){return"string"!=typeof t&&Oa("expecting string, got "+typeof t),t}function Al(t){switch(t.type){case Ol.single_input:return qa(t,0).type===Aa.T_NEWLINE?0:Al(qa(t,0));case Ol.file_input:let e=0;for(let r=0;r<Sa(t);++r){const n=qa(t,r);n.type===Ol.stmt&&(e+=Al(n))}return e;case Ol.stmt:return Al(qa(t,0));case Ol.compound_stmt:return 1;case Ol.simple_stmt:return Math.floor(Sa(t)/2);case Ol.suite:if(1===Sa(t))return Al(qa(t,0));{let e=0;for(let r=2;r<Sa(t)-1;++r)e+=Al(qa(t,r));return e}default:throw new Error("Non-statement found")}}function Nl(t,e,r,n){if("None"===r)throw Sl("assignment to None",n);if("True"===r||"False"===r)throw Sl("assignment to True or False is forbidden",n)}function $l(t,e,r,n){ba(r!==zu&&r!==Ku);let s=null,i=null;if(e instanceof cl)r===Du&&Nl(0,0,e.attr.value,n.range),e.ctx=r;else if(e instanceof fl)r===Du&&Nl(0,0,void 0,n.range),e.ctx=r;else if(e instanceof ll)e.ctx=r;else if(e instanceof hl)e.ctx=r,s=e.elts;else if(e instanceof pl){if(0===e.elts.length)throw Sl("can't assign to ()",n.range);e.ctx=r,s=e.elts}else if(e instanceof Yc)i="lambda";else if(e instanceof ol)i="function call";else if(e instanceof Wc)i="operator";else switch(e.constructor){case Wc:case Jc:case Xc:i="operator";break;case nl:i="generator expression";break;case sl:i="yield expression";break;case rl:i="list comprehension";break;case el:case al:case ul:i="literal";break;case il:i="comparison expression";break;case tl:i="conditional expression";break;default:throw new Error("unhandled expression in assignment")}if(i)throw Sl("can't "+(r===Du?"assign to":"delete")+" "+i,n.range);if(s)for(const e of s)$l(t,e,r,n)}const Ll={};function kl(t){return ba(void 0!==Ll[t.type],`${t.type}`),{op:Ll[t.type],range:t.range}}function Rl(t,e){if(Tl(e,Ol.comp_op),1===Sa(e))switch((e=qa(e,0)).type){case Aa.T_LESS:return fc;case Aa.T_GREATER:return pc;case Aa.T_EQEQUAL:return cc;case Aa.T_LESSEQUAL:return hc;case Aa.T_GREATEREQUAL:return dc;case Aa.T_NOTEQUAL:return lc;case Aa.T_NAME:if("in"===e.value)return wc;if("is"===e.value)return mc}else if(2===Sa(e)&&qa(e,0).type===Aa.T_NAME){if("in"===qa(e,1).value)return _c;if("is"===qa(e,0).value)return gc}throw new Error("invalid comp_op")}function Il(t,e){ba(e.type===Ol.testlist||e.type===Ol.listmaker||e.type===Ol.testlist_gexp||e.type===Ol.testlist_safe||e.type===Ol.testlist1);const r=[];for(let n=0;n<Sa(e);n+=2)ba(qa(e,n).type===Ol.IfExpr||qa(e,n).type===Ol.old_test),r[n/2]=uf(t,qa(e,n));return r}function Pl(t,e){Tl(e,Ol.suite);const r=[];let n,s=0;if(qa(e,0).type===Ol.simple_stmt){let n=Sa(e=qa(e,0))-1;qa(e,n-1).type===Aa.T_SEMI&&(n-=1);for(let i=0;i<n;i+=2)r[s++]=cf(t,qa(e,i))}else for(let i=2;i<Sa(e)-1;++i){if(n=qa(e,i),Tl(n,Ol.stmt),1===Al(n))r[s++]=cf(t,n);else{n=qa(n,0),Tl(n,Ol.simple_stmt);for(let e=0;e<Sa(n);e+=2){if(0===Sa(qa(n,e))){ba(e+1===Sa(n));break}r[s++]=cf(t,qa(n,e))}}}return ba(s===Al(e)),r}function Fl(t,e,r){if(Tl(e,Ol.except_clause),Tl(r,Ol.suite),1===Sa(e))return new xl(null,null,Pl(t,r),e.range);if(2===Sa(e))return new xl(uf(t,qa(e,1)),null,Pl(t,r),e.range);if(4===Sa(e)){const n=uf(t,qa(e,3));return $l(t,n,Du,qa(e,3)),new xl(uf(t,qa(e,1)),n,Pl(t,r),e.range)}throw new Error("wrong number of children for except clause")}function Ul(t,e){Tl(e,Ol.decorator),Tl(qa(e,0),Aa.T_AT),Tl(qa(e,Sa(e)-1),Aa.T_NEWLINE);const r=function(t,e){Tl(e,Ol.dotted_name);const r=qa(e,0);let n=new xc(r.value,r.range),s=new fl(n,Cu);for(let t=2;t<Sa(e);t+=2){const r=qa(e,t);n=new xc(r.value,r.range),s=new cl(s,n,Cu,e.range)}return s}(0,qa(e,1));return 3===Sa(e)?r:5===Sa(e)?new ol(r,[],[],null,null):Gl(t,qa(e,3),r)}function Cl(t,e){Tl(e,Ol.decorated);const r=function(t,e){Tl(e,Ol.decorators);const r=[];for(let n=0;n<Sa(e);++n)r[n]=Ul(t,qa(e,n));return r}(t,qa(e,0));ba(qa(e,1).type===Ol.funcdef||qa(e,1).type===Ol.classdef);let n=null;if(qa(e,1).type===Ol.funcdef)n=jl(t,qa(e,1),r);else{if(qa(e,1).type!==Ol.classdef)throw new Error("astForDecorated");n=Wl(t,qa(e,1),r)}return n}function Dl(t,e){let r=3;ba(e.type===Ol.with_stmt);const n=uf(t,qa(e,1));let s;return qa(e,2).type===Ol.with_var&&(s=function(t,e){return Tl(e,Ol.with_var),uf(t,qa(e,1))}(t,qa(e,2)),$l(t,s,Du,e),r=4),new Pc(n,s,Pl(t,qa(e,r)),e.range)}function Bl(t,e,r){Tl(e,Ol.ExprList);const n=[];for(let s=0;s<Sa(e);s+=2){const i=uf(t,qa(e,s));n[s/2]=i,r&&$l(t,i,r,qa(e,s))}return n}function Kl(t,e){t:for(;;)switch(e.type){case Ol.ImportSpecifier:{let t=null;const r=qa(e,0),n=Ml(r.value),s=r.range;return 3===Sa(e)&&(t=qa(e,2).value),new bl(new xc(n,s),null==t?null:Ml(t))}case Ol.dotted_as_name:if(1===Sa(e)){e=qa(e,0);continue t}{const r=Kl(t,qa(e,0));return ba(!r.asname),r.asname=Ml(qa(e,2).value),r}case Ol.dotted_name:if(1===Sa(e)){const t=qa(e,0),r=Ml(t.value),n=t.range;return new bl(new xc(r,n),null)}{let t="";for(let r=0;r<Sa(e);r+=2)t+=qa(e,r).value+".";return new bl(new xc(t.substr(0,t.length-1),null),null)}case Aa.T_STAR:return new bl(new xc("*",e.range),null);case Aa.T_NAME:return new bl(new xc(e.value,e.range),null);default:throw Sl(`unexpected import name ${Ia(e.type)}`,e.range)}}function zl(t,e){Tl(e,Ol.ModuleSpecifier);const r=Sa(e);let n,s="";for(let i=0;i<r;++i){const r=qa(e,i);s+=nf(t,r.value),n=r.range}return{value:s,range:n}}function Ql(t,e){Tl(e,Ol.import_stmt);let r=qa(e,0);if(r.type===Ol.import_name){const n=qa(r,1);Tl(n,Ol.dotted_as_names);const s=[];for(let e=0;e<Sa(n);e+=2)s[e/2]=Kl(t,qa(n,e));return new Bc(s,e.range)}if(r.type===Ol.import_from){let n,s,i,o=0;for(i=1;i<Sa(r);++i){const e=qa(r,i),s=e.type;if(s===Ol.dotted_name)throw Sl(`unknown import statement ${Ia(s)}.`,e.range);if(s===Ol.ModuleSpecifier){n=zl(t,e);break}if(s!==Aa.T_DOT)throw Sl(`unknown import statement ${Ia(s)}.`,e.range);o++}++i;let a=r;switch(qa(r,i).type){case Aa.T_STAR:a=qa(r,i),s=1;break;case Aa.T_LPAR:a=qa(a,i+1),s=Sa(a);break;case Ol.ImportList:if(a=qa(a,i),s=Sa(a),s%2==0)throw Sl("trailing comma not allowed without surrounding parentheses",a.range)}const u=[];if(a.type===Aa.T_STAR)u[0]=Kl(t,a);else{Tl(a,Ol.import_from);const e=qa(a,function(t,e){ba(void 0!==e);const r=Ta(t),n=r.length;for(let t=0;t<n;t++)if(r[t].type===e)return t;return-1}(a,Ol.ImportList));!function(t,e,r){Tl(e,Ol.ImportList);const n=Sa(e);for(let s=0;s<n;s++){const n=qa(e,s);n.type===Ol.ImportSpecifier&&r.push(Kl(t,n))}}(t,e,u)}return ba("string"==typeof n.value),new Kc(new xc(n.value,n.range),u,o,e.range)}throw Sl(`unknown import statement ${Ia(r.type)}.`,r.range)}function Zl(t,e){if(qa(e,0).type===Aa.T_MINUS&&2===Sa(e)){const r=qa(e,1);if(r.type===Ol.UnaryExpr&&1===Sa(r)){const e=qa(r,0);if(e.type===Ol.PowerExpr&&1===Sa(e)){const r=qa(e,0);if(r.type===Ol.AtomExpr){const e=qa(r,0);if(e.type===Aa.T_NUMBER)return e.value="-"+e.value,of(t,r)}}}}const r=uf(t,qa(e,1));switch(qa(e,0).type){case Aa.T_PLUS:return new Xc(ac,r,e.range);case Aa.T_MINUS:return new Xc(uc,r,e.range);case Aa.T_TILDE:return new Xc(ic,r,e.range)}throw new Error("unhandled UnaryExpr")}function Gl(t,e,r){Tl(e,Ol.arglist);let n=0,s=0,i=0;for(let t=0;t<Sa(e);++t){const r=qa(e,t);r.type===Ol.argument&&(1===Sa(r)?n++:qa(r,1).type===Ol.gen_for?i++:s++)}if(i>1||i&&(n||s))throw Sl("Generator expression must be parenthesized if not sole argument",e.range);if(n+s+i>255)throw Sl("more than 255 arguments",e.range);const o=[],a=[];n=0,s=0;let u=null,c=null;for(let r=0;r<Sa(e);++r){const i=qa(e,r);if(i.type===Ol.argument)if(1===Sa(i)){if(s)throw Sl("non-keyword arg after keyword arg",e.range);if(u)throw Sl("only named arguments may follow *expression",e.range);o[n++]=uf(t,qa(i,0))}else if(qa(i,1).type===Ol.gen_for)o[n++]=Xl(t,i);else{const r=uf(t,qa(i,0));if(r.constructor===Yc)throw Sl("lambda cannot contain assignment",e.range);if(r.constructor!==fl)throw Sl("keyword can't be an expression",e.range);const n=r.id;Nl(0,qa(i,0),n.value,e.range);for(let t=0;t<s;++t){if(a[t].arg.value===n.value)throw Sl("keyword argument repeated",e.range)}a[s++]=new vl(n,uf(t,qa(i,2)))}else i.type===Aa.T_STAR?u=uf(t,qa(e,++r)):i.type===Aa.T_DOUBLESTAR&&(c=uf(t,qa(e,++r)))}const l=function(t){let e=[],r=[];for(const n of t)r.push(n.value),e.push(new fl(new xc(n.arg.value,n.arg.range),Cu));return new el(e,r)}(a);return 0!==l.keys.length&&o.push(l),new ol(r,o,[],u,c)}function Hl(t,e,r){const n=e,s=qa(n,0),i=qa(n,1),o=qa(n,2);if(Tl(n,Ol.trailer),s.type===Aa.T_LPAR)return 2===Sa(n)?new ol(r,[],[],null,null):Gl(t,i,r);if(s.type===Aa.T_DOT)return new cl(r,new xc(i.value,i.range),Cu,n.range);{Tl(s,Aa.T_LSQB),Tl(o,Aa.T_RSQB);const e=i;if(1===Sa(e))return new ll(r,sf(t,qa(e,0)),Cu,e.range);{let n=!0;const s=[];for(let r=0;r<Sa(e);r+=2){const i=sf(t,qa(e,r));i.constructor!==wl&&(n=!1),s[r/2]=i}if(!n)return new ll(r,new gl(s),Cu,e.range);const i=[];for(let t=0;t<s.length;++t){let e=s[t];e instanceof wl?(ba(null!==e.value&&void 0!==e.value),i[t]=e.value):ba(e instanceof wl)}const o=new pl(i,Cu,e.range);return new ll(r,new wl(o),Cu,e.range)}}}function Vl(t,e){let r,n=null,s=null;if(e.type===Ol.parameters){if(2===Sa(e))return new yl([],null,null,[]);e=qa(e,1)}Tl(e,Ol.varargslist);const i=[],o=[];let a=!1,u=0,c=0,l=0;for(;u<Sa(e);)switch(r=qa(e,u),r.type){case Ol.fpdef:let f=0,h=!1;t:for(;;){if(u+1<Sa(e)&&qa(e,u+1).type===Aa.T_EQUAL)o[c++]=uf(t,qa(e,u+2)),u+=2,a=!0;else if(a){if(h&&!f)throw Sl("parenthesized arg with default",e.range);throw Sl("non-default argument follows default argument",e.range)}if(3===Sa(r)&&r.children[2].type===Aa.T_RPAR){if(r=qa(r,1),1!==Sa(r))throw Sl("tuple parameter unpacking has been removed",e.range);h=!0,r=qa(r,0),ba(r.type===Ol.fpdef);continue t}const n=qa(r,0);if(n.type===Aa.T_NAME){Nl(0,0,n.value,e.range);const s=new xc(n.value,n.range),o=qa(r,2);if(o){let e=uf(t,o);i[l++]=new Sc(new fl(s,Qu),e)}else i[l++]=new Sc(new fl(s,Qu))}if(u+=2,h)throw Sl("parenthesized argument names are invalid",e.range);break}break;case Aa.T_STAR:Nl(0,qa(e,u+1),qa(e,u+1).value,e.range),n=Ml(qa(e,u+1).value),u+=3;break;case Aa.T_DOUBLESTAR:Nl(0,qa(e,u+1),qa(e,u+1).value,e.range),s=Ml(qa(e,u+1).value),u+=3;break;default:throw new Error("unexpected node in varargslist")}return new yl(i,n,s,o)}function jl(t,e,r){Tl(e,Ol.funcdef);const n=Sa(e);let s,i,o,a,u;return 8!==n&&6!==n?(s=qa(e,1),i=Ml(s.value),Nl(0,0,i,e.range),o=Vl(t,qa(e,2))):(s=qa(e,2),i=Ml(s.value),Nl(0,0,i,e.range),o=Vl(t,qa(e,3))),5===n?(a=Pl(t,qa(e,4)),u=null):6===n?(a=Pl(t,qa(e,5)),u=null):7===n?(u=uf(t,qa(e,4)),a=Pl(t,qa(e,6))):8===n?(u=uf(t,qa(e,5)),a=Pl(t,qa(e,7))):Oa(`Was expecting 5, 7 or 8 children, received ${n} children`),new Ec(new xc(i,s.range),o,a,u,r,e.range)}function Wl(t,e,r){const n=e,s=Sa(n);let i,o,a;if(Tl(n,Ol.classdef),5!==s&&8!==s?7===s&&qa(n,4).type===Aa.T_RPAR||(i=qa(n,1),Nl(0,0,i.value,n.range),o=Ml(i.value),a=i.range):(i=qa(n,2),Nl(0,0,i.value,n.range),o=Ml(i.value),a=i.range),4===s)return new qc(new xc(o,a),[],Pl(t,qa(n,3)),r,n.range);7===s&&(qa(n,3).type,Aa.T_RPAR);const u=qa(n,3);if(u.type===Aa.T_RPAR)return new qc(new xc(o,a),[],Pl(t,qa(n,5)),r,n.range);const c=function(t,e){const r=Sa(e);return ba(r>0),Tl(e,Ol.testlist),1===r?[uf(t,qa(e,0))]:Il(t,e)}(t,u),l=Pl(t,qa(n,6));return new qc(new xc(o,a),c,l,r,n.range)}function Jl(t,e){let r,n;return 3===Sa(e)?(r=new yl([],null,null,[]),n=uf(t,qa(e,2))):(r=Vl(t,qa(e,1)),n=uf(t,qa(e,3))),new Yc(r,n,e.range)}function Xl(t,e){function r(t,e){let r=0;for(;;){if(Tl(e,Ol.gen_iter),qa(e,0).type===Ol.gen_for)return r;if(Tl(e=qa(e,0),Ol.gen_if),r++,2===Sa(e))return r;e=qa(e,2)}}ba(e.type===Ol.testlist_gexp||e.type===Ol.argument),ba(Sa(e)>1);const n=uf(t,qa(e,0)),s=function(t,e){let r=0,n=qa(e,1);t:for(;;){if(r++,Tl(n,Ol.gen_for),5!==Sa(n))return r;n=qa(n,4);e:for(;;){if(Tl(n,Ol.gen_iter),n=qa(n,0),n.type===Ol.gen_for)continue t;if(n.type===Ol.gen_if){if(3===Sa(n)){n=qa(n,2);continue e}return r}break}break}throw new Error("logic error in countGenFors")}(0,e),i=[];let o=qa(e,1);for(let e=0;e<s;++e){Tl(o,Ol.gen_for);const n=qa(o,1),s=Bl(t,n,Du);let a,u=uf(t,qa(o,3));if(a=1===Sa(n)?new _l(s[0],u,[]):new _l(new pl(s,Du,o.range),u,[]),5===Sa(o)){o=qa(o,4);const e=r(0,o),n=[];for(let r=0;r<e;++r)Tl(o,Ol.gen_iter),o=qa(o,0),Tl(o,Ol.gen_if),u=uf(t,qa(o,1)),n[r]=u,3===Sa(o)&&(o=qa(o,2));o.type===Ol.gen_iter&&(o=qa(o,0)),a.ifs=n}i[e]=a}return new nl(n,i,e.range)}function Yl(t,e){let r=new Jc(uf(t,qa(e,0)),kl(qa(e,1)),uf(t,qa(e,2)),e.range);const n=(Sa(e)-1)/2;for(let s=1;s<n;++s){const n=qa(e,2*s+1),i=uf(t,qa(e,2*s+2));r=new Jc(r,kl(n),i,n.range)}return r}function tf(t,e){return ba(Sa(e)>0),e.type===Ol.testlist_gexp?Sa(e)>1&&ba(qa(e,1).type!==Ol.gen_for):ba(e.type===Ol.testlist||e.type===Ol.testlist_safe||e.type===Ol.testlist1),1===Sa(e)?uf(t,qa(e,0)):new pl(Il(t,e),Cu,e.range)}function ef(t,e){const r=e;if(Tl(r,Ol.ExprStmt),1===Sa(r))return new Gc(tf(t,qa(r,0)),r.range);if(qa(r,1).type===Ol.augassign){let e=qa(r,0);const n=tf(t,e);switch(n.constructor){case nl:throw Sl("augmented assignment to generator expression not possible",r.range);case sl:throw Sl("augmented assignment to yield expression not possible",r.range);case fl:Nl(0,0,n.id.value,r.range);break;case cl:case ll:break;default:throw Sl("illegal expression for augmented assignment",r.range)}let s;return $l(t,n,Du,e),e=qa(r,2),s=e.type===Ol.testlist?tf(t,e):uf(t,e),new Nc(n,function(t,e){switch(Tl(e,Ol.augassign),(e=qa(e,0)).value.charAt(0)){case"+":return Hu;case"-":return Vu;case"/":return"/"===e.value.charAt(1)?sc:Wu;case"%":return Ju;case"<":return Yu;case">":return tc;case"&":return nc;case"^":return rc;case"|":return ec;case"*":return"*"===e.value.charAt(1)?Xu:ju;default:throw new Error("invalid augassign")}}(0,qa(r,1)),s,r.range)}if(qa(r,1).type===Ol.annasign){const e=qa(r,0),n=qa(r,1),s=uf(t,qa(n,1)),i=qa(n,2);if(i){Tl(i,Aa.T_EQUAL);const o=[tf(t,e)],a=qa(n,3);let u;return u=a.type===Ol.testlist?tf(t,a):uf(t,a),new Ac(o,u,r.range,i.range,s)}return new $c(s,tf(t,e),r.range)}{const e=qa(r,1);Tl(e,Aa.T_EQUAL);const n=[],s=Sa(r);for(let e=0;e<s-2;e+=2){const s=qa(r,e);if(s.type===Ol.YieldExpr)throw Sl("assignment to yield expression not possible",r.range);const i=tf(t,s);$l(t,i,Du,qa(r,e)),n[e/2]=i}const i=qa(r,s-1);let o;return o=i.type===Ol.testlist?tf(t,i):uf(t,i),new Ac(n,o,r.range,e.range)}}function rf(t,e){return ba(5===Sa(e)),new tl(uf(t,qa(e,2)),uf(t,qa(e,0)),uf(t,qa(e,4)),e.range)}function nf(t,e){const r=function(t){return decodeURIComponent(function(t){return encodeURIComponent(t)}(t))};let n=e.charAt(0),s=!1;return"u"===n||"U"===n?n=(e=e.substr(1)).charAt(0):"r"!==n&&"R"!==n||(n=(e=e.substr(1)).charAt(0),s=!0),ba("b"!==n&&"B"!==n,"todo; haven't done b'' strings yet"),ba("'"===n||'"'===n&&e.charAt(e.length-1)===n),(e=e.substr(1,e.length-2)).length>=4&&e.charAt(0)===n&&e.charAt(1)===n&&(ba(e.charAt(e.length-1)===n&&e.charAt(e.length-2)===n),e=e.substr(2,e.length-4)),s||-1===e.indexOf("\\")?Ml(r(e)):Ml(function(t,e){const r=t.length;let n="";for(let e=0;e<r;++e){let r=t.charAt(e);if("\\"===r)if(++e,r=t.charAt(e),"n"===r)n+="\n";else if("\\"===r)n+="\\";else if("t"===r)n+="\t";else if("r"===r)n+="\r";else if("b"===r)n+="\b";else if("f"===r)n+="\f";else if("v"===r)n+="\v";else if("0"===r)n+="\0";else if('"'===r)n+='"';else if("'"===r)n+="'";else if("\n"===r);else if("x"===r){const r=t.charAt(++e),s=t.charAt(++e);n+=String.fromCharCode(parseInt(r+s,16))}else if("u"===r||"U"===r){const r=t.charAt(++e),s=t.charAt(++e),i=t.charAt(++e),o=t.charAt(++e);n+=String.fromCharCode(parseInt(r+s,16),parseInt(i+o,16))}else n+="\\"+r;else n+=r}return n}(e))}function sf(t,e){const r=e;Tl(r,Ol.subscript);let n=qa(r,0),s=null,i=null,o=null;if(n.type===Aa.T_DOT)return new dl;if(1===Sa(r)&&n.type===Ol.IfExpr){const e=uf(t,n);return new wl(e)}if(n.type===Ol.IfExpr&&(s=uf(t,n)),n.type===Aa.T_COLON){if(Sa(r)>1){const e=qa(r,1);e.type===Ol.IfExpr&&(i=uf(t,e))}}else if(Sa(r)>2){const e=qa(r,2);e.type===Ol.IfExpr&&(i=uf(t,e))}return n=qa(r,Sa(r)-1),n.type===Ol.sliceop&&(1===Sa(n)?(n=qa(n,0),o=new fl(new xc("None",null),Cu)):(n=qa(n,1),n.type===Ol.IfExpr&&(o=uf(t,n)))),new ml(s,i,o)}function of(t,e){const r=qa(e,0);switch(r.type){case Aa.T_NAME:return new fl(new xc(r.value,r.range),Cu);case Aa.T_STRING:return new ul(new xc(function(t,e){Tl(qa(e,0),Aa.T_STRING);let r="";for(let t=0;t<Sa(e);++t){const n=qa(e,t);try{r+=nf(0,n.value)}catch(t){throw Sl("invalid string (possibly contains a unicode character)",n.range)}}return r}(0,e),e.range));case Aa.T_NUMBER:return new al(new xc(function(t,e,r){const n=e.charAt(e.length-1);if("j"===n||"J"===n)throw Sl("complex numbers are currently unsupported",r);if(-1!==e.indexOf("."))return Pu(e);let s,i=e,o=10,a=!1;if("-"===e.charAt(0)&&(i=e.substr(1),a=!0),"0"!==i.charAt(0)||"x"!==i.charAt(1)&&"X"!==i.charAt(1)){if(-1!==e.indexOf("e")||-1!==e.indexOf("E"))return Pu(e);if("0"!==i.charAt(0)||"b"!==i.charAt(1)&&"B"!==i.charAt(1))if("0"===i.charAt(0))if("0"===i)s=0;else{if("l"===n||"L"===n)return Uu(e.substr(0,e.length-1),8);o=8,i=i.substring(1),"o"!==i.charAt(0)&&"O"!==i.charAt(0)||(i=i.substring(1)),s=parseInt(i,8)}else{if("l"===n||"L"===n)return Uu(e.substr(0,e.length-1),o);s=parseInt(i,o)}else i=i.substring(2),s=parseInt(i,2),o=2}else i=i.substring(2),s=parseInt(i,16),o=16;return s>El&&Math.floor(s)===s&&-1===e.indexOf("e")&&-1===e.indexOf("E")?Uu(e,0):"l"===n||"L"===n?Uu(e.substr(0,e.length-1),o):Fu(a?-s:s)}(0,r.value,r.range),e.range));case Aa.T_LPAR:{const r=qa(e,1);return r.type===Aa.T_RPAR?new pl([],Cu,e.range):r.type===Ol.YieldExpr?uf(t,r):Sa(r)>1&&qa(r,1).type===Ol.gen_for?Xl(t,r):function(t,e){return ba(e.type===Ol.testlist_gexp||e.type===Ol.argument),Sa(e)>1&&qa(e,1).type===Ol.gen_for?Xl(t,e):tf(t,e)}(t,r)}case Aa.T_LSQB:{const r=qa(e,1);return r.type===Aa.T_RSQB?new hl([],Cu,e.range):(Tl(r,Ol.listmaker),1===Sa(r)||qa(r,1).type===Aa.T_COMMA?new hl(Il(t,r),Cu,e.range):function(t,e){function r(t,e){let r=0;for(;;){if(Tl(e,Ol.list_iter),qa(e,0).type===Ol.list_for)return r;if(Tl(e=qa(e,0),Ol.list_if),r++,2===Sa(e))return r;e=qa(e,2)}}Tl(e,Ol.listmaker),ba(Sa(e)>1);const n=uf(t,qa(e,0)),s=function(t,e){let r=0,n=qa(e,1);t:for(;;){if(r++,Tl(n,Ol.list_for),5!==Sa(n))return r;n=qa(n,4);e:for(;;){if(Tl(n,Ol.list_iter),n=qa(n,0),n.type===Ol.list_for)continue t;if(n.type===Ol.list_if){if(3===Sa(n)){n=qa(n,2);continue e}return r}break}break}throw new Error("TODO: Should this be returning void 0?")}(0,e),i=[];let o=qa(e,1);for(let e=0;e<s;++e){Tl(o,Ol.list_for);const n=qa(o,1),s=Bl(t,n,Du),a=tf(t,qa(o,3));let u;if(u=1===Sa(n)?new _l(s[0],a,[]):new _l(new pl(s,Du,o.range),a,[]),5===Sa(o)){o=qa(o,4);const e=r(0,o),n=[];for(let r=0;r<e;++r)Tl(o,Ol.list_iter),o=qa(o,0),Tl(o,Ol.list_if),n[r]=uf(t,qa(o,1)),3===Sa(o)&&(o=qa(o,2));o.type===Ol.list_iter&&(o=qa(o,0)),u.ifs=n}i[e]=u}return new rl(n,i,e.range)}(t,r))}case Aa.T_LBRACE:{const r=qa(e,1),n=Sa(r),s=[],i=[];for(let e=0;e<n;e+=4)s[e/4]=uf(t,qa(r,e)),i[e/4]=uf(t,qa(r,e+2));return new el(s,i,e.range)}case Aa.T_BACKQUOTE:throw Sl("backquote not supported, use repr()",e.range);default:throw new Error(`unhandled atom '${Ia(r.type)}'`)}}function af(t,e){const r=e;Tl(r,Ol.PowerExpr);const n=Sa(r),s=n-1;let i=of(t,qa(r,0));if(1===n)return i;for(let e=1;e<n;++e){const n=qa(r,e);if(n.type!==Ol.trailer)break;i=Hl(t,n,i)}if(qa(r,s).type===Ol.UnaryExpr){const e=uf(t,qa(r,s));return new Jc(i,kl(qa(r,n-2)),e,r.range)}return i}function uf(t,e){t:for(;;)switch(e.type){case Ol.IfExpr:case Ol.old_test:if(qa(e,0).type===Ol.LambdaExpr||qa(e,0).type===Ol.old_LambdaExpr)return Jl(t,qa(e,0));if(Sa(e)>1)return rf(t,e);case Ol.OrExpr:case Ol.AndExpr:if(1===Sa(e)){e=qa(e,0);continue t}const n=[];for(let r=0;r<Sa(e);r+=2)n[r/2]=uf(t,qa(e,r));return"and"===qa(e,1).value?new Wc(Zu,n,e.range):(ba("or"===qa(e,1).value),new Wc(Gu,n,e.range));case Ol.NotExpr:if(1===Sa(e)){e=qa(e,0);continue t}return new Xc(oc,uf(t,qa(e,1)),e.range);case Ol.ComparisonExpr:if(1===Sa(e)){e=qa(e,0);continue t}{const r=[],n=[];for(let s=1;s<Sa(e);s+=2)r[(s-1)/2]=Rl(0,qa(e,s)),n[(s-1)/2]=uf(t,qa(e,s+1));return new il(uf(t,qa(e,0)),r,n,e.range)}case Ol.ArithmeticExpr:case Ol.GeometricExpr:case Ol.ShiftExpr:case Ol.BitwiseOrExpr:case Ol.BitwiseXorExpr:case Ol.BitwiseAndExpr:if(1===Sa(e)){e=qa(e,0);continue t}return Yl(t,e);case Ol.YieldExpr:let s=null;return 2===Sa(e)&&(s=tf(t,qa(e,1))),new sl(s,e.range);case Ol.UnaryExpr:if(1===Sa(e)){e=qa(e,0);continue t}return Zl(t,e);case Ol.PowerExpr:return af(t,e);default:throw new Error(`unhandled expr: n.type: ${e.type}, n.value: ${e.value}, n.range= ${e.range}, dump=${r=e,function t(e,r){let n="";if(Iu(e.type)){if(n+=r+ka.number2symbol[e.type]+"\n",e.children)for(let s=0;s<e.children.length;++s)n+=t(e.children[s],"  "+r)}else n+=r+Ra[e.type]+": "+e.value+"\n";return n}(r,"")}`)}var r}function cf(t,e){if(e.type===Ol.stmt&&(ba(1===Sa(e)),e=qa(e,0)),e.type===Ol.simple_stmt&&(ba(1===Al(e)),e=qa(e,0)),e.type===Ol.small_stmt)switch(Tl(e,Ol.small_stmt),(e=qa(e,0)).type){case Ol.ExprStmt:return ef(t,e);case Ol.print_stmt:return function(t,e){let r=1,n=null;Tl(e,Ol.print_stmt),Sa(e)>=2&&qa(e,1).type===Aa.T_RIGHTSHIFT&&(n=uf(t,qa(e,2)),r=4);const s=[];for(let n=r,i=0;n<Sa(e);n+=2,++i)s[i]=uf(t,qa(e,n));const i=qa(e,Sa(e)-1).type!==Aa.T_COMMA;return new Lc(n,s,i,e.range)}(t,e);case Ol.del_stmt:return function(t,e){return Tl(e,Ol.del_stmt),new Mc(Bl(t,qa(e,1),Bu),e.range)}(t,e);case Ol.pass_stmt:return new Hc(e.range);case Ol.flow_stmt:return function(t,e){Tl(e,Ol.flow_stmt);const r=qa(e,0);switch(r.type){case Ol.break_stmt:return new Vc(e.range);case Ol.continue_stmt:return new jc(e.range);case Ol.yield_stmt:return new Gc(uf(t,qa(r,0)),e.range);case Ol.return_stmt:return 1===Sa(r)?new Tc(null,e.range):new Tc(tf(t,qa(r,1)),e.range);case Ol.raise_stmt:if(1===Sa(r))return new Fc(null,null,null,e.range);if(2===Sa(r))return new Fc(uf(t,qa(r,1)),null,null,e.range);if(4===Sa(r))return new Fc(uf(t,qa(r,1)),uf(t,qa(r,3)),null,e.range);if(6===Sa(r))return new Fc(uf(t,qa(r,1)),uf(t,qa(r,3)),uf(t,qa(r,5)),e.range);throw new Error("unhandled flow statement");default:throw new Error("unexpected flow_stmt")}}(t,e);case Ol.import_stmt:return Ql(t,e);case Ol.GlobalStmt:return function(t,e){Tl(e,Ol.GlobalStmt);const r=[];for(let t=1;t<Sa(e);t+=2)r[(t-1)/2]=Ml(qa(e,t).value);return new Qc(r,e.range)}(0,e);case Ol.NonLocalStmt:return function(t,e){Tl(e,Ol.NonLocalStmt);const r=[];for(let t=1;t<Sa(e);t+=2)r[(t-1)/2]=Ml(qa(e,t).value);return new Zc(r,e.range)}(0,e);case Ol.exec_stmt:return function(t,e){let r=null,n=null;const s=Sa(e);ba(2===s||4===s||6===s),Tl(e,Ol.exec_stmt);const i=uf(t,qa(e,1));return s>=4&&(r=uf(t,qa(e,3))),6===s&&(n=uf(t,qa(e,5))),new zc(i,r,n,e.range)}(t,e);case Ol.assert_stmt:return function(t,e){if(Tl(e,Ol.assert_stmt),2===Sa(e))return new Dc(uf(t,qa(e,1)),null,e.range);if(4===Sa(e))return new Dc(uf(t,qa(e,1)),uf(t,qa(e,3)),e.range);throw new Error("improper number of parts to assert stmt")}(t,e);default:throw new Error("unhandled small_stmt")}else{const r=qa(e,0);switch(Tl(e,Ol.compound_stmt),r.type){case Ol.if_stmt:return function(t,e){if(Tl(e,Ol.if_stmt),4===Sa(e))return new Ic(uf(t,qa(e,1)),Pl(t,qa(e,3)),[],e.range);const r=qa(e,4).value.charAt(2);if("s"===r)return new Ic(uf(t,qa(e,1)),Pl(t,qa(e,3)),Pl(t,qa(e,6)),e.range);if("i"===r){let r=Sa(e)-4,n=!1,s=[];qa(e,r+1).type===Aa.T_NAME&&"s"===qa(e,r+1).value.charAt(2)&&(n=!0,r-=3),r/=4,n&&(s=[new Ic(uf(t,qa(e,Sa(e)-6)),Pl(t,qa(e,Sa(e)-4)),Pl(t,qa(e,Sa(e)-1)),qa(e,Sa(e)-6).range)],r--);for(let n=0;n<r;++n){const i=5+4*(r-n-1);s=[new Ic(uf(t,qa(e,i)),Pl(t,qa(e,i+2)),s,qa(e,i).range)]}return new Ic(uf(t,qa(e,1)),Pl(t,qa(e,3)),s,e.range)}throw new Error("unexpected token in 'if' statement")}(t,r);case Ol.while_stmt:return function(t,e){if(Tl(e,Ol.while_stmt),4===Sa(e))return new Rc(uf(t,qa(e,1)),Pl(t,qa(e,3)),[],e.range);if(7===Sa(e))return new Rc(uf(t,qa(e,1)),Pl(t,qa(e,3)),Pl(t,qa(e,6)),e.range);throw new Error("wrong number of tokens for 'while' stmt")}(t,r);case Ol.for_stmt:return function(t,e){let r=[];Tl(e,Ol.for_stmt),9===Sa(e)&&(r=Pl(t,qa(e,8)));const n=qa(e,1),s=Bl(t,n,Du);let i;return i=1===Sa(n)?s[0]:new pl(s,Du,e.range),new kc(i,tf(t,qa(e,3)),Pl(t,qa(e,5)),r,e.range)}(t,r);case Ol.try_stmt:return function(t,e){const r=Sa(e);let n=(r-3)/3,s=[],i=null;Tl(e,Ol.try_stmt);let o=Pl(t,qa(e,2));if(qa(e,r-3).type===Aa.T_NAME)"finally"===qa(e,r-3).value?(r>=9&&qa(e,r-6).type===Aa.T_NAME&&(s=Pl(t,qa(e,r-4)),n--),i=Pl(t,qa(e,r-1)),n--):(s=Pl(t,qa(e,r-1)),n--);else if(qa(e,r-3).type!==Ol.except_clause)throw Sl("malformed 'try' statement",e.range);if(n>0){const r=[];for(let s=0;s<n;++s)r[s]=Fl(t,qa(e,3+3*s),qa(e,5+3*s));const a=new Uc(o,r,s,e.range);if(!i)return a;o=[a]}return ba(null!==i),new Cc(o,i,e.range)}(t,r);case Ol.with_stmt:return Dl(t,r);case Ol.funcdef:return jl(t,r,[]);case Ol.classdef:return Wl(t,r,[]);case Ol.decorated:return Cl(t,r);default:throw new Error("unhandled compound_stmt")}}}Ll[Aa.T_DOUBLESTAR]=Xu,Ll[Aa.T_STAR]=ju,Ll[Aa.T_SLASH]=Wu,Ll[Aa.T_PERCENT]=Ju,Ll[Aa.T_PLUS]=Hu,Ll[Aa.T_MINUS]=Vu,Ll[Aa.T_LEFTSHIFT]=Yu,Ll[Aa.T_RIGHTSHIFT]=tc,Ll[Aa.T_AMPER]=nc,Ll[Aa.T_CIRCUMFLEX]=rc,Ll[Aa.T_VBAR]=ec,Ll[Aa.T_DOUBLESLASH]=sc;class lf{constructor(){this.stack=[]}annAssign(t){throw new Error("Method not implemented.")}assign(t){t.targets.forEach((t=>{t.accept(this)})),t.value.accept(this);const e=this.stack.pop(),r=this.stack.pop();this.stack.push(u(Qn,r,e))}attribute(t){throw new Error("Method not implemented.")}binOp(t){t.lhs.accept(this),t.rhs.accept(this);const e=this.stack.pop(),r=this.stack.pop();switch(t.op){case Hu:this.stack.push(u(Re,r,e));break;case Vu:this.stack.push(u(Ie,r,e));break;case ju:this.stack.push(u(Pe,r,e));break;case Wu:this.stack.push(u(Fe,r,e));break;case Xu:this.stack.push(u(Ue,r,e));break;case rc:this.stack.push(u(Ce,r,e));break;case ec:this.stack.push(u(De,r,e));break;case Yu:this.stack.push(u(Ke,r,e));break;case tc:this.stack.push(u(ze,r,e));break;default:throw new Error(JSON.stringify(t,null,2))}}callExpression(t){const e=D(t.func.id?.value),r=[];t.args.forEach((t=>{t.accept(this),r.push(this.stack.pop())})),this.stack.push(u(e,...r))}classDef(t){throw new Error("Method not implemented.")}compareExpression(t){throw new Error("Method not implemented.")}dict(t){throw new Error("Method not implemented.")}expressionStatement(t){t.value.accept(this)}functionDef(t){const e=D(t.name.value),r=[];t.args.args.forEach((t=>{t.name.accept(this),r.push(this.stack.pop())}));const n=[];t.body.forEach((t=>{t.accept(this),n.push(this.stack.pop())}));const s=u(D("lambda"),u(...r),...n);this.stack.push(u(D("define"),e,s))}ifStatement(t){throw new Error("Method not implemented.")}importFrom(t){throw new Error("Method not implemented.")}list(t){const e=[];t.elts.forEach((t=>{t.accept(this),e.push(this.stack.pop())})),this.stack.push(v(e))}module(t){t.body.forEach((t=>{t.accept(this)}))}name(t){t.id.range,t.id.value,this.stack.push(D(t.id.value))}num(t){const e=t.n.value;if(t.n.range.begin,e.isInt())this.stack.push(Ut(e.value));else if(e.isFloat())this.stack.push((new po).parse(e.text,0,0));else{if(!e.isLong())throw new Error;this.stack.push((new mo).parse(e.text,0,0))}}print(t){throw new Error("Method not implemented.")}returnStatement(t){t.value?t.value.accept(this):this.stack.push(c)}str(t){t.s.range;const e=t.s.value;this.stack.push(new se(e,0,0))}subscript(t){t.value.accept(this);const e=this.stack.pop();if(t.slice instanceof dl)throw new Error;if(t.slice instanceof wl){t.slice.value.accept(this);const r=this.stack.pop();this.stack.push(u(He,e,r))}if(t.slice instanceof fl)throw new Error;if(t.slice instanceof ml)throw new Error}unaryOp(t){throw new Error("Method not implemented.")}forStatement(t){throw new Error("Method not implemented.")}}function ff(t,e,r){const n=Ru(e,ku.File);if("object"==typeof n){const t=function(t){const e=new ql("utf-8"),r=[];let n=0;for(let s=0;s<Sa(t)-1;++s){let i=qa(t,s);if(t.type===Aa.T_NEWLINE)continue;Tl(i,Ol.stmt);const o=Al(i);if(1===o)r[n++]=cf(e,i);else{i=qa(i,0),Tl(i,Ol.simple_stmt);for(let t=0;t<o;++t)r[n++]=cf(e,qa(i,2*t))}}return r}(n),e=new Oc(t),r=new lf;e.accept(r);const s=[];for(;r.stack.length>0;)s.push(r.stack.pop());return s.reverse(),{trees:s,errors:[]}}throw new Error}var hf;function pf(t){switch(t){case hf.Native:return"Native";case hf.Python:return"Python";case hf.Scheme:return"Scheme"}}!function(t){t[t.Native=1]="Native",t[t.Python=2]="Python",t[t.Scheme=3]="Scheme"}(hf||(hf={}));const df=[hf.Native,hf.Python,hf.Scheme];function mf(t,e){const{trees:r,errors:n}=gf("",t,e);if(0==n.length){if(r.length>0)return r[0];throw new Error}throw n[1]}function gf(t,e,r){const n=function(t){return t&&t.syntaxKind?t.syntaxKind:hf.Native}(r);switch(n){case hf.Native:return Yo(0,e,function(t){return t?{explicitAssocAdd:t.explicitAssocAdd,explicitAssocMul:t.explicitAssocMul,useCaretForExponentiation:t.useCaretForExponentiation}:{}}(r));case hf.Scheme:return function(t,e,r){const n=new xa(e,r),s=[];let i=!1;for(;!i;){const t=n.value();t===ma?i=!0:s.push(t)}return{trees:s,errors:[]}}(0,e,wf(r));case hf.Python:return ff(0,e,function(t){if(t){if(t.useCaretForExponentiation)throw new Error("useCaretForExponentiation is not supported by the Python parser");return{explicitAssocAdd:t.explicitAssocAdd,explicitAssocMul:t.explicitAssocMul}}}(r));default:throw new Error(`options.syntaxKind ${n} must be one of ${JSON.stringify(df.map(pf).sort())}.`)}}function wf(t){if(t){if(t.useCaretForExponentiation)throw new Error("useCaretForExponentiation is not supported by the Scheme parser");return{lexicon:{"+":Re,"*":Pe,exp:ta,expt:Ue,quote:In,"real?":Dn},explicitAssocAdd:t.explicitAssocAdd,explicitAssocMul:t.explicitAssocMul}}return wf({})}function _f(t,e){return t.multiply(e)}function xf(t,e){return t.divide(e)}function yf(t,e){return t.mod(e)}function vf(t,e){const r=t.divmod(e);return[r.quotient,r.remainder]}function bf(t,e){return t.pow(e)}function Of(t){return t.geq(Number.MIN_SAFE_INTEGER)&&t.leq(Number.MAX_SAFE_INTEGER)}function Ef(t){return re(t)&&t.isInteger()}function Sf(t){let e=NaN;return re(t)?Ef(t)&&Of(t.a)&&(e=t.a.toJSNumber()):it(t)&&Math.floor(t.d)===t.d&&(e=t.d),e}function qf(t){if(void 0===t)throw new Error("expr must be defined.");nr.stack[nr.tos++]=t}function Tf(){if(0===nr.tos)throw new $i("stack underflow");const t=nr.stack[--nr.tos];return nr.stack[nr.tos]=null,t}function Mf(t){for(;t.length>0;)qf(t.shift())}function Af(t){qf(c);for(let e=0;e<t;e++){const t=Tf();qf(a(Tf(),t))}}function Nf(t){return gt(t)}function $f(t,e){if(t.isPositive()){if(e.isNegative())return t.multiply(gt(-1))}else if(e.isPositive())return t.multiply(gt(-1));return t}function Lf(t,e){if(t.isPositive()){if(e<0)return t.multiply(gt(-1))}else if(e>0)return t.multiply(gt(-1));return t}function kf(t){const e=xf(t.a,t.b);return new kt(e,gt.one)}function Rf(t){return re(t)?t.numer():Dt}function If(t){return re(t)?t.denom():Dt}function Pf(t,e){return new kt(gt(t),gt(e))}function Ff(t){return re(t)||it(t)?t.toNumber():0}function Uf(t){return new kt(function(t){let e;if(0===t||1===t)return e=gt(1),e;e=gt(2);let r=gt(0);if(3<=t)for(let n=3;n<=t;n++)r=gt(n),e=_f(e,r);return e}(t),gt.one)}function Cf(t,e){const r=t.car;return!!ue(r)&&r.equalsSym(e)}const Df=z(P.abs);function Bf(t){return f(t)&&Cf(t,Df)}function Kf(t){return f(t)&&function(t){return Cf(t,Re)}(t)}function zf(t){return f(t)&&Cf(t,Pe)}function Qf(t){return f(t)&&Cf(t,Ue)}function Zf(t){return f(t)&&Cf(t,Ve)}function Gf(t){return f(t)&&Cf(t,Ce)}function Hf(t){return!!f(t)&&(!!Cf(t,De)||!!Cf(t,Zr))}function Vf(t){return f(t)&&Cf(t,as)}function jf(t){return f(t)&&Cf(t,gn)}function Wf(t){return!(!ne(t)&&!Is.equals(t))||!!y(t)&&t.everyElement(Wf)}function Jf(t){return Is.equals(t)}const Xf=z(P.E);function Yf(t){if(ue(t))return Xf.equals(t);if(Qf(t)){const e=t.lhs,r=t.rhs;return!(!ne(r)||!r.isOne())&&Yf(e)}return!1}function th(t){return p(p(t))}function eh(t){return p(d(t))}function rh(t){return d(d(t))}function nh(t){return p(p(d(t)))}function sh(t){return p(d(d(t)))}function ih(t){return d(p(d(t)))}function oh(t){return d(d(d(t)))}function ah(t){return p(d(p(d(t))))}function uh(t){return p(d(d(d(t))))}function ch(t){return p(d(d(d(d(t)))))}function lh(t){return!!ue(t)&&Ge.equalsSym(t)}function fh(t,e){e.pushNativeDirective(N.evaluatingAsFloat,!0);try{return e.valueOf(hh(e.valueOf(t),e))}finally{e.popNativeDirective()}}function hh(t,e){e.pushNativeDirective(N.evaluatingAsFloat,!0);try{return ph(t,e)}finally{e.popNativeDirective()}}function ph(t,e){return f(t)?e.valueOf(u(...t.map((function(t){return ph(t,e)})))):y(t)?t.map((function(t){return ph(t,e)})):re(t)?W(t.toNumber()):lh(t)?et:Yf(t)?rt:t}function dh(t,e){return mh(e.valueOf(t.argList.head),e)}function mh(t,e){if(y(t))return t.map((function(t){return mh(t,e)}));if(it(t))return function(t,e){const r=fh(t,e);if(it(r)){const t=r.d,e=t.toString().split(".");if(2===e.length){const r=e[1].length,n=function(t,e){if(isNaN(t))return[0,0];if(t===1/0)return[1,0];if(t===-1/0)return[-1,0];const r=t<0?-1:1;if(t=Math.abs(t),Math.abs(t-Math.floor(t))<e){return[t*r,1]}if(t<1e-19){return[r,1e19]}if(t>1e19){return[1e19*r,1]}let n,s=t,i=0,o=1;for(;;){s=1/(s-Math.floor(s));const r=o;if(o=o*Math.floor(s)+i,i=r,n=Math.floor(t*o+.5),!(Math.abs(t-n/o)>e)||s===Math.floor(s))break}return n*=r,[n,o]}(t,1/Math.pow(10,r));return Pf(n[0],n[1])}return Ut(t)}return u(dr,r)}(t,e);if(f(t)){const r=t.head,n=t.argList;return a(mh(r,e),mh(n,e))}return t}function gh(t){return t=(t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135,t+=t>>8,63&(t+=t>>16)}function wh(t,e){const r=t.bitmap,n=e.bitmap;return r<n?b:r>n?E:O}class _h{constructor(t){}get key(){return"Blade"}get hash(){return ri}get name(){return"BladeExtension"}get dependencies(){return["Blade"]}isImag(t){return!1}isKind(t){return Q(t)}isMinusOne(){return!1}isOne(){return!1}isReal(t){return!1}isScalar(t){return 0===gh(t.bitmap)}isZero(t){return!1}subst(t,e,r){return Q(e)&&t.equals(e)?r:t}toInfixString(t){return t.toInfixString()}toLatexString(t){return t.toLatexString()}toListString(t){return t.toListString()}evaluate(t,e){return this.transform(a(t,e))}transform(t){return Q(t)?[T,t]:[S,t]}valueOf(t){return t}}const xh=new qi((function(t){return new _h(t)}));function yh(t){return Cf(t,Pe)}function vh(t,e){return yh(t)?bh(t.argList,e):0}function bh(t,e){if(h(t))return 0;return e(t.car)?1+bh(t.argList,e):bh(t.argList,e)}function Oh(t){const e=t;if(yh(e)){const t=e.cdr;return h(t)?Dt:h(t.cdr)?t.car:e}return e}function Eh(t){if(f(t)){const e=t;if(yh(e)){const t=e.cdr;if(h(t))return Dt;{const e=t.car;return ne(e)?e:Dt}}return Dt}return Dt}function Sh(t){if(f(t)){const e=t;if(yh(e)){const t=e.cdr;if(h(t))return Dt;if(ne(t.car)){const r=t.cdr;return Oh(a(e.opr,r))}return e}return e}return t}function qh(t,e){return f(t)?yh(t)?Oh(a(t.opr,Th(t.argList,e))):t:e(t)?Dt:t}function Th(t,e){if(h(t))return t;{const r=t.car;return e(r)?Th(t.argList,e):a(r,Th(t.argList,e))}}function Mh(t,e){return t===e?0:t>e?1:-1}function Ah(t){return t instanceof se}class Nh{constructor(t){}get key(){return ie.name}get hash(){return ci}get name(){return"StrExtension"}valueOf(t){return t}isImag(t){return!1}isKind(t){return Ah(t)}isMinusOne(){return!1}isOne(){return!1}isReal(t){return!1}isScalar(t){return!0}isZero(){return!1}subst(t,e,r){return Ah(e)&&t.equals(e)?r:t}toInfixString(t){return t.toInfixString()}toLatexString(t){return t.toInfixString()}toListString(t){return t.toListString()}evaluate(t,e){return this.transform(a(t,e))}transform(t){return Ah(t)?[T,t]:[S,t]}}const $h=new qi((function(t){return new Nh(t)}));function Lh(t,e){let r;if(nr.codeGen||e.getNativeDirective(N.renderFloatAsEcmaScript))return`${t}`;if(e.is_zero(e.getSymbolValue(xs)))r=""+t,r=nr.printMode===Xe?/\d*\.\d*e.*/gm.test(r)?r.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):r.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(r)?r.replace(/e(.*)/gm,"*10^($1)"):r.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)");else{const n=e.getSymbolValue(ys),s=Sf(h(n)?Ut(vs):n);r=t.toFixed(s),r=r.replace(/(\.\d*?[1-9])0+$/gm,"$1"),r=r.replace(/\.0+$/gm,""),-1===r.indexOf(".")&&(r+=".0"),parseFloat(r)!==t&&(r=t.toFixed(s)+"...")}return r}function kh(t){return t instanceof J}class Rh{constructor(t){}get key(){return Y.name}get name(){return"FltExtension"}get dependencies(){return["Flt"]}evaluate(t,e){return this.transform(a(t,e))}transform(t){return[t instanceof J?T:S,t]}isImag(t){return!1}isKind(t){return kh(t)}isMinusOne(t){return t.isMinusOne()}isOne(t){return t.isOne()}isReal(t){return!0}isScalar(t){return!0}isZero(t){return t.isZero()}subst(t,e,r){return kh(e)&&t.equals(e)?r:t}toInfixString(t,e){return Lh(t.d,e)}toLatexString(t,e){return Lh(t.d,e)}toListString(t,e){return Lh(t.d,e)}valueOf(t){return t}}const Ih=new qi((function(t){return new Rh(t)}));function Ph(t,e){if(Mi(t)&&Mi(e))return t.compare(e);const r=(kh(t),t.toNumber()),n=(kh(e),e.toNumber());return r<n?b:r>n?E:O}function Fh(t,e){return lh(t)&&lh(e)?O:lh(t)?b:lh(e)?E:t.compare(e)}function Uh(t,e,r){if(t.ndim<e.ndim)return b;if(t.ndim>e.ndim)return E;const n=t.ndim;for(let r=0;r<n;r++){if(t.dim(r)<e.dim(r))return b;if(t.dim(r)>e.dim(r))return E}const s=t.nelem;for(let r=0;r<s;r++)switch(Ch(t.elem(r),e.elem(r))){case E:return E;case b:return b;default:continue}return O}function Ch(t,e,r){let n=O;if(t===e)return O;if(h(t)&&h(e))return O;if(h(t))return b;if(h(e))return E;if(ne(t)&&ne(e))return Ph(t,e);if(ne(t))return b;if(ne(e))return E;if(ae(t)&&ae(e))return Mh(t.str,e.str);if(ae(t))return b;if(ae(e))return E;if(ue(t)&&ue(e))return Fh(t,e);if(ue(t))return b;if(ue(e))return E;if(y(t)&&y(e))return Uh(t,e);if(y(t))return b;if(y(e))return E;if(Le(t)&&Le(e))return O;if(Le(t))return E;if(Le(e))return b;if(Q(t)&&Q(e))return wh(t,e);if(Q(t))return E;if(Q(e))return b;if(pt(t)&&pt(e))return O;if(pt(t))return E;if(pt(e))return b;for(;f(t)&&f(e);){if(n=Ch(p(t),p(e)),0!==n)return n;t=d(t),e=d(e)}return f(e)?b:f(t)?E:O}function Dh(t){return!!Q(t)||!(!f(t)||!yh(t)||1!==vh(t,Q))}const Bh=t=>!Q(t);function Kh(t){if(Q(t))return t;if(f(t)&&yh(t)&&1===vh(t,Q)){const e=qh(t,Bh);if(Q(e))return e;throw new Error}throw new Error}class zh{compare(t,e,r){switch(function(t,e,r){if(t.equals(e))return O;if(Dh(t)&&Dh(e)){const n=Kh(t),s=Kh(e);if(n.equals(t)&&s.equals(e))return wh(n,s);switch(Qh(n,s,r)){case E:return E;case b:return b;default:return Qh(qh(t,Q),qh(e,Q),r)}}if(Dh(t))return E;if(Dh(e))return b;if(Zh(t)&&Zh(e))return Qh(qh(t,pt),qh(e,pt),r);if(Zh(t))return E;if(Zh(e))return b;if(ne(t)&&ne(e))return O;if(y(t)&&y(e)){if(t.ndim<e.ndim)return b;if(t.ndim>e.ndim)return E;const r=t.ndim;for(let n=0;n<r;n++){if(t.dim(n)<e.dim(n))return b;if(t.dim(n)>e.dim(n))return E}return O}const n=Sh(t),s=Sh(e);return n.equals(t)&&s.equals(e)?Ch(n,s):Qh(n,s,r)}(Sh(t),Sh(e),r)){case E:return E;case b:return b;case O:return Ph(Eh(t),Eh(e))}}}function Qh(t,e,r){return r.compareFn(Re)(t,e)}function Zh(t){return!!pt(t)||!(!f(t)||!yh(t)||1!==vh(t,pt))}class Gh{compare(t,e,r){if(t===e||t.equals(e))return O;if(t===e)return O;if(h(t)&&h(e))return O;if(h(t))return b;if(h(e))return E;if(ne(t)&&ne(e))return Ph(t,e);if(ne(t))return b;if(ne(e))return E;if(pt(t)&&pt(e))return O;if(pt(t))return b;if(pt(e))return E;if(ae(t)&&ae(e))return Mh(t.str,e.str);if(ae(t))return b;if(ae(e))return E;if(ue(t)&&ue(e))return Fh(t,e);if(ue(t))return b;if(ue(e))return E;if(y(t)&&y(e))return Uh(t,e);if(y(t))return b;if(y(e))return E;for(;f(t)&&f(e);){const r=Ch(p(t),p(e));if(r!==O)return r;t=d(t),e=d(e)}return f(t)?b:f(e)?E:Q(t)&&Q(e)?O:Q(t)?b:Q(e)?E:Le(t)&&Le(e)?O:Le(t)?b:Le(e)?E:O}}const Hh=["e=exp(1)","i=sqrt(-1)","pi=tau(1)/2","autoexpand=1","assumeRealVariables=1","last=0","trace=0","forceFixedPrintout=1",`${ys}=${vs}`,"printLeaveEAlone=1","printLeaveXAlone=0"];function Vh(t){const e=nr.codeGen;nr.codeGen=!1;try{for(let e=0;e<Hh.length;e++){jh(Hh[e],t)}}finally{nr.codeGen=e}}function jh(t,e){const r=nr.codeGen;nr.codeGen=!1;try{const[r,n]=qo(t,{useCaretForExponentiation:e.getNativeDirective(N.useCaretForExponentiation),explicitAssocAdd:!1,explicitAssocMul:!1});try{if(r>0){e.pushNativeDirective(N.expand,!0);try{e.valueOf(n)}finally{e.popNativeDirective()}}}catch(e){throw e instanceof Error?new Error(`Unable to compute the value of definition ${JSON.stringify(t)}. Cause: ${e.message}. Stack: ${e.stack}`):new Error(`Unable to compute the value of definition ${JSON.stringify(t)}. Cause: ${e}`)}}finally{nr.codeGen=r}}function Wh(t){return nr.userSimplificationsInListForm=[],nr.userSimplificationsInStringForm=[],t.clearBindings(),Vh(t),c}function Jh(t,e){let r=t.argList;for(;f(r);){const t=p(r);ue(t)?e.remove(t):sr("symbol error"),r=d(r)}return c}function Xh(t){return t.contains(Ls)?Ls:t.contains(ks)?ks:t.contains(Rs)?Rs:t.contains($s)?$s:t.contains(Ns)?Ns:Ls}function Yh(t){return f(t)?[...t].length:0}function tp(t){return(re(t)||!!it(t))&&t.isNegative()}function ep(t){return re(t)?1===Hs(t.a):!!it(t)&&t.d>0}function rp(t){return re(t)?Vs(t.a,2)&&Vs(t.b,1):!!it(t)&&2===t.d}function np(t){return!!ne(t)&&t.isMinusOne()}function sp(t,e){return e.isOne(t)||np(t)}function ip(t){return it(t)?t.d===Math.round(t.d):re(t)?t.isInteger():Ef(t)}function op(t){return!!Ef(t)&&t.isPositiveInteger()}function ap(t,e,r){return null==e&&(e=Xh(t)),function(t,e,r){return function(t,e,r){return zf(t)?t.tail().every((t=>up(t,e))):up(t,e)}(t,e)}(t,e)&&1===function(...t){return t.reduce(((t,e)=>t+Number(e)),0)}(t.contains(Ls),t.contains(ks),t.contains(Rs))?e:c}function up(t,e,r){return Qf(t)?op(sh(t))&&lp(eh(t),e):lp(t,e)}function cp(t,e,r){return!!t.contains(e)&&lp(t,e)}function lp(t,e,r){return Kf(t)?t.tail().every((t=>fp(t,e))):fp(t,e)}function fp(t,e,r){return zf(t)?t.tail().every((t=>hp(t,e))):hp(t,e)}function hp(t,e,r){return!!t.equals(e)||(Qf(t)&&eh(t).equals(e)?op(sh(t)):!t.contains(e))}function pp(t){return!!(Qf(t)&&re(p(d(d(t))))&&tp(p(d(t))))}function dp(t,e){return zf(t)&&3===Yh(t)&&it(eh(t))&&pp(sh(t))||e.equals(t,ht)}function mp(t){if(zf(t)&&3===Yh(t)){if(ne(eh(t))&&sh(t).equals(ht))return!0;if(t.equals(ht))return!0;if(pp(sh(t)))return!0}return!1}function gp(t,e){if(Kf(t)){if(3===Yh(t)){if(ne(eh(t))&&(mp(sh(t))||mp(t)))return!0}}return!1}function wp(t){return Ef(t)&&t.a.isEven()}function _p(t){return re(t)&&t.isFraction()}function xp(t,e){return null!==t&&(re(t)?Vs(t.a,e)&&Vs(t.b,1):!!it(t)&&t.d===e)}function yp(t,e,r){return re(t)?t.numer().isIntegerNumber(e)&&t.denom().isIntegerNumber(r):!!it(t)&&t.d===e/r}function vp(t){return yp(t,1,2)}function bp(t){return yp(t,-1,2)}function Op(t){return Qf(t)&&xp(eh(t),2)&&yp(sh(t),-1,2)}function Ep(t){return zf(t)&&xp(eh(t),-1)&&Op(sh(t))&&3===Yh(t)}function Sp(t){return zf(t)&&vp(eh(t))&&Tp(sh(t))&&3===Yh(t)}function qp(t){return zf(t)&&bp(eh(t))&&Tp(sh(t))&&3===Yh(t)}function Tp(t){return Qf(t)&&xp(eh(t),3)&&vp(sh(t))}function Mp(t){return!(!it(t)&&!sn.equals(t))||!!f(t)&&[...t].some(Mp)}function Ap(t,e){const r=new Array(t);for(let n=0;n<t;n++)r[n]=e;return r}function Np(t,e,r){const n=Ap(t*t,r);for(let r=0;r<t;r++)n[t*r+r]=e;return n}function $p(t,e,r){const n=r.negate(e);return r.add(t,n)}function Lp(t,e){const r=e.valueOf(t);return ne(r)?function(t){if(t.isZero())throw new Error("divide by zero");if(it(t))return t.inv();if(re(t))return t.inv();throw new Error}(r):e.valueOf(u(Ue,r,Jt))}function kp(t,e,r){if(ne(t)&&ne(e))return function(t,e){if(re(t)&&re(e))return t.div(e);if(e.isZero())throw new Error("divide by zero");return W((it(t)?t.d:t.toNumber())/(it(e)?e.d:e.toNumber()))}(t,e);{const n=Lp(e,r);return r.multiply(t,n)}}function Rp(t,e,r){r.pushNativeDirective(N.expand,!0);try{return kp(t,e,r)}finally{r.popNativeDirective()}}function Ip(t,e,r){return function(t,e,r){if(Kf(t))return function(t,e,r){return t.tail().reduce(((t,n)=>r.add(t,Ip(n,e,r))),Yt)}(t,e,r);if(y(t))return function(t,e,r){return t.map((t=>Ip(t,e,r)))}(t,e,r);if(t.contains(e))return Yt;return t}(t,e,r)}function Pp(t){return 3===t.length}function Fp(t){return function(e){return Cf(e,t)&&Pp(e)}}function Up(t){return Fp(Pe)(t)}function Cp(t,e,r,n){if(t.equals(e))return r;if(f(t)){const s=t.car,i=t.cdr,o=s.contains(e),u=i.contains(e);if(o){const t=Cp(s,e,r,n);if(u){return a(t,Cp(i,e,r,n))}return a(t,i)}if(u){return a(s,Cp(i,e,r,n))}return t}return n.operatorFor(t).subst(t,e,r)}function Dp(t,e,r){const n=[];let s=t;let i=0;for(;;){const t=Cp(s,e,Yt,r),o=r.valueOf(t);if(n.push(o),s=s.equals(o)?Yt:r.valueOf($p(s,o,r)),s.equals(Yt))return n;if(s.equals(e)?s=Dt:f(s)&&Bp(s,e)?s=s.lhs:(s=Rp(s,e,r),s=r.valueOf(s)),i++,i>10)throw new Error("No making progress computing coefficients.")}}function Bp(t,e){return!!Up(t)&&t.rhs.equals(e)}function Kp(t,e){return u(pn,t)}function zp(t,e){const r=e.negate(ht),n=Cp(t,ht,r,e);return e.valueOf(n)}const Qp=z(P.exp),Zp=z(P.log),Gp=z(P.multiply),Hp=z(P.real);function Vp(t,e,r){const n=r.valueOf(u(Zp,t)),s=r.valueOf(u(Gp,e,n)),i=r.valueOf(u(Hp,s));return r.valueOf(u(Qp,i))}const jp=z(P.log),Wp=z(P.multiply),Jp=z(P.imag);function Xp(t,e,r){const n=r.valueOf(u(jp,t)),s=r.valueOf(u(Wp,e,n));return r.valueOf(u(Jp,s))}const Yp=z(P.add),td=z(P.cos),ed=z(P.exp),rd=z(P.imag),nd=z(P.multiply),sd=z(P.pow),id=z(P.real);function od(t,e){const r=function(t,e){return t};if(e.is_real(t))return r(t);if(re(t))return t;if(ue(t)){const r=e.getSymbolValue(_s);return re(r)&&r.isOne()?t:u(id,t)}if(Kf(t)){const n=t.argList.map((function(t){return od(t,e)}));return r(e.valueOf(a(Yp,n)))}if(Qf(t)){const n=t.lhs,s=t.rhs;if(n.contains(ht)){if(re(s)&&s.isInteger()&&s.isNegative()){const t=zp(n,e),i=e.valueOf(u(sd,n,s.succ())),o=e.valueOf(t),a=kp(e.valueOf(u(nd,i,o)),e.valueOf(u(nd,n,t)),e);return r(e.valueOf(u(id,a)))}throw new Error("Power")}{const t=Vp(n,s,e),i=Xp(n,s,e),o=e.valueOf(u(td,i));return r(e.valueOf(u(nd,t,o)))}}if(zf(t)){const r=[],n=[];[...t.argList].forEach((function(t){if(e.is_real(t))r.push(t);else if(ue(t)){const e=u(id,t),r=u(rd,t),s=u(nd,ht,r),i=u(Yp,e,s);n.push(i)}else if(t.equals(ht))n.push(t);else if(Qf(t)){const s=t.lhs,i=t.rhs;if(re(i)&&i.isMinusOne()){const t=e.conj(s),r=e.valueOf(u(nd,t,s)),i=e.valueOf(u(sd,r,Jt)),o=e.multiply(t,i);n.push(o)}else{const t=Vp(s,i,e),o=Xp(s,i,e),a=e.valueOf(u(nd,ht,o)),c=e.valueOf(u(ed,a));r.push(t),n.push(c)}}else{if(!f(t)||!ue(t.opr))throw new Error(e.toSExprString(t));n.push(t)}}));const s=ad(r,e),i=ad(n,e),o=e.valueOf(u(id,i));return e.valueOf(u(nd,s,o))}return t.equals(ht)?Yt:r(t)}function ad(t,e){return t.length>1?e.valueOf(u(nd,...t)):1===t.length?e.valueOf(t[0]):Dt}const ud=101,cd=1e-6,ld=1e-9;function fd(t){return Math.sqrt(t.r*t.r+t.i*t.i)}function hd(){return 4*Math.random()-2}class pd{constructor(){this.r=0,this.i=0}}const dd=new pd,md=new pd,gd=new pd,wd=new pd,_d=new pd,xd=new pd,yd=new pd,vd=new pd,bd=[];for(let t=0;t<ud;t++)bd[t]=new pd;function Od(t,e){let r=e.valueOf(sh(t)),n=e.valueOf(eh(t));r=h(r)?Xh(n):r,cp(n,r)||sr(`nroots: Polynomial ${e.toInfixString(n)} in variable ${e.toInfixString(r)} must be in expanded form.`);const s=nr.tos,i=Dp(n,r,e);let o=i.length;o>ud&&sr("nroots: degree?");for(let t=0;t<o;t++)n=e.valueOf(hh(od(i[t],e),e)),r=e.valueOf(hh(Kp(i[t]),e)),it(n)&&it(r)||sr("nroots: coefficients?"),bd[t].r=n.d,bd[t].i=r.d;!function(t){wd.r=bd[t-1].r,wd.i=bd[t-1].i;const e=wd.r*wd.r+wd.i*wd.i;for(let r=0;r<t-1;r++)bd[r].r=(bd[r].r*wd.r+bd[r].i*wd.i)/e,bd[r].i=(bd[r].i*wd.r-bd[r].r*wd.i)/e;bd[t-1].r=1,bd[t-1].i=0}(o);for(let t=o;t>1;t--)Ed(t),Math.abs(dd.r)<cd&&(dd.r=0),Math.abs(dd.i)<cd&&(dd.i=0),qf(e.add(W(dd.r),e.multiply(W(dd.i),ht))),qd(t);if(o=nr.tos-s,o>1){!function(t,e){const r=nr.tos-t,n=nr.stack.slice(r,r+t);n.sort((function(t,r){return Qh(t,r,e)})),nr.stack=nr.stack.slice(0,r).concat(n).concat(nr.stack.slice(r+t))}(o,e);const t=[o],r=nr.stack.slice(s,s+o);ir(s),qf(new x(t,r))}return Tf()}function Ed(t){if(fd(bd[0])<cd)return dd.r=0,void(dd.i=0);for(let e=0;e<100;e++){dd.r=hd(),dd.i=hd(),Sd(t),md.r=dd.r,md.i=dd.i,xd.r=_d.r,xd.i=_d.i,dd.r=hd(),dd.i=hd();for(let e=0;e<1e3;e++){Sd(t);if(fd(_d)<ld)return;fd(_d)<fd(xd)&&(gd.r=dd.r,gd.i=dd.i,dd.r=md.r,dd.i=md.i,md.r=gd.r,md.i=gd.i,gd.r=_d.r,gd.i=_d.i,_d.r=xd.r,_d.i=xd.i,xd.r=gd.r,xd.i=gd.i),yd.r=md.r-dd.r,yd.i=md.i-dd.i,vd.r=xd.r-_d.r,vd.i=xd.i-_d.i;const e=vd.r*vd.r+vd.i*vd.i;if(0===e)break;wd.r=(yd.r*vd.r+yd.i*vd.i)/e,wd.i=(yd.i*vd.r-yd.r*vd.i)/e,dd.r=md.r-(wd.r*xd.r-wd.i*xd.i),dd.i=md.i-(wd.r*xd.i+wd.i*xd.r)}}sr("nroots: convergence error")}function Sd(t){gd.r=dd.r,gd.i=dd.i,_d.r=bd[0].r+bd[1].r*gd.r-bd[1].i*gd.i,_d.i=bd[0].i+bd[1].r*gd.i+bd[1].i*gd.r;for(let e=2;e<t;e++){const t=dd.r*gd.r-dd.i*gd.i;gd.i=dd.r*gd.i+dd.i*gd.r,gd.r=t,_d.r+=bd[e].r*gd.r-bd[e].i*gd.i,_d.i+=bd[e].r*gd.i+bd[e].i*gd.r}}function qd(t){for(let e=t-1;e>0;e--)bd[e-1].r+=bd[e].r*dd.r-bd[e].i*dd.i,bd[e-1].i+=bd[e].i*dd.r+bd[e].r*dd.i;fd(bd[0])>cd&&sr("nroots: residual error");for(let e=0;e<t-1;e++)bd[e].r=bd[e+1].r,bd[e].i=bd[e+1].i}function Td(t,e){if(e>0){const r=t.argList;return f(r)?Td(r,e-1):r}return t.car}function Md(t,e){return Ph(t,e)===b}function Ad(t,e){return e.power(z(P.E),t)}function Nd(t){return tp(t)||zf(t)&&tp(eh(t))}function $d(t){return Kf(t)&&Nd(eh(t))||Nd(t)}function Ld(t,e,r){if(pt(t))return!1;if(Qf(t)&&!Ef(sh(e))&&eh(t).contains(ht))return!0;if(Qf(t)&&xp(eh(t),-1)&&!Ef(sh(e)))return!0;if(y(t)){for(let r=0;r<t.nelem;r++)if(Ld(t.elem(r),e))return!0;return!1}return!!f(t)&&[...t].some((t=>Ld(t,e)))}function kd(t,e){if(f(t)){if(Qf(t)){const e=t.cdr;if(f(e)){if(Yf(e.car)){const t=e.argList;if(f(t)){return t.car.contains(ht)}}}}return[...t].some((function(t){return kd(t)}))}if(y(t)){for(let e=0;e<t.nelem;e++)if(kd(t.elem(e)))return!0;return!1}return!1}function Rd(...t){return u(...t)}function Id(t,e){if(re(t)){if(re(e))return t.mul(e);return W(t.toNumber()*e.d)}if(re(e)){return W(t.d*e.toNumber())}return t.mul(e)}function Pd(t,e){if(re(t)){if(re(e))return t.add(e);return W(t.toNumber()+e.d)}if(re(e)){return W(t.d+e.toNumber())}return t.add(e)}function Fd(t,e){const r=function(t,e){const r=t.map((function(t,e){return{value:t,index:e}})),n=e.compareFn(Re);r.sort((function(t,e){return n(t.value,e.value)}));const s=r.map((function(t){return t.value}));return s}(t,e);return function(t,e){let r=0,n=Yt;for(;r<t.length-1;){const s=t[r],i=t[r+1];if(y(s)&&y(i)){const n=e.add(s,i);c!==n&&(t.splice(r,2,n),r--),r++;continue}if(y(s)||y(i)){r++;continue}if(ne(s)&&ne(i)){const o=Pd(s,i);e.is_zero(o)?(n=Id(n,o),t.splice(r,2)):t.splice(r,2,o),r--,r++;continue}if(ne(s)||ne(i)){r++;continue}const o=Ud(s),u=o.denorm,l=o.lhs,f=o.rhs,h=Ud(i),p=h.lhs,d=h.rhs;if(!e.equals(f,d)){r++;continue}const m=Pd(l,p);if(e.is_zero(m)){t.splice(r,2),r--,r++;continue}const g=f,w=u?a(Pe,g):g,_=e.multiply(m,w);t.splice(r,2,_),r--,r++}return t.length>0?t.length>1?a(Re,Rd(...t)):t[0]:n}(r,e)}function Ud(t){if(f(t)&&zf(t)){const e=t.cdr,r=p(e);if(ne(r)){const t=d(e),n=d(t);if(c===n){return{denorm:!1,lhs:r,rhs:p(t)}}return{denorm:!0,lhs:r,rhs:t}}return{denorm:!0,lhs:Dt,rhs:e}}return{denorm:!1,lhs:Dt,rhs:t}}function Cd(t,e,r){if(f(e)&&Kf(e)){e.tail().forEach((function(e){Cd(t,e,r)}))}else r.is_zero(e)?r.getNativeDirective(N.keepZeroTermsInSums)&&t.push(e):t.push(e)}function Dd(t,e){const r=[];for(const n of t)Cd(r,n,e);return Fd(r,e)}function Bd(t,e,r,n){const s=u(t,e,r);return n.valueOf(s)}function Kd(t,e,r){return Bd(Pe,t,e,r)}function zd(t,e,r){return function(t,e,r,n){n.pushNativeDirective(N.expand,!1);try{return t(e,r,n)}finally{n.popNativeDirective()}}(Kd,t,e,r)}function Qd(t,e){if(t.length>1){let r=t[0];for(let n=1;n<t.length;n++)r=e.multiply(r,t[n]);return r}return 1===t.length?t[0]:Dt}function Zd(t,e){e.pushNativeDirective(N.factor,!0);try{return Qd(t,e)}finally{e.popNativeDirective()}}function Gd(t,e,r){return cr(Hd,t,e,r)}function Hd(t,e,r){if(t.equals(e))return t;if(re(t)&&re(e))return t.gcd(e);const n=Vd(t,e);return n?function(t,e,r,n){t=n.factorize(t,r),e=n.factorize(e,r),(zf(t)||zf(e))&&(zf(t)||(t=Rd(bn,t,Dt)),zf(e)||(e=Rd(bn,e,Dt)));if(zf(t)&&zf(e))return jd(t,e,n);return Wd(t,e,n)}(t,e,n,r):Kf(t)&&Kf(e)?function(t,e,r){if(Yh(t)!==Yh(e))return Dt;const n=f(t)?t.tail().reduce((function(t,e){return Gd(t,e,r)})):p(d(t)),s=f(e)?e.tail().reduce((function(t,e){return Gd(t,e,r)})):p(d(e)),i=kp(t,n,r),o=kp(e,s,r);if(i.equals(o))return r.multiply(i,Gd(n,s,r));return Dt}(t,e,r):(Kf(t)&&(t=Jd(t,r)),Kf(e)&&(e=Jd(e,r)),zf(t)?function(t,e,r){return f(t)?t.tail().reduce(((t,n)=>r.multiply(t,Gd(n,e,r))),Dt):Dt}(t,e,r):zf(e)?function(t,e,r){return f(e)?e.tail().reduce(((e,n)=>r.multiply(e,Gd(t,n,r))),Dt):Dt}(t,e,r):zf(t)&&zf(e)?jd(t,e,r):Wd(t,e,r))}function Vd(t,e,r){const n=ap(t,null);if(n&&ap(e,n))return n}function jd(t,e,r){const n=d(t),s=d(e);if(f(n))return[...n].reduce(((t,e)=>{if(f(s))return r.multiply(t,[...s].reduce(((t,n)=>r.multiply(t,Gd(e,n,r))),Dt));throw new Error}),Dt);throw new Error}function Wd(t,e,r){let n,s;if(Qf(t)?(n=sh(t),t=eh(t)):n=Dt,Qf(e)?(s=sh(e),e=eh(e)):s=Dt,!t.equals(e))return Dt;if(ne(n)&&ne(s)){const e=Ph(n,s)<0?n:s;return r.power(t,e)}if(ne(kp(n,s,r))){const e=eh(n),i=zf(n)&&ne(e)?e:Dt,o=eh(s),a=Ph(i,zf(s)&&ne(o)?o:Dt)<0?n:s;return r.power(t,a)}const i=r.subtract(n,s);if(!ne(i))return Dt;const o=tp(i)?n:s;return r.power(t,o)}function Jd(t,e){return f(t)?t.tail().reduce((function(t,r){return Gd(t,r,e)})):p(d(t))}function Xd(t,e){return ar(Yd,t,e)}function Yd(t,e){if(!Kf(t))return t;const r=Lp(t.tail().reduce((function(t,r){return Gd(t,r,e)})),e);return kp(function(t,e){return ur((function(t){return e.valueOf(t)}),t,e)}(t.tail().reduce(((t,n)=>e.add(t,zd(r,n,e))),Yt),e),r,e)}function tm(t,e){return fh(e.valueOf(Hm(e.valueOf(t),e)),e)}const em=z(P.test_eq);function rm(t,e,r){const n=Dp(t,e,r);n.forEach((function(t){}));const s=n[n.length-1];return n.map((t=>kp(t,s,r)))}function nm(t,e,r){if(nr.recursionLevelNestedRadicalsRemoval>1)return new x([],[]);const n=rm(t,e,r);n.forEach((function(t){}));const s=[];if(function(t,e){return!(t.length<=2)&&!e.is_zero(t[0])&&t.slice(1,t.length-1).every((t=>e.is_zero(t)))}(n,r)){const t=n.length,e=n[0],i=function(t,e,r,n){t-=1;const s=kp(n.power(r,Pf(1,t)),n.power(e,Pf(1,t)),n),i=[];if(t%2==0){for(let e=1;e<=t;e+=2){const r=n.multiply(s,n.power(Jt,Pf(e,t)));i.push(r),i.push(n.negate(r))}return i}for(let e=1;e<=t;e++){let r=n.multiply(s,n.power(Jt,Pf(e,t)));e%2==0&&(r=n.negate(r)),i.push(r)}return i}(t,n.pop(),e,r);s.push(...i)}else{const n=function(t,e,r){const n=rm(t,e,r);if(n.some((t=>gp(t)))){if(zf(t)){const n=t.tail().map((t=>sm(t,e,r)));return n.flat()}return sm(t,e,r)}{const n=r.factorize(t,e);if(zf(n)){return n.tail().map((t=>sm(t,e,r))).flat()}return sm(n,e,r)}}(t,e,r);s.push(...n)}const i=s.length;if(0===i&&sr("roots: the polynomial is not factorable, try nroots"),1===i)return new x([1],s);s.sort((function(t,e){return Ch(t,e)}));return new x([i],s)}function sm(t,e,r){if(Qf(t)&&cp(eh(t),e)&&op(sh(t))){return im(rm(eh(t),e,r),r)}if(cp(t,e)){return im(rm(t,e,r),r)}return[]}function im(t,e){t.forEach((function(t){}));const r=t.length;if(2===r){return function(t,e,r){return[r.negate(kp(e,t,r))]}(t.pop(),t.pop(),e)}if(3===r){return function(t,e,r,n){const s=n.power(n.subtract(n.power(e,Bt),n.multiply(n.multiply(zt,t),r)),te),i=kp(n.subtract(s,e),n.multiply(t,Bt),n),o=n.multiply(kp(n.negate(n.add(s,e)),t,n),te);return[i,o]}(t.pop(),t.pop(),t.pop(),e)}if(4===r){return function(t,e,r,n,s){const i=s.multiply(s.multiply(r,r),r),o=s.multiply(e,e),a=s.multiply(o,e),u=s.multiply(s.multiply(a,n),Xt),l=s.multiply(a,Bt),f=s.multiply(Kt,t),h=s.multiply(s.multiply(t,t),n),p=s.multiply(h,Ut(27)),d=s.multiply(s.multiply(h,n),Ut(-27)),m=s.multiply(s.multiply(t,r),e),g=s.multiply(s.multiply(t,r),Kt),w=s.multiply(Xt,s.multiply(t,i)),_=s.negate(s.multiply(m,Vt)),x=s.multiply(s.multiply(m,n),Ut(18)),y=s.subtract(o,g),v=s.multiply(o,s.multiply(r,r)),b=kp(s.negate(e),f,s),O=s.multiply(s.power(y,Kt),zt),E=tm(Dm(y,s),s),S=tm(Dm(Dd([x,u,v,w,d],s),s),s),q=Dd([l,_,p],s),T=Dm(s.power(s.subtract(s.power(q,Bt),O),te),s);if(s.is_zero(S)){return function(t,e,r,n,s,i){const{R_DELTA0_toBeCheckedIfZero:o,R_m_b_over_3a:a,R_DELTA0:u,R_b3:c,R_a_b_c:l}=s;if(i.is_zero(o))return[a];const f=kp(i.subtract(i.multiply(t,i.multiply(n,Vt)),i.multiply(e,r)),i.multiply(u,Bt),i),h=i.negate(c),p=i.negate(i.multiply(t,i.multiply(t,i.multiply(n,Vt)))),d=i.multiply(l,zt),m=kp(Dd([d,p,h],i),i.multiply(t,u),i);return[f,f,m]}(t,e,r,n,{R_DELTA0_toBeCheckedIfZero:E,R_m_b_over_3a:b,R_DELTA0:y,R_b3:a,R_a_b_c:m},s)}let M=!1,A=!1,N=c;for(;!M;){const t=A?s.negate(T):T;N=Dm(s.power(s.multiply(s.add(t,q),te),ee),s);const e=tm(Dm(N,s),s);s.is_zero(e)?A=!0:M=!0}const $=s.multiply(s.multiply(N,f),Bt),L=s.multiply(ht,s.power(Kt,te)),k=s.add(Dt,L),R=s.subtract(Dt,L),I=kp(N,f,s),P=b,F=s.negate(I),U=s.negate(kp(y,s.multiply(N,f),s)),C=Dm(Dd([P,F,U],s),s),D=b,B=kp(s.multiply(I,k),Bt,s),K=kp(s.multiply(R,y),$,s),z=Dm(Dd([D,B,K],s),s),Q=b,Z=kp(s.multiply(I,R),Bt,s),G=kp(s.multiply(k,y),$,s),H=Dm(Dd([Q,Z,G],s),s);return[C,z,H]}(t.pop(),t.pop(),t.pop(),t.pop(),e)}if(5===r){return function(t,e,r,n,s,i){if(i.is_zero(e)&&i.is_zero(n)&&!i.is_zero(r)&&!i.is_zero(s))return function(t,e,r,n,s,i){const o=nm(i.add(i.multiply(t,i.power(Ss,Bt)),i.add(i.multiply(r,Ss),s)),Ss,i),a=[];for(const t of o.copyElements())a.push(Dm(i.power(t,te),i)),a.push(Dm(i.negate(i.power(t,te)),i));return a}(t,0,r,0,s,i);return i.is_zero(e)?function(t,e,r,n,s,i){const o=r,a=n,u=s,l=i.multiply(Pf(5,2),o),f=i.subtract(i.multiply(Bt,i.power(o,Bt)),u),h=i.add(i.multiply(Pf(-1,2),i.multiply(o,u)),i.add(kp(i.power(o,Kt),Bt,i),i.multiply(Pf(-1,8),i.power(a,Bt)))),p=i.add(i.power(Ss,Kt),i.add(i.multiply(l,i.power(Ss,Bt)),i.add(i.multiply(f,Ss),h))),d=nm(p,Ss,i);let m=c;for(const t of d.copyElements()){const e=tm(i.add(i.multiply(t,Bt),o),i);if(!i.is_zero(e)){m=t;break}}const g=Dm(i.power(i.add(i.multiply(m,Bt),o),te),i),w=Dm(kp(i.multiply(a,Bt),g,i),i),_=i.add(i.multiply(o,Kt),i.multiply(m,Bt)),x=Dm(i.power(i.negate(i.add(_,w)),te),i),y=kp(i.add(g,x),Bt,i),v=Dm(i.power(i.negate(i.add(_,w)),te),i),b=kp(i.subtract(g,v),Bt,i),O=Dm(i.power(i.negate(i.subtract(_,w)),te),i),E=kp(i.add(i.negate(g),O),Bt,i),S=Dm(i.power(i.negate(i.subtract(_,w)),te),i),q=kp(i.subtract(i.negate(g),S),Bt,i);return[y,b,E,q]}(0,0,r,n,s,i):function(t,e,r,n,s,i){const o=kp(i.add(i.multiply(Ht,i.multiply(r,t)),i.multiply(Ut(-3),i.power(e,Bt))),i.multiply(Ht,i.power(t,Bt)),i),a=kp(i.add(i.power(e,Kt),i.add(i.multiply(Xt,i.multiply(t,i.multiply(e,r))),i.multiply(Ht,i.multiply(n,i.power(t,Bt))))),i.multiply(Ht,i.power(t,Kt)),i),u=i.multiply(i.multiply(t,t),t),c=i.multiply(e,e),l=i.multiply(i.multiply(t,t),n),f=kp(i.add(i.multiply(i.power(e,zt),Ut(-3)),i.add(i.multiply(Ut(256),i.multiply(u,s)),i.add(i.multiply(Ut(-64),i.multiply(l,e)),i.multiply(Ut(16),i.multiply(c,i.multiply(t,r)))))),i.multiply(Ut(256),i.power(t,zt)),i),h=i.power(Ss,zt),p=i.multiply(o,i.power(Ss,Bt)),d=i.multiply(a,Ss),m=Dm(Dd([h,p,d,f],i),i),g=nm(m,Ss,i);return g.mapElements((r=>Dm(i.subtract(r,kp(e,i.multiply(zt,t),i)),i)))}(t,e,r,n,s,i)}(t.pop(),t.pop(),t.pop(),t.pop(),t.pop(),e)}return[]}const om=t=>t.reduce(((t,e)=>t+e),0);function am(t){let e;if(f(t)){const r=[...t];e=om(r.map(am))+r.length}else e=1;return e}function um(t,e,r){let n=0;return f(e)?n=om([...e].map((e=>um(t,e,r)))):r.equals(t,e)&&(n=1),n}function cm(t){const e=Sf(t);return e<0||isNaN(e)?Rd(nn,t):Uf(e)}function lm(t,e){if(Kf(t)){return Dd(t.tail().map((function(t){return fm(t,e)})),e)}return fm(t,e)}function fm(t,e){if(!zf(t))return t;const r=t.tail();for(;hm(r,e););return Zd(r,e)}function hm(t,e){for(let r=0;r<t.length;r++){const n=t[r];for(let s=0;s<t.length;s++){if(r===s)continue;const i=t[s];if(Zf(n)&&Qf(i)&&np(sh(i))&&e.equals(eh(n),eh(i)))return t[r]=cm(e.subtract(eh(n),Dt)),t[s]=Dt,!0;if(Qf(i)&&np(sh(i))&&nh(i).equals(nn)&&e.equals(n,ah(i)))return t[r]=Lp(cm(e.add(n,Jt)),e),t[s]=Dt,!0;if(Zf(i)){const o=e.subtract(n,eh(i));if(e.isOne(o))return t[r]=cm(n),t[s]=Dt,!0}if(Qf(n)&&np(sh(n))&&Qf(i)&&np(sh(i))&&nh(i).equals(nn)){const o=e.subtract(eh(n),eh(eh(i)));if(e.isOne(o))return t[r]=Lp(cm(eh(n)),e),t[s]=Dt,!0}if(Zf(n)&&Qf(i)&&np(sh(i))&&nh(i).equals(nn)){const o=e.subtract(eh(n),eh(eh(i)));if(e.isOne(o))return t[r]=eh(n),t[s]=Dt,!0;if(np(o))return t[r]=Lp(eh(eh(i)),e),t[s]=Dt,!0;if(xp(o,2))return t[r]=eh(n),t[s]=e.add(eh(n),Jt),!0;if(xp(o,-2))return t[r]=Lp(eh(eh(i)),e),t[s]=Lp(e.add(eh(eh(i)),Jt),e),!0}}}return!1}function pm(t,e){e.pushNativeDirective(N.evaluatingAsClock,!0);try{const r=e.arg(t),n=lr.Pi(e),s=u($n,Jt,kp(r,n,e)),i=Hm(t,e);return e.multiply(i,s)}finally{e.popNativeDirective()}}function dm(t,e){e.pushNativeDirective(N.factor,!0);try{return function(t,e){if(y(t))return function(t,e){if(!y(t))return t;const r=t.mapElements((function(t){return dm(t,e)}));return t.withElements(r)}(t,e);if(!Kf(t))return t;const r=function(t,e){if(Kf(t))return t.tail().reduce(((t,r)=>mm(r,t,e)),Dt);return mm(t,Dt,e)}(t,e);let n=Yt;f(t)&&(n=t.tail().reduce(((t,n)=>e.add(t,e.multiply(r,n))),n));const s=Xd(n,e),i=kp(s,r,e);return i}(t,e)}finally{e.popNativeDirective()}}function mm(t,e,r){return zf(t)?t.tail().reduce(((t,e)=>gm(e,t,r)),e):gm(t,e,r)}function gm(t,e,r){if(!Qf(t))return e;const n=t;return tp(t=sh(t))||zf(t)&&tp(eh(t))?wm(e,Lp(n,r),r):e}function wm(t,e,r){return kp(r.multiply(t,e),Gd(t,e,r),r)}function _m(t,e){if(Kf(t)&&(t=dm(t,e)),f(t)){const r=t.cdr;if(zf(t)&&!e.isOne(p(r))){const r=function(t,e){const r=function(t){return function(e){return _m(e,t)}}(e),n=t.map(r);return n}(t.tail(),e);return Qd(r,e)}}return re(t)?If(t):Qf(t)&&$d(sh(t))?Lp(t,e):Dt}function xm(t,e){return gt.gcd(t,e)}function ym(t){return t.isProbablePrime()}function vm(t,e){return t.compare(e)}let bm=gt(0);function Om(t){if(xp(t,0)||xp(t,1)||xp(t,-1))return t;bm=t.a;const e=function(){const t=[];bm.isNegative()&&(bm=Lf(bm,1),t.push(Jt));for(let e=0;e<1e4;e++)if(t.push(...Em(e)),0===bm.compare(1))return t;return t.push(...function(){const t=[],e=Nf(1);let r=Nf(5),n=Nf(2),s=1,i=1;for(;;){if(ym(bm))return t.push(Sm(bm,1)),t;for(;;){let o=n.subtract(r);o=Lf(o,1);const a=xm(o,bm);if(!a.equals(1)){if(t.push(Sm(a,1)),0===vm(a,bm))return t;o=xf(bm,a),bm=o,o=yf(r,bm),r=o,o=yf(n,bm),n=o;break}0==--s&&(n=r,i*=2,s=i),o=_f(r,r),r=o.add(e),o=yf(r,bm),r=o}}}()),t}();return e.length,1===e.length?e[0]:e.length>1?a(bn,u(...e)):c}function Em(t){const e=[];let r;const n=Nf(Qs[t]);let s=0;for(;;){if(0===bm.compare(1))return s&&e.push(Sm(n,s)),e;let t;if([r,t]=Array.from(vf(bm,n)),!t.isZero())break;s++,bm=r}return s&&e.push(Sm(n,s)),-1===vm(r,n)&&(e.push(Sm(bm,1)),bm=Nf(1)),e}function Sm(t,e){let r=new kt(t,gt.one);return e>1&&(r=u($n,r,new kt(Nf(e),gt.one))),r}function qm(t,e,r,n){const s=n.factorize(e,r);zf(s)?t.push(...s.tail()):t.push(s)}function Tm(t,e,r){return Ef(t)?Om(t):r.factorize(t,e)}function Mm(t){isNaN(t)&&sr("number too big to factor");const e=[];t<0&&(t=-t);for(let r=0;r<Cs;r++){const n=Qs[r];if(n>t/n)break;let s=0;for(;t%n==0;)t/=n,s++;s&&(e.push(Ut(n)),e.push(Ut(s)))}return t>1&&(e.push(Ut(t)),e.push(Dt)),e}function Am(t,e){return Kf(t)&&(t=dm(t,e)),zf(t)&&!e.isOne(p(d(t)))?Qd(t.tail().map((function(t){return Am(t,e)})),e):re(t)?Rf(t):Qf(t)&&$d(sh(t))?Dt:t}function Nm(t,e){return $m(e.valueOf(eh(t)),e)}function $m(t,e){e.pushNativeDirective(N.evaluatingAsPolar,!0);try{const r=Hm(t,e),n=e.arg(t),s=Ad(e.multiply(ht,n),e);return e.multiply(r,s)}finally{e.popNativeDirective()}}function Lm(t){return function(t){const e=t.opr;return!!ue(e)&&Ue.equalsSym(e)}(t)&&Pp(t)}const km=z(P.cos);function Rm(t,e){return e.valueOf(u(km,t))}const Im=D("sin");function Pm(t,e){return e.valueOf(u(Im,t))}function Fm(t,e){const r=Td(t,1);return Um(e.valueOf(r),e)}function Um(t,e){if(ue(t))return e.is_zero(e.getSymbolValue(_s))?u(Kn,t):t;const r=!e.is_zero(e.getSymbolValue(_s));if(r&&!kd(t)&&!Ld(t,t)&&!(t.contains(Qe)&&t.contains(Ir)&&t.contains(ht)))return t;if(f(t)&&zf(t)&&pt(eh(t))&&r)return t;if(f(t)&&Kf(t))return t.tail().reduce(((t,r)=>e.add(t,Um(r,e))),Yt);return e.multiply(Hm(t,e),e.add(Rm(e.arg(t),e),e.multiply(ht,Pm(e.arg(t),e))))}function Cm(t,e,r,n){let s=0;const i=Array(Ks).fill(0),o=Array(Ks).fill(0);if(ne(t))return t;if((n.isOne(e)&&rp(r)||n.isOne(r)&&rp(e))&&Jf(t))return t;if(Vf(t)){const s=p(d(d(t))),i=p(d(d(d(t))));if(n.equals(s,r)&&n.equals(i,e)||n.equals(i,r)&&n.equals(s,e)||n.equals(s,c)&&n.equals(i,c)&&(n.isOne(r)&&rp(e)||n.isOne(e)&&rp(r)))return p(d(t))}if(n.isExpanding()&&Kf(t))return t.tail().reduce(((t,s)=>n.add(t,Cm(s,e,r,n))),Yt);if(n.isExpanding()&&zf(t))return t.tail().reduce(((t,s)=>n.multiply(t,Cm(s,e,r,n))),Dt);if(n.isExpanding()&&Hf(t)){const s=[];return f(t)&&s.push(...t.tail().map((t=>[t,e,r]))),s.reverse(),s.reduce(((t,e)=>n.inner(t,Cm(e[0],e[1],e[2],n))),Is)}if(!y(t))return n.is_zero(t)?Yt:n.isOne(e)&&rp(r)||n.isOne(r)&&rp(e)?Rd(as,t):Rd(as,t,e,r);const{ndim:a,nelem:u}=t;if(1===a)return t;let l=Sf(e),h=Sf(r);(l<1||l>a||h<1||h>a)&&sr("transpose: index out of range"),l--,h--;const m=new Array(u),g=t.copyDimensions();g[l]=t.dim(h),g[h]=t.dim(l);for(let e=0;e<a;e++)i[e]=0,o[e]=t.dim(e);for(let e=0;e<u;e++){s=i[l],i[l]=i[h],i[h]=s,s=o[l],o[l]=o[h],o[h]=s;let r=0;for(let t=0;t<a;t++)r=r*o[t]+i[t];s=i[l],i[l]=i[h],i[h]=s,s=o[l],o[l]=o[h],o[h]=s,m[r]=t.elem(e);for(let t=a-1;t>=0&&!(++i[t]<o[t]);t--)i[t]=0}return new x(g,m)}function Dm(t,e){const r=function(t,e){if(nr.codeGen&&p(t).equals(un)){const r=eh(t),n=Dm(e.valueOf(r),e),s=sh(t);return Rd(un,n,s)}return t}(t,e);if(y(r))return function(t,e){const r=t.map((function(t){return Dm(t,e)}));return e.is_zero(r),r}(r,e);const n=function(t,e){if(t.contains(nn)){const r=lm(t,e),n=lm(dm(t,e),e);return am(r)<am(n)?r:n}return t}(t,e);let s=function(t,e){const r=p(t);if((r.equals(bn)||Hf(t))&&p(p(d(t))).equals(as)&&p(p(d(d(t)))).equals(as)){const n=eh(p(d(t))),s=eh(p(d(d(t))));let i;i=r.equals(bn)?e.multiply(n,s):Hf(t)?e.inner(s,n):Tf();const o=function(t,e,r,n){n.pushNativeDirective(N.factor,!0);try{return Cm(t,e,r,n)}finally{n.popNativeDirective()}}(i,Dt,Bt,e);am(o)<am(t)&&(t=o)}return t}(n,e);s=function(t,e){if(!f(t)||!Kf(t))return t;const r=dm(t,e);am(r)<am(t)&&(t=r);return t}(s,e),s=function(t,e){if(!f(t)||!Kf(t))return t;const r=Xd(t,e);am(r)<=am(t)&&(t=r);return t}(s,e),s=function(t,e){const r=dm(e.negate(dm(e.negate(dm(t,e)),e)),e);am(r)<am(t)&&(t=r);return t}(s,e),s=function(t,e){if(e.is_zero(t))return t;const r=dm(t,e),n=Lp(r,e),s=dm(n,e),i=Lp(s,e),o=dm(i,e);return am(o)<am(t)?o:t}(s,e),s=Bm(s,e),s=function(t,e){if(!f(t)||!Kf(t))return t;let r=d(t);f(r)&&(r=[...r].reduce(((t,r)=>Km(e.add(t,Dm(r,e)),e)),Yt));am(r)<am(t)&&(t=r);return t}(s,e),s=function(t,e){const r=zm(t,e),n=e.valueOf(r);am(n)<am(t)&&(t=n);return t}(s,e);{let t;if([t,s]=function(t,e){if(nr.recursionLevelNestedRadicalsRemoval>0)return[S,t];const[r,n]=Zm(t,e),s=ar(Yd,r,e);return t=um($n,r,e)<um($n,s,e)?r:s,[n,t]}(s,e),t)return Dm(s,e)}return s=function(t,e){const r=t;if(!r.contains(Hn)&&!r.contains(Ir))return r;const n=pm(e.valueOf(r),e);return am(n)<am(r)?n:r}(s,e),s=Km(s,e),s}function Bm(t,e){const r=function(t,e){return t};if(!t.contains(Hn)&&!t.contains(Ir))return r(t);nr.trigmode=1;const n=e.valueOf(t);nr.trigmode=2;const s=e.valueOf(t);return nr.trigmode=0,am(s)<am(n)||Qm(s)<Qm(n)?am(s)<am(t)||Qm(s)<Qm(t)?r(s):r(t):am(n)<am(t)||Qm(n)<Qm(t)?r(n):r(t)}function Km(t,e){const r=_m(t,e);if(sp(r,e))return t;const n=Am(t,e);if(sp(n,e))return t;let s;if(!(s=Vd(n,r)))return t;const i=Tm(Gd(n,r,e),s,e);if(sp(i,e))return t;const o=Tm(n,s,e),a=Lp(i,e),u=Xd(kp(Dm(zd(o,a,e),e),Dm(zd(Tm(r,s,e),a,e),e),e),e);return am(u)<am(t)?u:t}function zm(t,e){if(pt(t))return t;if(p(t).equals($n)&&np(eh(t))){const r=e.negate(Dt),n=zm(sh(t),e);return Um($m(e.power(r,n),e),e)}if(f(t)){const r=[];for(;f(t);)r.push(zm(p(t),e)),t=d(t);return Rd(...r)}return t}function Qm(t){return f(t)&&Kf(t)?Yh(t)-1:1}function Zm(t,e){return nr.recursionLevelNestedRadicalsRemoval>0?[t,S]:f(t)?Lm(t)?function(t,e){const r=t.lhs,n=t.rhs;if(ne(n)&&n.isMinusOne()||!p(r).equals(fr)||!re(n)||!n.isFraction()||!yp(n,1,3)&&!yp(n,1,2))return[t,S];const s=eh(r);Zm(s,e);const i=sh(r);Zm(i,e);let o=0,a=r;for(;c!==d(a);)o++,a=d(a);if(o>2)return[t,S];const{commonBases:u,termsThatAreNotPowers:l}=function(t,e){let r=null;const n=[],s=[];if(zf(t)){let i=d(t);if(f(i))for(;f(i);){const t=p(i);if(Qf(t)){const s=eh(t),i=sh(t);yp(i,1,2)&&(null==r?(r=i,n.push(s)):e.equals(i,r)&&n.push(s))}else s.push(t);i=d(i)}}else if(Qf(t)){const e=eh(t),s=sh(t);null==r&&yp(s,1,2)&&(r=s,n.push(e))}return{commonBases:n,termsThatAreNotPowers:s}}(i,e);if(0===u.length)return[t,S];const h=s,m=u.reduce(e.multiply,Dt),g=l.reduce(e.multiply,Dt);let w=c;if(yp(n,1,3)){const r=kp(e.multiply(e.negate(h),m),g,e),n=Ff(hh(od(r,e),e));if(Math.abs(n)>Math.pow(2,32))return[t,S];const s=e.multiply(Kt,m),i=Ff(hh(od(s,e),e));if(Math.abs(i)>Math.pow(2,32))return[t,S];const o=e.multiply(s,Ss),a=kp(e.multiply(Ut(-3),h),g,e),u=Ff(hh(od(a,e),e));if(Math.abs(u)>Math.pow(2,32))return[t,S];w=Dd([r,o,e.multiply(a,e.power(Ss,Bt)),e.multiply(Dt,e.power(Ss,Kt))],e)}else if(yp(n,1,2)){const r=Ff(hh(od(m,e),e));if(Math.abs(r)>Math.pow(2,32))return[t,S];const n=kp(e.multiply(Ut(-2),h),g,e),s=Ff(hh(od(n,e),e));if(Math.abs(s)>Math.pow(2,32))return[t,S];w=e.add(m,e.add(e.multiply(n,Ss),e.multiply(Dt,e.power(Ss,Bt))))}nr.recursionLevelNestedRadicalsRemoval++;const _=nm(w,Ss,e);if(nr.recursionLevelNestedRadicalsRemoval--,0===_.ndim)return[t,S];const x=_.filterElements((t=>!t.contains($n)));if(0===x.length)return[t,S];const y=[],v=[];for(const t of Array.from(x)){const r=Ff(hh(od(t,e),e));y.push(t),v.push(r)}const b=v.indexOf(Math.max.apply(Math,v)),O=y[b];if(!yp(n,1,3)&&!yp(n,1,2))return[t,S];if(yp(n,1,3)){const t=e.power(kp(h,e.add(e.power(O,Kt),e.multiply(e.multiply(Kt,m),O)),e),ee),r=e.multiply(t,O);return[Dm(e.add(e.multiply(t,e.power(m,te)),r),e),q]}if(yp(n,1,2)){const t=e.power(kp(h,e.add(e.power(O,Bt),m),e),te),r=e.multiply(t,O),n=Dm(e.add(e.multiply(t,e.power(m,te)),r),e);if(!tp(hh(od(n,e),e)))return[n,q];return[Dm(e.add(e.multiply(e.negate(t),e.power(m,te)),e.negate(r)),e),q]}return[c,q]}(t,e):function(t,e){let r=S;const n=[];if(f(t)){const s=Array.from(t).map((t=>{if(!r){let n;return[n,r]=Zm(t,e),n}return t}));n.push(...s)}return[Rd(...n),r]}(t,e):[t,S]}const Gm=z(P.abs);function Hm(t,e){const r=function(t,e){return t},n=t;if(e.is_zero(n))return r(n);if(e.isOne(n))return r(n);if(tp(n))return r(e.negate(n));if(ep(n))return r(n);if(lh(n))return r(n);if(pt(n))return r(Dt);if(f(n)&&Kf(n)&&(Ld(n,n)||kd(n)||n.contains(ht))){const t=n,s=od(t,e),i=Kp(t),o=e.power(s,Bt),a=e.power(i,Bt),u=e.add(o,a);return r(Bm(e.power(u,te),e))}if(f(n)&&Qf(n)&&xp(p(n.cdr),-1))return r(e.getNativeDirective(N.evaluatingAsFloat)?Y:Dt);if(f(n)&&Qf(n)){const t=eh(n),s=sh(n);if(ne(s)){if(ep(s)){const n=Hm(t,e);return r(e.power(n,s))}if(re(s)&&ne(t)&&!t.isNegative())return r(e.power(t,s))}}const s=eh(n);if(Qf(n)&&Yf(s))return r(Ad(od(sh(n),e),e));if(f(n)&&zf(n))return r(n.tail().map((function(t){return Hm(t,e)})).reduce(e.multiply));if(f(n)&&Bf(n))return r(n);if(y(n)){const t=function(t,e){if(1!==t.ndim)throw new Error("abs(tensor) with tensor rank > 1");const r=Dm(t,e);return e.valueOf(Dm(e.power(e.inner(r,zp(r,e)),te),e))}(n,e);return r(t)}if($d(n)||f(n)&&Kf(n)&&$d(eh(n))){const t=e.negate(n);return r(u(Gm,t))}return f(n)&&Kf(n),r(u(Gm,n))}const Vm=D("derivative"),jm=D("last");function Wm(t,e,r){return t.bitmap===e.bitmap}function Jm(t){return 0===t.bitmap}function Xm(t,e,r,n){if(!e){const e=r?r():"satisfy some condition",s=n?" in "+n():"";throw new Error(t+" must "+e+s+".")}}function Ym(){return"not be 'undefined'"}function tg(t,e,r){Xm(t,!!e,Ym,r)}function eg(){return"be an integer"}function rg(t,e,r){var n;return Xm(t,"number"==typeof(n=e)&&n%1==0,eg,r),e}function ng(t,e){t>>=1;let r=0;for(;0!==t;)r+=gh(t&e),t>>=1;return 0==(1&r)?1:-1}function sg(t){return 0==(1&t)?1:-1}const ig=0;function og(t){return cg(ig,t.zero,t)}function ag(t,e){return cg(t,e.one,e)}function ug(t,e){return cg(ig,t,e)}function cg(t,e,r){const n={get bitmap(){return t},get weight(){return e},__neg__:()=>cg(t,r.neg(e),r),__wedge__(n){if(t&n.bitmap)return ug(r.zero,r);{const s=t^n.bitmap,i=ng(t,n.bitmap),o=r.mul(e,n.weight);return cg(s,i>0?o:r.neg(o),r)}},grade:()=>gh(t),reverse(){const s=n.grade(),i=sg(s*(s-1)/2);return cg(t,i>0?e:r.neg(e),r)},gradeInversion(){const s=sg(n.grade());return cg(t,s>0?e:r.neg(e),r)},cliffordConjugate(){const s=n.grade(),i=sg(s*(s+1)/2);return cg(t,i>0?e:r.neg(e),r)},isOne:()=>n.isScalar()&&r.isOne(e),isScalar:()=>t===ig,isZero:()=>r.isZero(e),zero:()=>ug(r.zero,r),asString(n){let s="",i=1,o=t;for(;0!==o;)0!=(1&o)&&(s.length>0&&(s+=" ^ "),null==n||void 0===n||i>n.length||null==n[i-1]?s=s+"e"+i:s+=n[i-1]),o>>=1,i++;return 0===s.length?r.asString(e):r.isOne(e)?s:r.asString(e)+" * "+s},toString:()=>n.asString(void 0)};return n}function lg(t,e){const r={};for(let n=0;n<t.length;n++){const s=t[n],i=r[s.bitmap];if(i){const t=e.add(i.weight,s.weight);e.isZero(t)?delete r[s.bitmap]:r[s.bitmap]=cg(s.bitmap,t,e)}else e.isZero(s.weight)||(r[s.bitmap]=s)}return function(t){const e=Object.keys(t).map((function(t){return parseInt(t)})),r=[];for(let n=0;n<e.length;n++){const s=t[e[n]];r.push(s)}return r}(r)}function fg(t,e,r){const n=t.bitmap^e.bitmap,s=ng(t.bitmap,e.bitmap),i=r.mul(t.weight,e.weight);return cg(n,s>0?i:r.neg(i),r)}function hg(t,e,r,n){const s=fg(t,e,n);let i=s.weight,o=t.bitmap&e.bitmap,a=0;for(;0!==o;)0!=(1&o)&&(i=n.mul(i,r[a])),a++,o>>=1;return cg(s.bitmap,i,n)}function pg(t,e,r,n){const s=r.toEigenBasis(t),i=r.toEigenBasis(e),o=r.getEigenMetric(),a=[];for(let t=0;t<s.length;t++)for(let e=0;e<i.length;e++)s[t].bitmap,s[t].weight,a.push(hg(s[t],i[e],o,n));return r.toMetricBasis(lg(a,n))}function dg(t){return gh(t)}function mg(t){if("object"==typeof t){return"function"==typeof t.scalarCoordinate}return!1}function gg(t){return"function"==typeof t.getEigenMetric}function wg(t,e){if(Array.isArray(t))return t.length;if(gg(t))return t.getEigenMetric().length;if(e.isDimension(t))return e.dim(t);throw new Error("metric is undefined")}function _g(t,e,r,n){const s=e.field;if(t.length>0){const i=t.map((function(t){return{blade:Sg(t.bitmap,e,r,n),weight:t.weight}}));return s.sum(i)}return s.treeZero()}function xg(t,e){return e.sum([t])}function yg(t,e,r,n){const s=e.field;if(0===t.bitmap)return s.weightToTree(t.weight);{const i=function(t,e,r,n){return{blade:Sg(t.bitmap,e,r,n),weight:t.weight}}(t,e,r,n);return xg(i,s)}}function vg(t,e,r,n,s){const i=r.field;if(i.isField(t)&&mg(e)){const o=[];return o.push(ug(t,i)),o.push(ag(e.bitmap,i)),_g(lg(o,i),r,n,s)}if(mg(t)&&i.isField(e)){const o=[];return o.push(ug(e,i)),o.push(ag(t.bitmap,i)),_g(lg(o,i),r,n,s)}if(mg(t)&&mg(e)){const o=[];return o.push(ag(t.bitmap,i)),o.push(ag(e.bitmap,i)),_g(lg(o,i),r,n,s)}}function bg(t,e,r,n,s){const i=r.field;if(i.isField(t)&&mg(e)){const o=[];return o.push(ug(t,i)),o.push(ag(e.bitmap,i).__neg__()),_g(lg(o,i),r,n,s)}if(mg(t)&&i.isField(e)){const o=[];return o.push(ug(i.neg(e),i)),o.push(ag(t.bitmap,i)),_g(lg(o,i),r,n,s)}if(mg(t)&&mg(e)){const o=[];return o.push(ag(t.bitmap,i)),o.push(ag(e.bitmap,i).__neg__()),_g(lg(o,i),r,n,s)}}function Og(t,e,r,n,s){const i=r.field;if(i.isField(t)&&mg(e)){return xg({blade:e,weight:t},i)}if(mg(t)&&i.isField(e)){return xg({blade:t,weight:e},i)}if(mg(t)&&mg(e)){const o=cg(t.bitmap,i.one,i),a=cg(e.bitmap,i.one,i);if(Array.isArray(n)){return yg(hg(o,a,n,i),r,n,s)}if(gg(n)){const t=pg(o,a,n,i),e=[];for(let r=0;r<t.length;r++)e.push(t[r]);return _g(lg(e,i),r,n,s)}return yg(fg(o,a,i),r,n,s)}}function Eg(t,e,r,n){return rg("index",t),tg("algebra",e),Sg(1<<t,e,r,n)}function Sg(t,e,r,n){if(0===t){throw new Error("bitmap must be non-zero (without weights a scalar blade is ambiguous)")}const s=e.field;let o=0;const a={get bitmap(){return t},get meta(){return o},set meta(t){o=t},get name(){return"Blade"},reset(t){o=i(o,t)},__abs__(){const t=s.bladeToTree(a),e=a.rev(),r=s.treeScp(t,e);return s.treeSqrt(r)},add:t=>vg(a,t,e,r,n),__add__:t=>vg(a,t,e,r,n),__radd__:t=>vg(t,a,e,r,n),sub:t=>bg(a,t,e,r,n),__sub__:t=>bg(a,t,e,r,n),__rsub__:t=>bg(t,a,e,r,n),__eq__:t=>Wm(a,t),__ge__:t=>function(t,e,r){if(Jm(t)&&Jm(e)){const n=t.scalarCoordinate(),s=e.scalarCoordinate();return r.ge(n,s)}throw new Error(`${t} >= ${e} is not implemented.`)}(a,t,s),__gt__:t=>function(t,e,r){if(Jm(t)&&Jm(e)){const n=t.scalarCoordinate(),s=e.scalarCoordinate();return r.gt(n,s)}throw new Error(`${t} > ${e} is not implemented.`)}(a,t,s),__le__:t=>function(t,e,r){if(Jm(t)&&Jm(e)){const n=t.scalarCoordinate(),s=e.scalarCoordinate();return r.le(n,s)}throw new Error(`${t} <= ${e} is not implemented.`)}(a,t,s),__lt__:t=>function(t,e,r){if(Jm(t)&&Jm(e)){const n=t.scalarCoordinate(),s=e.scalarCoordinate();return r.lt(n,s)}throw new Error(`${t} < ${e} is not implemented.`)}(a,t,s),__ne__:t=>!Wm(a,t),inv(){throw new Error("Multivector.inv method not implemented.")},isCons:()=>!1,isNil:()=>!1,map(i){const o=i(s.one);return s.isZero(o)?s.treeZero():yg(cg(t,o,s),e,r,n)},mul:t=>Og(a,t,e,r,n),__mul__:t=>Og(a,t,e,r,n),__rmul__:t=>Og(t,a,e,r,n),__div__:t=>function(t,e,r){throw new Error(`Multivector division is not yet supported. ${t} / ${e}`)}(a,t),__lshift__(i){const o=cg(t,s.one,s),a=cg(i.bitmap,s.one,s);if(Array.isArray(r)){return yg(function(t,e,r,n){const s=t.grade(),i=e.grade();return s>i||dg(t.bitmap^e.bitmap)!==i-s?og(n):hg(t,e,r,n)}(o,a,r,s),e,r,n)}if(gg(r)){const t=function(t,e,r,n){const s=t.grade(),i=e.grade();return s>i||dg(t.bitmap^e.bitmap)!==i-s?[]:pg(t,e,r,n)}(o,a,r,s),i=[];for(let e=0;e<t.length;e++)i.push(t[e]);return _g(lg(i,s),e,r,n)}return yg(function(t,e,r){const n=t.grade(),s=e.grade();return n>s||dg(t.bitmap^e.bitmap)!==s-n?og(r):fg(t,e,r)}(o,a,s),e,r,n)},__rshift__(i){const o=cg(t,s.one,s),a=cg(i.bitmap,s.one,s);if(Array.isArray(r)){return yg(function(t,e,r,n){const s=t.grade(),i=e.grade();return s<i||dg(t.bitmap^e.bitmap)!==s-i?og(n):hg(t,e,r,n)}(o,a,r,s),e,r,n)}if(gg(r)){const t=[],i=function(t,e,r,n){const s=t.grade(),i=e.grade();return s<i||dg(t.bitmap^e.bitmap)!==s-i?[]:pg(t,e,r,n)}(o,a,r,s);for(let e=0;e<i.length;e++)t.push(i[e]);return _g(lg(t,s),e,r,n)}return yg(function(t,e,r){const n=t.grade(),s=e.grade();return n<s||dg(t.bitmap^e.bitmap)!==n-s?og(r):fg(t,e,r)}(o,a,s),e,r,n)},__vbar__(t){const r=e.field,n=a.__mul__(t);return r.extractGrade(n,0)},__wedge__(i){const o=[],a=ag(t,s),u=ag(i.bitmap,s),c=a.__wedge__(u);return o.push(c),_g(lg(o,s),e,r,n)},__bang__:()=>a.inv(),__pos__:()=>s.bladeToTree(a),neg:()=>yg(ag(t,s).__neg__(),e,r,n),__neg__:()=>yg(ag(t,s).__neg__(),e,r,n),__tilde__:()=>a.rev(),cliffordConjugate:()=>yg(ag(t,s).cliffordConjugate(),e,r,n),contains:t=>a.equals(t),direction(){const t=s.bladeToTree(a),e=a.rev(),r=s.treeScp(t,e),n=s.scalarCoordinate(r),i=s.sqrt(n);return s.isZero(i)?t:a.divByScalar(i)},equals(t){return a===t||!!mg(t)&&this.bitmap===t.bitmap},exp(){throw new Error("BasisBlade.exp")},extractGrade:function(e){return gh(t)===e?s.bladeToTree(a):s.treeZero()},div:t=>s.treeMul(s.bladeToTree(a),t.inv()),divByScalar(i){const o=s.div(s.one,i);return s.isZero(o)?s.treeZero():yg(cg(t,o,s),e,r,n)},dual(){const t=yg(cg((1<<wg(r,e.field))-1,s.one,s),e,r,n);return s.treeLco(s.bladeToTree(a),t)},gradeInversion:()=>yg(ag(t,s).gradeInversion(),e,r,n),isCompatible:t=>!0,rev:()=>yg(ag(t,s).reverse(),e,r,n),scalarCoordinate:()=>0===t?s.one:s.zero,scp:t=>a.__vbar__(t),sqrt(){if(0===t)return yg(cg(t,s.one,s).reverse(),e,r,n);throw new Error("sqrt on arbitrary multivectors is not yet supported.")},asString(e,r){let n="",s=1,i=t;for(;0!==i;)0!=(1&i)&&(n.length>0&&(n+=r),null==e||void 0===e||s>e.length||null==e[s-1]?n=n+"e"+s:n+=e[s-1]),i>>=1,s++;if(n.length>0)return n;throw new Error(`Expecting something for bitmap ${t}`)},toInfixString:()=>a.asString(n,"^"),toListString:()=>a.asString(n,"^"),toLatexString:()=>a.asString(n," \\wedge "),toString:()=>a.asString(n,"^")};return a}function qg(t,e,r){tg("metric",t);const n=wg(t,e);tg("field",e),function(t,e,r){if(e){if(!Array.isArray(e))throw new Error(`${t} must be a string[]`);if(e.length!==r)throw new Error(`${t}.length must match the dimensionality of the vector space.`);for(let r=0;r<e.length;r++)if("string"!=typeof e[r])throw new Error(`${t}[${r}] must be a string.`)}}("labels",r,n);const s=[],i={get field(){return e},unit(t){if(rg("index",t),t>=0&&t<n)return s[t];throw new Error(`index must be in range [0 ... ${n-1})`)},get units(){return s.map((t=>t))}};for(let e=0;e<n;e++)s[e]=Eg(e,i,t,r);return i}const Tg=1e4;class Mg{constructor(){this.c=0,this.x=0,this.y=0}}let Ag=[];for(let t=0;t<Tg;t++)Ag[t]=new Mg;let Ng=0,$g=0,Lg=0;function kg(t){let e="";return e+=t,e}function Rg(t){return kg(t)}function Ig(t,e){Ng=0,$g=0,Lg=0,function(t,e){if(p(t).equals(Qn))return Fg(eh(t),e),Xg(" = "),void Fg(sh(t),e);y(t)?function(t,e){let r=0,n=0,s=0;if(t.ndim>2)return void ow(t,e);const i=t.dim(0);r=2===t.ndim?t.dim(1):1;const o=i*r;if(o>ew)return void ow(t,e);const a=Lg;for(let r=0;r<o;r++)nw[r].index=Ng,nw[r].x=Lg,Fg(t.elem(r),e),nw[r].count=Ng-nw[r].index,[nw[r].h,nw[r].w,nw[r].y]=Array.from(Wg(nw[r].index,Ng));let u=0,c=0;for(let t=0;t<o;t++)nw[t].h>u&&(u=nw[t].h),nw[t].w>c&&(c=nw[t].w);const l=i*u+(i-1)*iw,f=r*c+(r-1)*sw,h=-l/2;for(let t=0;t<i;t++)for(let e=0;e<r;e++){const i=t*r+e;n=a-nw[i].x,s=h-nw[i].y,jg(nw[i].index,nw[i].index+nw[i].count,n,s),n=0,e>0&&(n=e*(c+sw)),s=0,t>0&&(s=t*(u+iw)),n+=(c-nw[i].w)/2,s+=(u-nw[i].h)/2,jg(nw[i].index,nw[i].index+nw[i].count,n,s)}Lg=a+f}(t,e):Fg(t,e)}(t,e);const[r,n,s]=Array.from(Wg(0,Ng));if(n>100)return xw(t,e),"";const i=function(){let t="";const e=Ag.slice(0,Ng);e.sort(tw);const r=Ag.slice(Ng);Ag.length=0,Ag=Ag.concat(e).concat(r);let n=0,{y:s}=Ag[0];for(let e=0;e<Ng;e++){for(;Ag[e].y>s;)t+=Rg("\n"),n=0,s++;for(;Ag[e].x>n;)t+=kg(" "),n++;t+=kg(Ag[e].c),n++}return t}();return i}function Pg(t,e){if($g>0)return!1;if(_p(t))return!0;if(!zf(t))return!1;if(_p(eh(t)))return!0;for(;f(t);){if(Dg(p(t)))return!0;t=d(t)}return!1}function Fg(t,e){if(Kf(t))for(Ug(p(t=d(t)))&&(Jg("-"),Pg(p(t))&&Jg(" ")),Cg(p(t),e),t=d(t);f(t);)Ug(p(t))?(Jg(" "),Jg("-"),Jg(" ")):(Jg(" "),Jg("+"),Jg(" ")),Cg(p(t),e),t=d(t);else Ug(t)&&(Jg("-"),Pg(t)&&Jg(" ")),Cg(t,e)}function Ug(t){return!!tp(t)||!(!zf(t)||!tp(eh(t)))}function Cg(t,e){if(zf(t)){const r=function(t,e){let r=0;t=d(t);for(;f(t);){Dg(p(t))&&r++,t=d(t)}return r}(t);r&&0===$g?function(t,e,r){let n,s,i=0,o=0,a=0,u=0,c=0,l=Dt,h=Dt;re(eh(t))&&(l=Hm(Rf(eh(t)),r),h=If(eh(t)));it(eh(t))&&(l=Hm(eh(t),r));u=r.isOne(l)?0:1,n=d(t),ne(p(n))&&(n=d(n));for(;f(n);)s=p(n),Dg(s)||u++,n=d(n);c=Lg,o=Ng,i=0,r.isOne(l)||(Yg(l,0,r),i++);n=d(t),ne(p(n))&&(n=d(n));for(;f(n);)s=p(n),Dg(s)||(i>0&&Jg(" "),1===u?Fg(s,r):Kg(s,r),i++),n=d(n);0===i&&Jg("1");a=Ng,i=0,r.isOne(h)||(Yg(h,0,r),i++,e++);n=d(t),re(p(n))&&(n=d(n));for(;f(n);)s=p(n),Dg(s)&&(i>0&&Jg(" "),Qg(s,e,r),i++),n=d(n);Hg(c,o,a)}(t,r,e):function(t,e,r){if(0===e)for(t=d(t),(r.isOne(p(t))||np(p(t)))&&(t=d(t)),Kg(p(t),r),t=d(t);f(t);)Jg(" "),Kg(p(t),r),t=d(t);else!function(t,e){let r=Dt;t=d(t),re(p(t))?(r=Hm(Rf(p(t)),e),t=d(t)):it(p(t))&&(r=Hm(p(t),e),t=d(t));let n=0;e.isOne(r)||(Yg(r,0,e),n++);for(;f(t);)Dg(p(t))||(n>0&&Jg(" "),Kg(p(t),e),n++),t=d(t);0===n&&Jg("1")}(t,r),Jg("/"),e>1||_p(eh(t))?(Jg("("),Bg(t,r),Jg(")")):Bg(t,r)}(t,r,e)}else Kg(t,e)}function Dg(t,e){const r=eh(t);return Qf(t)&&Yf(r)&&Ug(sh(t))}function Bg(t,e){let r=0;if(_p(p(t=d(t)))){Yg(If(p(t)),0,e),r++,t=d(t)}for(;f(t);)Dg(p(t))&&(r>0&&Jg(" "),Qg(p(t),0,e),r++),t=d(t)}function Kg(t,e){y(t)?ow(t,e):it(t)?Yg(t,0,e):Kf(t)||zf(t)?Zg(t,e):Qf(t)?function(t,e){let r=0,n=0,s=0;const i=eh(t);if(Yf(i))return Xg("exp("),Fg(sh(t),e),void Jg(")");if($g>0)return void(np(sh(t))?(Jg("1"),Jg("/"),zg(eh(t))?Kg(eh(t),e):Zg(eh(t),e)):(zg(eh(t))?Kg(eh(t),e):Zg(eh(t),e),e.getNativeDirective(N.useCaretForExponentiation)?Jg("^"):(Jg("*"),Jg("*")),zg(sh(t))?Kg(sh(t),e):Zg(sh(t),e)));if(Ug(sh(t)))return s=Lg,r=Ng,Jg("1"),n=Ng,Qg(t,1,e),void Hg(s,r,n);r=Ng,zg(eh(t))?Kg(eh(t),e):Zg(eh(t),e);n=Ng,$g++,Fg(sh(t),e),$g--,Vg(r,n)}(t,e):f(t)?function(t,e){if(t.opr.equals(dn)&&ue(eh(t)))return void function(t,e){t=d(t),th(t).equals(fr)||th(t).equals(bn)||th(t).equals($n)||th(t).equals(nn)?Zg(p(t),e):Fg(p(t),e);if(Jg("["),t=d(t),f(t))for(Fg(p(t),e),t=d(t);f(t);)Jg(","),Fg(p(t),e),t=d(t);Jg("]")}(t,e);if(Zf(t))return void function(t,e){t=eh(t),_p(t)||Kf(t)||zf(t)||Qf(t)||Zf(t)?Zg(t,e):Fg(t,e);Jg("!")}(t,e);p(t).equals(Vm)?Jg("d"):Gg(p(t),e);Jg("(");let r=t.cdr;if(f(r))for(Fg(r.head,e),r=r.cdr;f(r);)Jg(","),Fg(r.head,e),r=r.cdr;Jg(")")}(t,e):ne(t)?0===$g?function(t,e){re(t)&&function(t,e){const r=t.numer().abs(),n=t.denom();if(n.isOne())return void Yg(r,0,e);const s=Lg,i=Ng;Yg(r,0,e);const o=Ng;Yg(n,0,e),Hg(s,i,o)}(t,e);it(t)&&function(t,e){const r=t.abs();Yg(r,0,e)}(t,e)}(t,e):Yg(t,0,e):ue(t)?Gg(t,e):ae(t)&&function(t){const e=t.str;Jg('"');for(let t=0;t<e.length;t++)Jg(e[t]);Jg('"')}(t)}function zg(t){return!(!f(t)||Kf(t)||zf(t)||Qf(t))||(!!ue(t)||!_p(t)&&(!tp(t)&&!!ne(t)))}function Qg(t,e,r){let n=0,s=0;np(sh(t))?1===e?Fg(eh(t),r):Kg(eh(t),r):(n=Ng,zg(eh(t))?Kg(eh(t),r):Zg(eh(t),r),s=Ng,$g++,function(t,e){if(Kf(t))for(Cg(p(t=d(t)),e),t=d(t);f(t);)Ug(p(t))?(Jg(" "),Jg("-"),Jg(" ")):(Jg(" "),Jg("+"),Jg(" ")),Cg(p(t),e),t=d(t);else Cg(t,e)}(sh(t),r),$g--,Vg(n,s))}function Zg(t,e){Jg("("),Fg(t,e),Jg(")")}function Gg(t,e){if(Yf(t))return void Xg("exp(1)");const r=e.getSymbolPrintName(t);for(let t=0;t<r.length;t++)Jg(r[t])}function Hg(t,e,r){let n=0,s=0;const[i,o,a]=Array.from(Wg(e,r)),[u,c,l]=Array.from(Wg(r,Ng));n=c>o?(c-o)/2:0,n++;s=-(a+i-1)-1,jg(e,r,n,s),n=c>o?-o:(o-c)/2-o,n++,s=1-l,jg(r,Ng,n,s);let f=0;f=c>o?c:o,f+=2,Lg=t;for(let t=0;t<f;t++)Jg("-")}function Vg(t,e){let r=0,n=0,s=0,i=0,o=0,a=0,u=0;[n,s,i]=Array.from(Wg(t,e)),[o,a,u]=Array.from(Wg(e,Ng)),r=-u-o+1,r+=i-1,jg(e,Ng,0,r)}function jg(t,e,r,n){for(let s=t;s<e;s++)Ag[s].x+=r,Ag[s].y+=n}function Wg(t,e){let r=Ag[t].x,n=Ag[t].x,s=Ag[t].y,i=Ag[t].y;for(let o=t+1;o<e;o++)Ag[o].x<r&&(r=Ag[o].x),Ag[o].x>n&&(n=Ag[o].x),Ag[o].y<s&&(s=Ag[o].y),Ag[o].y>i&&(i=Ag[o].y);return[i-s+1,n-r+1,s]}function Jg(t){if(Ng!==Tg)return Ag[Ng].c=t,Ag[Ng].x=Lg,Ag[Ng].y=0,Ng++,Lg++}function Xg(t){for(let e=0;e<t.length;e++)Jg(t[e])}function Yg(t,e,r){if(re(t)){let r=t.a.toString();"-"===r[0]&&0===e&&(r=r.substring(1));for(let t=0;t<r.length;t++)Jg(r[t]);if(r=t.b.toString(),"1"===r)return;Jg("/");for(let t=0;t<r.length;t++)Jg(r[t])}else if(it(t)){let n=Lh(t.d,r);"-"===n[0]&&0===e&&(n=n.substring(1));for(let t=0;t<n.length;t++)Jg(n[t])}}function tw(t,e){return t.y<e.y?-1:t.y>e.y?1:t.x<e.x?-1:t.x>e.x?1:0}const ew=100;class rw{constructor(){this.x=0,this.y=0,this.h=0,this.w=0,this.index=0,this.count=0}}const nw=[];for(let t=0;t<1e4;t++)nw[t]=new rw;const sw=3,iw=1;function ow(t,e){aw(t,0,0,e)}function aw(t,e,r,n){Jg("(");for(let s=0;s<t.dim(e);s++)e+1===t.ndim?(Fg(t.elem(r),n),r+=1):r=aw(t,e+1,r,n),s+1<t.dim(e)&&Jg(",");return Jg(")"),r}function uw(t,e){if(f(t)){let r="";for(r+="(",r+=uw(p(t),e),t=d(t);f(t);)r+=" ",r+=uw(p(t),e),t=d(t);return t!==c&&(r+=" . ",r+=uw(t,e)),r+=")",r}return e.toSExprString(t)}const cw="undefined",lw=z(P.E),fw=z(P.IMU),hw=z(P.PI),pw=z(P.test_eq);function dw(t){switch(t){case Ye:return ls;case er:return ds;case Xe:return hs;case tr:return fs;case rr:return ps;default:throw new Error(t)}}function mw(t,e,r){const n='"'+t+'"',[s,i]=qo(n,{useCaretForExponentiation:r.getNativeDirective(N.useCaretForExponentiation),explicitAssocAdd:!1,explicitAssocMul:!1});if(s===n.length){const t=function(t){if(ae(t))return t;throw new $i(`expr => ${t}`)}(i);r.setSymbolValue(e,t)}}function gw(t,e){return function(t){if(re(t)&&(t.isNegative()||t.isFraction()))return!0;if(it(t)&&t.isNegative())return!0;if(Kf(t))return!0;if(zf(t))return!0;if(Qf(t))return!0;return!1}(t)?`(${xw(t,e)})`:xw(t,e)}function ww(t,e){return re(t)&&t.isFraction()||Kf(t)||zf(t)||Qf(t)?`(${xw(t,e)})`:xw(t,e)}function _w(t,e,r){let n="";const s=eh(t);let i=sh(t);return np(i)?(n+=gw(s,r),n):(1===e&&(n+="("),i=r.negate(i),n+=Rw(s,i,r),1===e&&(n+=")"),n)}function xw(t,e){return function(t,e){let r="";if(Kf(t))for("-"===yw(p(t=d(t)))&&(r+="-"),r+=bw(p(t),e),t=d(t);f(t);)"+"===yw(p(t))?nr.printMode!==er||nr.testFlag?r+="+":r+=" + ":nr.printMode!==er||nr.testFlag?r+="-":r+=" - ",r+=bw(p(t),e),t=d(t);else"-"===yw(t)&&(r+="-"),r+=bw(t,e);return r}(t,e)}function yw(t){if(f(t)&&zf(t)){const e=p(t.cdr);if(ne(e)&&Md(e,Yt))return"-"}return ne(t)&&Md(t,Yt)?"-":"+"}function vw(t,e){let r="",n="",s=d(t);np(p(s))&&(s=d(s));let i=!1;ne(p(s))&&(i=!0);let o=!1;nr.printMode===Xe&&f(d(s))&&function(t){return re(t)&&t.isFraction()&&Vs(t.a.abs(),1)}(p(s))&&(o=!0,r=p(s).b.toString());let a="";for(o?(n=a,a=""):a+=Ow(p(s),!1,!1,e),s=d(s);f(s);)nr.printMode===Xe&&i&&th(s).equals($n)&&ne(p(d(p(s))))&&(_p(p(d(d(p(s)))))||(a+=" \\cdot ")),a+=Pw(),a+=Ow(p(s),!1,!0,e),i=!1,ne(p(s))&&(i=!0),s=d(s);return o&&(a=n+"\\frac{"+a+"}{"+r+"}"),a}function bw(t,e){return f(t)&&zf(t)?function(t,e){let r=t.cdr;for(;f(r);){if(Fw(r.car))return!0;r=r.cdr}return!1}(t)?function(t,e){let r,n,s="",i=0,o=0,a=0,u=t.cdr,c=p(u);for(re(c)?(r=Hm(Rf(c),e),n=If(c),e.isOne(r)||o++,e.isOne(n)||a++,u=d(u)):(r=Dt,n=Dt);f(u);)c=p(u),Fw(c)?a++:o++,u=d(u);if(nr.printMode===Xe&&(s+="\\frac{"),0===o)s+="1";else for(i=0,u=d(t),re(p(u))&&(u=d(u)),e.isOne(r)||(s+=Iw(r,!1,!1,e),i=1);f(u);)c=p(u),Fw(c)||(i&&(s+=Pw()),s+=Iw(c,!1,!1,e),i=1),u=d(u);for(nr.printMode===Xe?s+="}{":nr.printMode!==er||nr.testFlag?s+="/":s+=" / ",a>1&&nr.printMode!==Xe&&(s+="("),i=0,u=d(t),re(p(u))&&(u=d(u)),e.isOne(n)||(s+=Iw(n,!1,!1,e),i=1);f(u);)c=p(u),Fw(c)&&(i&&(s+=Pw()),s+=_w(c,a,e),i=1),u=d(u);return a>1&&nr.printMode!==Xe&&(s+=")"),nr.printMode===Xe&&(s+="}"),s}(t,e):vw(t,e):Ow(t,!1,!1,e)}function Ow(t,e,r,n){if(f(t)&&Gf(t)){let e=t.argList;if(f(e)){let t=Sw(e.car,!1,!1,n);for(e=e.cdr;f(e);)t+=Ew(),t+=Sw(p(e),!1,!0,n),e=e.cdr;return t}throw new Error}return Sw(t,e,r,n)}function Ew(){return nr.printMode===Xe?" \\wedge ":nr.printMode!==er||nr.testFlag||nr.codeGen?"^":" ^ "}function Sw(t,e,r,n){if(f(t)&&Hf(t)){let e=t.argList;if(f(e)){let t=Iw(e.car,!1,!1,n);for(e=e.cdr;f(e);)t+=qw(),t+=Iw(p(e),!1,!0,n),e=e.cdr;return t}throw new Error}if(f(t)&&function(t){return f(t)&&Cf(t,Ke)}(t)){let e=t.argList;if(f(e)){let t=Iw(e.car,!1,!1,n);for(e=e.cdr;f(e);)t+=Tw(),t+=Iw(p(e),!1,!0,n),e=e.cdr;return t}throw new Error}if(f(t)&&function(t){return f(t)&&Cf(t,ze)}(t)){let e=t.argList;if(f(e)){let t=Iw(e.car,!1,!1,n);for(e=e.cdr;f(e);)t+=Mw(),t+=Iw(p(e),!1,!0,n),e=e.cdr;return t}throw new Error}return Iw(t,e,r,n)}function qw(){return nr.printMode===Xe?" \\mid ":nr.printMode!==er||nr.testFlag||nr.codeGen?"|":" | "}function Tw(){return nr.printMode===Xe?" \\ll ":nr.printMode!==er||nr.testFlag||nr.codeGen?"<<":" << "}function Mw(){return nr.printMode===Xe?" \\gg ":nr.printMode!==er||nr.testFlag||nr.codeGen?">>":" >> "}function Aw(t,e){let r="";return r+="(",r+=xw(t,e),r+=")",r}function Nw(t,e){let r="";return r+=$w(t,0,0,e)[1],r}function $w(t,e,r,n){let s="";if(s+="[",e<t.ndim-1)for(let i=0;i<t.dim(e);i++){let o;[r,o]=Array.from($w(t,e+1,r,n)),s+=o,i!==t.dim(e)-1&&(s+=",")}else for(let i=0;i<t.dim(e);i++)s+=xw(t.elem(r),n),i!==t.dim(e)-1&&(s+=","),r++;return s+="]",[r,s]}function Lw(t,e){let r="";return t.ndim<=2&&(r+=kw(!0,t,0,0,e)[1]),r}function kw(t,e,r,n,s){let i="";if(t&&(i+="\\begin{bmatrix} "),r<e.ndim-1)for(let t=0;t<e.dim(r);t++){let o;[n,o]=Array.from(kw(!1,e,r+1,n,s)),i+=o,t!==e.dim(r)-1&&(i+=" \\\\ ")}else for(let t=0;t<e.dim(r);t++)i+=xw(e.elem(n),s),t!==e.dim(r)-1&&(i+=" & "),n++;return t&&(i+=" \\end{bmatrix}"),[n,i]}function Rw(t,e,r){let n="";if(vp(e))if(xp(t,2)){if(nr.codeGen)return n+="Math.SQRT2",n}else{if(nr.printMode===Xe)return n+="\\sqrt{",n+=xw(t,r),n+="}",n;if(nr.codeGen)return n+="Math.sqrt(",n+=xw(t,r),n+=")",n}if(xp(r.getSymbolValue(Ln),1)&&Yf(t))return nr.codeGen?(n+="Math.exp(",n+=ww(e,r),n+=")",n):(nr.printMode===Xe?(n+="e^{",n+=xw(e,r),n+="}"):(n+="exp(",n+=xw(e,r),n+=")"),n);if(nr.codeGen)return n+="Math.pow(",n+=gw(t,r),n+=", ",n+=ww(e,r),n+=")",n;if(function(t,e){if(ue(t)){if(t.equals(D("x"))){const t=kn,r=e.getSymbolValue(t);return t===r||!xp(r,1)}return!0}return!0}(t,r)){if(!Yf(t)){if(ne(e)&&e.isMinusOne())return nr.printMode===Xe?n+="\\frac{1}{":nr.printMode!==er||nr.testFlag?n+="1/":n+="1 / ",f(t)&&nr.printMode!==Xe?(n+="(",n+=xw(t,r),n+=")"):n+=xw(t,r),nr.printMode===Xe&&(n+="}"),n;if($d(e)){nr.printMode===Xe?n+="\\frac{1}{":nr.printMode!==er||nr.testFlag?n+="1/":n+="1 / ";const s=r.multiply(e,Jt);return f(t)&&nr.printMode!==Xe?(n+="(",n+=Rw(t,s,r),n+=")"):n+=Rw(t,s,r),nr.printMode===Xe&&(n+="}"),n}}if(_p(e)&&nr.printMode===Xe){n+="\\sqrt";const s=_m(e,r);return rp(s)||(n+="[",n+=xw(s,r),n+="]"),n+="{",n+=Rw(t,e=Am(e,r),r),n+="}",n}}return nr.printMode===Xe&&r.isOne(e)?n+=xw(t,r):(Qf(t)?nr.printMode!==Xe?(n+="(",n+=Iw(t,!0,!1,r),n+=")"):n+=Iw(t,!0,!1,r):tp(t)||Kf(t)?(n+="(",n+=xw(t,r),n+=")"):zf(t)?nr.printMode!==Xe?(n+="(",n+=Iw(t,!0,!1,r),n+=")"):n+=Iw(t,!0,!1,r):Gf(t)||Hf(t)?(n+="(",n+=xw(t,r),n+=")"):ne(t)&&(Md(t,Yt)||_p(t))?(n+="(",n+=Iw(t,!1,!1,r),n+=")"):n+=Iw(t,!1,!1,r),nr.printMode!==er||nr.testFlag?nr.printMode===Xe||r.getNativeDirective(N.useCaretForExponentiation)?n+="^":n+="**":r.getNativeDirective(N.useCaretForExponentiation)?n+="^":n+="**",nr.printMode===Xe?xw(e,r).length>1?(n+="{",n+=xw(e,r),n+="}"):n+=xw(e,r):f(e)||_p(e)||ne(e)&&Md(e,Yt)?(n+="(",n+=xw(e,r),n+=")"):n+=Iw(e,!1,!1,r)),n}function Iw(t,e=!1,r=!1,n){const s=e;if(ne(t)){let e="";return r&&Md(t,Yt)&&(e+="("),e+=function(t,e,r){if(re(t)){let r="",n=t.a.toString();if(e||"-"===n[0]&&(n=n.substring(1)),nr.printMode===Xe&&t.isFraction()&&(n="\\frac{"+n+"}{"),r+=n,t.isFraction()){nr.printMode!==Xe&&(r+="/");let e=t.b.toString();nr.printMode===Xe&&(e+="}"),r+=e}return r}if(it(t)){let n="",s=Lh(t.d,r);return e||"-"===s[0]&&(s=s.substring(1)),n+=s,n}throw new Error(`print_number(p = ${t})`)}(t,r,n),r&&Md(t,Yt)&&(e+=")"),e}if(j(t))return t.equals(H)?"true":"false";if(ae(t)){let e="";return e+='"',e+=t.str,e+='"',e}if(y(t)){let e="";return nr.printMode===Xe?e+=Lw(t,n):e+=Nw(t,n),e}if(mg(t)){let e="";return nr.printMode===Xe?e+=t.toLatexString():e+=t.toInfixString(),e}if(f(t)&&zf(t)){let e="";return s||"-"!==yw(t)&&nr.printMode===Xe||(nr.printMode===Xe?e+=" \\left (":e+="("),e+=xw(t,n),s||"-"!==yw(t)&&nr.printMode===Xe||(nr.printMode===Xe?e+=" \\right ) ":e+=")"),e}if(Kf(t)){let e="";return s||(e+="("),e+=xw(t,n),s||(e+=")"),e}if(Qf(t)){let e="";return e+=Rw(eh(t),sh(t),n),e}if(p(t).equals(un)){let e="";const r=eh(t);if(!nr.codeGen){e+="function ";e+=uw(sh(t),n),e+=" -> "}return e+=xw(r,n),e}if(p(t).equals(An)){let e="";return e+=xw(nh(t),n),nr.printMode===Xe?e+=" \\rightarrow ":nr.printMode!==er||nr.testFlag?e+="->":e+=" -> ",e+=xw(p(d(eh(t))),n),e}if(p(t).equals(dn)&&ue(eh(t))){let e="";return e+=function(t,e){let r="";if(th(t=d(t)).equals(fr)||th(t).equals(bn)||th(t).equals($n)||th(t).equals(nn)?r+=Aw(p(t),e):r+=xw(p(t),e),r+="[",f(t=d(t)))for(r+=xw(p(t),e),t=d(t);f(t);)r+=",",r+=xw(p(t),e),t=d(t);return r+="]",r}(t,n),e}if(f(t)&&Zf(t))return function(t,e){let r="";return _p(t=eh(t))||Kf(t)||zf(t)||Qf(t)||Zf(t)?r+=Aw(t,e):r+=xw(t,e),r+="!",r}(t,n);if(f(t)&&Bf(t))switch(nr.printMode){case er:case tr:return function(t,e){let r="";return r+="abs(",r+=xw(t.argList.head,e),r+=")",r}(t,n);case Xe:return function(t,e){let r="";return r+="\\left |",r+=xw(t.argList.head,e),r+=" \\right |",r}(t,n);default:throw new Error(nr.printMode)}else{if(p(t).equals(Wn)&&nr.printMode===Xe){let e="";return e+=function(t,e){let r="";return r+="\\sqrt{",r+=xw(eh(t),e),r+="} ",r}(t,n),e}if(Vf(t)){if(nr.printMode===Xe){let e="";return e+=function(t,e){let r="";return r+="{",f(eh(t))&&(r+="("),r+=xw(eh(t),e),f(eh(t))&&(r+=")"),r+="}",r+="^T",r}(t,n),e}if(nr.codeGen){let e="";return e+=function(t,e){let r="";return r+="transpose(",r+=xw(eh(t),e),r+=")",r}(t,n),e}}else if(p(t).equals(us)){if(nr.codeGen){let e="";return e+=function(t,e){let r="";return r+="identity(",r+=xw(eh(t),e),r+=")",r}(t,n),e}}else if(f(t)&&jf(t)){if(nr.printMode===Xe){let e="";return e+=function(t,e){let r="";return r+="{",f(eh(t))&&(r+="("),r+=xw(eh(t),e),f(eh(t))&&(r+=")"),r+="}",r+="^{-1}",r}(t,n),e}if(nr.codeGen){let e="";return e+=function(t,e){let r="";return r+="inv(",r+=xw(eh(t),e),r+=")",r}(t,n),e}}else{if(p(t).equals(Or)&&nr.printMode===Xe){let e="";return e+=function(t,e){let r="";return r+="\\binom{",r+=xw(eh(t),e),r+="}{",r+=xw(sh(t),e),r+="} ",r}(t,n),e}if(p(t).equals(Fr)&&nr.printMode===Xe){let e="";return e+=function(t,e){let r="";const n=p(d(t)),s=t=d(t);let i=0;for(;f(d(d(t)));){i++;const n=d(d(t));r+="\\int^{",r+=xw(p(d(n)),e),r+="}_{",r+=xw(p(n),e),r+="} \\! ",t=d(n)}r+=xw(n,e),r+=" \\,",t=s;for(let n=1;n<=i;n++){const s=d(t);r+=" \\mathrm{d} ",r+=xw(p(s),e),n<i&&(r+=" \\, "),t=d(d(s))}return r}(t,n),e}if(Hf(t)){if(nr.printMode===Xe){let e="";return e+=function(t,e){let r="";return r+=xw(eh(t),e),r+=" \\cdot ",r+=xw(sh(t),e),r}(t,n),e}if(nr.codeGen){let e="";return e+=function(t,e){let r="dot(";return r+=xw(eh(t),e),r+=", ",r+=xw(sh(t),e),r+=")",r}(t,n),e}}else if(p(t).equals(Hn)){if(nr.codeGen){let e="";return e+=function(t,e){let r="Math.sin(";return r+=xw(eh(t),e),r+=")",r}(t,n),e}}else if(p(t).equals(Ir)){if(nr.codeGen){let e="";return e+=function(t,e){let r="Math.cos(";return r+=xw(eh(t),e),r+=")",r}(t,n),e}}else if(p(t).equals(Yn)){if(nr.codeGen){let e="";return e+=function(t,e){let r="Math.tan(";return r+=xw(eh(t),e),r+=")",r}(t,n),e}}else if(p(t).equals(wr)){if(nr.codeGen){let e="";return e+=function(t,e){let r="Math.asin(";return r+=xw(eh(t),e),r+=")",r}(t,n),e}}else if(p(t).equals(mr)){if(nr.codeGen){let e="";return e+=function(t,e){let r="Math.acos(";return r+=xw(eh(t),e),r+=")",r}(t,n),e}}else if(p(t).equals(xr)){if(nr.codeGen){let e="";return e+=function(t,e){let r="Math.atan(";return r+=xw(eh(t),e),r+=")",r}(t,n),e}}else if(p(t).equals(Xn)){if(nr.printMode===Xe){let e="";return e+=function(t,e){let r="\\sum_{";return r+=xw(sh(t),e),r+="=",r+=xw(uh(t),e),r+="}^{",r+=xw(ch(t),e),r+="}{",r+=xw(eh(t),e),r+="}",r}(t,n),e}if(nr.codeGen){let e="";return e+=function(t,e){const r=eh(t),n=sh(t),s=uh(t),i=ch(t);return"(function(){ var "+xw(n,e)+";  var holderSum = 0;  var lowerlimit = "+xw(s,e)+";  var upperlimit = "+xw(i,e)+";  for ("+xw(n,e)+" = lowerlimit; "+xw(n,e)+" < upperlimit; "+xw(n,e)+"++) {    holderSum += "+xw(r,e)+"; }  return holderSum;})()"}(t,n),e}}else if(p(t).equals(Rn)){if(nr.printMode===Xe){let e="";return e+=function(t,e){let r="\\prod_{";return r+=xw(sh(t),e),r+="=",r+=xw(uh(t),e),r+="}^{",r+=xw(ch(t),e),r+="}{",r+=xw(eh(t),e),r+="}",r}(t,n),e}if(nr.codeGen){let e="";return e+=function(t,e){const r=eh(t),n=sh(t),s=uh(t),i=ch(t);return"(function(){ var "+xw(n,e)+";  var holderProduct = 1;  var lowerlimit = "+xw(s,e)+";  var upperlimit = "+xw(i,e)+";  for ("+xw(n,e)+" = lowerlimit; "+xw(n,e)+" < upperlimit; "+xw(n,e)+"++) {    holderProduct *= "+xw(r,e)+"; }  return holderProduct;})()"}(t,n),e}}else if(p(t).equals(an)){if(nr.codeGen){let e="";return e+=function(t,e){const r=eh(t),n=sh(t),s=uh(t),i=ch(t);return"(function(){ var "+n+";  var lowerlimit = "+xw(s,e)+";  var upperlimit = "+xw(i,e)+";  for ("+n+" = lowerlimit; "+n+" < upperlimit; "+n+"++) {    "+xw(r,e)+" } })()"}(t,n),e}}else if(p(t).equals(Qr)){if(nr.codeGen){let e="";return e+=function(t,e){let r="";for(t=d(t);f(t);)r+=xw(p(t),e),t=d(t);return r}(t,n),e}}else if(p(t).equals(rs)){if(nr.codeGen){let e="";return e+=function(t,e){let r="(function(){";t=d(t);let n=0;for(;f(t);){if(c===d(t)){r+="else {",r+="return ("+xw(p(t),e)+");,$",r+="}";break}n&&(r+=" else "),r+="if ("+xw(p(t),e)+"){,$",r+="return ("+xw(eh(t),e)+");,$",r+="}",n++,t=rh(t)}return r+="})()",r}(t,n),e}if(nr.printMode===Xe){let e="";return e+=function(t,e){let r="\\left\\{ \\begin{array}{ll}";for(t=d(t);f(t);){if(c===d(t)){r+="{",r+=xw(p(t),e),r+="} & otherwise ",r+=" \\\\\\\\";break}r+="{",r+=xw(eh(t),e),r+="} & if & ",r+=xw(p(t),e),r+=" \\\\\\\\",t=rh(t)}return r=r.substring(0,r.length-4),r+"\\end{array} \\right."}(t,n),e}}else if(p(t).equals(os)){if(nr.codeGen){let e="";return e+="(("+xw(eh(t),n)+") < ("+xw(sh(t),n)+"))",e}if(nr.printMode===Xe){let e="";return e+=function(t,e){let r="{";return r+=xw(eh(t),e),r+="}",r+=" < ",r+="{",r+=xw(sh(t),e),r+"}"}(t,n),e}}else if(p(t).equals(is)){if(nr.codeGen){let e="";return e+="(("+xw(eh(t),n)+") <= ("+xw(sh(t),n)+"))",e}if(nr.printMode===Xe){let e="";return e+=function(t,e){let r="{";return r+=xw(eh(t),e),r+="}",r+=" \\leq ",r+="{",r+=xw(sh(t),e),r+"}"}(t,n),e}}else if(p(t).equals(ss)){if(nr.codeGen){let e="";return e+="(("+xw(eh(t),n)+") > ("+xw(sh(t),n)+"))",e}if(nr.printMode===Xe){let e="";return e+=function(t,e){let r="{";return r+=xw(eh(t),e),r+="}",r+=" > ",r+="{",r+=xw(sh(t),e),r+"}"}(t,n),e}}else if(p(t).equals(ns)){if(nr.codeGen){let e="";return e+="(("+xw(eh(t),n)+") >= ("+xw(sh(t),n)+"))",e}if(nr.printMode===Xe){let e="";return e+=function(t,e){let r="{";return r+=xw(eh(t),e),r+="}",r+=" \\geq ",r+="{",r+=xw(sh(t),e),r+"}"}(t,n),e}}else if(f(t)&&t.opr.equals(pw)){if(nr.codeGen){let e="";return e+="(("+xw(eh(t),n)+") === ("+xw(sh(t),n)+"))",e}if(nr.printMode===Xe){let e="";return e+=function(t,e){let r="{";return r+=xw(t.lhs,e),r+="}",r+=" = ",r+="{",r+=xw(t.rhs,e),r+"}"}(t,n),e}}else if(p(t).equals(on)){if(nr.codeGen){let e="";return e+="Math.floor("+xw(eh(t),n)+"),$",e}if(nr.printMode===Xe){let e="";return e+=" \\lfloor {"+xw(eh(t),n)+"} \\rfloor ,$",e}}else if(p(t).equals(Er)){if(nr.codeGen){let e="";return e+="Math.ceiling("+xw(eh(t),n)+"),$",e}if(nr.printMode===Xe){let e="";return e+=" \\lceil {"+xw(eh(t),n)+"} \\rceil ,$",e}}else if(p(t).equals(Bn)){if(nr.codeGen){let e="";return e+="Math.round("+xw(eh(t),n)+"),$",e}}else if(p(t).equals(Qn)){if(nr.codeGen){let e="";return e+=function(t,e){let r="";return r+=xw(eh(t),e),r+=" = ",r+=xw(sh(t),e),r+="; ",r}(t,n),e}{let e="";return e+=xw(eh(t),n),e+="=",e+=xw(sh(t),n),e}}}}return function(t,e,r){if(f(t)){let n="";if(n+=Iw(t.car,!1,!1,r),t=t.cdr,c===t)return n;if(e||(n+="("),f(t))for(n+=xw(p(t),r),t=d(t);f(t);)n+=",",n+=xw(p(t),r),t=d(t);return e||(n+=")"),n}if(Le(t)){let e="";return e+=t.toString(),e}if(mg(t)){let e="";return e+=t.toString(),e}if(Vm.equals(t))return"d";if(Yf(t))return nr.codeGen?"Math.E":nr.printMode===Xe?"e":r.getSymbolPrintName(lw);if(lh(t))return nr.printMode===Xe?"\\pi":r.getSymbolPrintName(hw);if(ue(t))return nr.printMode===tr?r.toInfixString(t):nr.printMode===Xe?r.toLatexString(t):t.text;if(lt(t))return t.printname;if(h(t))return r.getSymbolPrintName(z(P.NIL));if(Xs(t))return cw;if(pt(t))return nr.printMode===Xe?"i":r.getSymbolPrintName(fw);throw new Error(`${t} ???`)}(t,s,n)}function Pw(){return nr.printMode===Xe?"":nr.printMode!==er||nr.testFlag||nr.codeGen?"*":" "}function Fw(t,e){if(f(t)&&Qf(t)){const e=t.cdr;if(f(e)){if(!Yf(e.car)){const t=e.cdr;if(f(t)){return $d(t.car)}}}}return!1}function Uw(t,e){const r=nr.codeGen,n=nr.printMode;nr.codeGen=!1,nr.setPrintMode(tr);try{let r=xw(t,e);return r=r.replace(/_/g,"\\_"),r}finally{nr.codeGen=r,nr.setPrintMode(n)}}function Cw(t,e){const r=nr.codeGen,n=nr.printMode;nr.codeGen=!1,nr.setPrintMode(Xe);try{let r=xw(t,e);return r=r.replace(/_/g,"\\_"),r}finally{nr.codeGen=r,nr.setPrintMode(n)}}class Dw{constructor(t,e){this.name=t,this.$=e}compareFactors(t,e){throw new Error("Abtract Operator Method not implemented.")}compareTerms(t,e){throw new Error("Abtract Operator Method not implemented.")}subst(t,e,r){const n=this.$;if(n.equals(t,e))return r;if(f(t)){const s=Td(t,0),i=Cp(s,e,r,n);if(n.equals(i,s)){const i=Td(t,1),o=Td(t,2),a=Cp(i,e,r,n),c=Cp(o,e,r,n);return n.equals(i,a)&&n.equals(o,c)?t:u(s,a,c)}{const s=Td(t,1),o=Td(t,2);return u(i,Cp(s,e,r,n),Cp(o,e,r,n))}}if(ue(t))return ue(e)&&t.equalsSym(e)?r:t;throw new $i}toInfixString(t){return Uw(t,this.$)}toLatexString(t){return Cw(t,this.$)}toListString(t){return uw(t,this.$)}valueOf(t){throw new Error(`AbstractOperator.valueOf ${t} method not implemented.`)}}class Bw extends Dw{constructor(t,e,r){super(t,r),this.opr=e,this.key=`(${e.key()})`}evaluate(t){const e=a(this.opr,t);return this.transform(e,this.$)}transform(t,e){throw new Error(`FunctionVarArgs.transform must be implemented in ${this.name}`)}isKind(t){return t.opr.equals(this.opr)}isImag(t){return!1}isMinusOne(t){return!1}isOne(t){return!1}isReal(t){return!1}isScalar(t){return!1}isZero(t){return!1}}class Kw extends Bw{constructor(t,e,r,n){super(t,e,n),this.guard=r}isKind(t){return!!this.match(t)}match(t){if(f(t)&&2===t.length){const e=t.opr,r=t.item(1);return ue(e)&&this.opr.equalsSym(e)&&this.guard(r)?t:void 0}}transform(t){const e=this.match(t);if(e){const t=this.$,r=t.valueOf(e.arg);return r.equals(e.arg)?this.transform1(e.opr,e.arg,e):[q,t.valueOf(u(e.opr,r))]}return[S,t]}}class zw extends Kw{constructor(t,e,r){super(`${t}∘${e}`,t,f,r),this.innerOpr=e,this.hash=xi(this.opr,pi)}isKind(t){if(super.isKind(t)){const e=t.arg;return!!f(e)&&e.opr.equals(this.innerOpr)}return!1}}const Qw=z(P.abs),Zw=z(P.add);let Gw=class extends zw{constructor(t){super(Qw,Zw,t)}isKind(t){if(super.isKind(t)){return t.argList.head.tail().some(Dh)}return!1}transform1(t,e,r){const n=this.$,s=n.valueOf(Dm(n.power(n.inner(e,e),te),n));return[q,s]}};const Hw=new class{create(t){return new Gw(t)}};function Vw(t){if(void 0===t)throw new Error;return!0}function jw(t,e){return[t.equals(e)?S:q,t]}const Ww=z(P.abs);let Jw=class extends Kw{constructor(t){super("abs_any",Ww,Vw,t),this.phases=$}isKind(t){if(super.isKind(t)){const e=t.arg;return!!ue(e)||!l(e)}return!1}transform1(t,e,r){return jw(Hm(e,this.$),r)}};const Xw=new class{create(t){return new Jw(t)}},Yw=D("sqrt");let t_=class extends Kw{constructor(t,e,r,n){super(`${t.text}_${r}`,t,e,n),this.hash=xi(this.opr,r)}};class e_ extends t_{constructor(t,e){super(t,Q,ri,e)}}let r_=class extends e_{constructor(t){super(z(P.abs),t)}transform1(t,e,r){const n=this.$,s=e.__vbar__(e);return jw(n.valueOf(u(Yw,n.valueOf(s))),r)}};const n_=new class{create(t){return new r_(t)}};let s_=class extends Kw{constructor(t){super("abs_rat",z(P.abs),it,t),this.hash=xi(this.opr,ii)}transform1(t,e,r){return jw(e.abs(),r)}};const i_=new class{create(t){return new s_(t)}};let o_=class extends Kw{constructor(t){super("abs_imu",z(P.abs),pt,t),this.hash=xi(this.opr,ai)}transform1(t,e,r){return jw(Dt,r)}};const a_=new class{create(t){return new o_(t)}},u_=z(P.pow),c_=z(P.abs);let l_=class extends zw{constructor(t){super(c_,u_,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head.rhs;return re(e)&&e.isMinusOne()}return!1}transform1(t,e,r){const n=this.$,s=e.lhs,i=n.valueOf(u(t,s)),o=n.valueOf(u(e.opr,i,Jt));return[q,o]}};const f_=new class{create(t){return new l_(t)}};let h_=class extends Kw{constructor(t){super("abs_rat",z(P.abs),re,t),this.hash=xi(this.opr,ui)}transform1(t,e,r){return jw(e.abs(),r)}};const p_=new class{create(t){return new h_(t)}};class d_ extends Kw{constructor(t,e){super(`${t.text}_${fi}`,t,y,e),this.hash=xi(this.opr,fi)}}let m_=class extends d_{constructor(t){super(z(P.abs),t)}transform1(t,e,r){return jw(function(t,e){if(1!==t.ndim)throw new Error("abs(tensor) with tensor rank > 1");const r=Dm(t,e);return e.valueOf(Dm(e.power(e.inner(r,zp(r,e)),te),e))}(e,this.$),r)}};const g_=new class{create(t){return new m_(t)}};class w_ extends Kw{constructor(t,e,r,n){super(`${t.text}_${hi}`,t,e,n),this.hash=xi(this.opr,hi)}}class __ extends w_{constructor(t,e){super(t,Le,hi,e)}}let x_=class extends __{constructor(t){super(z(P.abs),t)}transform1(t,e,r){return jw(e,r)}};const y_=new class{create(t){return new x_(t)}};function v_(t,e,r,n,s){if(t.equals(e)){const e=s.valueOf(u(Pe,t,r)),n=s.valueOf(u(Pe,Bt,e));return[q,n]}if(ne(t)&&ne(e)){const n=s.valueOf(u(Pe,Pd(t,e),r));return[q,n]}if(f(t)&&Up(t)){if(ne(t.lhs)&&t.rhs.equals(e)){const n=s.valueOf(u(Pe,Pd(t.lhs,Dt),e)),i=s.valueOf(u(Pe,n,r));return[q,i]}if(f(e)&&Up(e)&&t.rhs.equals(e.rhs))return v_(t.lhs,e.lhs,s.valueOf(u(Pe,t.rhs,r)),n,s);if(t.rhs.equals(e)){const n=u(Re,t.lhs,Dt),s=u(Pe,n,e),i=u(Pe,s,r);return[q,i]}}if(f(e)&&Up(e)&&ne(e.lhs)&&e.rhs.equals(t)){const n=s.valueOf(u(Pe,Pd(e.lhs,Dt),t)),i=s.valueOf(u(Pe,n,r));return[q,i]}return[S,n]}function b_(t,e){if(t.equals(e))return!0;if(ne(t)&&ne(e))return!0;if(f(t)&&Up(t)){if(ne(t.lhs)&&t.rhs.equals(e))return!0;if(f(e)&&Up(e)&&t.rhs.equals(e.rhs))return b_(t.lhs,e.lhs);if(t.rhs.equals(e))return!0}return!!(f(e)&&Up(e)&&ne(e.lhs)&&e.rhs.equals(t))}function O_(t,e){return function(r){return t(r)&&e(r)}}class E_ extends Bw{constructor(t,e,r,n,s){super(t,e,s),this.guardL=r,this.guardR=n}isKind(t){return!!this.match(t)}match(t){try{if(f(t)&&3===t.length){const e=t.opr,r=t.item(1),n=t.item(2);return ue(e)&&this.opr.equalsSym(e)&&this.guardL(r)&&this.guardR(n)?t:void 0}return}catch(t){throw new Error(`${this.name} + ${t}`)}}transform(t){const e=this.match(t);if(e){const t=this.$,[r,n]=t.transform(e.lhs),[s,i]=t.transform(e.rhs);return A(r)||A(s)?[q,t.valueOf(u(e.opr,n,i))]:this.transform2(e.opr,e.lhs,e.rhs,e)}return[S,t]}}class S_ extends E_{constructor(t,e,r,n,s,i){super(t,e,r,n,i),this.cross=s,this.$=i}match(t){const e=super.match(t);if(e&&this.cross(e.lhs,e.rhs,e))return e}transform(t){const e=this.match(t);if(e){const t=this.$,[r,n]=t.transform(e.lhs),[s,i]=t.transform(e.rhs);return A(r)||A(s)?[q,t.valueOf(u(e.opr,n,i))]:this.transform2(e.opr,e.lhs,e.rhs,e)}return[S,t]}}function q_(t){return Fp(Re)(t)}let T_=class extends S_{constructor(t){super("add_2_add_2_any_any_any_factorize_rhs",Re,O_(f,q_),Vw,(function(t,e){return b_(t.rhs,e)}),t),this.hash=wi(Re,Re,pi)}transform2(t,e,r,n){const s=this.$;if(s.isExpanding()){const t=e.lhs,i=v_(e.rhs,r,Dt,n,s)[1];return[q,s.valueOf(u(Re,t,i))]}return[S,n]}};const M_=new class{create(t){return new T_(t)}};function A_(t){return Up(t)&&re(t.lhs)&&ue(t.rhs)}function N_(t){if(q_(t)){const e=t.lhs,r=t.rhs;return Vw(e)&&ue(r)}return!1}function $_(t,e){switch(t.rhs.compare(e.rhs)){case E:case O:return!0;default:return!1}}let L_=class extends S_{constructor(t){super("add_2_add_2_any_mul_2_rat_sym",Re,O_(f,N_),O_(f,A_),$_,t),this.hash=_i(Re,Re,Pe)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.rhs,a=r.lhs;if(i.compare(o)===E){const t=n.valueOf(Rd(Re,n.valueOf(Rd(Re,s,r)),i));return[q,t]}{const t=n.valueOf(Rd(Re,s,n.valueOf(Rd(Pe,a.succ(),i))));return[q,t]}}};const k_=new class{create(t){return new L_(t)}};let R_=class extends S_{constructor(t){super("add_2_any_any_factorize_rhs",Re,Vw,Vw,function(t){return function(e,r){return!!t.isFactoring()&&b_(e,r)}}(t),t),this.hash=mi(Re,pi,pi)}transform2(t,e,r,n){const s=this.$;return v_(e,r,Dt,n,s)}};const I_=new class{create(t){return new R_(t)}};function P_(t,e,r){if(ne(t)&&ne(e))return function(t,e){return Pd(t,e).isZero()}(t,e);if(f(t)&&Up(t)){const n=t.lhs,s=t.rhs,i=e;if(s.equals(i))return r.isMinusOne(n)||r.is_zero(s);if(f(e)&&Up(e)){const t=e.lhs,i=e.rhs;if(s.equals(i))return P_(n,t,r)||r.is_zero(s)}}if(f(e)&&Up(e)){const n=t,s=e.lhs;if(e.rhs.equals(n))return r.isMinusOne(s)||r.is_zero(n)}return!1}let F_=class extends S_{constructor(t){super("add_2_any_any_zero_sum",Re,Vw,Vw,function(t){return function(e,r){return P_(e,r,t)}}(t),t),this.hash=mi(Re,pi,pi)}transform2(t,e,r,n){return[q,Yt]}};const U_=new class{create(t){return new F_(t)}};function C_(t,e,r){if(Q(t)&&Q(e))return wh(t,e);throw new Error}function D_(t,e){return!0}let B_=class extends S_{constructor(t,e){super("add_2_blade_blade",Re,Q,Q,D_,t),this.comparator=e,this.hash=mi(Re,ri,ri)}transform2(t,e,r,n){const s=this.$;switch(this.comparator(e,r,s)){case E:return[q,u(t,r,e)];case O:return[q,u(Pe,Bt,e)];default:return[T,n]}}};const K_=new class{create(t,e){return e.noOptimize?new B_(t,Qh):new B_(t,C_)}};function z_(t){return Up(t)&&re(t.lhs)&&Q(t.rhs)}let Q_=class extends E_{constructor(t,e){super("add_2_blade_mul_2_rat_blade",Re,Q,O_(f,z_),t),this.config=e,this.hash=gi(Re,ri,Pe)}transform2(t,e,r,n){const s=this.$;if(this.config.noOptimize)return[S,n];if(!s.isExpanding())return[S,n];switch(wh(e,r.rhs)){case E:return[q,u(t,r,e)];case O:{const t=r.lhs.succ();return t.isZero()?[q,Yt]:t.isOne()?[q,e]:[q,u(r.opr,t,e)]}default:return[T,n]}}};const Z_=new class{create(t,e){return new Q_(t,e)}};let G_=class extends E_{constructor(t){super("add_2_flt_any",Re,it,Vw,t),this.dependencies=["Flt"],this.hash=mi(Re,ii,pi)}transform2(t,e,r,n){const s=this.$,i=hh(r,s);if(e.isZero())return[q,i];if(i.equals(r))return[S,n];return jw(s.add(e,i),n)}};const H_=new class{create(t){return new G_(t)}};let V_=class extends E_{constructor(t){super("add_2_flt_flt",Re,it,it,t),this.dependencies=["Flt"],this.hash=mi(Re,ii,ii)}transform2(t,e,r,n){return[q,n.lhs.add(n.rhs)]}};const j_=new class{create(t){return new V_(t)}};let W_=class extends E_{constructor(t){super("add_2_flt_rat",Re,it,re,t),this.dependencies=["Flt"],this.hash=mi(Re,ii,ui)}transform2(t,e,r){const n=e.toNumber(),s=r.toNumber();return[q,W(n+s)]}};const J_=new class{create(t){return new W_(t)}};function X_(t){return t instanceof $e}class Y_{constructor(t){}get key(){return $e.ONE.name}get hash(){return hi}get name(){return"UomExtension"}get dependencies(){return["Uom"]}valueOf(t,e){throw new Error("Method not implemented.")}isImag(t){return!1}isKind(t){return X_(t)}isMinusOne(t){return!1}isOne(t){return t.isOne()}isReal(t){return!1}isScalar(t){return!0}isZero(){return!1}subst(t,e,r){return X_(e)&&t.equals(e)?r:t}toInfixString(t){return t.toInfixString()}toLatexString(t){return t.toInfixString()}toListString(t){return t.toListString()}evaluate(t,e){return this.transform(a(t,e))}transform(t){return X_(t)?[T,t]:[S,t]}}const tx=new qi((function(t){return new Y_(t)}));let ex=class extends E_{constructor(t){super("add_2_flt_uom",Re,it,X_,t),this.dependencies=["Flt","Uom"],this.hash=mi(Re,ii,hi)}transform2(t,e,r,n){throw new TypeError(this.$.toInfixString(n))}};const rx=new class{create(t){return new ex(t)}};let nx=class extends E_{constructor(t){super("add_2_imu_flt",Re,pt,it,t),this.phases=I,this.dependencies=["Flt","Imu"],this.hash=wi(Re,Ue,ii)}transform2(t,e,r){return[q,u(t,r,e)]}};const sx=new class{create(t){return new nx(t)}};function ix(t){return u(t.opr,t.rhs,t.lhs)}function ox(t,e,r){return function(n){return Fp(t)(n)&&e(n.lhs)&&r(n.rhs)}}let ax=class extends E_{constructor(t){super("add_2_mul_2_any_imu_sym",Re,O_(f,ox(Pe,Vw,pt)),ue,t),this.hash=wi(Re,Pe,li)}transform2(t,e,r,n){return[q,ix(n)]}};const ux=new class{create(t){return new ax(t)}};function cx(t){return Up(t)&&re(t.lhs)}function lx(t,e){const r=t.rhs,n=e.rhs;return!!r.equals(n)}let fx=class extends S_{constructor(t){super("add_2_mul_2_rat_X_mul_2_rat_X",Re,O_(f,cx),O_(f,cx),lx,t),this.hash=_i(Re,Pe,Pe)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.lhs,a=s.add(o),c=n.valueOf(u(Pe,a,i));return[q,c]}};const hx=new class{create(t){return new fx(t)}};function px(t,e){return Fh(t.rhs,e)>0}let dx=class extends S_{constructor(t){super("add_2_mul_2_rat_zzz_aaa",Re,O_(f,A_),ue,px,t),this.hash=wi(Re,Pe,li)}transform2(t,e,r,n){return[q,ix(n)]}};const mx=new class{create(t){return new dx(t)}};let gx=class extends E_{constructor(t){super("add_2_pow_2_any_any_mul_2_any_any",Re,O_(f,Lm),O_(f,Up),t),this.hash=_i(Re,Ue,Pe)}transform2(t,e,r,n){return[S,n]}};const wx=new class{create(t){return new gx(t)}};let _x=class extends E_{constructor(t){super("add_2_rat_blade",Re,re,Q,t),this.hash=mi(Re,ui,ri)}transform2(t,e,r,n){return e.isZero()?[q,r]:[T,n]}};const xx=new class{create(t){return new _x(t)}};let yx=class extends E_{constructor(t){super("add_rat_flt",Re,re,it,t),this.dependencies=["Flt"],this.hash=mi(Re,ui,ii)}transform2(t,e,r){const n=e.toNumber(),s=r.toNumber();return[q,W(n+s)]}};const vx=new class{create(t){return new yx(t)}};let bx=class extends E_{constructor(t){super("add_2_rat_rat",Re,re,re,t),this.hash=mi(Re,ui,ui)}transform2(t,e,r){return[q,e.add(r)]}};const Ox=new class{create(t){return new bx(t)}};let Ex=class extends E_{constructor(t){super("add_2_rat_sym",Re,re,ue,t),this.hash=mi(Re,ui,li)}isScalar(t){const e=t.lhs,r=t.rhs;return this.$.isScalar(e)&&this.$.isScalar(r)}isReal(t){const e=t.lhs,r=t.rhs;return this.$.is_real(e)&&this.$.is_real(r)}transform2(t,e,r,n){return e.isZero()?[q,r]:[T,n]}};const Sx=new class{create(t){return new Ex(t)}};let qx=class extends E_{constructor(t){super("add_2_rat_uom",Re,re,X_,t),this.hash=mi(Re,ui,hi)}transform2(t,e,r,n){throw new TypeError(this.$.toInfixString(n))}};const Tx=new class{create(t){return new qx(t)}};let Mx=class extends E_{constructor(t){super("add_2_sym_rat",Re,ue,re,t),this.hash=mi(Re,li,ui)}transform2(t,e,r){if(r.isZero())return[q,e];{const n=this.$;return[q,n.valueOf(u(t,r,e))]}}};const Ax=new class{create(t){return new Mx(t)}};let Nx=class extends E_{constructor(t){super("add_2_sym_sym",Re,ue,ue,t),this.hash=mi(Re,li,li)}transform2(t,e,r,n){switch(Fh(e,r)){case E:return[q,u(t,r,e)];case b:return[T,n];default:return e.equals(r)?[q,u(Pe.clone(t.pos,t.end),Bt,e)]:[T,n]}}};const $x=new class{create(t){return new Nx(t)}};function Lx(t,e){return"-"===yw(t)?`-${bw(t,e)}`:bw(t,e)}function kx(t,e,r){return t.sameDimensions(e)?t.map((function(t,n){return r.add(t,e.elem(n))})):c}class Rx{constructor(t){this.$=t}get key(){return fi}get hash(){return fi}get name(){return"TensorExtension"}isImag(t){return!1}isKind(t){return t instanceof x}isMinusOne(t){return!1}isOne(t){return!1}isReal(t){return!1}isScalar(){return!1}isZero(t,e){return t.everyElement((function(t){return e.is_zero(t)}))}subst(t,e,r,n){if(y(e)&&t.equals(e))return r;const s=t.mapElements((t=>Cp(t,e,r,n)));return function(t,e,r){const n=t.length;for(let s=0;s<n;s++)if(!r.equals(t[s],e[s]))return!1;return!0}(t.copyElements(),s,n)?t:t.withElements(s)}toInfixString(t,e){return Lx(t,e)}toLatexString(t,e){return Lx(t,e)}toListString(t,e){return Lx(t,e)}evaluate(t,e){return this.transform(a(t,e))}transform(t){const e=this.$;if(this.isKind(t)){const r=t.mapElements((function(t){return e.valueOf(t)})),n=t.withElements(r);return[!n.equals(t)?q:S,n]}return[S,t]}valueOf(t,e){const r=t.mapElements((function(t){return e.valueOf(t)}));return t.withElements(r)}}const Ix=new qi((function(t){return new Rx(t)}));let Px=class extends E_{constructor(t){super("add_2_tensor_tensor",Re,y,y,t),this.hash=mi(Re,fi,fi)}transform2(t,e,r){const n=this.$;return[q,kx(e,r,n)]}};const Fx=new class{create(t){return new Px(t)}};let Ux=class extends E_{constructor(t){super("add_2_uom_flt",Re,X_,it,t),this.dependencies=["Flt","Uom"],this.hash=mi(Re,hi,ii)}transform2(t,e,r,n){throw new TypeError(this.$.toInfixString(n))}};const Cx=new class{create(t){return new Ux(t)}};let Dx=class extends E_{constructor(t){super("add_2_uom_rat",Re,X_,re,t),this.dependencies=["Uom"],this.hash=mi(Re,hi,ui)}transform2(t,e,r,n){throw new TypeError(this.$.toInfixString(n))}};const Bx=new class{create(t){return new Dx(t)}};function Kx(t,e){return e.lhs.isMinusOne()&&t.equalsSym(e.rhs)}let zx=class extends S_{constructor(t){super("add_2_xxx_mul_2_rm1_xxx",Re,ue,O_(f,A_),Kx,t),this.hash=gi(Re,li,Pe)}transform2(t,e,r,n){return[q,Yt]}};const Qx=new class{create(t){return new zx(t)}};function Zx(t,e){const r=[],n=t.argList,s=n.map(e.valueOf);if(s.equals(n)){const t=[...s],n=t.some((t=>it(t)&&t.isZero()));for(const s of t)Gx(r,n?hh(s,e):e.valueOf(s));return function(t,e){t.forEach((function(t){}));const r=e.compareFn(Re);for(let n=0;n<10&&!(t.length<2);n++){let n=0;const s=function(t,e){if(ne(t)&&ne(e))return n=1,O;const s=Sh(t),i=Sh(e);if(y(s)&&y(i)){if(s.ndim<i.ndim)return b;if(s.ndim>i.ndim)return E;const t=s.ndim;for(let e=0;e<t;e++){if(s.dim(e)<i.dim(e))return b;if(s.dim(e)>i.dim(e))return E}return n=1,O}if(Dh(s)&&Dh(i)){switch(wh(Kh(s),Kh(i))){case b:return b;case E:return E;default:switch(r(qh(s,Q),qh(i,Q))){case b:return b;case E:return E;case O:return n=1,O}}}const o=r(s,i);return o===O&&(n=1),o};if(t.sort(s),0===n)break;Hx(t,e)}switch(t.length){case 0:return Yt;case 1:return t[0];default:return t.unshift(Re),u(...t)}}(r,e)}return e.valueOf(a(t.car,s))}function Gx(t,e){Kf(e)?t.push(...e.tail()):ne(e)&&e.isZero()||t.push(e)}function Hx(t,e){let r=0;for(;r<t.length-1;){let n=t[r],s=t[r+1];if(y(n)&&y(s)){const i=kx(n,s,e);h(i)||(t.splice(r,2,i),r--),r++;continue}if(y(n)||y(s)){r++;continue}if(ne(n)&&ne(s)){const i=Pd(n,s);Vx(i,e)?2===t.length?t.splice(r,2,i):t.splice(r,2):t.splice(r,2,i),r--,r++;continue}if(ne(n)||ne(s)){r++;continue}let i=Dt,o=Dt,u=0;if(zf(n)&&(n=d(n),u=1,ne(p(n))&&(i=p(n),n=d(n),h(d(n))&&(n=p(n),u=0))),zf(s)&&(s=d(s),ne(p(s))&&(o=p(s),s=d(s),h(d(s))&&(s=p(s)))),!n.equals(s)){r++;continue}if(i=Pd(i,o),Vx(i,e)){t.splice(r,2),r--,r++;continue}const c=u?a(Pe,n):n;t.splice(r,2,e.multiply(i,c)),r--,r++}}function Vx(t,e){return function(t){return ne(t)&&t.isZero()}(t)||function(t,e){return y(t)&&e.is_zero(t)}(t,e)}class jx extends Bw{constructor(t){super("add_varargs",fr,t),this.hash=vi(this.opr)}transform(t){const e=Zx(t,this.$);return[e.equals(t)?S:q,((t,e)=>e)(0,e)]}}const Wx=new class{create(t){return new jx(t)}};function Jx(t,e){if(!wy(t))return Rd(Dr,t);const r=t.copyElements();return r.every((t=>ne(t)))?function(t,e){const r=t.dim(0),n=function(t,e,r){let n=Dt;for(let s=0;s<e-1;s++){if(r.equals(Yx(t,e,s,s),Yt)){let i=0;for(i=s+1;i<e&&r.equals(Yx(t,e,i,s),Yt);i++);if(i===e){n=Yt;break}for(let r=s;r<e;r++){const n=Yx(t,e,s,r);ty(t,e,s,r,Yx(t,e,i,r)),ty(t,e,i,r,n)}n=r.negate(n)}n=r.multiply(n,Yx(t,e,s,s));for(let n=s+1;n<e;n++){const i=r.negate(kp(Yx(t,e,n,s),Yx(t,e,s,s),r));ty(t,e,n,s,Yt);for(let o=s+1;o<e;o++){ty(t,e,n,o,r.add(r.multiply(Yx(t,e,s,o),i),Yx(t,e,n,o)))}}}return r.multiply(n,Yx(t,e,e-1,e-1))}(t.copyElements(),r,e);return n}(t,e):Xx(r,t.dim(0),e)}function Xx(t,e,r){if(0===e)return Dt;let n=0;const s=[];for(let t=0;t<e;t++)s[t]=t,s[t+e]=0,s[t+e+e]=1;let i=1,o=Yt;for(;;){let a=Ut(i);for(let n=0;n<e;n++){const i=e*s[n]+n;a=r.multiply(a,t[i])}o=r.add(o,a);let u=e-1,c=0,l=!1;for(;;)if(n=s[e+u]+s[e+e+u],n<0)s[e+e+u]=-s[e+e+u],u--;else{if(n!==u+1)break;if(0===u){l=!0;break}c++,s[e+e+u]=-s[e+e+u],u--}if(l)break;const f=s[u-s[e+u]+c];s[u-s[e+u]+c]=s[u-n+c],s[u-n+c]=f,s[e+u]=n,i=1===i?-1:1}return o}function Yx(t,e,r,n){return t[e*r+n]}function ty(t,e,r,n,s){t[e*r+n]=s}function ey(t,e){if(f(t)&&jf(t))return t.argList;if(Jf(t))return t;if(e.isExpanding()&&Hf(t)){const r=(f(t)?t.tail():[]).map((function(t){return ey(t,e)}));for(let t=r.length-1;t>0;t--)r[t-1]=e.inner(r[t],r[t-1]);return r[0]}if(!wy(t))return u(gn,t);if(Wf(t))return function(t,e){const r=t.dim(0),n=new Array(r*r);n.fill(Yt);for(let t=0;t<r;t++)n[t*r+t]=Dt;const s=function(t,e,r,n){for(let s=0;s<r;s++){if(n.equals(e[r*s+s],Yt)){let i=0;for(i=s+1;i<r&&n.equals(e[r*i+s],Yt);i++);i===r&&sr("inverse of singular matrix");for(let n=0;n<r;n++){let o=e[r*s+n];e[r*s+n]=e[r*i+n],e[r*i+n]=o,o=t[r*s+n],t[r*s+n]=t[r*i+n],t[r*i+n]=o}}const i=e[r*s+s];for(let o=0;o<r;o++)o>s&&(e[r*s+o]=kp(e[r*s+o],i,n)),t[r*s+o]=kp(t[r*s+o],i,n);for(let i=0;i<r;i++){if(i===s)continue;const o=e[r*i+s];for(let a=0;a<r;a++)a>s&&(e[r*i+a]=n.subtract(e[r*i+a],n.multiply(e[r*s+a],o))),t[r*i+a]=n.subtract(t[r*i+a],n.multiply(t[r*s+a],o))}}return t}(n,t.copyElements(),r,e);return new x([r,r],s)}(t,e);const r=Jx(t,e);return e.is_zero(r)&&sr("inverse of singular matrix"),kp(vy(t,e),r,e)}function ry(t,e){return it(t)||re(t)?e.is_zero(t)?Dt:Yt:Qf(t)?u(Kr,eh(t)):$d(t)?u(Kr,e.negate(t)):(($d(t)||f(t)&&Kf(t)&&$d(eh(t)))&&(t=e.negate(t)),u(Kr,t))}function ny(t,e,r){return function(t,e,r){const n=Sf(e);if(it(t)&&!isNaN(n)){return W(function(t,e){throw new Error("Not implemented")}(0,t.d))}if(r.is_zero(t)&&r.is_zero(e))return Dt;if(r.is_zero(t)&&!isNaN(n))return Yt;if(re(e)&&Vs(e.b,2)){if(Vs(e.a,1)){const e=r.getNativeDirective(N.evaluatingAsFloat)?W(2/Math.PI):kp(Bt,qs,r);return r.multiply(r.power(kp(e,t,r),te),Pm(t,r))}if(Vs(e.a,-1)){const e=r.getNativeDirective(N.evaluatingAsFloat)?W(2/Math.PI):kp(Bt,qs,r);return r.multiply(r.power(kp(e,t,r),te),Rm(t,r))}const n=Ut(Hs(e.a));return r.subtract(r.multiply(r.multiply(kp(Bt,t,r),e.sub(n)),ny(t,r.subtract(e,n),r)),ny(t,r.subtract(e,Bt.mul(n)),r))}if($d(t))return r.multiply(r.multiply(r.power(r.negate(t),e),r.power(t,r.negate(e))),Rd(vr,r.negate(t),e));if($d(e))return r.multiply(r.power(Jt,e),Rd(vr,t,r.negate(e)));return Rd(vr,t,e)}(t,e,r)}function sy(t,e,r){return function(t,e,r){const n=Sf(e);if(it(t)&&!isNaN(n)){return W(function(t,e){throw new Error("Not implemented")}(0,t.d))}if($d(e))return r.multiply(r.power(Jt,e),Rd(br,t,r.negate(e)));return Rd(br,t,e)}(t,e,r)}function iy(t,e){if(p(t).equals(gr))return eh(t);if(it(t)){let e=Math.cosh(t.d);return Math.abs(e)<1e-10&&(e=0),W(e)}return e.is_zero(t)?Dt:u(Pr,t)}function oy(t,e,r){return function(t,e,r){const n=Sf(e);if(n<0||isNaN(n))return Rd(fn,t,e);if(ue(t))return ay(n,t,r);return r.valueOf(Cp(ay(n,Ss,r),Ss,t,r))}(t,e,r)}function ay(t,e,r){let n=Yt,s=Dt;for(let i=0;i<t;i++){const t=n;n=s,s=r.multiply(r.subtract(r.multiply(e,n),r.multiply(Ut(i),t)),Bt)}return s}let uy=class extends Kw{constructor(t){super("sgn_any",Zn,Vw,t),this.hash=xi(this.opr,pi)}isKind(t){return!!super.isKind(t)&&!it(t)}transform1(t,e){return[q,ly(e,this.$)]}};const cy=new class{create(t){return new uy(t)}};function ly(t,e){return kp(t,Hm(t,e),e)}function fy(t,e){if(p(t).equals(_r))return eh(t);if(it(t)){let e=Math.sinh(t.d);return Math.abs(e)<1e-10&&(e=0),W(e)}return e.is_zero(t)?Yt:Rd(Vn,t)}function hy(t,e){if(Yf(t))return Dt;if(re(t)&&t.isOne())return Yt;if(it(t)&&t.isOne())return X;if(tp(t)){const r=hy(e.negate(t),e),n=e.multiply(ht,lr.Pi(e));return e.add(r,n)}return it(t)?W(Math.log(t.d)):re(t)&&t.isFraction()?e.subtract(hy(Am(t,e),e),hy(_m(t,e),e)):Qf(t)?e.multiply(sh(t),hy(eh(t),e)):zf(t)?t.tail().map((function(t){return hy(t,e)})).reduce((function(t,r){return e.add(t,r)}),Yt):Rd(vn,t)}function py(t,e,r){const n=eh(t),s=sh(t),i=kp(s,n,r),o=gy(n,e,r),a=hy(n,r),u=gy(s,e,r);return r.multiply(r.add(r.multiply(i,o),r.multiply(a,u)),t)}function dy(t,e,r){const n=Yh(t)-1,s=[];for(let i=0;i<n;i++){const o=[];let a=d(t);for(let t=0;t<n;t++){const n=p(a);i===t?o.push(gy(n,e,r)):o.push(n),a=d(a)}s.push(Qd(o,r))}return Dd(s,r)}function my(t,e,r){if(ue(e))return function(t,e,r){if(t.equals(e))return Dt;if(ue(t))return t.equals(Ze)||t.equals(Ge)?Yt:u(Vm,t,e);if(!f(t))return Yt;if(Bf(t))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(n,ly(eh(t),r))}(t,e,r);if(Kf(t))return function(t,e,r){const n=f(t)?t.tail().map((t=>gy(t,e,r))):[];return Dd(n,r)}(t,e,r);const n=p(t);if(n.equals(bn))return dy(t,e,r);if(n.equals($n))return py(t,e,r);if(n.equals(Vm))return function(t,e,r){const n=gy(eh(t),e,r);if(p(n).equals(Vm)){const e=sh(n),s=sh(t),i=eh(n);return r.compareFn(Re)(e,s)<0?u(Vm,u(Vm,i,e),s):u(Vm,u(Vm,i,s),e)}return gy(n,sh(t),r)}(t,e,r);if(n.equals(vn))return function(t,e,r){const n=gy(eh(t),e,r);return kp(n,eh(t),r)}(t,e,r);if(n.equals(Hn))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(n,Rm(eh(t),r))}(t,e,r);if(n.equals(Ir))return function(t,e,r){const n=gy(eh(t),e,r);return r.negate(r.multiply(n,Pm(eh(t),r)))}(t,e,r);if(n.equals(Yn))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(n,r.power(Rm(eh(t),r),Ut(-2)))}(t,e,r);if(n.equals(wr))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(n,r.power(r.subtract(Dt,r.power(eh(t),Bt)),Pf(-1,2)))}(t,e,r);if(n.equals(mr))return function(t,e,r){const n=gy(eh(t),e,r);return r.negate(r.multiply(n,r.power(r.subtract(Dt,r.power(eh(t),Bt)),Pf(-1,2))))}(t,e,r);if(n.equals(xr))return function(t,e,r){const n=gy(eh(t),e,r),s=Lp(r.add(Dt,r.power(eh(t),Bt)),r);return Dm(r.multiply(n,s),r)}(t,e,r);if(n.equals(Vn))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(n,iy(eh(t),r))}(t,e,r);if(n.equals(Pr))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(n,fy(eh(t),r))}(t,e,r);if(n.equals(ts))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(n,r.power(iy(eh(t),r),Ut(-2)))}(t,e,r);if(n.equals(_r))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(n,r.power(r.add(r.power(eh(t),Bt),Dt),Pf(-1,2)))}(t,e,r);if(n.equals(gr))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(n,r.power(r.add(r.power(eh(t),Bt),Jt),Pf(-1,2)))}(t,e,r);if(n.equals(yr))return function(t,e,r){const n=gy(eh(t),e,r),s=Lp(r.subtract(Dt,r.power(eh(t),Bt)),r);return r.multiply(n,s)}(t,e,r);if(n.equals(Zn))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(r.multiply(n,ry(eh(t),r)),Bt)}(t,e,r);if(n.equals(fn))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(r.multiply(n,r.multiply(Bt,sh(t))),oy(eh(t),r.add(sh(t),Jt),r))}(t,e,r);if(n.equals(jr))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(r.multiply(r.multiply(Ad(r.multiply(r.power(eh(t),Bt),Jt),r),r.power(lr.Pi(r),Pf(-1,2))),Bt),n)}(t,e,r);if(n.equals(Wr))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(r.multiply(r.multiply(Ad(r.multiply(r.power(eh(t),Bt),Jt),r),r.power(lr.Pi(r),Pf(-1,2))),Ut(-2)),n)}(t,e,r);if(n.equals(vr))return function(t,e,r){if(r.is_zero(sh(t)))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(r.multiply(n,ny(eh(t),Dt,r)),Jt)}(t,e,r);return function(t,e,r){const n=gy(eh(t),e,r),s=r.add(sh(t),Jt),i=r.multiply(sh(t),Jt),o=ny(eh(t),s,r),a=kp(i,eh(t),r),u=ny(eh(t),sh(t),r),c=r.multiply(a,u),l=r.add(o,c);return r.multiply(n,l)}(t,e,r)}(t,e,r);if(n.equals(br))return function(t,e,r){if(r.is_zero(sh(t)))return function(t,e,r){const n=gy(eh(t),e,r);return r.multiply(r.multiply(n,ny(eh(t),Dt,r)),Jt)}(t,e,r);return function(t,e,r){const n=gy(eh(t),e,r),s=r.add(sh(t),Jt),i=r.multiply(sh(t),Jt),o=kp(i,eh(t),r),a=sy(eh(t),sh(t),r),u=sy(eh(t),s,r),c=r.multiply(o,a),l=r.add(u,c);return r.multiply(n,l)}(t,e,r)}(t,e,r);if(p(t).equals(mn)&&sh(t).equals(e))return eh(t);return function(t,e,r){const n=t.argList;return c===n||n.contains(e),u(Vm,t,e)}(t,e)}(t,e,r);const n=Cp(t,e,Ss,r);return Cp(gy(n,Ss,r),Ss,e,r)}function gy(t,e,r){if(ne(e))throw new $i("undefined function");return y(t)?y(e)?function(t,e,r){if(t.ndim+1>=Ks)return Rd(Vm,t,e);const n=t.copyDimensions();n.push(e.dim(0));const s=t.nelem,i=e.nelem,o=new Array(s*i);for(let n=0;n<s;n++)for(let s=0;s<i;s++)o[n*i+s]=gy(t.elem(n),e.elem(s),r);return new x(n,o)}(t,e,r):function(t,e,r){const n=t.mapElements((t=>gy(t,e,r)));return t.withElements(n)}(t,e,r):y(e)?function(t,e,r){const n=[e.dim(0)],s=e.mapElements((e=>gy(t,e,r)));return new x(n,s)}(t,e,r):my(t,e,r)}function wy(t){return y(t)&&_y(t)}function _y(t){return 2===t.ndim&&t.dim(0)===t.dim(1)}function xy(t,e){return Sf(e.valueOf(t))}function yy(t,e,r,n){const s=t.dim(0),i=[];for(let n=0;n<s;n++)for(let o=0;o<s;o++)n!==e&&o!==r&&i.push(t.elem(s*n+o));const o=Xx(i,s-1,n);return(e+r)%2?n.negate(o):o}function vy(t,e){const r=function(t,e){if(_y(t))return t.dim(0);throw new Error(`tensor => ${e.toInfixString(t)} MUST be a square matrix. ${t} ndim=${t.ndim}`)}(t,e),n=new Array(t.nelem);for(let s=0;s<r;s++)for(let i=0;i<r;i++)n[r*i+s]=yy(t,s,i,e);return t.withElements(n)}let by=class extends Kw{constructor(t){super("adj",hr,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){const n=function(t,e){const r=p(t.cdr),n=e.valueOf(r);if(y(n))return vy(n,e);throw new Error("adj argument MUST be a tensor.")}(r,this.$);return[!n.equals(r)?q:S,n]}};const Oy=new class{create(t){return new by(t)}};function Ey(t,e,r){if(Q(t)){return t.extractGrade(e)}if(ue(t))return 0===e?t:Yt;if(it(t))return 0===e?t:Yt;if(Mi(t))return 0===e?t:Yt;if(f(t)&&Up(t)){const n=t.lhs,s=t.rhs;if(r.isScalar(n))return r.multiply(n,Ey(s,e,r));if(r.isScalar(s))return r.multiply(Ey(n,e,r),s);throw new Error(`extractGrade   ${n} * ${s}`)}throw new Error(`extractGrade(arg => ${t}, grade => ${e}) function not implemented.`)}function Sy(t,e,r){return r.isOne(e)?t:a(Pe,u(t,e))}class qy{constructor(t,e){this.dimensions=t,this.$=e}get"ε"(){return W(1e-6)}get one(){return Dt}get zero(){return Yt}abs(){throw new Error("abs Method not implemented.")}add(t,e){if(this.$.isOne(t)){if(this.$.isOne(e))return Bt;throw new Error("add Method not implemented.")}throw new Error("add Method not implemented.")}sub(t,e){throw new Error("sub Method not implemented.")}eq(t,e){throw new Error("eq Method not implemented.")}ne(t,e){throw new Error("ne Method not implemented.")}le(t,e){throw new Error("le Method not implemented.")}lt(t,e){throw new Error("lt Method not implemented.")}ge(t,e){throw new Error("ge Method not implemented.")}gt(t,e){throw new Error("gt Method not implemented.")}max(t,e){throw new Error("max Method not implemented.")}min(t,e){throw new Error("min Method not implemented.")}mul(t,e){return this.$.multiply(t,e)}div(t,e){throw new Error("div Method not implemented.")}neg(t){if(re(t))return t.neg();throw new Error(`neg ${t} Method not implemented.`)}asString(t){throw new Error("asString Method not implemented.")}cos(t){throw new Error("cos Method not implemented.")}isField(t){if(re(t))return!0;if(it(t))return!0;if(mg(t))return!1;throw new Error("isField method not implemented.")}isOne(t){throw new Error("isOne Method not implemented.")}isZero(t){return this.$.is_zero(t)}sin(t){throw new Error("sin Method not implemented.")}sqrt(t){throw new Error("sqrt Method not implemented.")}isDimension(t){throw new Error("isDimension Method not implemented.")}dim(t){throw new Error("dim Method not implemented.")}sum(t){if(1===t.length){const e=t[0],r=e.weight,n=e.blade;return this.$.multiply(r,n)}if(2===t.length){const e=Sy(t[0].blade,t[0].weight,this.$),r=Sy(t[1].blade,t[1].weight,this.$);return a(Re,u(e,r))}throw new Error(`sum of ${t.length} terms Method not implemented.`)}extractGrade(t,e){return Ey(t,e,this.$)}treeAdd(t,e){throw new Error("treeAdd Method not implemented.")}treeLco(t,e){if(mg(t)&&mg(e))return t.__lshift__(e);throw new Error(`treeLco(lhs=${t}, rhs=${e}) Method not implemented.`)}treeMul(t,e){throw new Error("treeMul Method not implemented.")}treeScp(t,e){throw new Error("treeScp Method not implemented.")}treeSqrt(t){throw new Error("treeSqrt Method not implemented.")}treeZero(){return Yt}scalarCoordinate(t){throw new Error("scalarCoordinate Method not implemented.")}bladeToTree(t){return t}weightToTree(t){return t}}let Ty=class extends E_{constructor(t){super("algebra_2_tensor_tensor",D("algebra"),y,y,t),this.dependencies=["Blade"],this.hash=mi(D("algebra"),fi,fi)}transform2(t,e,r){const n=this.$,s=function(t){if(y(t))return t.mapElements((function(t){if(ue(t))return t;if(ne(t))return t;if(Ef(t))return t;throw new Error(`${t} must be an integer.`)}));throw new Error("must be a tensor.")}(e),i=function(t,e,r){const n=qg(t,new qy(t.length,r),e),s=t.length,i=[t.length],o=new Array(s);for(let t=0;t<s;t++)o[t]=n.unit(t);return new x(i,o)}(s,function(t){if(y(t))return t.mapElements((function(t){if(ae(t))return t.str;throw new Error("must be a string.")}));throw new Error("must be a tensor.")}(r),n);return[q,i]}};const My=new class{create(t){return new Ty(t)}};function Ay(t,e){return function(t,e){if(p(t).equals(Ir))return eh(t);if(it(t))return W(Math.acos(t.d));if(Op(t)||zf(t)&&yp(p(d(t)),1,2)&&p(p(d(d(t)))).equals($n)&&xp(p(d(p(d(d(t))))),2)&&yp(p(d(d(p(d(d(t)))))),1,2))return e.getNativeDirective(N.evaluatingAsFloat)?W(Math.PI/4):e.multiply(Pf(1,4),qs);if(Ep(t)||zf(t)&&yp(p(d(t)),-1,2)&&p(p(d(d(t)))).equals($n)&&xp(p(d(p(d(d(t))))),2)&&yp(p(d(d(p(d(d(t)))))),1,2))return e.getNativeDirective(N.evaluatingAsFloat)?W(3*Math.PI/4):e.multiply(Pf(3,4),qs);if(Sp(t))return e.getNativeDirective(N.evaluatingAsFloat)?W(Math.PI/6):e.multiply(Pf(1,6),qs);if(qp(t))return e.getNativeDirective(N.evaluatingAsFloat)?W(5*Math.PI/6):e.multiply(Pf(5,6),qs);if(!re(t))return Rd(mr,t);switch(Sf(e.multiply(t,Bt))){case-2:return e.getNativeDirective(N.evaluatingAsFloat)?et:qs;case-1:return e.getNativeDirective(N.evaluatingAsFloat)?W(2*Math.PI/3):e.multiply(Pf(2,3),qs);case 0:return e.getNativeDirective(N.evaluatingAsFloat)?W(Math.PI/2):e.multiply(te,qs);case 1:return e.getNativeDirective(N.evaluatingAsFloat)?W(Math.PI/3):e.multiply(ee,qs);case 2:return e.getNativeDirective(N.evaluatingAsFloat)?X:Yt;default:return Rd(mr,t)}}(e.valueOf(eh(t)),e)}let Ny=class extends Bw{constructor(t){super("arccos",mr,t),this.hash=vi(this.opr)}transform(t){const e=Ay(t,this.$);return[!e.equals(t)?q:T,e]}};const $y=new class{create(t){return new Ny(t)}};function Ly(t,e){return function(t,e){if(p(t).equals(Pr))return eh(t);if(it(t)){let{d:e}=t;return e<1&&sr("arccosh function argument is less than 1.0"),e=Math.log(e+Math.sqrt(e*e-1)),W(e)}if(e.isOne(t))return Yt;return Rd(gr,t)}(e.valueOf(eh(t)),e)}let ky=class extends Bw{constructor(t){super("arccosh",gr,t),this.hash=vi(this.opr)}transform(t){const e=Ly(t,this.$);return[!e.equals(t)?q:T,e]}};const Ry=new class{create(t){return new ky(t)}};function Iy(t,e){if(f(t)&&(f(r=t)&&Cf(r,Qe)))return p(t.cdr);var r;if(it(t))return W(Math.asin(t.d));if(Op(t)||zf(t)&&yp(p(d(t)),1,2)&&p(p(d(d(t)))).equals($n)&&xp(p(d(p(d(d(t))))),2)&&yp(p(d(d(p(d(d(t)))))),1,2))return e.multiply(Pf(1,4),qs);if(Ep(t)||zf(t)&&yp(p(d(t)),-1,2)&&p(p(d(d(t)))).equals($n)&&xp(p(d(p(d(d(t))))),2)&&yp(p(d(d(p(d(d(t)))))),1,2))return e.getNativeDirective(N.evaluatingAsFloat)?W(-Math.PI/4):e.multiply(Pf(-1,4),qs);if(Sp(t))return e.getNativeDirective(N.evaluatingAsFloat)?W(Math.PI/3):e.multiply(ee,qs);if(qp(t))return e.getNativeDirective(N.evaluatingAsFloat)?W(-Math.PI/3):e.multiply(Pf(-1,3),qs);if(!re(t))return Rd(wr,t);switch(Sf(t.mul(Bt))){case-2:return e.getNativeDirective(N.evaluatingAsFloat)?W(-Math.PI/2):e.multiply(Pf(-1,2),qs);case-1:return e.getNativeDirective(N.evaluatingAsFloat)?W(-Math.PI/6):e.multiply(Pf(-1,6),qs);case 0:return e.getNativeDirective(N.evaluatingAsFloat)?X:Yt;case 1:return e.getNativeDirective(N.evaluatingAsFloat)?W(Math.PI/6):e.multiply(Pf(1,6),qs);case 2:return e.getNativeDirective(N.evaluatingAsFloat)?W(Math.PI/2):e.multiply(te,qs);default:return Rd(wr,t)}}let Py=class extends Bw{constructor(t){super("arcsin",wr,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){return Iy(e.valueOf(eh(t)),e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const Fy=new class{create(t){return new Py(t)}};let Uy=class extends Kw{constructor(t){super("arcsinh",_r,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){const n=function(t,e){if(p(t).equals(Vn))return eh(t);if(it(t)){let{d:e}=t;return e=Math.log(e+Math.sqrt(e*e+1)),W(e)}return e.is_zero(t)?Yt:Rd(_r,t)}(e,this.$);return[!n.equals(r)?q:S,n]}};const Cy=new class{create(t){return new Uy(t)}};function Dy(t,e){const r=t.argList.head;return function(t,e){if(p(t).equals(Yn))return eh(t);if(it(t))return W(Math.atan(t.d));if(e.is_zero(t))return Yt;if($d(t))return e.negate(e.arctan(e.negate(t)));if(t.contains(Hn)&&t.contains(Ir)){const r=Am(t,e),n=_m(t,e);if(p(r).equals(Hn)&&p(n).equals(Ir)&&e.equals(eh(r),eh(n)))return eh(r)}if(Qf(t)&&xp(eh(t),3)&&yp(sh(t),-1,2)||zf(t)&&yp(p(d(t)),1,3)&&p(p(d(d(t)))).equals($n)&&xp(p(d(p(d(d(t))))),3)&&yp(p(d(d(p(d(d(t)))))),1,2))return e.multiply(Pf(1,6),e.getNativeDirective(N.evaluatingAsFloat)?et:qs);if(xp(t,1))return e.multiply(Pf(1,4),lr.Pi(e));if(Qf(t)&&xp(eh(t),3)&&yp(sh(t),1,2))return e.multiply(ee,lr.Pi(e));return Rd(xr,t)}(e.valueOf(r),e)}let By=class extends Bw{constructor(t){super("arctan",xr,t),this.hash=vi(this.opr)}transform(t){const e=Dy(t,this.$);return[!e.equals(t)?q:T,e]}};const Ky=new class{create(t){return new By(t)}};function zy(t,e){return function(t,e){if(p(t).equals(ts))return eh(t);if(it(t)){let{d:e}=t;if(e<-1||e>1)throw new Error("arctanh function argument is not in the interval [-1,1]");return e=Math.log((1+e)/(1-e))/2,W(e)}if(e.is_zero(t))return Yt;return Rd(yr,t)}(e.valueOf(eh(t)),e)}let Qy=class extends Bw{constructor(t){super("arctanh",yr,t),this.hash=vi(this.opr)}transform(t){const e=zy(t,this.$);return[!e.equals(t)?q:T,e]}};const Zy=new class{create(t){return new Qy(t)}},Gy=z(P.arg),Hy=z(P.add);function Vy(t,e){const r=e.imag(t),n=e.real(t);if(e.is_zero(n)){if(e.is_zero(r))return new Js(u(Gy,e.add(n,r)));{const t=$d(r)?te.neg():te,n=lr.Pi(e);return e.multiply(t,n)}}if($d(n)){const t=lr.Pi(e);if($d(r))return e.subtract(e.arctan(e.divide(r,n)),t);{const s=e.arctan(e.divide(r,n)),i=t;return e.add(s,i)}}return e.arctan(e.divide(r,n))}let jy=class extends zw{constructor(t){super(Gy,Hy,t)}transform1(t,e,r){return[q,Vy(e,this.$)]}};const Wy=new class{create(t){return new jy(t)}},Jy=z(P.arg);let Xy=class extends Kw{constructor(t){super("arg_any",Jy,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){return[S,r]}};const Yy=new class{create(t){return new Xy(t)}},tv=z(P.arg);let ev=class extends Kw{constructor(t){super("arg_flt",tv,it,t),this.hash=xi(this.opr,ii)}transform1(t,e,r){return e.isZero()?[q,new Js(r)]:e.isNegative()?[q,et]:[q,X]}};const rv=new class{create(t){return new ev(t)}},nv=z(P.arg),sv=z(P.PI);let iv=class extends Kw{constructor(t){super("arg_imu",nv,pt,t),this.hash=xi(this.opr,ai)}transform1(t,e,r){return[q,this.$.divide(sv,Bt)]}};const ov=new class{create(t){return new iv(t)}},av=z(P.arg),uv=z(P.multiply),cv=z(P.PI);function lv(t,e){const r=e.divide(t,cv);return re(r)?e.multiply(fv(r),cv):it(r)?e.multiply(hv(r),cv):t}function fv(t,e){return t.isOne()||t.isMinusOne()?t:t.pred().isPositive()?fv(t.pred().pred()):t.succ().isNegative()?fv(t.succ().succ()):t}function hv(t,e){return t.isOne()||t.isMinusOne()?t:t.sub(Y).isPositive()?hv(t.sub(Y).sub(Y)):t.add(Y).isNegative()?hv(t.add(Y).add(Y)):t}let pv=class extends zw{constructor(t){super(av,uv,t)}transform1(t,e,r){const n=this.$,s=lv(e.tail().map(n.arg).reduce(((t,e)=>n.add(t,e)),Yt),n);return[q,s]}};const dv=new class{create(t){return new pv(t)}},mv=z(P.arg),gv=z(P.pow);let wv=class extends zw{constructor(t){super(mv,gv,t)}transform1(t,e){const r=this.$,n=Xp(e.lhs,e.rhs,r);return[q,n]}};const _v=new class{create(t){return new wv(t)}},xv=z(P.arg),yv=z(P.PI);let vv=class extends Kw{constructor(t){super("arg_rat",xv,re,t),this.hash=xi(this.opr,ui)}transform1(t,e,r){return e.isZero()?[q,new Js(r)]:e.isNegative()?[q,yv]:[q,Yt]}};const bv=new class{create(t){return new vv(t)}},Ov=z(P.arg),Ev=z(P.E),Sv=z(P.PI);let qv=class extends Kw{constructor(t){super("arg_sym",Ov,ue,t),this.hash=xi(this.opr,li)}transform1(t,e,r){const n=this.$;return e.equalsSym(Ev)||e.equalsSym(Sv)?[q,Yt]:n.is_real(e)?[q,r]:[S,r]}};const Tv=new class{create(t){return new qv(t)}};function Mv(t,e){const r=ah(t);if(!ue(r))throw new Error("indexed assignment: expected a symbol name");const n=nr.tos;qf(e.valueOf(sh(t)));const s=ih(t);f(s)&&Mf([...s].map((function(t){return e.valueOf(t)}))),function(t){t<3&&sr("error in indexed assign");const e=nr.tos-t,r=nr.stack[e],n=nr.stack[e+1];y(n)||sr("error in indexed assign: assigning to something that is not a tensor");const s=t-2;s>n.ndim&&sr("error in indexed assign");let i=0;for(let t=0;t<s;t++){const r=Sf(nr.stack[e+t+2]);(r<1||r>n.dim(t))&&sr("error in indexed assign\n"),i=i*n.dim(t)+r-1}for(let t=s;t<n.ndim;t++)i=i*n.dim(t)+0;const o=n.copyDimensions(),a=n.copyElements();if(n.ndim===s)return y(r)&&sr("error in indexed assign"),a[i]=r,ir(nr.tos-t),void qf(new x(o,a));y(r)||sr("error in indexed assign"),n.ndim-s!==r.ndim&&sr("error in indexed assign");for(let t=0;t<r.ndim;t++)o[s+t]!==r.dim(t)&&sr("error in indexed assign");for(let t=0;t<r.nelem;t++)a[i+t]=r.elem(t);ir(nr.tos-t),qf(new x(o,a))}(nr.tos-n);const i=Tf();return e.setSymbolValue(r,i),c}function Av(t,e){const r=t.lhs;if(nh(t).equals(dn))return Mv(t,e);if(f(r))return function(t,e){const r=nh(t),n=ih(t);let s=sh(t);ue(r)||sr("function name?"),p(s).equals(Jr)&&(s=e.valueOf(eh(s))),s=Rd(un,s,n),e.setSymbolValue(r,s)}(t,e),c;ue(r)||sr("symbol assignment: error in symbol");const n=e.valueOf(t.rhs);return e.setSymbolValue(r,n),c}let Nv=class extends E_{constructor(t){super("assign_any_any",Qn,Vw,Vw,t)}transform(t){const e=this.match(t);return e?this.transform2(e.opr,e.lhs,e.rhs,e):[S,t]}transform2(t,e,r,n){const s=this.$;return[q,Av(n,s)]}};const $v=new class{create(t){return new Nv(t)}};let Lv=class extends E_{constructor(t){super("assign_sym_any",Qn,ue,Vw,t),this.hash=mi(Qn,li,pi)}transform(t){const e=this.match(t);if(e){const t=this.$,[r,n]=t.transform(e.rhs);return A(r)?[q,t.valueOf(u(e.opr,e.lhs,n))]:this.transform2(e.opr,e.lhs,e.rhs,e)}return[S,t]}transform2(t,e,r,n){return this.$.setSymbolValue(e,r),[q,c]}};const kv=new class{create(t){return new Lv(t)}};let Rv=class extends Bw{constructor(t){super("besselj",vr,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){return ny(e.valueOf(eh(t)),e.valueOf(sh(t)),e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const Iv=new class{create(t){return new Rv(t)}};let Pv=class extends Bw{constructor(t){super("bessely",br,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){return sy(e.valueOf(eh(t)),e.valueOf(sh(t)),e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const Fv=new class{create(t){return new Pv(t)}};function Uv(t,e){const r=function(t,e,r){return function(t,e,r){if(!function(t,e,r){return(!ne(t)||!Md(t,Yt))&&((!ne(e)||!Md(e,Yt))&&!(ne(t)&&ne(e)&&Md(t,e)))}(t,e))return Yt;return kp(kp(cm(t),cm(e),r),cm(r.subtract(t,e)),r)}(t,e,r)}(e.valueOf(eh(t)),e.valueOf(sh(t)),e);return r}let Cv=class extends Bw{constructor(t){super("binomial",Or,t),this.hash=vi(this.opr)}transform(t){const e=Uv(t,this.$);return[!e.equals(t)?q:T,e]}};const Dv=new class{create(t){return new Cv(t)}};class Bv{constructor(t){}get key(){return H.name}get hash(){return ni}get name(){return"BooExtension"}evaluate(t,e,r){return this.transform(a(t,e),r)}transform(t,e){return t instanceof Z?[T,t]:[S,t]}valueOf(t,e){return t}isImag(t){throw new Error("Boo Method not implemented.")}isKind(t){return t instanceof Z}isMinusOne(t,e){throw new Error("Boo Method not implemented.")}isOne(t,e){throw new Error("Boo Method not implemented.")}isReal(t){throw new Error("Boo Method not implemented.")}isScalar(){throw new Error("Boo Method not implemented.")}isZero(t,e){return!1}subst(t,e,r,n){return t}toInfixString(t){return t.equals(H)?"true":"false"}toLatexString(t){return t.equals(H)?"true":"false"}toListString(t){return t.equals(H)?"#t":"#f"}}const Kv=new qi((function(t){return new Bv(t)}));class zv extends Kw{constructor(t){super("ceiling_cons",D("ceiling"),f,t)}transform1(t,e,r){return[S,r]}}const Qv=new class{create(t){return new zv(t)}};class Zv extends Kw{constructor(t){super("ceiling_flt",D("ceiling"),it,t)}transform1(t,e){return[q,W(Math.ceil(e.d))]}}const Gv=new class{create(t){return new Zv(t)}};class Hv extends Kw{constructor(t){super("ceiling_rat",D("ceiling"),Mi,t)}transform1(t,e){return[q,e.ceiling()]}}const Vv=new class{create(t){return new Hv(t)}},jv=z(P.test_eq);function Wv(t){if(f(t)&&t.head.equals(Qn)){const e=t.argList,r=e.head,n=e.cdr.head;return u(jv,r,n)}return t}function Jv(t,e){const r=e.valueOf(Wv(t));if(e.is_zero(r))return!1;if(Wf(r))return!0;const n=fh(r,e);if(e.is_zero(n))return!1;if(Wf(n))return!0;if(n.contains(ht)){const t=e.valueOf(Wv(tm(n,e)));if(e.is_zero(t))return!1;if(Wf(t))return!0}return null}function Xv(t,e){const r=Jv(t.argList.head,e);if("boolean"==typeof r)return Ut(Number(r));if(r)throw new Error;return t}function Yv(t,e){const r=t.cdr,n=function(t,e,r){if(!function(t,e){return!(ne(t)&&Ph(t,Yt)<0)&&(!(ne(e)&&Ph(e,Yt)<0)&&!(ne(t)&&ne(e)&&Ph(t,e)<0))}(t,e))return Yt;return kp(kp(cm(t),cm(e),r),cm(r.subtract(t,e)),r)}(e.valueOf(p(r)),e.valueOf(eh(r)),e);return n}let tb=class extends Bw{constructor(t){super("choose",qr,t),this.hash=vi(this.opr)}transform(t){const e=Yv(t,this.$);return[!e.equals(t)?q:T,e]}};const eb=new class{create(t){return new tb(t)}},rb=z(P.E),nb=z(P.pow);function sb(t,e){const r=u(nb,rb,e.multiply(t,ht));r.meta|=M;const n=u(nb,rb,e.multiply(e.negate(t),ht));return n.meta|=M,e.multiply(te,e.add(r,n))}function ib(t,e){const r=u(Ue,Ze,e.multiply(ht,t));r.meta|=M;const n=u(Ue,Ze,e.multiply(e.negate(ht),t));return n.meta|=M,e.subtract(e.multiply(kp(r,ht,e),te),e.multiply(kp(n,ht,e),te))}function ob(t,e){if(p(t).equals(Ir))return sb(eh(t),e);if(p(t).equals(Hn))return ib(eh(t),e);if(p(t).equals(Yn)){t=eh(t);const r=Ad(e.multiply(ht,t),e),n=Ad(e.negate(e.multiply(ht,t)),e);return kp(e.multiply(e.subtract(n,r),ht),e.add(r,n),e)}if(p(t).equals(Pr))return t=eh(t),e.multiply(e.add(Ad(t,e),Ad(e.negate(t),e)),te);if(p(t).equals(Vn))return t=eh(t),e.multiply(e.subtract(Ad(t,e),Ad(e.negate(t),e)),te);if(p(t).equals(ts))return t=Ad(e.multiply(eh(t),Bt),e),kp(e.subtract(t,Dt),e.add(t,Dt),e);if(f(t))return t.map((function(t){return ob(t,e)}));if(y(t)){const r=t.mapElements((function(t){return ob(t,e)}));return t.withElements(r)}return t}let ab=class extends Kw{constructor(t){super("circexp_any",Tr,Vw,t),this.phases=$,this.hash=xi(this.opr,pi)}transform1(t,e,r){const n=this.$;n.pushNativeDirective(N.evaluatingTrigAsExp,!0);try{const t=ob(e,n),s=n.valueOf(t);return[!s.equals(r)?q:S,s]}finally{n.popNativeDirective()}}};const ub=new class{create(t){return new ab(t)}};let cb=class extends Kw{constructor(t){super("clock_any",Nr,Vw,t),this.hash=xi(Nr,pi)}transform1(t,e,r){const n=this.$;if(n.isExpanding()){const t=pm(e,n);return[q,t]}return[S,r]}};const lb=new class{create(t){return new cb(t)}};let fb=class extends Bw{constructor(t){super("coeff",$r,t),this.phases=I,this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(eh(t));let n=e.valueOf(sh(t)),s=e.valueOf(uh(t));return c.equals(s)&&(s=n,n=Ls),Ip(kp(r,e.power(n,s),e),n,e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const hb=new class{create(t){return new fb(t)}};let pb=class extends Bw{constructor(t){super("cofactor",Lr,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(eh(t));wy(r)||sr("cofactor: 1st arg: square matrix expected");const n=r.dim(0),s=xy(sh(t),e);(s<1||s>n)&&sr("cofactor: 2nd arg: row index expected");const i=xy(uh(t),e);return(i<1||i>n)&&sr("cofactor: 3rd arg: column index expected"),yy(r,s-1,i-1,e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const db=new class{create(t){return new pb(t)}};let mb=class extends Bw{constructor(t){super("condense",kr,t),this.phases=$,this.hash=vi(this.opr)}transform(t){const e=function(t,e){return Xd(e.valueOf(eh(t)),e)}(t,this.$);e.meta|=M;return[!e.equals(t)?q:T,e]}};const gb=new class{create(t){return new mb(t)}},wb=z(P.conj),_b=z(P.add);let xb=class extends zw{constructor(t){super(wb,_b,t)}transform1(t,e,r){const n=this.$,s=e.tail().map((function(t){return n.conj(t)}));return[q,n.valueOf(u(_b,...s))]}};const yb=new class{create(t){return new xb(t)}},vb=D("conj");class bb extends Kw{constructor(t){super("conj_any",vb,Vw,t)}transform1(t,e,r){throw new Error(this.$.toInfixString(e))}}const Ob=new class{create(t){return new bb(t)}};class Eb extends Kw{constructor(t){super("conj_blade",vb,Q,t)}transform1(t,e){return[q,e.rev()]}}const Sb=new class{create(t){return new Eb(t)}};let qb=class extends Kw{constructor(t){super("conj_flt",vb,kh,t)}transform1(t,e){return[q,e]}};const Tb=new class{create(t){return new qb(t)}};class Mb extends Kw{constructor(t){super("conj_imu",vb,pt,t)}transform1(t,e){return[q,u(Pe,Jt,e)]}}const Ab=new class{create(t){return new Mb(t)}};function Nb(t){return function(t){const e=t.opr;return!!ue(e)&&De.equalsSym(e)}(t)&&Pp(t)}class $b extends Kw{constructor(t){super("conj_inner",vb,O_(f,Nb),t)}transform1(t,e){return[q,u(e.opr,e.rhs,e.lhs)]}}const Lb=new class{create(t){return new $b(t)}};let kb=class extends Kw{constructor(t){super("conj_mul_2_any_any",vb,O_(f,Fp(Pe)),t),this.hash=yi(vb,Pe)}transform1(t,e,r){const n=this.$,s=e.opr,i=e.lhs,o=e.rhs;if(n.isExpanding()){if(n.isScalar(i)&&n.isScalar(o)){const t=n.valueOf(u(vb,i)),e=n.valueOf(u(vb,o)),r=u(s,t,e);return[q,r]}return[S,r]}return[T,r]}};const Rb=new class{create(t){return new kb(t)}};class Ib extends Kw{constructor(t){super("conj_rat",vb,re,t)}transform1(t,e){return[q,e]}}const Pb=new class{create(t){return new Ib(t)}};class Fb extends Kw{constructor(t){super("conj_sym",vb,ue,t)}transform1(t,e,r){return[q,e]}}const Ub=new class{create(t){return new Fb(t)}};function Cb(t,e,r){return Db(t,e,Yt,r)}function Db(t,e,r,n){if(t.equals(e))return n.is_zero(r)?Dt:r;if(f(t)&&Qf(t)){const s=sh(t);return n.equals(eh(t),e)&&ne(s)&&Ph(r,s)<0?s:r}return f(t)?t.tail().reduce((function(t,r){return Db(r,e,t,n)}),r):r}function Bb(t,e){const r=t;let n=e.subtract(e.valueOf(eh(t)),e.valueOf(sh(t))),s=Jv(n,e);if(s)return Yt;if(null!=s&&!s)return Dt;const i=Dm(e.valueOf(eh(t)),e),o=Dm(e.valueOf(sh(t)),e);return n=e.subtract(i,o),s=Jv(n,e),s?Yt:null==s||s?r:Dt}function Kb(t,e){const r=t,n=Hb(t,e);return null==n?r:n>=0?Dt:Yt}function zb(t,e){const r=t,n=Hb(t,e);return null==n?r:n>0?Dt:Yt}function Qb(t,e){const r=t,n=Hb(t,e);return null==n?r:n<=0?Dt:Yt}function Zb(t,e){const r=t,n=Hb(t,e);return null==n?r:n<0?Dt:Yt}function Gb(t,e){const r=t;let n=d(r),s=!1;for(;f(n);){const t=Jv(p(n),e);if(null==t)s=!0,n=d(n);else if(t)n=d(n);else if(!t)return Yt}return s?r:Dt}function Hb(t,e){let r=O;const n=Dm(e.valueOf(eh(t)),e),s=Dm(e.valueOf(sh(t)),e);let i=e.subtract(n,s);return re(i)||it(i)||(i=e.valueOf(hh(i,e))),e.is_zero(i)?0:(r=re(i)?-1===Hs(i.a)?-1:1:it(i)?i.d<0?-1:1:null,r)}class Vb{constructor(t){}get key(){return"Cons"}get hash(){return"Cons"}get name(){return"ConsExtension"}compareFactors(t,e,r){throw new Error("Cons Method not implemented.")}isImag(t,e){return!1}isKind(t){return!!f(t)}isMinusOne(t,e){throw new Error("Cons Method not implemented.")}isOne(t,e){throw new Error("Cons Method not implemented.")}isReal(t,e){return!1}isScalar(t,e){return!1}isZero(t,e){throw new Error("Cons Method not implemented.")}subst(t,e,r,n){throw new Error(`expr = ${t} oldExpr = ${e} newExpr = ${r}`)}toInfixString(t,e){return Lx(t,e)}toLatexString(t,e){return Lx(t,e)}toListString(t,e){let r="";r+="(",r+=e.toSExprString(t.car);let n=t.cdr;for(;f(n);)r+=" ",r+=e.toSExprString(n.car),n=n.cdr;return n!==c&&(r+=" . ",r+=e.toSExprString(n)),r+=")",r}evaluate(t,e,r){return this.transform(a(t,e),r)}transform(t,e){return[S,t]}valueOf(t,e){const r=function(t,e){return t},n=t.car;if(ue(n))return t;{const s=e.operatorFor(n);return h(t.cdr)?r(s.valueOf(n)):r(t)}}}const jb=new qi((function(t){return new Vb(t)}));function Wb(t,e){const r=e.valueOf(eh(t));let n,s;c.equals(rh(t))?(n=Dt,s=Bt):(n=e.valueOf(sh(t)),s=e.valueOf(uh(t)));const i=function(t,e,r,n){const s=[],i=[];if(!y(t))return n.is_zero(t)||sr("contract: tensor expected, 1st arg is not a tensor"),Yt;let o=Sf(e),a=Sf(r);const{ndim:u}=t;(o<1||o>u||a<1||a>u||o===a||t.dim(o-1)!==t.dim(a-1))&&sr("contract: index out of range");o--,a--;const c=t.dim(o);let l=1;for(let e=0;e<u;e++)e!==o&&e!==a&&(l*=t.dim(e));const f=new Array(u-2),h=new Array(l);let p=0;for(let e=0;e<u;e++)e!==o&&e!==a&&(f[p++]=t.dim(e));const d=t.copyElements(),m=h;for(let e=0;e<u;e++)s[e]=0,i[e]=t.dim(e);for(let t=0;t<l;t++){let e=Yt;for(let t=0;t<c;t++){s[o]=t,s[a]=t;let r=0;for(let t=0;t<u;t++)r=r*i[t]+s[t];e=n.add(e,d[r])}m[t]=e;for(let t=u-1;t>=0;t--)if(t!==o&&t!==a){if(++s[t]<i[t])break;s[t]=0}}if(1===l)return m[0];return new x(f,h)}(r,n,s,e);return i}let Jb=class extends Bw{constructor(t){super("contract",Rr,t),this.dependencies=[],this.hash=vi(this.opr)}transform(t){const e=Wb(t,this.$);return[!e.equals(t)?q:T,e]}};const Xb=new class{create(t){return new Jb(t)}};function Yb(t,e){return function(r){return Fp(t)(r)&&e(r.lhs)}}let tO=class extends Kw{constructor(t){super("cos_add_2_any_any",km,O_(f,Yb(Re,Vw)),t),this.phases=$,this.hash=yi(km,Re)}transform1(t,e){const r=this.$,n=e.lhs,s=e.rhs,i=r.valueOf(u(km,n)),o=r.valueOf(u(km,s)),a=r.valueOf(u(Im,n)),c=r.valueOf(u(Im,s)),l=r.valueOf(u(Pe,i,o)),f=r.valueOf(u(Pe,a,c)),h=r.valueOf(u(Re,l,r.negate(f)));return[q,h]}};const eO=new class{create(t){return new tO(t)}};function rO(t,e,r){if(p(t).equals(mr))return[q,eh(t)];if(it(t)){let e=Math.cos(t.d);return Math.abs(e)<1e-10&&(e=0),[q,W(e)]}if($d(t))return[q,r.valueOf(u(Ir,r.negate(t)))];if(p(t).equals(xr)){const e=r.add(Dt,r.power(eh(t),Bt));return[q,r.power(e,Pf(-1,2))]}const n=Sf(kp(r.multiply(t,Ut(180)),lr.Pi(r),r));if(n<0||isNaN(n))return[S,e];switch(n%360){case 90:case 270:return[q,Yt];case 60:case 300:return[q,te];case 120:case 240:return[q,Pf(-1,2)];case 45:case 315:return[q,r.multiply(te,r.power(Bt,te))];case 135:case 225:return[q,r.multiply(Pf(-1,2),r.power(Bt,te))];case 30:case 330:return[q,r.multiply(te,r.power(Kt,te))];case 150:case 210:return[q,r.multiply(Pf(-1,2),r.power(Kt,te))];case 0:return[q,Dt];case 180:return[q,Jt];default:return[S,e]}}function nO(t,e){let r=0;return lh(t)?2:zf(t)&&ne(eh(t))&&lh(sh(t))&&3===Yh(t)?(r=Sf(e.multiply(eh(t),Bt)),isNaN(r)?0:(r=r<0?4- -r%4:1+(r-1)%4,r)):0}function sO(t,e,r){return Kf(t)?function(t,e,r){for(const e of t.tail())if(nO(e,r)){const n=r.subtract(t,e);return[q,r.subtract(r.multiply(Rm(n,r),Rm(e,r)),r.multiply(Pm(n,r),Pm(e,r)))]}return rO(t,e,r)}(t,e,r):rO(t,e,r)}let iO=class extends Kw{constructor(t){super("cos_any",km,Vw,t),this.hash=xi(km,pi)}transform1(t,e,r){return this.$.isExpanding()?sO(e,r,this.$):[S,r]}};const oO=new class{create(t){return new iO(t)}};let aO=class extends Kw{constructor(t){super("cos_hyp",km,lt,t),this.hash=xi(km,oi)}transform1(t,e){return[q,Dt]}};const uO=new class{create(t){return new aO(t)}};function cO(t,e){return function(r){return Fp(t)(r)&&e(r.rhs)}}let lO=class extends Kw{constructor(t){super("cos_mul_2_any_imu",km,O_(f,cO(Pe,pt)),t),this.hash=yi(km,Pe)}transform1(t,e,r){const n=this.$,s=e.lhs;if(n.isExpanding()){const t=n.valueOf(u(Pr,s));return[q,t]}return[T,r]}};const fO=new class{create(t){return new lO(t)}};let hO=class extends Kw{constructor(t){super("cos_sym",km,ue,t),this.hash=xi(km,li)}isReal(t){return this.$.is_real(t.arg)}transform1(t,e,r){return sO(e,r,this.$)}};const pO=new class{create(t){return new hO(t)}};let dO=class extends Kw{constructor(t){super("cosh_sym",Pr,ue,t),this.hash=xi(Pr,li)}isReal(t){return!0}transform1(t,e,r){return[T,r]}};const mO=new class{create(t){return new dO(t)}};let gO=class extends Bw{constructor(t){super("cosh",Pr,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){return iy(e.valueOf(eh(t)),e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const wO=new class{create(t){return new gO(t)}},_O=D("cross");let xO=class extends E_{constructor(t){super("cross_any_any",_O,Vw,Vw,t)}transform2(t,e,r,n){const s=this.$;if(Dh(e)){const n=Kh(e);if(!n.equals(e)){const i=qh(e,Q),o=s.valueOf(u(t,n,r)),a=s.valueOf(u(Pe,i,o));return[q,a]}}if(Dh(r)){const n=Kh(r);if(!n.equals(r)){const i=qh(r,Q),o=s.valueOf(u(t,e,n)),a=s.valueOf(u(Pe,o,i));return[q,a]}}return[S,n]}};const yO=new class{create(t){return new xO(t)}};let vO=class extends E_{constructor(t){super("cross_blade_blade",_O,Q,Q,t),this.dependencies=["Blade"],this.hash=mi(_O,ri,ri)}transform2(t,e,r,n){const s=this.$,i=s.valueOf(e.__wedge__(r));if(Q(i))return[q,s.valueOf(u(Pe,Jt,i.dual()))];if(Mi(i))return[q,i];if(f(i)&&function(t){return Up(t)&&Q(t.lhs)&&Mi(t.rhs)}(i)){const t=i.lhs,e=i.rhs;return[q,s.valueOf(u(Pe,Jt.mul(e),t.dual()))]}if(f(i)&&z_(i)){const t=i.lhs,e=i.rhs;return[q,s.valueOf(u(Pe,Jt.mul(t),e.dual()))]}throw new Error(`${s.toSExprString(i)}`)}};const bO=new class{create(t){return new vO(t)}};function OO(t,e){return ur(EO,t,e)}function EO(t,e){const r=function(t,e){return t},n=cp(t,Ns),s=cp(t,$s),i=cp(t,Ls),o=cp(t,ks),a=cp(t,Rs);if(!n||s||i||o||a){if(n||!s||i||o||a){if(n||s||!i||o||a){if(n||s||i||!o||a){if(n||s||i||o||!a){if(f(t)&&!p(t).equals(an)){const n=Rd(p(t),...t.tail().map((function(t){return OO(t,e)})));return r(n)}return r(t)}return r(qO(t,Rs,e))}return r(qO(t,ks,e))}return r(qO(t,Ls,e))}return r(qO(t,$s,e))}return r(qO(t,Ns,e))}function SO(t,e,r){return cp(t,e)?qO(t,e,r):f(t)?Rd(p(t),...t.tail().map((t=>SO(t,e,r)))):t}function qO(t,e,r){const n=Dp(t,e,r),s=[];for(let t=n.length-1;t>=0;t--){const i=TO(t,n[t],e,r);s.push(...i)}if(s.length>1)return a(fr,Rd(...s));if(s.length>0)return s[0];throw new $i}function TO(t,e,r,n){if(n.is_zero(e))return[];if(0===t)return f(e)&&Kf(e)?e.tail():[e];const s=[];return zf(e)?s.push(...e.tail()):xp(e,1)||s.push(e),1===t?s.push(r):s.push(Rd($n,r,Ut(t))),s.length>1?[Rd(bn,...s)]:s}function MO(t,e,r,n){if(t){if(!f(e))return[e]}else if(!e.contains(r))return[e];if(Kf(e))return function(t,e,r,n){let s=d(e);const i=[];for(;f(s);)(p(s).contains(r)||t)&&i.push(...MO(t,p(s),r,n)),s=d(s);const o=d(e),a=[...o].filter((t=>!t.contains(r)));if(a.length){const t=Dd(a,n);c=t,(u=i).length>0&&c.equals(u[u.length-1])||u.push(c),i.push(n.negate(t))}var u,c;return i}(t,e,r,n);if(zf(e))return function(t,e,r,n){let s=d(e);const i=[];for(;f(s);)(p(s).contains(r)||t)&&i.push(...MO(t,p(s),r,n)),s=d(s);s=d(e);const o=[];for(;f(s);){const t=p(s);t.contains(r)||(o.length<1||!t.equals(o[o.length-1]))&&o.push(t),s=d(s)}o.length>0&&i.push(Qd(o,n));return i}(t,e,r,n);let s=d(e);const i=[];for(;f(s);)t&&i.push(p(s)),i.push(...MO(t,p(s),r,n)),s=d(s);return i}function AO(t,e,r,n,s){const i=function(t){return{METAA:t.getSymbolValue(bs),METAB:t.getSymbolValue(Os),METAX:t.getSymbolValue(Es)}}(s);s.setSymbolValue(Es,e);const o=MO(n,SO(t,e,s),e,s);let a=!1,u=c;if(n){if(!ne(t)){let e=Cp(r,Ps,bs,s);e=Cp(e,Fs,Os,s);const i=Cp(e,Us,Es,s),l=p(i);u=eh(i);const h=rh(i);if(NO([Dt,...o],n,t,l,h,s))a=!0;else{const e=[];let i=t;for(f(i)&&(e.push(p(t)),i=d(t));f(i);){const t=p(i);i=d(i);const[o,u]=AO(t,c,r,n,s);a=a||u,e.push(o)}0!==e.length&&(u=Rd(...e))}}}else for(const e of Array.from(r))if(e){const r=To(e),i=eh(r);u=sh(r);const c=oh(r);if(NO([Dt,...o],n,t,i,c,s)){a=!0;break}}const l=a?s.valueOf(u):n?t:c;return function(t,e){e.setSymbolValue(Es,t.METAX),e.setSymbolValue(Os,t.METAB),e.setSymbolValue(bs,t.METAA)}(i,s),[l,a]}function NO(t,e,r,n,s,i){for(const o of t){i.setSymbolValue(bs,o);for(const o of t){i.setSymbolValue(Os,o);let t=s;for(;f(t);){const e=i.valueOf(t.car);if(i.is_zero(e))break;t=t.cdr}if(f(t))continue;const a=e?ar((function(t){return i.valueOf(t)}),n,i):i.valueOf(n);if(i.is_zero(i.subtract(r,a)))return!0}}return!1}function $O(t,e,r){let n;return n=Kf(t)?function(t,e,r){t=d(t);let n=$O(p(t),e,r);f(t)&&(n=t.tail().reduce(((t,n)=>r.add(t,$O(n,e,r))),n));return n}(t,e,r):zf(t)?function(t,e,r){const[n,s]=function(t,e,r){let n=Dt,s=n;if(!f(t=d(t)))return[n,s];for(const i of t)i.contains(e)?s=r.multiply(s,i):n=r.multiply(n,i);return[n,s]}(t,e,r);return r.multiply(n,LO(s,e,r))}(t,e,r):LO(t,e,r),n.contains(mn)&&sr("integral: sorry, could not find a solution"),r.valueOf(Dm(n,r))}function LO(t,e,r){const n=RO(t,e,r).toFixed(6),s=PO[n];if(!s)return Rd(mn,t,e);const[i,o]=AO(t,e,s,!1,r);return c===i?Rd(mn,t,e):i}const kO={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916};function RO(t,e,r){if(ue(t))return ue(e)&&t.equals(e)?kO.x:kO.constant;if(f(t)){const n=t.car;return n.equals(fr)?function(t,e,r){const n={};for(;f(t);){const s=p(t);t=d(t);let i=0;i=s.contains(e)?RO(s,e,r):kO.constant,n[i.toFixed(6)]=!0}let s=0;for(const t of Object.keys(n||{}))s+=Number(t);return s}(d(t),e,r):n.equals(bn)?function(t,e,r){let n=1;f(t)&&[...t].forEach((t=>{t.contains(e)&&(n*=RO(t,e,r))}));return n}(d(t),e,r):n.equals($n)?IO(eh(t),sh(t),e,r):n.equals(Xr)?IO(Ad(Dt,r),eh(t),e,r):n.equals(Wn)?IO(eh(t),W(.5),e,r):function(t,e,r){if(!eh(t).contains(e))return kO.constant;const n=t.car;if(ue(n)){const s=RO(p(t.cdr),e,r),i=n.key(),o=kO[i];if(!o)throw new Error("Unsupported function "+i);return Math.pow(o,s)}throw new Error("is_sym(car(u)) MUST be true.")}(t,e,r)}return kO.constant}function IO(t,e,r,n){let s=kO.constant,i=kO.constexp;if(t.contains(r)&&(s=RO(t,r,n)),e.contains(r))i=RO(e,r,n);else{if(s===kO.constant)return kO.constant;np(e)?i=-1:vp(e)?i=.5:bp(e)?i=-.5:yp(e,2,1)?i=2:yp(e,-2,1)&&(i=-2)}return Math.pow(s,i)}const PO={1.144166:["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x**a,x**(a+1)/(a+1))"],1.095727:["f(x**(-2),-x**(-1))"],1.023118:["f(x**(-1/2),2*x**(1/2))"],.977405:["f(x**(1/2),2/3*x**(3/2))"],"0.955320":["f(x,x**2/2)"],.912636:["f(x**2,x**3/3)"],1.137302:["f(exp(a*x),1/a*exp(a*x))","f(a**x,a**x/log(a),or(not(number(a)),a>0))"],1.326774:["f(exp(a*x+b),1/a*exp(a*x+b))"],1.080259:["f(x*exp(a*x**2),exp(a*x**2)/(2*a))"],1.260228:["f(x*exp(a*x**2+b),exp(a*x**2+b)/(2*a))"],1.451902:["f(log(a*x),x*log(a*x)-x)"],.486192:["f(1/(a+x**2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x**2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x**2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x**2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],.697274:["f(1/sqrt(a-x**2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x**2),log(x+sqrt(a+x**2)))","f(1/sqrt(x**2+a),log(x+sqrt(x**2+a)))"],.476307:["f(1/(a+b*x),1/b*log(a+b*x))"],.226868:["f(1/(a+b*x)**2,-1/(b*(a+b*x)))"],2.904531:["f(1/(a+b*x)**3,-1/(2*b)*1/(a+b*x)**2)"],.455026:["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],.216732:["f(x/(a+b*x)**2,1/b**2*(log(a+b*x)+a/(a+b*x)))"],.434695:["f(x**2/(a+b*x),1/b**2*(1/2*(a+b*x)**2-2*a*(a+b*x)+a**2*log(a+b*x)))"],.207048:["f(x**2/(a+b*x)**2,1/b**3*(a+b*x-2*a*log(a+b*x)-a**2/(a+b*x)))"],2.650781:["f(x**2/(a+b*x)**3,1/b**3*(log(a+b*x)+2*a/(a+b*x)-1/2*a**2/(a+b*x)**2))"],.498584:["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],.237479:["f(1/x*1/(a+b*x)**2,1/a*1/(a+b*x)-1/a**2*log((a+b*x)/x))"],3.040375:["f(1/x*1/(a+b*x)**3,1/a**3*(1/2*((2*a+b*x)/(a+b*x))**2+log(x/(a+b*x))))"],.521902:["f(1/x**2*1/(a+b*x),-1/(a*x)+b/a**2*log((a+b*x)/x))"],.446014:["f(1/x**3*1/(a+b*x),(2*b*x-a)/(2*a**2*x**2)+b**2/a**3*log(x/(a+b*x)))"],.248586:["f(1/x**2*1/(a+b*x)**2,-(a+2*b*x)/(a**2*x*(a+b*x))+2*b/a**3*log((a+b*x)/x))"],.464469:["f(x/(a+b*x**2),1/2*1/b*log(a+b*x**2))"],.443716:["f(x**2/(a+b*x**2),x/b-a/b*integral(1/(a+b*x**2),x))"],.236382:["f(1/(a+b*x**2)**2,x/(2*a*(a+b*x**2))+1/2*1/a*integral(1/(a+b*x**2),x))"],.508931:["f(1/x*1/(a+b*x**2),1/2*1/a*log(x**2/(a+b*x**2)))"],.532733:["f(1/x**2*1/(a+b*x**2),-1/(a*x)-b/a*integral(1/(a+b*x**2),x))"],.480638:["f(1/(a+b*x**3),1/3*1/a*(a/b)**(1/3)*(1/2*log(((a/b)**(1/3)+x)**3/(a+b*x**3))+sqrt(3)*arctan((2*x-(a/b)**(1/3))*(a/b)**(-1/3)/sqrt(3))))"],.438648:["f(x**2/(a+b*x**3),1/3*1/b*log(a+b*x**3))"],.459164:["f(x/(a+b*x**4),1/2*sqrt(b/a)/b*arctan(x**2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x**4),1/4*sqrt(-b/a)/b*log((x**2-sqrt(-a/b))/(x**2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x**3/(a+b*x**4),1/4*1/b*log(a+b*x**4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)**3))"],1.384221:["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)**3)/15/b**2)"],1.322374:["f(x**2*sqrt(a+b*x),2*(8*a**2-12*a*b*x+15*b**2*x**2)*sqrt((a+b*x)**3)/105/b**3)"],1.516728:["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],1.587665:["f(sqrt(a+b*x)/x**2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],.659314:["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b**2)"],.629856:["f(x**2/sqrt(a+b*x),2/15*(8*a**2-4*a*b*x+3*b**2*x**2)*sqrt(a+b*x)/b**3)"],.722428:["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],.756216:["f(1/x**2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],1.434156:["f(sqrt(x**2+a),1/2*(x*sqrt(x**2+a)+a*log(x+sqrt(x**2+a))))","f(sqrt(a-x**2),1/2*(x*sqrt(a-x**2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x**2+b),x*sqrt(a*x**2+b)/2+b*log(x*sqrt(a)+sqrt(a*x**2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x**2+b),x*sqrt(a*x**2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],.729886:["f(1/x*1/sqrt(x**2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x**2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x**2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x**2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x**2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x**2+a)/x,sqrt(x**2+a)-sqrt(a)*log((sqrt(a)+sqrt(x**2+a))/x),or(not(number(a)),a>0))","f(sqrt(x**2+a)/x,sqrt(x**2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x**2)/x,sqrt(a-x**2)-sqrt(a)*log((sqrt(a)+sqrt(a-x**2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x**2+a),sqrt(x**2+a))","f(x/sqrt(a-x**2),-sqrt(a-x**2))"],1.370077:["f(x*sqrt(x**2+a),1/3*sqrt((x**2+a)**3))","f(x*sqrt(a-x**2),-1/3*sqrt((a-x**2)**3))"],1.730087:["f(sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),1/4*(x*sqrt((x**2+a**(1/3))**3)+3/2*a**(1/3)*x*sqrt(x**2+a**(1/3))+3/2*a**(2/3)*log(x+sqrt(x**2+a**(1/3)))))","f(sqrt(-a+x**6-3*a**(1/3)*x**4+3*a**(2/3)*x**2),1/4*(x*sqrt((x**2-a**(1/3))**3)-3/2*a**(1/3)*x*sqrt(x**2-a**(1/3))+3/2*a**(2/3)*log(x+sqrt(x**2-a**(1/3)))))"],.578006:["f(1/sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),x/a**(1/3)/sqrt(x**2+a**(1/3)))"],"0.552180":["f(x/sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),-1/sqrt(x**2+a**(1/3)))"],1.652787:["f(x*sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),1/5*sqrt((x**2+a**(1/3))**5))"],1.308862:["f(x**2*sqrt(x**2+a),1/4*x*sqrt((x**2+a)**3)-1/8*a*x*sqrt(x**2+a)-1/8*a**2*log(x+sqrt(x**2+a)))","f(x**2*sqrt(a-x**2),-x/4*sqrt((a-x**2)**3)+1/8*a*(x*sqrt(a-x**2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],1.342944:["f(x**3*sqrt(x**2+a),(1/5*x**2-2/15*a)*sqrt((x**2+a)**3),and(number(a),a>0))","f(x**3*sqrt(x**2+a),sqrt((x**2+a)**5)/5-a*sqrt((x**2+a)**3)/3,and(number(a),a<0))","f(x**3*sqrt(a-x**2),(-1/5*x**2-2/15*a)*sqrt((a-x**2)**3),or(not(number(a)),a>0))","f(sqrt(a-x**2)/x**3,-1/2*sqrt(a-x**2)/x**2+1/2*log((sqrt(a)+sqrt(a-x**2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x**2)/x**4,-1/3*sqrt((a-x**2)**3)/a/x**3,or(not(number(a)),a>0))"],.636358:["f(x**2/sqrt(x**2+a),1/2*x*sqrt(x**2+a)-1/2*a*log(x+sqrt(x**2+a)))","f(x**2/sqrt(a-x**2),-x/2*sqrt(a-x**2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],.652928:["f(x**3/sqrt(x**2+a),1/3*sqrt((x**2+a)**3)-a*sqrt(x**2+a))","f(1/x**3*1/sqrt(x**2+a),-1/2*sqrt(x**2+a)/a/x**2+1/2*log((sqrt(a)+sqrt(x**2+a))/x)/a**(3/2),or(not(number(a)),a>0))","f(1/x**3*1/sqrt(x**2-a),1/2*sqrt(x**2-a)/a/x**2+1/2*1/(a**(3/2))*arcsec(x/(a**(1/2))),or(not(number(a)),a>0))"],.764022:["f(1/x**2*1/sqrt(x**2+a),-sqrt(x**2+a)/a/x)","f(1/x**2*1/sqrt(a-x**2),-sqrt(a-x**2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x**2*sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),1/6*x*sqrt((x**2+a**(1/3))**5)-1/24*a**(1/3)*x*sqrt((x**2+a**(1/3))**3)-1/16*a**(2/3)*x*sqrt(x**2+a**(1/3))-1/16*a*log(x+sqrt(x**2+a**(1/3))),or(not(number(a)),a>0))","f(x**2*sqrt(-a-3*a**(1/3)*x**4+3*a**(2/3)*x**2+x**6),1/6*x*sqrt((x**2-a**(1/3))**5)+1/24*a**(1/3)*x*sqrt((x**2-a**(1/3))**3)-1/16*a**(2/3)*x*sqrt(x**2-a**(1/3))+1/16*a*log(x+sqrt(x**2-a**(1/3))),or(not(number(a)),a>0))"],1.620055:["f(x**3*sqrt(a+x**6+3*a**(1/3)*x**4+3*a**(2/3)*x**2),1/7*sqrt((x**2+a**(1/3))**7)-1/5*a**(1/3)*sqrt((x**2+a**(1/3))**5),or(not(number(a)),a>0))","f(x**3*sqrt(-a-3*a**(1/3)*x**4+3*a**(2/3)*x**2+x**6),1/7*sqrt((x**2-a**(1/3))**7)+1/5*a**(1/3)*sqrt((x**2-a**(1/3))**5),or(not(number(a)),a>0))"],.332117:["f(1/(x-a)/sqrt(x**2-a**2),-sqrt(x**2-a**2)/a/(x-a))","f(1/(x+a)/sqrt(x**2-a**2),sqrt(x**2-a**2)/a/(x+a))"],1.571443:["f(sqrt(a-x**2)/x**2,-sqrt(a-x**2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],1.690994:["f(sin(a*x),-cos(a*x)/a)"],1.055979:["f(cos(a*x),sin(a*x)/a)"],1.116714:["f(tan(a*x),-log(cos(a*x))/a)"],.895484:["f(1/tan(a*x),log(sin(a*x))/a)"],.946989:["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],.591368:["f(1/sin(a*x),log(tan(a*x/2))/a)"],2.859462:["f(sin(a*x)**2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)**3,-cos(a*x)*(sin(a*x)**2+2)/(3*a))","f(sin(a*x)**4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],1.115091:["f(cos(a*x)**2,x/2+sin(2*a*x)/(4*a))"],1.081452:["f(cos(a*x)**3,sin(a*x)*(cos(a*x)**2+2)/(3*a))","f(cos(a*x)**4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],.349716:["f(1/sin(a*x)**2,-1/(a*tan(a*x)))"],.896788:["f(1/cos(a*x)**2,tan(a*x)/a)"],1.785654:["f(sin(a*x)*cos(a*x),sin(a*x)**2/(2*a))"],"3.188560":["f(sin(a*x)**2*cos(a*x)**2,-sin(4*a*x)/(32*a)+x/8)"],1.516463:["f(sin(a*x)/cos(a*x)**2,1/(a*cos(a*x)))"],2.707879:["f(sin(a*x)**2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],.369293:["f(cos(a*x)/sin(a*x)**2,-1/(a*sin(a*x)))"],.560019:["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],.530332:["f(1/(sin(a*x)*cos(a*x)**2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],.331177:["f(1/(sin(a*x)**2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],.313621:["f(1/(sin(a*x)**2*cos(a*x)**2),-2/(a*tan(2*a*x)))"],3.172365:["f(sin(a+b*x),-cos(a+b*x)/b)"],1.127162:["f(cos(a+b*x),sin(a+b*x)/b)"],.352714:["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b**2-a**2)*log((a*tan(x/2)+b-sqrt(b**2-a**2))/(a*tan(x/2)+b+sqrt(b**2-a**2))),b**2-a**2)"],.454515:["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b**2-a**2)*log((sqrt(b**2-a**2)*tan(x/2)+a+b)/(sqrt(b**2-a**2)*tan(x/2)-a-b)),b**2-a**2)"],1.615441:["f(x*sin(a*x),sin(a*x)/a**2-x*cos(a*x)/a)"],1.543263:["f(x**2*sin(a*x),2*x*sin(a*x)/a**2-(a**2*x**2-2)*cos(a*x)/a**3)"],1.008798:["f(x*cos(a*x),cos(a*x)/a**2+x*sin(a*x)/a)"],.963724:["f(x**2*cos(a*x),2*x*cos(a*x)/a**2+(a**2*x**2-2)*sin(a*x)/a**3)"],1.611938:["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a**2*x**2)/a)"],1.791033:["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a**2*x**2)/a)"],1.123599:["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a**2*x**2)/a)"],1.387031:["f(x*log(a*x),x**2*log(a*x)/2-x**2/4)"],1.325058:["f(x**2*log(a*x),x**3*log(a*x)/3-1/9*x**3)"],2.108018:["f(log(x)**2,x*log(x)**2-2*x*log(x)+2*x)"],.403214:["f(1/x*1/(a+log(x)),log(a+log(x)))"],2.269268:["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],2.486498:["f(log(a*x+b)/x**2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],1.769733:["f(sinh(x),cosh(x))"],1.883858:["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],1.690661:["f(x*sinh(x),x*cosh(x)-sinh(x))"],1.799688:["f(x*cosh(x),x*sinh(x)-cosh(x))"],3.131954:["f(sinh(x)**2,sinh(2*x)/4-x/2)"],2.579685:["f(tanh(x)**2,x-tanh(x))"],3.548923:["f(cosh(x)**2,sinh(2*x)/4+x/2)"],1.058866:["f(x**3*exp(a*x**2),exp(a*x**2)*(x**2/a-1/(a**2))/2)"],"1.235270":["f(x**3*exp(a*x**2+b),exp(a*x**2)*exp(b)*(x**2/a-1/(a**2))/2)"],1.130783:["f(exp(a*x**2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],1.078698:["f(erf(a*x),x*erf(a*x)+exp(-a**2*x**2)/a/sqrt(pi))"],"2.573650":["f(x**2*(1-x**2)**(3/2),(x*sqrt(1-x**2)*(-8*x**4+14*x**2-3)+3*arcsin(x))/48)","f(x**2*(1-x**2)**(5/2),(x*sqrt(1-x**2)*(48*x**6-136*x**4+118*x**2-15)+15*arcsin(x))/384)"],2.640666:["f(x**4*(1-x**2)**(3/2),(-x*sqrt(1-x**2)*(16*x**6-24*x**4+2*x**2+3)+3*arcsin(x))/128)"],1.086487:["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a**2))"],1.267493:["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a**2))"],1.037943:["f(x**2*exp(a*x),exp(a*x)*(a**2*x**2-2*a*x+2)/(a**3))"],1.210862:["f(x**2*exp(a*x+b),exp(a*x+b)*(a**2*x**2-2*a*x+2)/(a**3))"],"1.064970":["f(x**3*exp(a*x),exp(a*x)*x**3/a-3/a*integral(x**2*exp(a*x),x))"],1.242392:["f(x**3*exp(a*x+b),exp(a*x+b)*x**3/a-3/a*integral(x**2*exp(a*x+b),x))"]};let FO=class extends Bw{constructor(t){super("defint",Fr,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){let r=e.valueOf(eh(t)),n=rh(t);for(;f(n);){const t=e.valueOf(p(n));n=d(n);const s=e.valueOf(p(n));n=d(n);const i=e.valueOf(p(n));n=d(n),r=$O(r,t,e);const o=e.valueOf(Cp(r,t,i,e)),a=e.valueOf(Cp(r,t,s,e));r=e.subtract(o,a)}return r}(t,this.$);return[!e.equals(t)?q:T,e]}};const UO=new class{create(t){return new FO(t)}};let CO=class extends Bw{constructor(t){super("degree",Ur,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(sh(t)),n=e.valueOf(eh(r));return Cb(n,c.equals(r)?Xh(n):r,e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const DO=new class{create(t){return new CO(t)}};let BO=class extends Bw{constructor(t){super("denominator",Cr,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){return _m(e.valueOf(eh(t)),e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const KO=new class{create(t){return new BO(t)}};let zO=class extends E_{constructor(t){super("derivative_2_mul_any",Vm,O_(f,Fp(Pe)),ue,t),this.hash=wi(Vm,Pe,pi)}transform2(t,e,r,n){const s=dy(e,r,this.$);return[!s.equals(n)?q:S,s]}};const QO=new class{create(t){return new zO(t)}};let ZO=class extends E_{constructor(t){super("derivative_2_pow_any",Vm,O_(f,Fp(Ue)),Vw,t),this.hash=wi(Vm,Ue,pi)}transform2(t,e,r,n){const s=py(e,r,this.$);return[!s.equals(n)?q:S,s]}};const GO=new class{create(t){return new ZO(t)}};function HO(t,e){let r,n,s=e.valueOf(p(t.cdr)),i=d(t.cdr);const o=e.valueOf(p(i));for(c.equals(o)?(r=Xh(s),n=c):ne(o)?(r=Xh(s),n=o):(r=o,i=d(i),n=e.valueOf(p(i)));;){let t;if(ne(n)){if(t=Sf(n),isNaN(t))throw new Error("nth derivative: check n")}else t=1;let o=s;if(t>=0)for(let n=0;n<t;n++)o=gy(o,r,e);else{t=-t;for(let n=0;n<t;n++)o=$O(o,r,e)}if(s=o,c===n)break;if(ne(n)){if(i=d(i),n=e.valueOf(p(i)),c===n)break;ne(n)||(r=n,i=d(i),n=e.valueOf(p(i)))}else r=n,i=d(i),n=e.valueOf(p(i))}return s}let VO=class extends Bw{constructor(t){super("derivative",Vm,t),this.hash=vi(this.opr)}transform(t){const e=HO(t,this.$);return[!e.equals(t)?q:T,e]}};const jO=new class{create(t){return new VO(t)}};let WO=class extends Bw{constructor(t,e,r,n){super(t,e,n),this.oprNew=r}transform(t){if(f(t)&&function(t,e){const r=e.opr;return!!ue(r)&&t.equalsSym(r)}(this.opr,t)){const e=this.$;if(h(e.getSymbolValue(this.opr))){const r=u(this.oprNew,...t.tail());return[q,e.valueOf(r)]}return[S,t]}return[S,t]}};const JO=new class{constructor(t,e,r){this.name=t,this.opr=e,this.oprNew=r}create(t){return new WO(this.name,this.opr,this.oprNew,t)}}("d_to_derivative",D("d"),Vm);let XO=class extends Kw{constructor(t){super("determinant",Dr,Vw,t),this.hash=xi(Dr,pi)}transform1(t,e,r){const n=function(t,e){return Jx(e.valueOf(eh(t)),e)}(r,this.$);return[!n.equals(r)?q:S,n]}};const YO=new class{create(t){return new XO(t)}};let tE=class extends Bw{constructor(t){super("dim",Br,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(eh(t)),n=f(rh(t))?xy(sh(t),e):1;return y(r)?n<1||n>r.ndim?t:Ut(r.dim(n-1)):Dt}(t,this.$);return[!e.equals(t)?q:T,e]}};const eE=new class{create(t){return new tE(t)}};let rE=class extends Bw{constructor(t){super("dirac",Kr,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){return ry(e.valueOf(eh(t)),e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const nE=new class{create(t){return new rE(t)}};class sE extends E_{constructor(t,e,r){super(`${e} left-distributive over ${r}`,e,Vw,function(t){return function(e){return f(e)&&Cf(e,t)}}(r),t),this.phases=$,this.hash=gi(e,pi,r)}transform2(t,e,r,n){const s=this.$,i=r.opr,o=e,a=r.tail().map((function(e){return s.valueOf(u(t,o,e))})),c=s.valueOf(u(i,...a));return[q,c]}}class iE extends E_{constructor(t,e,r){super(`${e} right-distributive over ${r}`,e,function(t){return function(e){return f(e)&&Cf(e,t)}}(r),Vw,t),this.phases=$,this.hash=wi(e,r,pi)}transform2(t,e,r,n){const s=this.$,i=e.opr,o=r,a=e.tail().map((function(e){return s.valueOf(u(t,e,o))})),c=s.valueOf(u(i,...a));return[q,c]}}class oE{constructor(t,e){this.upper=t,this.lower=e}create(t){return new sE(t,this.upper,this.lower)}}class aE{constructor(t,e){this.upper=t,this.lower=e}create(t){return new iE(t,this.upper,this.lower)}}function uE(t,e){return new oE(t,e)}function cE(t,e){return new aE(t,e)}function lE(t,e){const r=fE(t,e),n=r.length;return new x([n],function(t,e){const r=t.map((function(t,e){return{value:t,index:e}}));r.sort((function(t,r){const n=e.compareFn(Pe)(t.value,r.value);return e.isScalar(t.value)||e.isScalar(r.value)?n:t.index-r.index}));const n=r.map((function(t){return t.value}));return n}(r,e))}function fE(t,e){const r=[];if(ne(t))r.push(...Mm(Sf(t)));else if(f(t)&&Kf(t))r.push(...function(t,e){const r=f(t)?t.tail().reduce((function(t,r){return Gd(t,r,e)})):p(t),n=[];let s=r;if(e.isOne(s))return n.push(t,Dt),n;if(ne(s))n.push(...Mm(Sf(s)));else if(zf(s)){const t=d(s);ne(p(t))?n.push(...Mm(Sf(p(t)))):n.push(p(t),Dt),f(t)&&t.tail().forEach((t=>n.push(t,Dt)))}else n.push(s,Dt);s=Lp(s,e);const i=f(t)?t.tail().reduce(((t,r)=>e.add(t,e.multiply(s,r))),Yt):d(t);return n.push(i,Dt),n}(t,e));else if(zf(t)){if(ne(p(t=d(t)))&&(r.push(...Mm(Sf(p(t)))),t=d(t)),f(t)){const e=[...t].map((t=>Qf(t)?[eh(t),sh(t)]:[t,Dt]));r.push(...e.flat())}}else Qf(t)?r.push(eh(t),sh(t)):r.push(t,Dt);const n=r.length;return r.push(Dt),hE(r,0,n,e),r.slice(n)}function hE(t,e,r,n){const s=t.pop();if(e===r)return void t.push(s);const i=t[e+0],o=Sf(t[e+1]);if(!isNaN(o))for(let u=0;u<=Math.abs(o);u++)t.push(n.multiply(s,n.power(i,Ut(((a=o)<0?-1:a>0?1:0)*u)))),hE(t,e+2,r,n);var a}let pE=class extends Bw{constructor(t){super("divisors",zr,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){return lE(e.valueOf(eh(t)),e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const dE=new class{create(t){return new pE(t)}};let mE=class extends Bw{constructor(t){super("do",Qr,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){let r=p(t),n=d(t);for(;f(n);)r=e.valueOf(p(n)),n=d(n);return r}(t,this.$);return[!e.equals(t)?q:T,e]}};const gE=new class{create(t){return new mE(t)}};let wE=0;const _E=[],xE=[];function yE(t,e){return function(t,e){const{arg:r,invalid:n}=bE(t,e);if(n)return u(Hr,n);const[s,i]=OE(Hr,r);return s}(t,e)}function vE(t,e){return function(t,e){const{arg:r,invalid:n}=bE(t,e);if(n)return u(Vr,n);const[s,i]=OE(Vr,r);return i}(t,e)}function bE(t,e){if(!y(t=e.valueOf(hh(e.valueOf(eh(t)),e))))return{invalid:t};2===t.ndim&&t.dim(0)===t.dim(1)||sr("eigen: argument is not a square matrix"),wE=t.dim(0),function(t){for(let e=0;e<wE;e++)for(let r=0;r<wE;r++)if(!it(t.elem(wE*e+r)))return!1;return!0}(t)||sr("eigen: matrix is not numerical");for(let e=0;e<wE-1;e++)for(let r=e+1;r<wE;r++){const n=t.elem(wE*e+r),s=t.elem(wE*r+e);Math.abs(n.d-s.d)>1e-10&&sr("eigen: matrix is not symmetrical")}return{arg:t}}function OE(t,e){for(let t=0;t<wE*wE;t++)_E[t]=0;for(let t=0;t<wE*wE;t++)xE[t]=0;for(let t=0;t<wE;t++){_E[wE*t+t]=e.elem(wE*t+t).d;for(let r=t+1;r<wE;r++)_E[wE*t+r]=e.elem(wE*t+r).d,_E[wE*r+t]=e.elem(wE*t+r).d}for(let t=0;t<wE;t++){xE[wE*t+t]=1;for(let e=t+1;e<wE;e++)xE[wE*t+e]=0,xE[wE*e+t]=0}let r=0;for(r=0;r<100&&0!==EE();r++);const n=e.copyDimensions(),s=e.copyElements();if(t.equals(Gr)||t.equals(Hr))for(let t=0;t<wE;t++)for(let e=0;e<wE;e++)s[wE*t+e]=W(_E[wE*t+e]);const i=e.copyDimensions(),o=e.copyElements();if(t.equals(Gr)||t.equals(Vr))for(let t=0;t<wE;t++)for(let e=0;e<wE;e++)o[wE*t+e]=W(xE[wE*t+e]);return[new x(n,s),new x(i,o)]}function EE(){let t=0;for(let e=0;e<wE-1;e++)for(let r=e+1;r<wE;r++)0!==_E[wE*e+r]&&(SE(e,r),t++);return t}function SE(t,e){const r=.5*(_E[wE*t+t]-_E[wE*e+e])/_E[wE*t+e];let n=1/(Math.abs(r)+Math.sqrt(r*r+1));r<0&&(n=-n);const s=1/Math.sqrt(n*n+1),i=n*s;for(let r=0;r<wE;r++){const n=_E[wE*t+r],o=_E[wE*e+r];_E[wE*t+r]=s*n+i*o,_E[wE*e+r]=s*o-i*n}for(let r=0;r<wE;r++){const n=_E[wE*r+t],o=_E[wE*r+e];_E[wE*r+t]=s*n+i*o,_E[wE*r+e]=s*o-i*n}for(let r=0;r<wE;r++){const n=xE[wE*t+r],o=xE[wE*e+r];xE[wE*t+r]=s*n+i*o,xE[wE*e+r]=s*o-i*n}_E[wE*t+e]=0,_E[wE*e+t]=0}let qE=class extends Bw{constructor(t){super("eigenval",Hr,t),this.hash=vi(this.opr)}transform(t){const e=yE(t,this.$);return[!e.equals(t)?q:T,e]}};const TE=new class{create(t){return new qE(t)}};let ME=class extends Bw{constructor(t){super("eigenvec",Vr,t),this.hash=vi(this.opr)}transform(t){const e=vE(t,this.$);return[!e.equals(t)?q:T,e]}};const AE=new class{create(t){return new ME(t)}};let NE=class extends Bw{constructor(t){super("eigen",Gr,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const{arg:r}=bE(t,e);r||sr("eigen: argument is not a square matrix");const[n,s]=OE(Gr,r);return e.setSymbolValue(D("D"),n),e.setSymbolValue(D("Q"),s),c}(t,this.$);return[!e.equals(t)?q:T,e]}};const $E=new class{create(t){return new NE(t)}};function LE(t){if(0===t)return 1;const e=Math.abs(t),r=1/(1+.5*e),n=r*Math.exp(-e*e-1.26551223+r*(1.00002368+r*(.37409196+r*(.09678418+r*(r*(.27886807+r*(r*(1.48851587+r*(.17087277*r-.82215223))-1.13520398))-.18628806)))));return t>=0?n:2-n}let kE=class extends Bw{constructor(t){super("erf",jr,t),this.hash=vi(this.opr)}transform(t){const e=this.$,r=function(t,e){if(it(t))return W(1-LE(t.d));if(e.is_zero(t))return Yt;if($d(t))return e.negate(u(jr,e.negate(t)));return u(jr,t)}(e.valueOf(eh(t)),e);return[!r.equals(t)?q:T,r]}};const RE=new class{create(t){return new kE(t)}};let IE=class extends Bw{constructor(t){super("erfc",Wr,t),this.hash=vi(this.opr)}transform(t){const e=this.$,r=function(t,e){if(it(t)){return W(LE(t.d))}if(e.is_zero(t))return Dt;return u(Wr,t)}(e.valueOf(eh(t)),e);return[!r.equals(t)?q:T,r]}};const PE=new class{create(t){return new IE(t)}},FE="undefined";class UE{constructor(t){}get key(){return js}get name(){return"ErrExtension"}evaluate(t,e){return this.transform(a(t,e))}transform(t){return[t instanceof Js?T:S,t]}valueOf(t,e){throw new Error("ErrExtension.valueOf Method not implemented.")}isImag(t){throw new Error("ErrExtension Method not implemented.")}isKind(t){return t instanceof Js}isMinusOne(t,e){throw new Error("ErrExtension.isMinusOne Method not implemented.")}isOne(){return!1}isReal(t){throw new Error("ErrExtension.isReal Method not implemented.")}isScalar(t){return!1}isZero(){return!1}subst(t,e,r){return this.isKind(e)&&t.equals(e)?r:t}toInfixString(t,e){return FE}toLatexString(t,e){return FE}toListString(t,e){return FE}}const CE=new qi((function(t){return new UE(t)}));let DE=class extends Bw{constructor(t){super("eval",Jr,t),this.hash=vi(this.opr)}transform(t){const e=this.$;let r=t,n=e.valueOf(eh(r));for(r=rh(r);f(r);){n=Cp(n,e.valueOf(p(r)),e.valueOf(eh(r)),e),r=rh(r)}return[q,e.valueOf(n)]}};const BE=new class{create(t){return new DE(t)}},KE=z(P.E),zE=z(P.exp),QE=z(P.pow);class ZE extends Kw{constructor(t){super("exp",zE,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){const n=this.$;return n.isExpanding()?[q,Bd(QE,KE,e,n)]:[S,r]}}const GE=new class{create(t){return new ZE(t)}},HE=z(P.add),VE=z(P.exp),jE=z(P.multiply);let WE=class extends zw{constructor(t){super(VE,HE,t)}transform1(t,e,r){const n=this.$;return[q,n.valueOf(a(jE,e.argList.map(n.exp)))]}};const JE=new class{create(t){return new WE(t)}};class XE extends Kw{constructor(t){super("exp_flt",ta,it,t),this.hash=xi(this.opr,ui)}transform1(t,e){return[q,W(Math.exp(e.toNumber()))]}}const YE=new class{create(t){return new XE(t)}};class tS extends Kw{constructor(t){super("exp_rat",D("exp"),Mi,t),this.hash=xi(this.opr,ui)}transform1(t,e){return e.isZero()?[q,Dt]:e.isOne()?[q,Ze]:[q,this.$.power(Ze,e)]}}const eS=new class{create(t){return new tS(t)}};function rS(t){const e=[];return Kf(t)?t.tail().forEach((t=>e.push(...nS(t)))):e.push(...nS(t)),e}function nS(t){return zf(t)?t.tail():[t]}function sS(t,e,r,n){const s=Dp(t,r,n);let i=s.length-1;const o=Dp(e,r,n),a=o.length-1;let u=i-a,c=Yt;for(;u>=0;){const t=kp(s[i],o[a],n);for(let e=0;e<=a;e++)s[u+e]=n.subtract(s[u+e],n.multiply(o[e],t));c=n.add(c,n.multiply(t,n.power(r,Ut(u)))),i--,u--}return c}function iS(t,e,r){if(y(t))return function(t,e,r){return t.map((function(t){return iS(t,e,r)}))}(t,e,r);if(Kf(t))return t.tail().reduce(((t,n)=>r.add(t,iS(n,e,r))),Yt);let n=Am(t,r),s=_m(t,r);if([s,n]=function(t,e,r,n){const s=[...rS(t),...rS(e)];let i=0;for(let t=0;t<s.length;t++){const e=s[t];if(!Qf(e))continue;if(!eh(e).equals(r))continue;const n=Sf(sh(e));isNaN(n)||n<i&&(i=n)}if(0===i)return[t,e];return t=n.multiply(t,n.power(r,Ut(-i))),e=n.multiply(e,n.power(r,Ut(-i))),[t,e]}(s,n,e,r),(sp(n,r)||sp(s,r))&&(!cp(s,e)||sp(s,r)))return t;const i=sS(n,s,e,r);if(n=r.subtract(n,r.multiply(s,i)),r.is_zero(n))return i;s=r.factorize(s,e);const o=function(t,e,r){const n=[];zf(t)?t.tail().forEach((s=>n.push(...oS(t,s,e,r)))):n.push(...oS(t,t,e,r));const s=n.length;if(1===s)return n[0];const i=[s,s],o=new Array(s*s);for(let t=0;t<s;t++)for(let i=0;i<s;i++){const a=r.power(e,Ut(t)),u=Rp(n[i],a,r);o[s*t+i]=Ip(u,e,r)}return new x(i,o)}(s,e,r);let a;if(n=function(t,e,r,n){if(!y(e))return t;const s=e.dim(0),i=[s],o=new Array(s);for(let e=0;e<s;e++){const s=Rp(t,n.power(r,Ut(e)),n);o[e]=Ip(s,r,n)}return new x(i,o)}(n,o,e,r),s=function(t,e,r,n){if(!y(e))return Lp(t,n);let s=[];zf(t)?t.tail().forEach((t=>{s.push(...uS(t,r,n))})):s=uS(t,r,n);const i=s.length;return new x([i],s)}(s,o,e,r),y(o)){const t=ur(ey,o,r);a=r.inner(r.inner(t,n),s)}else{const t=Rp(n,o,r);a=r.multiply(t,s)}return r.add(a,i)}function oS(t,e,r,n){let s,i=0;if(!e.contains(r))return[];const o=cr(aS,t,e,n);Qf(e)?(i=Sf(sh(e)),s=eh(e)):(i=1,s=e);const a=[],u=Sf(Cb(s,r,n));for(let t=0;t<i;t++)for(let e=0;e<u;e++){const i=cr(Kd,o,n.power(s,Ut(t)),n),u=cr(Kd,i,n.power(r,Ut(e)),n);a.push(u)}return a}function aS(t,e,r){let n=Dt;if(zf(t)){const s=[];t.tail().forEach((t=>{t.equals(e)||s.push(r.valueOf(t))})),n=Qd(s,r)}return n}function uS(t,e,r){let n=1;if(!t.contains(e))return[];Qf(t)&&(n=Sf(sh(t)),t=eh(t));const s=[],i=Sf(Cb(t,e,r));for(let o=n;o>0;o--)for(let n=0;n<i;n++){const i=Lp(r.power(t,Ut(o)),r),a=r.power(e,Ut(n));s.push(r.multiply(i,a))}return s}let cS=class extends Bw{constructor(t){super("expand",Yr,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(eh(t)),n=e.valueOf(sh(t));return iS(r,c===n?Xh(r):n,e)}(t,this.$);return[e.equals(t)?S:q,e]}};const lS=new class{create(t){return new cS(t)}};let fS=class extends Bw{constructor(t){super("expcos",tn,t),this.hash=vi(this.opr)}transform(t){const e=this.$;if(e.isExpanding()){const r=sb(e.valueOf(eh(t)),e);return[!r.equals(t)?q:T,r]}return[S,t]}};const hS=new class{create(t){return new fS(t)}};let pS=class extends Bw{constructor(t){super("expsin",en,t),this.hash=vi(this.opr)}transform(t){const e=this.$;if(e.isExpanding()){const r=ib(e.valueOf(eh(t)),e);return[!r.equals(t)?q:T,r]}return[S,t]}};const dS=new class{create(t){return new pS(t)}};function mS(t,e){const r=e.valueOf(Td(t,1)),n=e.valueOf(Td(t,2));let s=Tm(r,c===n?Xh(r):n,e);const i=oh(t);return f(i)&&(s=[...i].reduce(((t,r)=>function(t,e,r){if(zf(t)){const n=[];return t.tail().forEach((t=>qm(n,t,e,r))),Zd(n,r)}const n=[];return qm(n,t,e,r),n[0]}(t,e.valueOf(r),e)),s)),s}let gS=class extends Bw{constructor(t){super("factor",rn,t),this.hash=vi(this.opr)}transform(t){const e=mS(t,this.$);return[!e.equals(t)?q:T,e]}};const wS=new class{create(t){return new gS(t)}};let _S=class extends Bw{constructor(t){super("factorial",nn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){return cm(e.valueOf(eh(t)))}(t,this.$);return[!e.equals(t)?q:T,e]}};const xS=new class{create(t){return new _S(t)}};let yS=class extends Bw{constructor(t){super("float",sn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){e.pushNativeDirective(N.evaluatingAsFloat,!0);try{const r=eh(t);Yf(r),lh(r);const n=hh(e.valueOf(r),e);return e.valueOf(n)}finally{e.popNativeDirective()}}(t,this.$);return[e.equals(t)?S:q,e]}};const vS=new class{create(t){return new yS(t)}};function bS(t,e){const r=function(t,e){return function(t,e){if(!ne(t))return Rd(on,t);if(it(t))return W(Math.floor(t.d));if(Ef(t))return t;let r=new kt(xf(t.a,t.b),gt.one);tp(t)&&(r=e.add(r,Jt));return r}(t,e)}(e.valueOf(eh(t)),e);return r}let OS=class extends Bw{constructor(t){super("floor",on,t),this.hash=vi(this.opr)}transform(t){const e=bS(t,this.$);return[q,e]}};const ES=new class{create(t){return new OS(t)}};class SS extends Bw{constructor(t){super("for",an,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=sh(t);ue(r)||sr("for: 2nd arg should be the variable to loop over");const n=xy(uh(t),e);if(isNaN(n))return t;const s=xy(ch(t),e);if(isNaN(s))return t;const i=e.getSymbolValue(r);try{for(let i=n;i<=s;i++)e.setSymbolValue(r,Ut(i)),e.valueOf(eh(t))}finally{e.setSymbolValue(r,i)}return c}(t,this.$);return[!e.equals(t)?q:T,e]}}const qS=new class{create(t){return new SS(t)}};function TS(t,e){return function(t,e){if(re(t)&&Vs(t.a,1)&&Vs(t.b,2))return e.power(lr.Pi(e),te);if(re(t)&&Vs(t.a,3)&&Vs(t.b,2))return e.multiply(e.power(lr.Pi(e),te),te);if($d(t))return kp(e.multiply(lr.Pi(e),Jt),e.multiply(e.multiply(Pm(e.multiply(lr.Pi(e),t),e),t),TS(e.negate(t),e)),e);if(Kf(t))return function(t,e){const r=d(t);if(re(p(r))&&Vs(p(r).a,1)&&Vs(p(r).b,1))return e.multiply(eh(r),TS(eh(r),e));if(re(p(r))&&Vs(p(r).a,-1)&&Vs(p(r).b,1))return kp(TS(eh(r),e),e.add(eh(r),Jt),e);return u(cn,t)}(t,e);return u(cn,t)}(t,e)}let MS=class extends Bw{constructor(t){super("gamma",cn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){return TS(e.valueOf(eh(t)),e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const AS=new class{create(t){return new MS(t)}};let NS=class extends Bw{constructor(t){super("gcd",ln,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){t=d(t);let r=e.valueOf(p(t));return f(t)&&(r=t.tail().reduce(((t,r)=>Gd(t,e.valueOf(r),e)),r)),r}(t,this.$);return[!e.equals(t)?q:T,e]}};const $S=new class{create(t){return new NS(t)}};let LS=class{constructor(t,e,r,n,s){this.name=t,this.hash=e,this.sym=r,this.guardL=n,this.guardR=s}create(t){return new kS(this.name,this.hash,this.sym,this.guardL,this.guardR,t)}},kS=class extends E_{constructor(t,e,r,n,s,i){super(t,r,O_(f,ox(r,Vw,n)),s,i),this.name=t,this.hash=e}transform2(t,e,r){const n=e.lhs,s=e.rhs,i=r;return[q,u(t,u(e.opr,n,i),s)]}};function RS(t,e,r,n,s){return new LS(t,e,r,s,n)}let IS=class extends Bw{constructor(t){super("hermite",fn,t),this.hash=vi(this.opr)}transform(t){const e=this.$;if(e.isExpanding()){const r=function(t,e){return oy(e.valueOf(Td(t,1)),e.valueOf(Td(t,2)),e)}(t,e);return[!r.equals(t)?q:T,r]}return[S,t]}};const PS=new class{create(t){return new IS(t)}};function FS(t,e){return function(t,e){const r=Sf(t);if(r<2)return u(hn,t);const n=[r,r],s=new Array(r*r);for(let t=0;t<r;t++)for(let n=0;n<r;n++)s[t*r+n]=Lp(Ut(t+n+1),e);return new x(n,s)}(e.valueOf(eh(t)),e)}let US=class extends Bw{constructor(t){super("hilbert",hn,t),this.dependencies=[],this.hash=vi(this.opr)}transform(t){const e=FS(t,this.$);return[!e.equals(t)?q:T,e]}};const CS=new class{create(t){return new US(t)}};class DS{constructor(t){}get key(){return ut.name}get hash(){return oi}get name(){return"HypExtension"}evaluate(t,e){return this.transform(a(t,e))}transform(t){return[t instanceof ot?T:S,t]}valueOf(t,e){throw new Error("Hyp Method not implemented.")}isImag(t){return!1}isKind(t){return t instanceof ot}isMinusOne(){return!1}isOne(){return!1}isReal(t){return!1}isScalar(t){return!0}isZero(){return!1}subst(t,e,r){return this.isKind(e)&&t.equals(e)?r:t}toInfixString(t,e){throw new Error("HypExtension.toInfixString Method not implemented.")}toLatexString(t,e){throw new Error("HypExtension.toLatexString Method not implemented.")}toListString(t){return t.printname}}const BS=new qi((function(t){return new DS(t)})),KS=z(P.add),zS=z(P.imag);let QS=class extends zw{constructor(t){super(zS,KS,t)}transform1(t,e,r){const n=this.$,s=e.argList.map((function(t){return n.valueOf(u(zS,t))}));return[S,n.valueOf(a(KS,s))]}};const ZS=new class{create(t){return new QS(t)}};let GS=class extends Kw{constructor(t){super("imag",pn,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){return[S,r]}};const HS=new class{create(t){return new GS(t)}},VS=z(P.imag);let jS=class extends zw{constructor(t){super(VS,xr,t)}isKind(t){if(super.isKind(t)){return re(t.argList.head.argList.head)}return!1}transform1(t,e){return[q,Yt]}};const WS=new class{create(t){return new jS(t)}},JS=z(P.cos),XS=z(P.imag);let YS=class extends zw{constructor(t){super(XS,JS,t)}transform1(t,e,r){const n=this.$,s=e.argList.head;return n.is_real(s)?[q,Dt]:[S,r]}};const tq=new class{create(t){return new YS(t)}},eq=z(P.exp),rq=z(P.imag);let nq=class extends zw{constructor(t){super(rq,eq,t)}transform1(t,e,r){const n=this.$,s=e.argList.head;return n.is_real(s)?[q,Yt]:[S,r]}};const sq=new class{create(t){return new nq(t)}},iq=z(P.imag);let oq=class extends Kw{constructor(t){super("imag_flt",iq,it,t),this.hash=xi(this.opr,ii)}transform1(t,e,r){return[S,X]}};const aq=new class{create(t){return new oq(t)}},uq=z(P.imag);let cq=class extends Kw{constructor(t){super("imag_imu",uq,pt,t),this.hash=xi(this.opr,ai)}transform1(t,e,r){return[q,Dt]}};const lq=new class{create(t){return new cq(t)}},fq=z(P.imag),hq=z(P.log);let pq=class extends zw{constructor(t){super(fq,hq,t)}isKind(t){if(super.isKind(t)){return re(t.argList.head.argList.head)}return!1}transform1(t,e){const r=this.$,n=e.argList.head;if(re(n)){if(n.isZero())return[q,new Js(e)];if(n.isNegative())throw new Error(r.toInfixString(n));return[q,Yt]}throw new Error(r.toInfixString(n))}};const dq=new class{create(t){return new pq(t)}},mq=z(P.imag),gq=z(P.multiply);let wq=class extends zw{constructor(t){super(mq,gq,t)}transform1(t,e,r){const n=this.$,s=[],i=[];[...e.argList].forEach((function(t){n.is_real(t)?s.push(t):i.push(t)}));const o=xq(s,n),a=xq(i,n);if(a.equals(e))return[S,r];const c=n.valueOf(u(mq,a)),l=n.valueOf(u(gq,o,c));return[q,l]}};const _q=new class{create(t){return new wq(t)}};function xq(t,e){return t.length>1?e.valueOf(u(gq,...t)):1===t.length?e.valueOf(t[0]):Dt}const yq=z(P.real),vq=z(P.multiply),bq=z(P.imag);let Oq=class extends zw{constructor(t){super(bq,vq,t)}isKind(t){if(super.isKind(t)){return 1===vh(t.argList.head,pt)}return!1}transform1(t,e){const r=qh(e,pt),n=this.$.valueOf(u(yq,r));return[q,n]}};const Eq=new class{create(t){return new Oq(t)}},Sq=z(P.pow),qq=z(P.imag);let Tq=class extends zw{constructor(t){super(qq,Sq,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return Yf(r)&&re(n)}return!1}transform1(t,e,r){return[q,Yt]}};const Mq=new class{create(t){return new Tq(t)}},Aq=z(P.pow),Nq=z(P.imag);let $q=class extends zw{constructor(t){super(Nq,Aq,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return Yf(r)&&ue(n)}return!1}transform1(t,e,r){const n=this.$,s=Li(e.rhs);return n.is_real(s)?[q,Yt]:[S,r]}};const Lq=new class{create(t){return new $q(t)}};function kq(t){if(re(t))return t;throw new $i(`Expecting a Rat but got expression ${t}.`)}const Rq=z(P.PI),Iq=z(P.pow),Pq=z(P.imag);let Fq=class extends zw{constructor(t){super(Pq,Iq,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return re(r)&&re(n)}return!1}transform1(t,e,r){const n=this.$,s=kq(e.lhs);if(s.isMinusOne()){const t=kq(e.rhs);return[q,n.sin(n.multiply(t,Rq))]}return s.isPositive()?[q,Yt]:[q,r]}};const Uq=new class{create(t){return new Fq(t)}},Cq=z(P.imag);let Dq=class extends Kw{constructor(t){super("imag_rat",Cq,re,t),this.hash=xi(this.opr,ui)}transform1(t,e,r){return[S,Yt]}};const Bq=new class{create(t){return new Dq(t)}},Kq=z(P.sin),zq=z(P.imag);let Qq=class extends zw{constructor(t){super(zq,Kq,t)}transform1(t,e,r){const n=this.$,s=e.argList.head;return n.is_real(s)?[q,Yt]:[S,r]}};const Zq=new class{create(t){return new Qq(t)}},Gq=z(P.imag);let Hq=class extends Kw{constructor(t){super("imag_sym",Gq,ue,t),this.hash=xi(this.opr,li)}transform1(t,e,r){return this.$.is_real(e)?[S,Yt]:[S,r]}};const Vq=new class{create(t){return new Hq(t)}};class jq{constructor(t){this.$=t}get key(){return ht.name}get hash(){return ai}get name(){return"ImuExtension"}isImag(t){return!0}isKind(t){return ht.equals(t)}isMinusOne(t){return!1}isOne(t){return!1}isNil(t){return!1}isReal(t){return!1}isScalar(t){return!0}isZero(t){return!1}subst(t,e,r){return t.equals(e)?r:t}toInfixString(t){return"i"}toLatexString(t){return"\\imath"}toListString(t){return this.$.getSymbolPrintName(Je)}evaluate(t,e){return[T,a(t,e)]}transform(t){return[T,t]}valueOf(t){return t}}const Wq=new class{create(t){return new jq(t)}};function Jq(t,e){if(e>0){const r=t.argList;return f(r)?Jq(r,e-1):r}return t}function Xq(t,e){const r=t.ndim,n=e.length;if(n>r)throw new Error("too many indices for tensor");let s=0;for(let r=0;r<n;r++){const n=Sf(e[r]);if(n<1||n>t.dim(r))throw new Error("index out of range");s=s*t.dim(r)+n-1}if(r===n)return t.elem(s);s=t.sliceDimensions(n).reduce(((t,e)=>t*e),s);const i=t.sliceDimensions(n).reduce(((t,e)=>t*e),1),o=t.sliceDimensions(n),a=new Array(i);for(let e=0;e<i;e++)a[e]=t.elem(s+e);return new x(o,a)}function Yq(t,e){const r=e.valueOf(Td(t,1));return y(r)?function(t,e,r){if(h(e))return t;if(f(e)){const n=[];let s=e;for(;f(s);){const t=s.car,e=r.valueOf(t);if(n.push(e),!ip(e))throw new Error("index with something other than an integer");s=s.cdr}return Xq(t,n)}if(re(e))return Xq(t,[e]);throw new Error}(r,Jq(t,2),e):t}let tT=class extends Bw{constructor(t){super("index_varargs",dn,t),this.hash=vi(this.opr)}transform(t){const e=Yq(t,this.$);return[!e.equals(t)?q:T,e]}};const eT=new class{create(t){return new tT(t)}};class rT extends E_{constructor(t){super("inner_extension",De,Vw,Vw,t),this.hash=mi(De,pi,pi)}transform2(t,e,r,n){const s=this.$,i=(t,e)=>e;if(Dh(e)&&Dh(r)){if(Q(e)&&Q(r))return[S,i(0,n)];{const n=Kh(e),o=qh(e,Q),a=Kh(r),c=qh(r,Q),l=s.valueOf(u(t,o,c)),f=s.valueOf(u(t,n,a)),h=s.valueOf(u(Pe,l,f));return[q,i(0,h)]}}{const t=s.valueOf(u(Pe,e,r));return[S,i(0,t)]}}}const nT=new class{create(t){return new rT(t)}};let sT=class extends E_{constructor(t){super("inner_2_any_imu",De,Vw,pt,t),this.hash=mi(De,pi,ai)}transform2(t,e,r){const n=this.$,s=e,i=r,o=n.valueOf(u(t,Dt,s)),a=n.valueOf(u(Pe,o,i));return[q,a]}};const iT=new class{create(t){return new sT(t)}};let oT=class extends E_{constructor(t){super("inner_2_any_rat",De,Vw,re,t),this.hash=mi(De,pi,ui)}transform2(t,e,r,n){return r.isOne()?[q,e]:[q,u(Pe.clone(t.pos,t.end),e,r)]}};const aT=new class{create(t){return new oT(t)}};let uT=class extends E_{constructor(t){super("inner_2_any_real",De,Vw,function(t){return function(e){return!t.isOne(e)&&t.is_real(e)}}(t),t)}transform2(t,e,r,n){const s=this.$,i=s.valueOf(Rd(t,e,Dt)),o=s.valueOf(Rd(Pe,i,r));return[q,o]}};const cT=new class{create(t){return new uT(t)}};let lT=class extends E_{constructor(t){super("inner_2_blade_blade",De,Q,Q,t),this.hash=mi(De,ri,ri)}transform2(t,e,r){return[q,this.$.valueOf(e.scp(r))]}};const fT=new class{create(t){return new lT(t)}};let hT=class extends E_{constructor(t){super("inner_2_imu_any",De,pt,Vw,t),this.hash=mi(De,ai,pi)}transform2(t,e,r){const n=this.$,s=e,i=r,o=n.negate(s),a=n.valueOf(u(t,Dt,i)),c=n.valueOf(u(Pe,o,a));return[q,c]}};const pT=new class{create(t){return new hT(t)}};let dT=class extends E_{constructor(t){super("inner_2_imu_imu",De,pt,pt,t),this.hash=mi(De,ai,ai)}transform2(t,e,r){return[q,Dt]}};const mT=new class{create(t){return new dT(t)}};let gT=class extends E_{constructor(t){super("inner_2_imu_rat",De,pt,re,t),this.hash=wi(De,Ue,ui)}transform2(t,e,r){const n=this.$;return[q,n.negate(u(Pe.clone(t.pos,t.end),e,r))]}};const wT=new class{create(t){return new gT(t)}};let _T=class extends E_{constructor(t){super("inner_2_num_num",De,ne,ne,t),this.hash=mi(De,ui,ui)}transform2(t,e,r){return[q,Id(e,r)]}};const xT=new class{create(t){return new _T(t)}};let yT=class extends E_{constructor(t){super("inner_2_rat_any",De,re,Vw,t),this.hash=mi(De,ui,pi)}transform2(t,e,r,n){return e.isOne()?[q,r]:[q,u(Pe.clone(t.pos,t.end),e,r)]}};const vT=new class{create(t){return new yT(t)}};let bT=class extends E_{constructor(t){super("inner_2_rat_imu",De,re,pt,t),this.hash=mi(De,ui,ai)}transform2(t,e,r){return[q,u(Pe.clone(t.pos,t.end),e,r)]}};const OT=new class{create(t){return new bT(t)}};let ET=class extends E_{constructor(t){super("inner_2_rat_sym",De,re,ue,t),this.hash=mi(De,ui,li)}transform2(t,e,r){return[q,u(Pe.clone(t.pos,t.end),e,r)]}};const ST=new class{create(t){return new ET(t)}};let qT=class extends E_{constructor(t){super("inner_2_real_any",De,function(t){return function(e){return!t.isOne(e)&&t.is_real(e)}}(t),Vw,t),this.phases=$}transform2(t,e,r,n){const s=this.$,i=s.valueOf(u(t,Dt,r)),o=s.valueOf(u(Pe,e,i));return[q,o]}};const TT=new class{create(t){return new qT(t)}};let MT=class extends E_{constructor(t){super("inner_2_sym_sym",De,ue,ue,t),this.hash=mi(De,li,li)}isScalar(){return!0}isZero(t){return!1}transform2(t,e,r,n){const s=this.$;return[q,s.valueOf(u(Pe.clone(t.pos,t.end),e,r))]}};const AT=new class{create(t){return new MT(t)}};function NT(t){return function(e){return t.isScalar(e)}}let $T=class extends E_{constructor(t){super("inner_2_vec_scalar",De,Q,NT(t),t)}transform2(t,e,r,n){return[q,Yt]}};const LT=new class{create(t){return new $T(t)}};let kT=class extends Bw{constructor(t){super("integral_varargs",mn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){let r,n,s=0,i=d(t),o=e.valueOf(p(i));i=d(i);const a=e.valueOf(p(i));for(c===a?(r=Xh(o),n=c):ne(a)?(r=Xh(o),n=a):(r=a,i=d(i),n=e.valueOf(p(i)));;){ne(n)?(s=Sf(n),isNaN(s)&&sr("nth integral: check n")):s=1;let t=o;if(s>=0)for(let n=0;n<s;n++)t=$O(t,r,e);else{s=-s;for(let n=0;n<s;n++)t=gy(t,r,e)}if(o=t,c===n)break;if(ne(n)){if(i=d(i),n=e.valueOf(p(i)),c===n)break;ne(n)||(r=n,i=d(i),n=e.valueOf(p(i)))}else r=n,i=d(i),n=e.valueOf(p(i))}return o}(t,this.$);return[!e.equals(t)?q:T,e]}};const RT=new class{create(t){return new kT(t)}};let IT=class extends Kw{constructor(t){super("inv_any",Be,Vw,t),this.hash=xi(Be,pi)}transform1(t,e,r){const n=ey(e,this.$);return[!n.equals(r)?q:S,n]}};const PT=new class{create(t){return new IT(t)}},FT=z(P.inverse);let UT=class extends zw{constructor(t){super(FT,FT,t)}transform1(t,e,r){const n=e.argList.head;return[q,n]}};const CT=new class{create(t){return new UT(t)}},DT=z(P.is_complex);let BT=class extends Kw{constructor(t){super("is_complex_any",DT,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){return[S,r]}};const KT=new class{create(t){return new BT(t)}},zT=z(P.is_complex);let QT=class extends Kw{constructor(t){super("is_complex_sym",zT,ue,t),this.hash=xi(this.opr,li)}transform1(t,e){const r=this.$.getSymbolProps(e);return[q,G(r.complex)]}};const ZT=new class{create(t){return new QT(t)}};function GT(t,e){return function(t){if(e=t,re(e)&&Vs(e.b,1)&&1===Hs(e.a)&&ym(t.a))return Dt;var e;return Yt}(e.valueOf(eh(t)))}let HT=class extends Bw{constructor(t){super("isprime",wn,t),this.hash=vi(this.opr)}transform(t){const e=GT(t,this.$);return[!e.equals(t)?q:T,e]}};const VT=new class{create(t){return new HT(t)}},jT=z(P.pow),WT=z(P.is_real);let JT=class extends zw{constructor(t){super(WT,jT,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head.rhs;return re(e)&&e.isMinusOne()}return!1}transform1(t,e,r){const n=this.$,s=e.lhs;return[q,G(n.is_real(s))]}};const XT=new class{create(t){return new JT(t)}},YT=z(P.abs),tM=z(P.is_real);let eM=class extends zw{constructor(t){super(tM,YT,t)}transform1(t,e,r){return[q,H]}};const rM=new class{create(t){return new eM(t)}},nM=z(P.add),sM=z(P.is_real);class iM extends zw{constructor(t){super(sM,nM,t)}transform1(t,e){const r=this.$;return[...e.argList].every((function(t){return r.is_real(t)}))?[q,H]:[q,V]}}const oM=new class{create(t){return new iM(t)}};class aM extends Kw{constructor(t){super("is_real_any",Dn,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){return[q,V]}}const uM=new class{create(t){return new aM(t)}},cM=z(P.is_real),lM=z(P.cos);class fM extends zw{constructor(t){super(cM,lM,t)}transform1(t,e){const r=this.$,n=e.argList.head;return[q,G(r.is_real(n))]}}const hM=new class{create(t){return new fM(t)}};class pM extends Kw{constructor(t){super(`${Dn.text}(expr: ${ii}) => ${ni}`,Dn,it,t),this.hash=xi(this.opr,ii)}transform1(t,e){return[q,H]}}const dM=new class{create(t){return new pM(t)}};class mM extends zw{constructor(t){super(Dn,pn,t)}transform1(t,e){return[q,H]}}const gM=new class{create(t){return new mM(t)}};class wM extends Kw{constructor(t){super(`${Dn.text}(expr: ${ai}) => ${ni}`,Dn,pt,t),this.hash=xi(this.opr,ai)}transform1(t,e){return[q,V]}}const _M=new class{create(t){return new wM(t)}};class xM extends zw{constructor(t,e){super(Dn,t,e)}transform1(t,e){const r=this.$;return[...e.argList].every((function(t){return r.is_real(t)}))?[q,H]:[q,V]}}const yM=new class{create(t){return new xM(Pe,t)}},vM=z(P.pow),bM=z(P.is_real);let OM=class extends zw{constructor(t){super(bM,vM,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return Yf(r)&&ue(n)}return!1}transform1(t,e,r){const n=this.$,s=Li(e.rhs);return n.is_real(s)?[q,H]:[q,V]}};const EM=new class{create(t){return new OM(t)}},SM=z(P.pow),qM=z(P.is_real);class TM extends zw{constructor(t){super(qM,SM,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return pt(r)&&re(n)}return!1}transform1(t,e,r){const n=kq(e.rhs),s=n.numer();return n.denom().isOne()&&s.div(zt).isInteger()?[q,H]:[q,V]}}const MM=new class{create(t){return new TM(t)}},AM=z(P.PI),NM=z(P.pow),$M=z(P.is_real);let LM=class extends zw{constructor(t){super($M,NM,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return re(r)&&re(n)}return!1}transform1(t,e,r){const n=this.$,s=kq(e.lhs);if(s.isMinusOne()){const t=kq(e.rhs),r=n.sin(n.multiply(t,AM));return n.is_zero(r)?[q,H]:[q,V]}return s.isPositive()?[q,H]:[q,V]}};const kM=new class{create(t){return new LM(t)}},RM=z(P.pow),IM=z(P.is_real);let PM=class extends zw{constructor(t){super(IM,RM,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return ue(r)&&re(n)}return!1}transform1(t,e,r){const n=this.$,s=Li(e.lhs),i=kq(e.rhs),o=i.numer(),a=i.denom();return n.is_real(s)?o.div(Bt).isInteger()?a.isOne()?[q,H]:[q,V]:o.isMinusOne()&&a.isOne()?[q,G(n.is_real(s))]:[q,V]:[q,V]}};const FM=new class{create(t){return new PM(t)}};class UM extends Kw{constructor(t){super("is_real_rat",Dn,re,t),this.hash=xi(this.opr,ui)}transform1(t,e){return[q,H]}}const CM=new class{create(t){return new UM(t)}};let DM=class extends zw{constructor(t){super(Dn,Cn,t)}transform1(t,e){return[q,H]}};const BM=new class{create(t){return new DM(t)}};class KM extends zw{constructor(t){super(Dn,Im,t)}transform1(t,e){const r=this.$,n=e.argList.head;return[q,G(r.is_real(n))]}}const zM=new class{create(t){return new KM(t)}};let QM=class{constructor(t){this.predicate=t}create(t){return new ZM(this.predicate,t)}};class ZM extends Kw{constructor(t,e){super(`${t.text}(sym: ${li}) => ${ni}`,t,ue,e),this.hash=xi(this.opr,li)}transform1(t,e){const r=this.$.getSymbolProps(e);return[q,G(r.real)]}}const GM=z(P.is_zero);class HM extends Kw{constructor(t){super("iszero_any",GM,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){return[S,r]}}const VM=new class{create(t){return new HM(t)}};const jM=z(P.is_zero);class WM extends Kw{constructor(t){super("iszero_rat",jM,re,t),this.hash=xi(this.opr,ui)}transform1(t,e){return[q,e.isZero()?H:V]}}const JM=new class{create(t){return new WM(t)}};function XM(t,e){const r=e.valueOf(eh(t)),n=e.valueOf(sh(t)),s=e.valueOf(uh(t));return function(t,e,r,n){const s=Sf(e);if(s<0||isNaN(s))return Rd(_n,t,e,r);if(ue(t))return YM(s,t,r,n);return n.valueOf(Cp(YM(s,Ss,r,n),Ss,t,n))}(r,n,c===s?Yt:s,e)}function YM(t,e,r,n){let s=Yt,i=Dt;for(let o=0;o<t;o++){const t=kp(n.subtract(n.multiply(n.add(n.subtract(Ut(2*o+1),e),r),i),n.multiply(n.add(Ut(o),r),s)),Ut(o+1),n);s=i,i=t}return i}let tA=class extends Bw{constructor(t){super("laguerre",_n,t),this.hash=vi(this.opr)}transform(t){const e=XM(t,this.$);return[!e.equals(t)?q:T,e]}};const eA=new class{create(t){return new tA(t)}};function rA(t,e,r){return cr(nA,t,e,r)}function nA(t,e,r){const n=kp(Gd(t,e,r),t,r);return Lp(kp(n,e,r),r)}let sA=class extends Bw{constructor(t){super("lcm",xn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){t=d(t);let r=e.valueOf(p(t));return f(t)&&(r=t.tail().reduce(((t,r)=>rA(t,e.valueOf(r),e)),r)),r}(t,this.$);return[!e.equals(t)?q:T,e]}};const iA=new class{create(t){return new sA(t)}};let oA=class extends E_{constructor(t){super("lco_2_any_any",Ke,Vw,Vw,t)}isKind(t){if(super.isKind(t)){const e=t.lhs,r=t.rhs;return!Q(e)||!Q(r)}return!1}transform2(t,e,r,n){const s=this.$;if(zf(e)&&Dh(e)){const t=Kh(e),n=qh(e,Q),i=s.valueOf(u(Ke,t,r)),o=s.valueOf(u(Pe,n,i));return[q,o]}if(zf(r)&&Dh(r)){const t=Kh(r),n=qh(r,Q),i=s.valueOf(u(Ke,e,t)),o=s.valueOf(u(Pe,n,i));return[q,o]}return[S,n]}};const aA=new class{create(t){return new oA(t)}};let uA=class extends E_{constructor(t){super("lco_2_blade_blade",Ke,Q,Q,t),this.hash=mi(this.opr,ri,ri)}transform2(t,e,r){return[q,this.$.valueOf(e.__lshift__(r))]}};const cA=new class{create(t){return new uA(t)}};function lA(t,e){return e.power(t,Bt)}function fA(t,e){const r=e.valueOf(eh(t)),n=e.valueOf(sh(t)),s=e.valueOf(uh(t));return function(t,e,r,n){return function(t,e,r,n){const s=Sf(e),i=Sf(r);if(s<0||isNaN(s)||i<0||isNaN(i))return Rd(yn,t,e,r);let o;if(ue(t))o=hA(s,i,t,n);else{const e=hA(s,i,Ss,n);o=n.valueOf(Cp(e,Ss,t,n))}return o=function(t,e,r,n){if(0===e)return;let s=n.subtract(Dt,lA(r,n));p(r).equals(Ir)?s=lA(Pm(eh(r),n),n):p(r).equals(Hn)&&(s=lA(Rm(eh(r),n),n));let i=n.multiply(t,n.power(s,n.multiply(Ut(e),te)));e%2&&(i=n.negate(i));return i}(o,i,t,n)||o,o}(t,e,r,n)}(r,n,c===s?Yt:s,e)}function hA(t,e,r,n){let s=Yt,i=Dt;for(let e=0;e<t;e++){const t=kp(n.subtract(n.multiply(n.multiply(Ut(2*e+1),r),i),n.multiply(Ut(e),s)),Ut(e+1),n);s=i,i=t}for(let t=0;t<e;t++)i=gy(i,r,n);return i}let pA=class extends Bw{constructor(t){super("legendre",yn,t),this.hash=vi(this.opr)}transform(t){const e=fA(t,this.$);return[!e.equals(t)?q:T,e]}};const dA=new class{create(t){return new pA(t)}};let mA=class extends Bw{constructor(t){super("log",vn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){return hy(e.valueOf(eh(t)),e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const gA=new class{create(t){return new mA(t)}},wA=z(P.mod);function _A(t,e){const r=e.valueOf(sh(t));return function(t,e,r){r.is_zero(e)&&sr("mod function: divide by zero");if(!ne(t)||!ne(e))return u(wA,t,e);if(it(t)){const e=Sf(t);isNaN(e)&&sr("mod function: cannot convert float value to integer"),t=Ut(e)}if(it(e)){const t=Sf(e);isNaN(t)&&sr("mod function: cannot convert float value to integer"),e=Ut(t)}Ef(t)&&Ef(e)||sr("mod function: integer arguments expected");return new kt(yf(t.a,e.a),gt.one)}(e.valueOf(eh(t)),r,e)}const xA=z(P.mod);let yA=class extends Bw{constructor(t){super("mod",xA,t),this.hash=vi(this.opr)}transform(t){const e=_A(t,this.$);return[!e.equals(t)?q:T,e]}};const vA=new class{create(t){return new yA(t)}};let bA=class extends E_{constructor(t,e){super("mul_2_any_flt",e,Vw,it,t),this.dependencies=[],this.hash=mi(e,pi,ii)}isKind(t){if(super.isKind(t)){return t.rhs.isZero()}return!1}transform2(t,e,r){if(r.isZero())return[q,r];throw new Error}};const OA=new class{constructor(t){this.opr=t}create(t){return new bA(t,this.opr)}}(Pe);let EA=class extends E_{constructor(t,e){super("mul_2_any_rat",e,Vw,re,t),this.dependencies=[],this.hash=mi(e,pi,ui)}isKind(t){if(super.isKind(t)){const e=t.rhs;return e.isZero()||e.isOne()}return!1}transform2(t,e,r,n){return r.isOne()?[q,e]:r.isZero()?[q,Yt]:[S,n]}};const SA=new class{constructor(t){this.opr=t}create(t){return new EA(t,this.opr)}}(Pe);let qA=class extends E_{constructor(t){super("mul_2_blade_blade",Pe,Q,Q,t),this.hash=mi(Pe,ri,ri)}transform2(t,e,r){const n=this.$;return[q,n.valueOf(e.mul(r))]}};const TA=new class{create(t){return new qA(t)}};let MA=class extends E_{constructor(t){super("mul_2_blade_rat",Pe,Q,re,t),this.dependencies=["Blade"],this.hash=mi(Pe,ri,ui)}transform2(t,e,r){const n=this.$;return[q,n.valueOf(Rd(t,r,e))]}};const AA=new class{create(t){return new MA(t)}};let NA=class extends E_{constructor(t,e){super("mul_2_flt_any",e,it,Vw,t),this.dependencies=[],this.hash=mi(e,ii,pi)}isKind(t){if(super.isKind(t)){return t.lhs.isZero()}return!1}transform2(t,e,r,n){return e.isZero()?[q,e]:[S,n]}};const $A=new class{constructor(t){this.opr=t}create(t){return new NA(t,this.opr)}}(Pe);const LA=new class{create(t){return new kA(t)}};let kA=class extends E_{constructor(t){super("mul_2_flt_flt",Pe,it,it,t),this.dependencies=["Flt"],this.hash=mi(Pe,ii,ii)}transform2(t,e,r){return[q,e.mul(r)]}},RA=class extends E_{constructor(t){super("mul_2_flt_imu",Pe,kh,pt,t),this.dependencies=["Flt","Imu"],this.hash=mi(Pe,ii,ai)}transform2(t,e,r,n){return e.isZero()?[q,e]:e.isOne()?[S,n]:[T,n]}};const IA=new class{create(t){return new RA(t)}};function PA(t){return Up(t)&&it(t.lhs)}let FA=class extends E_{constructor(t){super("mul_2_flt_mul_2_flt_any",Pe,kh,O_(f,PA),t),this.dependencies=["Flt"],this.hash=gi(Pe,ii,Pe)}transform2(t,e,r){const n=this.$,s=e,i=r.lhs,o=s.mul(i),a=r.rhs,u=n.valueOf(Rd(Pe,o,a));return[q,u]}};const UA=new class{create(t){return new FA(t)}};let CA=class extends E_{constructor(t){super("mul_2_flt_rat",Pe,it,re,t),this.dependencies=["Flt"],this.hash=mi(Pe,ii,ui)}transform2(t,e,r){return[q,W(e.toNumber()*r.toNumber())]}};const DA=new class{create(t){return new CA(t)}};let BA=class extends E_{constructor(t){super("mul_2_flt_uom",Pe,kh,X_,t),this.dependencies=["Flt","Uom"],this.hash=mi(Pe,ii,hi)}transform2(t,e,r,n){return e.isZero()?[q,e]:e.isOne()?[q,r]:[T,n]}};const KA=new class{create(t){return new BA(t)}};let zA=class extends E_{constructor(t){super("mul_2_hyp_rat",Pe,lt,re,t),this.hash=mi(Pe,oi,ui)}isScalar(t){return this.$.isScalar(t.lhs)}transform2(t,e,r){return r.isZero()?[q,Yt]:r.isOne()?[q,e]:[q,Rd(t,r,e)]}};const QA=new class{create(t){return new zA(t)}};let ZA=class extends E_{constructor(t){super("mul_2_hyp_sym",Pe,lt,ue,t),this.dependencies=[],this.hash=mi(Pe,oi,li)}transform2(t,e,r){const n=this.$;return[q,n.valueOf(Rd(t,r,e))]}};const GA=new class{create(t){return new ZA(t)}};let HA=class extends E_{constructor(t){super("mul_2_imu_flt",Pe,pt,kh,t),this.dependencies=["Flt","Imu"],this.hash=mi(Pe,ai,ii)}isKind(t){if(super.isKind(t)){return!!t.rhs.isZero()}return!1}transform2(t,e,r){return[q,r]}};const VA=new class{create(t){return new HA(t)}};let jA=class extends E_{constructor(t){super("mul_2_imu_imu",Pe,pt,pt,t),this.dependencies=["Imu"],this.hash=mi(Pe,ai,ai)}transform2(t,e,r){return[q,Jt]}};const WA=new class{create(t){return new jA(t)}};function JA(t){return Up(t)&&f(t.rhs)}let XA=class extends S_{constructor(t){super("mul_2_mul_2_any_cons_sym",Pe,O_(f,JA),ue,function(t){return function(e,r){const n=e.rhs.opr;return!(!ue(n)||!n.equalsSym(Vm))&&t.isScalar(r)}}(t),t),this.hash=wi(Pe,Pe,li)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r,a=n.valueOf(u(Pe,s,o)),c=n.valueOf(u(Pe,a,i));return[q,c]}};const YA=new class{create(t){return new XA(t)}};function tN(t,e){const r=t.rhs.lhs,n=e.lhs;return r.equalsSym(n)}const eN=Vw,rN=O_(f,ox(Ue,ue,re)),nN=O_(f,ox(Pe,eN,rN)),sN=O_(f,ox(Ue,ue,re));let iN=class extends S_{constructor(t){super("mul_2_mul_2_any_pow_2_xxx_any_pow_2_xxx_any",Pe,nN,sN,tN,t),this.hash=_i(Pe,Pe,Ue)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs.lhs,o=e.rhs.rhs,a=r.rhs,u=n.valueOf(Rd(Re,o,a)),c=n.valueOf(Rd(Ue,i,u)),l=n.valueOf(Rd(t,s,c));return[q,l]}};const oN=new class{create(t){return new iN(t)}};function aN(t){return Up(t)&&ue(t.rhs)}let uN=class extends E_{constructor(t){super("mul_2_mul_2_any_sym_imu",Pe,O_(f,aN),pt,t),this.hash=wi(Pe,Pe,ai)}isImag(t){const e=this.$,r=t.lhs.lhs;return e.is_real(r)}transform2(t,e,r,n){const s=this.$,i=e.lhs,o=e.rhs,a=r;if(s.compareFn(t)(o,a)===E){const t=s.valueOf(u(Pe,i,a)),e=s.valueOf(u(Pe,t,o));return[q,e]}return[S,n]}};const cN=new class{create(t){return new uN(t)}};function lN(t){return Up(t)&&pt(t.lhs)}let fN=class extends E_{constructor(t){super("mul_2_mul_2_any_sym_mul_2_imu_sym",Pe,O_(f,aN),O_(f,lN),t),this.hash=_i(Pe,Pe,Pe)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.lhs,a=r.rhs,c=n.valueOf(u(Pe,s,o)),l=n.valueOf(u(Pe,i,a)),f=n.valueOf(u(Pe,c,l));return[q,f]}};const hN=new class{create(t){return new fN(t)}};const pN=O_(f,Fp(Pe)),dN=O_(f,cO(Ue,re));function mN(t,e){const r=t.rhs,n=e.lhs;return r.equals(n)}let gN=class extends S_{constructor(t){super("mul_2_mul_2_any_X_pow_2_X_rat",Pe,pN,dN,mN,t),this.hash=_i(Pe,Pe,Ue)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.rhs,a=n.valueOf(u(r.opr,i,o.succ())),c=n.valueOf(u(Pe,s,a));return[q,c]}};const wN=new class{create(t){return new gN(t)}};const _N=O_(f,Fp(Pe)),xN=O_(f,Fp(Ue));let yN=class extends S_{constructor(t){super("mul_2_mul_2_any_Z_pow_2_A_any",Pe,_N,xN,function(t){return function(e,r){const n=e.rhs,s=r.lhs;return ue(n)&&ue(s)&&t.compareFn(Pe)(n,s)>0}}(t),t),this.hash=_i(Pe,Pe,Ue)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.lhs,a=r.rhs,c=u(r.opr,o,a),l=n.valueOf(c),f=u(e.opr,s,l),h=u(t,n.valueOf(f),i),p=n.valueOf(h);return[q,p]}};const vN=new class{create(t){return new yN(t)}};let bN=class extends E_{constructor(t){super("mul_2_mul_2_rat_any_mul_2_rat_any",Pe,O_(f,cx),O_(f,cx),t),this.hash=_i(Pe,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=e.lhs,o=e.rhs,a=r.lhs,c=r.rhs,l=s.valueOf(u(r.opr,o,c)),f=s.valueOf(u(t,i.mul(a),l));return[q,f]}};const ON=new class{create(t){return new bN(t)}};let EN=class extends E_{constructor(t){super("mul_2_mul_2_sym_imu_sym",Pe,O_(f,ox(Pe,ue,pt)),ue,t),this.hash=wi(Pe,Pe,li)}transform2(t,e,r,n){const s=this.$,i=e.lhs,o=e.rhs,a=r;if(s.compareFn(t)(o,a)===E){const e=s.valueOf(u(t,i,a)),r=s.valueOf(u(Pe,e,o));return[q,r]}return[S,n]}};const SN=new class{create(t){return new EN(t)}};function qN(t){return Lm(t)&&ue(t.lhs)}function TN(t,e){const r=t.lhs,n=e.lhs;return r.equalsSym(n)}const MN=O_(f,qN),AN=O_(f,qN);let NN=class extends S_{constructor(t){super("mul_2_pow_2_xxx_any_pow_2_xxx_any",Pe,MN,AN,TN,t),this.hash=_i(Pe,Ue,Ue)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r.rhs,a=n.valueOf(Rd(Re,i,o)),u=n.valueOf(Rd(Ue,s,a));return[q,u]}};const $N=new class{create(t){return new NN(t)}};function LN(t){return Lm(t)&&ue(t.lhs)&&re(t.rhs)}function kN(t,e){const r=e;return t.lhs.equalsSym(r)}let RN=class extends S_{constructor(t){super("mul_2_pow_2_xxx_rat_xxx",Pe,O_(f,LN),ue,kN,t),this.hash=wi(Pe,Ue,li)}transform2(t,e,r,n){const s=this.$,i=e.lhs,o=e.rhs.succ(),a=s.valueOf(Rd(Ue,i,o));return[q,a]}};const IN=new class{create(t){return new RN(t)}};let PN=class extends E_{constructor(t){super("mul_2_rat_any",Pe,re,Vw,t),this.hash=mi(Pe,ui,pi)}isKind(t){if(super.isKind(t)){const e=t.lhs;return e.isZero()||e.isOne()}return!1}isImag(t){return this.$.is_imag(t.rhs)}isReal(t){return this.$.is_real(t.rhs)}isScalar(t){return this.$.isScalar(t.rhs)}transform2(t,e,r,n){return function(t,e,r){return t.isZero()?[q,t]:t.isOne()?[q,e]:[S,r]}(e,r,n)}};const FN=new class{create(t){return new PN(t)}};let UN=class extends E_{constructor(t){super("mul_2_rat_blade",Pe,re,Q,t),this.dependencies=["Blade"],this.hash=mi(Pe,ui,ri)}isScalar(t){return!1}transform2(t,e,r,n){return e.isZero()?[q,Yt]:e.isOne()?[q,r]:[T,n]}};const CN=new class{create(t){return new UN(t)}};let DN=class extends E_{constructor(t){super("mul_2_rat_flt",Pe,re,it,t),this.dependencies=["Flt"],this.hash=mi(Pe,ui,ii)}transform2(t,e,r){return[q,W(e.toNumber()*r.toNumber())]}};const BN=new class{create(t){return new DN(t)}};let KN=class extends E_{constructor(t){super("mul_2_rat_rat",Pe,re,re,t),this.hash=mi(Pe,ui,ui)}transform2(t,e,r,n){return[q,e.mul(r)]}};const zN=new class{create(t){return new KN(t)}};let QN=class extends E_{constructor(t){super("mul_2_rat_sym",Pe,re,ue,t),this.hash=mi(Pe,ui,li)}isKind(t){if(super.isKind(t)){const e=t.lhs;return e.isZero()||e.isOne()}return!1}isReal(t){return this.$.is_real(t.rhs)}isImag(t){return this.$.is_imag(t.rhs)}isScalar(t){return this.$.isScalar(t.rhs)}transform2(t,e,r,n){return e.isZero()?[q,Yt]:e.isOne()?[q,r]:[T,n]}};const ZN=new class{create(t){return new QN(t)}};let GN=class extends E_{constructor(t){super("mul_2_rat_tensor",Pe,re,y,t),this.hash=mi(Pe,ui,fi)}transform2(t,e,r){const n=this.$;if(e.isZero())return[q,Yt];if(e.isOne())return[q,r];const s=r.map((function(t){return n.multiply(e,t)}));return[q,s]}};const HN=new class{create(t){return new GN(t)}};let VN=class extends S_{constructor(t){super("mul_2_sym_blade",Pe,ue,Q,function(t){return function(e,r){return t.isScalar(e)}}(t),t),this.dependencies=["Blade"],this.hash=mi(Pe,li,ri)}transform2(t,e,r,n){return[T,n]}};const jN=new class{create(t){return new VN(t)}};let WN=class extends E_{constructor(t){super("mul_2_sym_imu",Pe,ue,pt,t),this.hash=gi(Pe,li,Ue)}isImag(t){return!0}isReal(t){return!1}isScalar(t){return this.$.isScalar(t.lhs)}transform2(t,e,r,n){const s=this.$;return s.compareFn(t)(e,r)===E?[q,s.valueOf(Rd(t,r,e))]:[S,n]}};const JN=new class{create(t){return new WN(t)}};const XN=new class{create(t){return new YN(t)}};let YN=class extends E_{constructor(t){super("mul_2_sym_mul_2_rat_any",Pe,ue,O_(f,cx),t),this.hash=gi(Pe,li,Pe)}transform2(t,e,r,n){const s=this.$,i=e,o=r.lhs,a=r.rhs;if(s.compareFn(t)(i,o)===E){const e=s.valueOf(Rd(r.opr,i,a)),n=s.valueOf(Rd(t,o,e));return[q,n]}return[S,n]}},t$=class extends E_{constructor(t){super("mul_2_sym_num",Pe,ue,ne,t),this.hash="(* Sym Num)"}isScalar(t){return this.$.isScalar(t.lhs)}transform2(t,e,r){return r.isZero()?[q,Yt]:r.isOne()?[q,e]:[q,Rd(t,r,e)]}};const e$=new class{create(t){return new t$(t)}};let r$=class extends E_{constructor(t){super("mul_2_sym_rat",Pe,ue,re,t),this.hash=mi(Pe,li,ui)}isScalar(t){return this.$.isScalar(t.lhs)}transform2(t,e,r){return r.isZero()?[q,Yt]:r.isOne()?[q,e]:[q,Rd(t,r,e)]}};const n$=new class{create(t){return new r$(t)}};let s$=class extends S_{constructor(t){super("mul_2_sym_tensor",Pe,ue,y,function(t){return function(e,r){return t.isScalar(e)}}(t),t),this.dependencies=[],this.hash=mi(Pe,li,fi)}transform2(t,e,r){const n=this.$,s=r.map((function(t){return n.multiply(e,t)}));return[q,s]}};const i$=new class{create(t){return new s$(t)}};let o$=class extends S_{constructor(t){super("mul_2_tensor_any",Pe,y,Vw,(function(t,e){return!0}),t),this.dependencies=[],this.hash=mi(Pe,fi,pi)}transform2(t,e,r){const n=this.$,s=e.map((function(t){return n.multiply(t,r)}));return[q,s]}};const a$=new class{create(t){return new o$(t)}};let u$=class extends S_{constructor(t){super("mul_2_tensor_sym",Pe,y,ue,function(t){return function(e,r){return t.isScalar(r)}}(t),t),this.dependencies=[],this.hash=mi(Pe,fi,li)}transform2(t,e,r){const n=this.$,s=e.map((function(t){return n.multiply(t,r)}));return[q,s]}};const c$=new class{create(t){return new u$(t)}};function l$(t,e,r){const n=t.dim(t.ndim-1);n!==e.dim(0)&&sr("inner: tensor dimension check");const s=t.ndim+e.ndim-2;s>Ks&&sr("inner: rank of result exceeds maximum");const i=t.sliceDimensions(0,t.ndim-1).reduce(((t,e)=>t*e),1),o=e.sliceDimensions(1).reduce(((t,e)=>t*e),1),a=Ap(i*o,Yt);for(let s=0;s<i;s++)for(let i=0;i<n;i++)if(!r.is_zero(t.elem(s*n+i)))for(let u=0;u<o;u++)a[s*o+u]=r.add(r.multiply(t.elem(s*n+i),e.elem(i*o+u)),a[s*o+u]);if(0===s)return a[0];{const r=[...t.sliceDimensions(0,t.ndim-1),...e.sliceDimensions(1,e.ndim)];return new x(r,a)}}let f$=class extends S_{constructor(t){super("mul_2_tensor_tensor",Pe,y,y,(function(t,e){return!0}),t),this.dependencies=[],this.hash=mi(Pe,fi,fi)}transform2(t,e,r){const n=this.$;return[q,l$(e,r,n)]}};const h$=new class{create(t){return new f$(t)}};let p$=class extends E_{constructor(t){super("mul_2_uom_flt",Pe,Le,it,t),this.dependencies=["Flt","Uom"],this.hash=mi(Pe,hi,ii)}isScalar(t){return!0}transform2(t,e,r){return r.isZero()?[q,Yt]:r.isOne()?[q,e]:[q,Rd(t,r,e)]}};const d$=new class{create(t){return new p$(t)}};let m$=class extends E_{constructor(t){super("mul_2_uom_rat",Pe,Le,re,t),this.dependencies=["Uom"],this.hash=mi(Pe,hi,ui)}isScalar(t){return!0}transform2(t,e,r){return r.isZero()?[q,Yt]:r.isOne()?[q,e]:[q,Rd(t,r,e)]}};const g$=new class{create(t){return new m$(t)}};let w$=class extends E_{constructor(t){super("mul_2_uom_uom",Pe,X_,X_,t),this.dependencies=["Uom"],this.hash=mi(Pe,hi,hi)}transform2(t,e,r){return[q,e.mul(r)]}};const _$=new class{create(t){return new w$(t)}};function x$(t){return Lm(t)&&re(t.rhs)}function y$(t,e){const r=t,n=e.lhs;return!(!ue(r)&&!lt(r))&&r.equals(n)}let v$=class extends S_{constructor(t){super("mul_2_X_pow_2_X_rat",Pe,Vw,O_(f,x$),y$,t),this.hash=gi(Pe,pi,Ue)}transform2(t,e,r){const n=this.$,s=e,i=r.rhs,o=Rd(r.opr,s,i.succ()),a=n.valueOf(o);return[q,a]}};const b$=new class{create(t){return new v$(t)}};function O$(t,e,r){if(ne(t)&&ne(e))return Id(t,e);if(re(t)&&t.isZero())return t;if(re(e)&&e.isZero())return e;if(r.isExpanding()&&Kf(t))return t.tail().reduce(((t,n)=>r.add(t,O$(n,e,r))),Yt);if(r.isExpanding()&&Kf(e))return e.tail().reduce(((e,n)=>r.add(e,O$(t,n,r))),Yt);const n=r.compareFn(Pe);if(Dh(t)&&Dh(e)){const n=Kh(t),s=Kh(e),i=n.mul(s),o=qh(t,Q),a=qh(e,Q);return r.multiply(r.multiply(o,a),i)}if(Le(t)&&Le(e))return t.mul(e);if(!y(t)&&y(e))return r.multiply(t,e);if(y(t)&&!y(e))return r.multiply(t,e);let s=zf(t)?t.cdr:u(t),i=zf(e)?e.cdr:u(e);const o=[],c=p(s),l=p(i);for(ne(c)&&ne(l)?(o.push(Id(c,l)),s=s.cdr,i=i.cdr):ne(c)?(o.push(c),s=s.cdr):ne(l)?(o.push(l),i=i.cdr):o.push(Dt);f(s)&&f(i);){const t=s.car,e=i.car;if(p(t).equals(Tn)&&p(e).equals(Tn)){o.push(a(Tn,S$(d(t),d(e)))),s=s.cdr,i=i.cdr;continue}const[u,c]=E$(t),[l,f]=E$(e);if(u.equals(l))T$(o,l,c,f,r),s=s.cdr,i=i.cdr;else switch(n(t,e)){case b:o.push(t),s=s.cdr;break;case E:o.push(e),i=i.cdr;break;default:throw new Error(`${Uw(u,r)} ${Uw(c,r)} ${Uw(l,r)} ${Uw(f,r)}`)}}if(f(s)&&o.push(...s),f(i)&&o.push(...i),r.isExpanding())for(let t=0;t<o.length;t++)if(Kf(o[t]))return q$(o,r);const h=o.length;if(1===h){return M$(o.pop())}const m=o[0];if(re(m)&&m.isOne()){if(2===h){return M$(o.pop())}o.splice(0,1),o.sort(n);return u(Pe,...o)}return a(Pe,u(...o))}function E$(t,e){if(Qf(t)){const e=t.cdr;return[p(e),eh(e)]}return[t,Dt]}function S$(t,e){const r=[];return f(t)&&r.push(...t),f(e)&&r.push(...e),u(...r)}function q$(t,e){if(1===t.length)return t[0];if(0===t.length)return Dt;let r=t[0];for(let n=1;n<t.length;n++)r=O$(r,t[n],e);return r}function T$(t,e,r,n,s){const i=s.power(e,s.add(r,n));if(ne(i))t[0]=Id(A$(t[0]),i);else if(zf(i)){const e=eh(i);if(ne(e)&&h(oh(i))){const r=A$(t[0]),n=e;t[0]=Id(r,n),t.push(sh(i))}else t.push(i)}else t.push(i)}function M$(t){if(void 0===t)throw new Error;return t}function A$(t){if(ne(t))return t;throw new Error}class N$ extends Bw{constructor(t){super("mul_varargs",Pe,t),this.hash=vi(this.opr)}isScalar(t){const e=this.$;return[...t.argList].every((t=>e.isScalar(t)))}transform(t){const e=function(t,e){const r=t.argList,n=r.map(e.valueOf);if(n.equals(r)){if(h(n))return Dt;{const t=n.car,r=n.cdr;return f(r)?[...r].reduce(((t,r)=>O$(t,r,e)),t):t}}return e.valueOf(a(t.car,n))}(t,this.$);return[e.equals(t)?S:q,((t,e)=>e)(0,e)]}}const $$=new class{create(t){return new N$(t)}};class L${constructor(t){this.$=t}get key(){return c.name}get hash(){return di}get name(){return"NilExtension"}isImag(t){throw new Error}isKind(t){return c.equals(t)}isMinusOne(t){throw new Error}isOne(t){return!1}isNil(t){throw new Error}isReal(t){throw new Error}isScalar(t){throw new Error}isZero(t){return!1}subst(t,e,r){return t.equals(e)?r:t}toInfixString(t){return"nil"}toLatexString(t){return"nil"}toListString(t){return"()"}evaluate(t){return this.transform(a(c,t))}transform(t){return c.equals(t)?[T,c]:[S,t]}valueOf(t){return c}}const k$=new class{create(t){return new L$(t)}};let R$=class extends Bw{constructor(t){super("not",On,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=t,n=Jv(eh(t),e);return null==n?r:n?Yt:Dt}(t,this.$);return[!e.equals(t)?q:T,e]}};const I$=new class{create(t){return new R$(t)}};let P$=class extends Bw{constructor(t){super("number",Sn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(eh(t));return Mi(r)||kh(r)?Dt:Yt}(t,this.$);return[!e.equals(t)?q:T,e]}};const F$=new class{create(t){return new P$(t)}};let U$=class extends Bw{constructor(t){super("numerator",qn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){return Am(e.valueOf(eh(t)),e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const C$=new class{create(t){return new U$(t)}};let D$=class extends Bw{constructor(t){super("or",Mn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=t;let n=d(r),s=!1;for(;f(n);){const t=Jv(p(n),e);if(null==t)s=!0,n=d(n);else{if(t)return Dt;t||(n=d(n))}}return s?r:Yt}(t,this.$);return[!e.equals(t)?q:T,e]}};const B$=new class{create(t){return new D$(t)}};let K$=class extends E_{constructor(t,e){super("outer_2_any_any",t,Vw,Vw,e),this.hash=mi(this.opr,pi,pi)}isKind(t){if(super.isKind(t)){const e=t.lhs,r=t.rhs;return!zf(e)&&!zf(r)}return!1}transform2(t,e,r,n){return[S,n]}};const z$=new class{constructor(t){this.opr=t}create(t){return new K$(this.opr,t)}}(Ce);function Q$(t){const e=NT(t);return function(t){return f(t)&&Up(t)&&e(t.lhs)}}let Z$=class extends E_{constructor(t){super("outer_2_any_mul_2_scalar_any",Ce,Vw,Q$(t),t),this.hash=mi(this.opr,pi,pi)}isKind(t){if(super.isKind(t)){return!zf(t.lhs)}return!1}transform2(t,e,r){const n=this.$,s=e,i=r.lhs,o=r.rhs,a=n.valueOf(u(t,s,o)),c=n.valueOf(u(r.opr,i,a));return[q,c]}};const G$=new class{create(t){return new Z$(t)}};class H$ extends E_{constructor(t){super("outer_2_blade_blade",Ce,Q,Q,t),this.dependencies=["Blade"],this.hash=mi(Ce,ri,ri)}transform2(t,e,r){return[q,e.__wedge__(r)]}}const V$=new class{create(t){return new H$(t)}};let j$=class extends E_{constructor(t){super("outer_2_mul_2_scalar_any_any",Ce,Q$(t),Vw,t),this.hash=mi(this.opr,pi,pi)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r,a=n.valueOf(u(Ce,i,o)),c=n.valueOf(u(Pe,s,a));return[q,c]}};const W$=new class{create(t){return new j$(t)}};let J$=class extends E_{constructor(t){super("outer_2_sym_sym",Ce,ue,ue,t),this.dependencies=["Vector"],this.hash=mi(Ce,li,li)}transform2(t,e,r,n){return[T,n]}};const X$=new class{create(t){return new J$(t)}};function Y$(t,e,r){t.ndim+e.ndim>Ks&&sr("outer: rank of result exceeds maximum");const n=[...t.copyDimensions(),...e.copyDimensions()],s=[];let i=0;for(let n=0;n<t.nelem;n++)for(let o=0;o<e.nelem;o++)s[i++]=r.multiply(t.elem(n),e.elem(o));return new x(n,s)}let tL=class extends E_{constructor(t){super("outer_2_tensor_tensor",Ce,y,y,t),this.dependencies=[],this.hash=mi(Ce,fi,fi)}transform2(t,e,r){const n=this.$;return[q,Y$(e,r,n)]}};const eL=new class{create(t){return new tL(t)}};function rL(t,e){return Yf(t)}let nL=class extends S_{constructor(t){super("pow_2_e_any",Ue,ue,Vw,rL,t),this.hash=mi(this.opr,li,pi)}isImag(t){return!1}isReal(t){return!0}isScalar(t){return!0}transform2(t,e,r,n){const s=this.$;if(s.getNativeDirective(N.evaluatingAsPolar));else if(s.getNativeDirective(N.evaluatingTrigAsExp));else{if(s.isExpanding()){if(pt(r)){const t=u(km,Dt),e=u(Qe,Dt),r=u(Pe,ht,e);return[q,u(Re,t,r)]}if(f(r)&&Up(r)){const t=r.lhs,e=r.rhs;if(pt(t)){if(lh(e))return[q,Jt];if(s.is_real(e)){const t=u(km,e),r=u(Qe,e),n=u(Pe,ht,r);return[q,u(Re,t,n)]}}if(s.is_real(t)&&pt(e)){if((n.meta&M)===M)return[S,n];{const e=s.valueOf(u(km,t)),r=s.valueOf(u(Qe,t)),n=s.valueOf(u(Pe,r,ht));return[q,s.valueOf(u(Re,e,n))]}}if(f(t)&&Yb(Pe,Mi)(t)&&s.is_real(t.rhs)&&pt(e)){const e=u(km,t),r=u(Qe,t),n=u(Pe,r,ht);return[q,u(Re,e,n)]}if(f(e)&&Cf(e,z(P.log))){const r=t,n=e.argList.head;return[q,s.valueOf(u(Ue,n,r))]}}if(f(r)&&yh(r)){if(1===vh(r,pt)){const t=function(t,e){const r=t,n=e.valueOf(u(Pe,r,ht));return e.valueOf(u(Pe,n,Jt))}(r,s);return[q,sL(t,s)]}}}if(s.isFactoring())return[q,u(ta,r)]}return[S,n]}};function sL(t,e){const r=e.valueOf(u(km,t)),n=e.valueOf(u(Qe,t)),s=e.valueOf(u(Pe,ht,n));return e.valueOf(u(Re,r,s))}const iL=new class{create(t){return new nL(t)}},oL=z(P.log),aL=z(P.pow);function uL(t,e){if(Yf(t)){if(f(e)){const t=e.head;return ue(t)&&t.equalsSym(oL)}return!1}return!1}let cL=class extends S_{constructor(t){super("pow_2_e_log",aL,ue,f,uL,t),this.hash=mi(this.opr,li,pi)}transform2(t,e,r,n){const s=r.argList.head;return[q,s]}};const lL=new class{create(t){return new cL(t)}};function fL(t,e){return Yf(t)&&Mi(e)}let hL=class extends S_{constructor(t){super("pow_2_e_rat",Ue,ue,Mi,fL,t),this.hash=mi(this.opr,li,pi)}transform2(t,e,r,n){return r.isZero()?[S,Dt]:[S,n]}};const pL=new class{create(t){return new hL(t)}};let dL=class extends E_{constructor(t){super("pow_2_imu_rat",Ue,pt,Mi,t),this.hash=mi(Ue,ai,ui)}isScalar(){return!0}transform2(t,e,r,n){const s=this.$;return r.isTwo()?[q,Jt]:r.isMinusOne()?[q,s.negate(ht)]:[S,n]}};const mL=new class{create(t){return new dL(t)}};const gL=O_(f,ox(Ue,Yf,O_(f,A_))),wL=Mi;function _L(t,e){const r=e;return t.rhs.lhs.isTwo()&&r.isHalf()}let xL=class extends S_{constructor(t){super("pow_2_pow_2_e_any_rat",Ue,gL,wL,_L,t),this.hash=wi(this.opr,Ue,pi)}transform2(t,e,r,n){const s=this.$,i=e.rhs.rhs,o=e.lhs,a=s.valueOf(u(Ue,o,i));return[q,a]}};const yL=new class{create(t){return new xL(t)}};class vL extends Kw{constructor(t){super("pred_any",D("pred"),Vw,t),this.name="pred_any",this.hash=xi(this.opr,pi)}transform1(t,e,r){return[S,r]}}const bL=new class{create(t){return new vL(t)}};class OL extends Kw{constructor(t){super("pred_rat",D("pred"),re,t),this.hash=xi(this.opr,ui)}transform1(t,e){return[q,e.pred()]}}const EL=new class{create(t){return new OL(t)}};function SL(t,e){const r=nr.codeGen,n=nr.printMode;nr.codeGen=!1,nr.setPrintMode(er);try{let r=xw(t,e);return r=r.replace(/_/g,"\\_"),r}finally{nr.codeGen=r,nr.setPrintMode(n)}}class qL{constructor(t,e){this.keyword=t,this.$=e}isImag(t){throw new Error("Keyword Symbol Method not implemented.")}isKind(t){return!!ue(t)&&t.equalsSym(this.keyword)}isMinusOne(t){throw new Error("Keyword.isMinusOne Symbol Method not implemented.")}isOne(t){throw new Error("Keyword.isOne Symbol Method not implemented.")}isReal(t){throw new Error("Keyword.isReal Symbol Method not implemented.")}isScalar(t){throw new Error("Keyword.isScalar Symbol Method not implemented.")}isZero(t){throw new Error("Keyword.isZero Symbol Method not implemented.")}subst(t,e,r){throw new Error("Keyword.subst Symbol Method not implemented.")}toInfixString(t){return t.text}toLatexString(t){throw new Error("Keyword.toLatexString Symbol Method not implemented.")}toListString(t){return this.keyword.key()}evaluate(t,e){return this.transform(a(t,e))}transform(t){throw new Error("Keyword.transform Symbol Method not implemented.")}valueOf(t){throw new Error("Keyword.valueOf Symbol Method not implemented.")}}const TL=D("Sym");class ML extends qL{constructor(t,e,r){super(D(t),r),this.printMode=e}get key(){return TL.name}get hash(){return li}get name(){return this.keyword.text}transform(t){if(ue(t)&&t.equalsSym(this.keyword)){const t=this.$,e=this.printMode(),r=nr.printMode;nr.setPrintMode(e);try{const r=function(t,e,r){switch(e){case Ye:return Ig(t,r);case er:return SL(t,r);case tr:return Uw(t,r);case Xe:return Cw(t,r);case rr:return uw(t,r);default:throw new Error(e)}}(t.getSymbolValue(jm),e,t);return this.$.getPrintHandler().print(r),mw(r,dw(e),t),[q,c]}finally{nr.setPrintMode(r)}}return[S,t]}}let AL=class{constructor(t,e){this.keyword=t,this.printMode=e}create(t){return new ML(this.keyword,this.printMode,t)}};function NL(t,e){return new AL(t,e)}class $L extends Kw{constructor(t,e,r){super(t,D(t),Vw,r),this.printMode=e,this.hash=xi(this.opr,pi)}transform1(t,e){const r=this.$,n=u(e);if(f(n)){const t=function(t,e,r){const n=[];let s=t;for(;f(s);){const t=r.valueOf(s.car),i=e;nr.setPrintMode(e);try{if(e===tr){const s=xw(t,r);n.push(s),mw(s,dw(e),r)}else if(e===er){const s=xw(t,r);n.push(s),mw(s,dw(e),r)}else if(e===Ye){const s=Ig(t,r);n.push(s),mw(s,dw(e),r)}else if(e===Xe){const s=xw(t,r);n.push(s),mw(s,dw(e),r)}else if(e===rr){const s=uw(t,r);n.push(s),mw(s,dw(e),r)}}finally{nr.setPrintMode(i)}s=s.argList}return n}(n,this.printMode(),r);this.$.getPrintHandler().print(...t)}return[q,c]}}let LL=class{constructor(t,e){this.opr=t,this.printMode=e}create(t){return new $L(this.opr,this.printMode,t)}};function kL(t,e){return new LL(t,e)}let RL=class extends Bw{constructor(t){super("product",Rn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=eh(t),n=sh(t);ue(n)||sr("sum: 2nd arg?");const s=xy(uh(t),e);if(isNaN(s))return t;const i=xy(ch(t),e);if(isNaN(i))return t;const o=e.getSymbolValue(n);let a=Dt;for(let t=s;t<=i;t++){e.setSymbolValue(n,Ut(t));const s=e.valueOf(r);a=e.multiply(a,s)}return e.setSymbolValue(n,o),a}(t,this.$);return[!e.equals(t)?q:T,e]}};const IL=new class{create(t){return new RL(t)}};function PL(t){return eh(t)}let FL=class extends Bw{constructor(t){super("quotient",Pn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(eh(t)),n=e.valueOf(sh(t)),s=e.valueOf(uh(t));return h(s)?sS(r,n,Ls,e):sS(r,n,s,e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const UL=new class{create(t){return new FL(t)}};let CL=class extends Bw{constructor(t){super("rank",Fn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(t.argList.car);return y(r)?Ut(r.rank):Yt}(t,this.$);return[q,e]}};const DL=new class{create(t){return new CL(t)}};let BL=class extends Bw{constructor(t){super("rationalize",Un,t),this.phases=R,this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=eh(t);return dm(e.valueOf(r),e)}(t,this.$);return[e.equals(t)?S:T,e]}};const KL=new class{create(t){return new BL(t)}};let zL=class extends E_{constructor(t){super("rco_2_any_any",ze,Vw,Vw,t),this.hash=mi(ze,pi,pi)}transform2(t,e,r,n){return[S,n]}};const QL=new class{create(t){return new zL(t)}};let ZL=class extends E_{constructor(t){super("rco_2_any_mul_2_scalar_any",ze,Vw,Q$(t),t),this.hash=gi(ze,pi,Pe)}transform2(t,e,r){const n=this.$,s=e,i=r.lhs,o=r.rhs,a=n.valueOf(u(t,s,o)),c=n.valueOf(u(r.opr,i,a));return[q,c]}};const GL=new class{create(t){return new ZL(t)}};let HL=class extends E_{constructor(t){super("rco_2_blade_blade",ze,Q,Q,t),this.hash=mi(ze,ri,ri)}transform2(t,e,r){return[q,e.__rshift__(r)]}};const VL=new class{create(t){return new HL(t)}};let jL=class extends E_{constructor(t){super("rco_2_mul_2_scalar_any_any",ze,Q$(t),Vw,t),this.hash=wi(ze,Pe,pi)}transform2(t,e,r){const n=this.$,s=e.lhs,i=e.rhs,o=r,a=n.valueOf(u(t,i,o)),c=n.valueOf(u(e.opr,s,a));return[q,c]}};const WL=new class{create(t){return new jL(t)}},JL=z(P.add),XL=z(P.real);let YL=class extends zw{constructor(t){super(XL,JL,t)}transform1(t,e,r){const n=this.$,s=e.argList.map((function(t){return n.valueOf(u(XL,t))})),i=n.valueOf(a(JL,s));return[S,i]}};const tk=new class{create(t){return new YL(t)}};let ek=class extends Kw{constructor(t){super("real",Cn,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){return[S,r]}};const rk=new class{create(t){return new ek(t)}},nk=z(P.cos),sk=z(P.real);let ik=class extends zw{constructor(t){super(sk,nk,t)}transform1(t,e,r){const n=this.$,s=e.argList.head;return n.is_real(s)?[q,e]:[S,r]}};const ok=new class{create(t){return new ik(t)}},ak=z(P.exp),uk=z(P.real);let ck=class extends zw{constructor(t){super(uk,ak,t)}transform1(t,e,r){const n=this.$,s=e.argList.head;return n.is_real(s)?[q,e]:[S,r]}};const lk=new class{create(t){return new ck(t)}},fk=z(P.real);let hk=class extends Kw{constructor(t){super("real_flt",fk,it,t),this.hash=xi(this.opr,ii)}transform1(t,e,r){return[S,e]}};const pk=new class{create(t){return new hk(t)}},dk=z(P.imag),mk=z(P.real);let gk=class extends zw{constructor(t){super(mk,dk,t)}transform1(t,e,r){return[q,e]}};const wk=new class{create(t){return new gk(t)}};let _k=class extends Kw{constructor(t){super("real",Cn,pt,t),this.hash=xi(this.opr,ai)}transform1(t,e,r){return[q,Yt]}};const xk=new class{create(t){return new _k(t)}},yk=z(P.real),vk=z(P.log);let bk=class extends zw{constructor(t){super(yk,vk,t)}isKind(t){if(super.isKind(t)){return pt(t.argList.head.argList.head)}return!1}transform1(t,e){return[q,Yt]}};const Ok=new class{create(t){return new bk(t)}},Ek=z(P.real),Sk=z(P.log);let qk=class extends zw{constructor(t){super(Ek,Sk,t)}isKind(t){if(super.isKind(t)){return re(t.argList.head.argList.head)}return!1}transform1(t,e){const r=this.$,n=e.argList.head;if(re(n)){if(n.isZero())return[q,new Js(e)];if(n.isNegative())throw new Error(r.toInfixString(n));return[q,e]}throw new Error(r.toInfixString(n))}};const Tk=new class{create(t){return new qk(t)}},Mk=z(P.add),Ak=z(P.exp),Nk=z(P.imag),$k=z(P.pow),Lk=z(P.real),kk=z(P.multiply);function Rk(t,e){return t.length>1?e.valueOf(u(kk,...t)):1===t.length?e.valueOf(t[0]):Dt}let Ik=class extends zw{constructor(t){super(Lk,kk,t)}transform1(t,e,r){const n=this.$,s=vh(e,pt);if(s>0){const t=qh(e,pt);switch(s%4){case 0:return[q,n.real(t)];case 1:return[q,n.negate(n.imag(t))];case 2:return[q,n.negate(n.real(t))];case 3:return[q,n.imag(t)];default:throw new Error(`${s}`)}}const i=[],o=[];[...e.argList].forEach((function(t){if(n.is_real(t))i.push(t);else if(ue(t)){const e=u(Lk,t),r=u(Nk,t),n=u(kk,ht,r),s=u(Mk,e,n);o.push(s)}else if(t.equals(ht))o.push(t);else if(Qf(t)){const e=t.lhs,r=t.rhs;if(re(r)&&r.isMinusOne()){const t=n.conj(e),r=n.valueOf(u(kk,t,e)),s=n.valueOf(u($k,r,Jt)),i=n.valueOf(u(kk,t,s));o.push(i)}else{const t=Vp(e,r,n),s=Xp(e,r,n),a=n.valueOf(u(kk,ht,s)),c=n.valueOf(u(Ak,a));i.push(t),o.push(c)}}else{if(!f(t)||!ue(t.opr))throw new Error(n.toSExprString(t));o.push(t)}}));const a=Rk(i,n),c=Rk(o,n);if(c.equals(e))return[S,r];const l=n.valueOf(u(Lk,c)),h=n.valueOf(u(kk,a,l));return[q,h]}};const Pk=new class{create(t){return new Ik(t)}},Fk=z(P.PI),Uk=z(P.pow),Ck=z(P.real);let Dk=class extends zw{constructor(t){super(Ck,Uk,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return re(r)&&re(n)}return!1}transform1(t,e,r){const n=this.$,s=kq(e.lhs);if(s.isMinusOne()){const t=kq(e.rhs);return[q,n.cos(n.multiply(t,Fk))]}return s.isPositive()?[q,e]:[q,r]}};const Bk=new class{create(t){return new Dk(t)}};let Kk=class extends Kw{constructor(t){super("real_rat",Cn,re,t),this.hash=xi(this.opr,ui)}transform1(t,e,r){return[S,e]}};const zk=new class{create(t){return new Kk(t)}},Qk=z(P.real);let Zk=class extends zw{constructor(t){super(Qk,Qk,t)}transform1(t,e,r){return[q,e]}};const Gk=new class{create(t){return new Zk(t)}};let Hk=class extends Kw{constructor(t){super("real",Cn,ue,t),this.hash=xi(this.opr,li)}transform1(t,e,r){return this.$.is_real(e)?[S,e]:[S,r]}};const Vk=new class{create(t){return new Hk(t)}},jk=t=>!re(t),Wk=z(P.rect),Jk=z(P.multiply);let Xk=class extends zw{constructor(t){super(Wk,Jk,t)}isKind(t){if(super.isKind(t)){return 1==vh(t.argList.head,re)}return!1}transform1(t,e,r){const n=this.$,s=kq(qh(e,jk)),i=qh(e,re),o=n.valueOf(u(Wk,i)),a=n.valueOf(u(Jk,s,o));return[q,a]}};const Yk=new class{create(t){return new Xk(t)}},tR=z(P.rect),eR=z(P.pow);let rR=class extends zw{constructor(t){super(tR,eR,t)}isKind(t){if(super.isKind(t)){const e=t.argList.head,r=e.lhs,n=e.rhs;return!!Yf(r)&&!(!f(n)||1!=vh(n,pt))}return!1}transform1(t,e,r){return[q,r]}};const nR=new class{create(t){return new rR(t)}};let sR=class extends Bw{constructor(t){super("roots_varargs",zn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=eh(t);let n;if(p(r).equals(em)||p(r).equals(Qn))n=e.subtract(e.valueOf(eh(r)),e.valueOf(sh(r)));else{const t=e.valueOf(r);n=p(t).equals(em)||p(t).equals(Qn)?e.subtract(e.valueOf(eh(t)),e.valueOf(sh(t))):t}const s=e.valueOf(sh(t)),i=c===s?Xh(n):s;if(cp(n,i))return nm(n,i,e);sr("roots: 1st argument is not a polynomial in the variable "+e.toInfixString(i))}(t,this.$);return[!e.equals(t)?q:T,e]}};const iR=new class{create(t){return new sR(t)}};function oR(t,e){return function(t,e){if(!ne(t))return Rd(Bn,t);if(it(t))return W(Math.round(t.d));if(Ef(t))return t;const r=hh(t,e);return it(r)?Ut(Math.round(r.d)):r}(e.valueOf(eh(t)),e)}let aR=class extends Bw{constructor(t){super("round",Bn,t),this.hash=vi(this.opr)}transform(t){const e=oR(t,this.$);return[q,e]}};const uR=new class{create(t){return new aR(t)}};class cR extends qL{constructor(t){super(jm,t)}get key(){return TL.name}get hash(){return li}get name(){return"ScriptLast"}evaluate(t){return this.transform(a(jm,t))}transform(t){return this.isKind(t)?[q,this.$.getSymbolValue(jm)]:[S,t]}}const lR=new class{create(t){return new cR(t)}};class fR extends Kw{constructor(t){super("sgn_flt",Zn,it,t),this.hash=xi(this.opr,ii)}transform1(t,e){return[q,pR(e)]}}const hR=new class{create(t){return new fR(t)}};function pR(t){return t.d>0?Dt:0===t.d?Yt:Jt}class dR extends Kw{constructor(t){super("sgn_rat",Zn,re,t),this.hash=xi(this.opr,ui)}transform1(t,e){return[q,gR(e)]}}const mR=new class{create(t){return new dR(t)}};function gR(t){const e=_f(t.a,t.b);return e.isNegative()?Jt:e.isZero()?Yt:Dt}function wR(t,e){return function(t,e){if(!y(t))return e.is_zero(t)||sr("transpose: tensor expected, 1st arg is not a tensor"),Yt;const{ndim:r}=t,n=new Array(r),s=[r];for(let e=0;e<r;e++)n[e]=Ut(t.dim(e));return new x(s,n)}(e.valueOf(eh(t)),e)}let _R=class extends Bw{constructor(t){super("shape",jn,t),this.hash=vi(this.opr)}transform(t){const e=wR(t,this.$);return[!e.equals(t)?q:T,e]}};const xR=new class{create(t){return new _R(t)}};function yR(t,e){const r=function(t,e){if(0===nr.userSimplificationsInListForm.length||t.contains(mn))return t;let r=ar((function(t){return e.valueOf(t)}),t,e),n=!0,s=0;for(;n&&s<Ds;){n=!1,s++;for(const t of Array.from(nr.userSimplificationsInListForm)){let s=!0,i=0;for(;s&&i<Bs;)i++,[r,s]=AO(r,c,t,!0,e),s&&(n=!0);i===Bs&&sr(`maximum application of single transformation rule exceeded: ${e.toInfixString(t)}`)}}s===Ds&&sr("maximum application of all transformation rules exceeded ");return r}(eh(t),e);return Dm(e.valueOf(r),e)}let vR=class extends Bw{constructor(t){super("simplify_varargs",Gn,t),this.hash=vi(this.opr)}transform(t){const e=yR(t,this.$);return[!e.equals(t)?q:T,e]}};const bR=new class{create(t){return new vR(t)}};function OR(t){return Up(t)&&Q(t.lhs)}let ER=class extends E_{constructor(t){super("simplify_mul_2_blade_mul_2_blade_any",Pe,Q,O_(f,OR),t),this.hash=gi(Pe,ri,Pe)}transform2(t,e,r){const n=this.$,s=e,i=r.lhs,o=s.mul(i),a=r.rhs,u=n.valueOf(Rd(Pe,o,a));return[q,u]}};const SR=new class{create(t){return new ER(t)}};let qR=class extends Kw{constructor(t){super("sin_add_2_any_any",Im,O_(f,Yb(Re,Vw)),t),this.phases=$,this.hash=yi(Im,Re)}transform1(t,e){const r=this.$,n=e.lhs,s=e.rhs,i=r.valueOf(u(Im,n)),o=r.valueOf(u(km,s)),a=r.valueOf(u(km,n)),c=r.valueOf(u(Im,s)),l=r.valueOf(u(Pe,i,o)),f=r.valueOf(u(Pe,a,c)),h=r.valueOf(u(Re,l,f));return[q,h]}};const TR=new class{create(t){return new qR(t)}};function MR(t,e,r){return Kf(t)?function(t,e,r){let n=d(t);for(;f(n);){const e=p(n);if(nO(e,r)){const n=r.subtract(t,e);return[q,r.add(r.multiply(Pm(n,r),Rm(e,r)),r.multiply(Rm(n,r),Pm(e,r)))]}n=d(n)}return AR(t,e,r)}(t,e,r):AR(t,e,r)}function AR(t,e,r){if(p(t).equals(wr))return[q,eh(t)];if(it(t)){let e=Math.sin(t.d);return Math.abs(e)<1e-10&&(e=0),[q,W(e)]}if($d(t))return[q,r.negate(Pm(r.negate(t),r))];if(p(t).equals(xr))return[q,r.multiply(eh(t),r.power(r.add(Dt,r.power(eh(t),Bt)),Pf(-1,2)))];const n=Sf(kp(r.multiply(t,Ut(180)),lr.Pi(r),r));if(n<0||isNaN(n))return[S,e];switch(n%360){case 0:case 180:return[q,Yt];case 30:case 150:return[q,te];case 210:case 330:return[q,Pf(-1,2)];case 45:case 135:return[q,r.multiply(te,r.power(Bt,te))];case 225:case 315:return[q,r.multiply(Pf(-1,2),r.power(Bt,te))];case 60:case 120:return[q,r.multiply(te,r.power(Kt,te))];case 240:case 300:return[q,r.multiply(Pf(-1,2),r.power(Kt,te))];case 90:return[q,Dt];case 270:return[q,Jt];default:return[S,e]}}let NR=class extends Kw{constructor(t){super("sin_any",Im,Vw,t),this.hash=xi(Im,pi)}transform1(t,e,r){const n=this.$;return n.isExpanding()?MR(e,r,n):[S,r]}};const $R=new class{create(t){return new NR(t)}};let LR=class extends Kw{constructor(t){super("sin_hyp",Im,lt,t),this.hash=xi(Im,oi)}transform1(t,e){return[q,e]}};const kR=new class{create(t){return new LR(t)}};let RR=class extends Kw{constructor(t){super("sin_mul_2_any_imu",Im,O_(f,cO(Pe,pt)),t),this.hash=yi(Im,Pe)}transform1(t,e,r){const n=this.$,s=e.lhs,i=e.rhs;if(n.isExpanding()){const t=n.valueOf(u(Vn,s)),e=n.valueOf(u(Pe,t,i));return[q,e]}return[T,r]}};const IR=new class{create(t){return new RR(t)}};let PR=class extends Kw{constructor(t){super("sin_sym",Im,ue,t),this.hash=xi(Im,li)}isReal(t){return this.$.is_real(t.arg)}transform1(t,e,r){return MR(e,r,this.$)}};const FR=new class{create(t){return new PR(t)}};let UR=class extends Kw{constructor(t){super("sinh",Vn,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){const n=fy(e,this.$);return[!n.equals(r)?q:S,n]}};const CR=new class{create(t){return new UR(t)}};let DR=class extends Kw{constructor(t){super("sinh_flt",Vn,it,t),this.dependencies=["Flt"],this.hash=xi(this.opr,ii)}isReal(t){return!0}transform1(t,e,r){const n=Math.sinh(e.d);return Math.abs(n)<1e-10?[q,X]:[q,W(n)]}};const BR=new class{create(t){return new DR(t)}};let KR=class extends Kw{constructor(t){super("sinh_rat",Vn,re,t),this.hash=xi(this.opr,ui)}isReal(t){return!0}transform1(t,e,r){return e.isZero()?[q,Yt]:[T,r]}};const zR=new class{create(t){return new KR(t)}};let QR=class extends Kw{constructor(t){super("sinh_sym",Vn,ue,t),this.hash=xi(this.opr,li)}isReal(t){return!0}transform1(t,e,r){return[T,r]}};const ZR=new class{create(t){return new QR(t)}};class GR extends Kw{constructor(t){super("sqrt_1_any",Yw,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e){return[q,this.$.valueOf(u(Ue,e,te))]}}const HR=new class{create(t){return new GR(t)}};class VR extends Kw{constructor(t){super("sqrt_1_rat",Yw,re,t),this.hash=xi(Yw,ui)}transform1(t,e){return[q,this.$.valueOf(Rd(Ue,e,te))]}}const jR=new class{create(t){return new VR(t)}},WR=D("st");const JR=O_(f,ox(Re,Vw,lt));let XR=class extends Kw{constructor(t){super("st_add_2_any_hyp",WR,JR,t),this.phases=$,this.hash=yi(WR,Re)}transform1(t,e){const r=this.$,n=e.lhs,s=r.valueOf(u(WR,n));return[q,s]}};const YR=new class{create(t){return new XR(t)}};let tI=class extends Kw{constructor(t){super("st_any",WR,Vw,t),this.hash=xi(WR,pi)}transform1(t,e,r){return this.$.is_real(e)?[q,e]:[S,r]}};const eI=new class{create(t){return new tI(t)}};const rI=O_(f,ox(Pe,re,Vw));let nI=class extends Kw{constructor(t){super("st_mul_2_rat_any",WR,rI,t),this.phases=$,this.hash=yi(WR,Pe)}transform1(t,e){const r=this.$,n=e.lhs,s=e.rhs,i=r.valueOf(u(t,s)),o=r.valueOf(u(e.opr,n,i));return[q,o]}};const sI=new class{create(t){return new nI(t)}};let iI=class extends Kw{constructor(t){super("st_rat",WR,Mi,t),this.hash=xi(WR,pi)}transform1(t,e){return[q,e]}};const oI=new class{create(t){return new iI(t)}};let aI=class extends Kw{constructor(t){super("st_sym",WR,ue,t),this.hash=xi(WR,pi)}transform1(t,e){return[q,e]}};const uI=new class{create(t){return new aI(t)}};let cI=class extends Bw{constructor(t){super("subst",Jn,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(eh(t)),n=e.valueOf(sh(t)),s=e.valueOf(uh(t));return e.valueOf(Cp(s,n,r,e))}(t,this.$);return[!e.equals(t)?q:T,e]}};const lI=new class{create(t){return new cI(t)}};class fI extends Kw{constructor(t){super("succ_any",D("succ"),Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){return[S,r]}}const hI=new class{create(t){return new fI(t)}};class pI extends Kw{constructor(t){super("succ_rat",D("succ"),re,t),this.hash=xi(this.opr,ui)}transform1(t,e,r){return[q,e.succ()]}}const dI=new class{create(t){return new pI(t)}};function mI(t,e){const r=function(t,e){const r=eh(t),n=sh(t);ue(n)||sr("sum: 2nd arg?");const s=xy(uh(t),e);if(isNaN(s))return t;const i=xy(ch(t),e);if(isNaN(i))return t;const o=e.getSymbolValue(n);let a=Yt;try{for(let t=s;t<=i;t++)e.setSymbolValue(n,Ut(t)),a=e.add(a,e.valueOf(r))}finally{e.setSymbolValue(n,o)}return a}(t,e);return r}let gI=class extends Bw{constructor(t){super("sum",Xn,t),this.hash=vi(this.opr)}transform(t){const e=mI(t,this.$);return[!e.equals(t)?q:T,e]}};const wI=new class{create(t){return new gI(t)}};class _I{constructor(t){this.$=t}get key(){return TL.name}get hash(){return li}get name(){return"SymExtension"}valueOf(t,e){if(lh(t)&&e.getNativeDirective(N.evaluatingAsFloat))return et;const r=e.getSymbolValue(t);return c===r?t:t!==r?e.valueOf(r):t}isImag(t,e){return!1}isKind(t){return!!ue(t)}isMinusOne(t,e){return!1}isOne(t,e){return!1}isReal(t,e){return e.is_real(t)}isScalar(t,e){return!0}isZero(){return!1}subst(t,e,r){return ue(e)&&t.equals(e)?r:t}toInfixString(t){return t.key()}toLatexString(t){return t.key()}toListString(t){const e=this.$.getSymbolPrintName(t);return e||t.key()}evaluate(t,e){return this.transform(a(t,e))}transform(t){if(ue(t)){return function(t,e){const r=e.getSymbolValue(t);return h(r)||t.equals(r)?[S,t]:[q,r]}(t,this.$)}return[S,t]}}const xI=new qi((function(t){return new _I(t)}));class yI{constructor(t){this.$=t}get key(){return TL.name}get hash(){return li}get name(){return"SymMathAdd"}isImag(t){throw new Error("SymMathAdd Method not implemented.")}isKind(t){return!!ue(t)&&Re.equalsSym(t)}isMinusOne(t){throw new Error("SymMathAdd Method not implemented.")}isOne(t){throw new Error("SymMathAdd Method not implemented.")}isReal(t){throw new Error("SymMathAdd Method not implemented.")}isScalar(t){throw new Error("SymMathAdd Method not implemented.")}isZero(t){throw new Error("SymMathAdd Method not implemented.")}subst(t,e,r){return t.equals(e)?r:t}toInfixString(){return"+"}toLatexString(){return"+"}toListString(){return this.$.getSymbolPrintName(Re)}evaluate(t,e){return this.transform(a(t,e))}transform(t){return ue(t)&&Re.equalsSym(t)?[T,t]:[S,t]}valueOf(t){return t}}const vI=new class{create(t){return new yI(t)}};class bI{constructor(t){this.$=t}get key(){return TL.name}get hash(){return li}get name(){return"SymMathMul"}evaluate(t,e){return this.transform(a(t,e))}transform(t){return[this.isKind(t)?T:S,t]}isImag(t){throw new Error("SymMathMul Method not implemented.")}isKind(t){return ue(t)&&Pe.equals(t)}isMinusOne(t){throw new Error("SymMathMul Method not implemented.")}isOne(t){throw new Error("SymMathMul Method not implemented.")}isReal(t){throw new Error("SymMathMul Method not implemented.")}isScalar(t){throw new Error("SymMathMul Method not implemented.")}isZero(t){throw new Error("SymMathMul Method not implemented.")}subst(t,e,r){return t.equals(e)?r:t}toInfixString(t){return"*"}toLatexString(t){return"*"}toListString(t){return this.$.getSymbolPrintName(Pe)}valueOf(t){return Li(this.transform(t)[1])}}const OI=new class{create(t){return new bI(t)}};class EI{constructor(t){this.$=t}get key(){return TL.name}get hash(){return li}get name(){return"SymMathPi"}evaluate(t,e){return this.transform(a(t,e))}transform(t){return[this.isKind(t)?T:S,t]}isImag(){return!1}isKind(t){return lh(t)}isMinusOne(){return!1}isOne(){return!1}isReal(){return!0}isScalar(){return!0}isZero(){return!1}subst(t,e,r){return t.equals(e)?r:t}toInfixString(t){return this.$.getSymbolPrintName(Ge)}toLatexString(t){return"\\pi"}toListString(t){return this.$.getSymbolPrintName(Ge)}valueOf(t){return Li(this.transform(t)[1])}}const SI=new class{create(t){return new EI(t)}},qI=z(P.pow);class TI{constructor(t){this.$=t}get key(){return TL.name}get hash(){return li}get name(){return"SymMathPow"}evaluate(t,e){return this.transform(a(t,e))}transform(t){return[this.isKind(t)?T:S,t]}isImag(t){throw new Error("SymMathPow Method not implemented.")}isKind(t){return ue(t)&&qI.equals(t)}isMinusOne(t){throw new Error("SymMathPow Method not implemented.")}isOne(t){throw new Error("SymMathPow Method not implemented.")}isReal(t){throw new Error("SymMathPow Method not implemented.")}isScalar(t){throw new Error("SymMathPow Method not implemented.")}isZero(t){throw new Error("SymMathPow Method not implemented.")}subst(t,e,r){return t.equals(e)?r:t}toInfixString(t){return this.$.getNativeDirective(N.useCaretForExponentiation)?"^":"**"}toLatexString(t){return" ^ "}toListString(t){return this.$.getSymbolPrintName(qI)}valueOf(t){return Li(this.transform(t)[1])}}const MI=new class{create(t){return new TI(t)}};function AI(t,e){return NI(e.valueOf(eh(t)),e)}function NI(t,e){if(p(t).equals(xr))return eh(t);if(it(t)){let e=Math.tan(t.d);return Math.abs(e)<1e-10&&(e=0),W(e)}if($d(t))return e.negate(NI(e.negate(t),e));const r=Sf(kp(e.multiply(t,Ut(180)),lr.Pi(e),e));if(r<0||isNaN(r))return Rd(Yn,t);switch(r%360){case 0:case 180:return Yt;case 30:case 210:return e.multiply(ee,e.power(Kt,te));case 150:case 330:return e.multiply(Pf(-1,3),e.power(Kt,te));case 45:case 225:return Dt;case 135:case 315:return Jt;case 60:case 240:return e.power(Kt,te);case 120:case 300:return e.negate(e.power(Kt,te));default:return Rd(Yn,t)}}let $I=class extends Bw{constructor(t){super("tan",Yn,t),this.hash=vi(this.opr)}transform(t){const e=this.$;if(e.isExpanding()){const r=AI(t,e);return[!r.equals(t)?q:T,r]}return[S,t]}};const LI=new class{create(t){return new $I(t)}};function kI(t,e){return function(t,e){if(p(t).equals(yr))return eh(t);if(it(t)){let e=Math.tanh(t.d);return Math.abs(e)<1e-10&&(e=0),W(e)}if(e.is_zero(t))return Yt;return u(ts,t)}(e.valueOf(eh(t)),e)}let RI=class extends Bw{constructor(t){super("tanh",ts,t),this.hash=vi(this.opr)}transform(t){const e=kI(t,this.$);return[!e.equals(t)?q:T,e]}};const II=new class{create(t){return new RI(t)}},PI=z(P.PI),FI=z(P.tau);let UI=class extends Kw{constructor(t){super("tau_any",FI,Vw,t)}transform1(t,e,r){const n=this.$.multiply(Bt,PI),s=this.$.multiply(n,e);return[q,s]}};const CI=new class{create(t){return new UI(t)}};function DI(t,e){t=d(t);const r=e.valueOf(p(t));t=d(t);let n=e.valueOf(p(t));const s=c===n?Xh(nr.stack[nr.tos-1]):n;t=d(t),n=e.valueOf(p(t));const i=c===n?Ut(24):n;t=d(t),n=e.valueOf(p(t));return function(t,e,r,n,s){const i=Sf(r);if(isNaN(i))return Rd(es,t,e,r,n);const o=s.subtract(e,n);let a=t,u=Dt,c=s.valueOf(Cp(a,e,n,s));for(let t=1;t<=i&&(a=gy(a,e,s),!s.is_zero(a));t++){u=s.multiply(u,o);const r=s.valueOf(Cp(a,e,n,s)),i=kp(s.multiply(r,u),cm(Ut(t)),s);c=s.add(c,i)}return c}(r,s,i,c===n?Yt:n,e)}let BI=class extends Bw{constructor(t){super("taylor",es,t),this.hash=vi(this.opr)}transform(t){const e=DI(t,this.$);return[!e.equals(t)?q:T,e]}};const KI=new class{create(t){return new BI(t)}},zI=z(P.test_eq);let QI=class extends E_{constructor(t){super("testeq_sym_rat",zI,ue,re,t),this.hash=mi(zI,li,ui)}transform2(t,e,r,n){return[q,V]}};const ZI=new class{create(t){return new QI(t)}};let GI=class extends E_{constructor(t){super("testgt_mul_2_any_any_rat",We,O_(f,Up),re,t),this.hash=wi(We,Pe,ui)}transform2(t,e,r,n){if(r.isNegative())return[q,V];if(r.isZero()){const t=this.$,r=e.lhs,n=e.rhs,s=t.valueOf(u(je,r,Yt)),i=t.valueOf(u(je,n,Yt)),o=t.valueOf(u(We,r,Yt)),a=t.valueOf(u(We,n,Yt));if(j(s)&&j(o)&&j(i)&&j(a)){const t=o.isTrue()&&a.isTrue()||s.isTrue()&&i.isTrue();return[q,t?H:V]}return[q,V]}return[q,V]}};const HI=new class{create(t){return new GI(t)}};let VI=class extends E_{constructor(t){super("testgt_rat_rat",We,re,re,t),this.hash=mi(We,ui,ui)}transform2(t,e,r){return[q,e.compare(r)>0?H:V]}};const jI=new class{create(t){return new VI(t)}};let WI=class extends E_{constructor(t){super("testgt_sym_rat",We,ue,re,t),this.hash=mi(We,li,ui)}transform2(t,e,r,n){return r.isNegative()||r.isZero()?[q,H]:[q,V]}};const JI=new class{create(t){return new WI(t)}};let XI=class extends E_{constructor(t){super("testlt_flt_rat",je,kh,re,t),this.hash=mi(je,ii,ui)}transform2(t,e,r){return[q,Ph(e,r)<0?H:V]}};const YI=new class{create(t){return new XI(t)}};let tP=class extends E_{constructor(t){super("testlt_mul_2_any_any_rat",je,O_(f,Up),re,t),this.hash=wi(je,Pe,ui)}transform2(t,e,r,n){if(r.isNegative())return[q,V];if(r.isZero()){const t=this.$,r=e.lhs,n=e.rhs,s=t.valueOf(u(je,r,Yt)),i=t.valueOf(u(je,n,Yt)),o=t.valueOf(u(We,r,Yt)),a=t.valueOf(u(We,n,Yt));if(j(s)&&j(o)&&j(i)&&j(a)){const t=s.isTrue()&&a.isTrue()||o.isTrue()&&i.isTrue();return[q,t?H:V]}return[q,V]}return[q,V]}};const eP=new class{create(t){return new tP(t)}};let rP=class extends E_{constructor(t){super("testlt_rat_rat",je,re,re,t),this.hash=mi(je,ui,ui)}transform2(t,e,r){return[q,e.compare(r)<0?H:V]}};const nP=new class{create(t){return new rP(t)}};let sP=class extends E_{constructor(t){super("testlt_sym_rat",je,ue,re,t),this.hash=mi(je,li,ui)}transform2(t,e,r,n){return r.isNegative()||r.isZero(),[q,V]}};const iP=new class{create(t){return new sP(t)}};let oP=class extends Bw{constructor(t){super("transpose",as,t),this.hash=vi(this.opr)}transform(t){const e=function(t,e){const r=e.valueOf(eh(t));let n=Dt,s=Bt;return c!==rh(t)&&(n=e.valueOf(sh(t)),s=e.valueOf(uh(t))),Cm(r,n,s,e)}(t,this.$);return[!e.equals(t)?q:T,e]}};const aP=new class{create(t){return new oP(t)}};function uP(t){return function(e){return Cf(e,t)&&function(t){return 2===t.length}(e)}}const cP=O_(f,uP(km)),lP=O_(f,uP(km)),fP=O_(f,ox(Pe,cP,lP)),hP=re,pP=O_(f,uP(Im)),dP=O_(f,ox(Pe,hP,pP)),mP=O_(f,uP(Im)),gP=O_(f,ox(Pe,dP,mP));function wP(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.lhs,i=e.lhs.rhs.arg,o=e.rhs.arg;return s.isMinusOne()&&r.equals(i)&&n.equals(o)}let _P=class extends S_{constructor(t){super("add_2_mul_2_cos_cos_mul_2_mul_2_rat_sin_sin",Re,fP,gP,wP,t),this.phases=L,this.hash=_i(Re,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=n.lhs.rhs.arg,a=s.valueOf(u(Re,i,o)),c=s.valueOf(u(km,a));return[q,c]}};const xP=new class{create(t){return new _P(t)}};const yP=O_(f,ox(Pe,O_(f,uP(km)),O_(f,uP(km)))),vP=O_(f,ox(Pe,O_(f,uP(Im)),O_(f,uP(Im))));function bP(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.arg,i=e.rhs.arg;return r.equals(s)&&n.equals(i)}let OP=class extends S_{constructor(t){super("add_2_mul_2_sin_cos_mul_2_cos_sin",Re,yP,vP,bP,t),this.phases=L,this.hash=_i(Re,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=n.lhs.rhs.arg,a=s.valueOf(u(Re,i,s.negate(o))),c=s.valueOf(u(km,a));return[q,c]}};const EP=new class{create(t){return new OP(t)}};const SP=O_(f,ox(Pe,O_(f,uP(km)),O_(f,uP(Im)))),qP=O_(f,ox(Pe,O_(f,uP(km)),O_(f,uP(Im))));function TP(t,e){const r=t.rhs.arg,n=t.lhs.arg,s=e.lhs.arg,i=e.rhs.arg;return r.equals(s)&&n.equals(i)}let MP=class extends S_{constructor(t){super("add_2_mul_2_cos_sin_mul_2_cos_sin_factoring",Re,SP,qP,TP,t),this.phases=L,this.hash=_i(Re,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=n.lhs.rhs.arg,a=s.valueOf(u(Re,i,o)),c=s.valueOf(u(Im,a));return[q,c]}};const AP=new class{create(t){return new MP(t)}};function NP(t){return function(t){const e=t.opr;return!!ue(e)&&Ce.equalsSym(e)}(t)&&Pp(t)}function $P(t){if(Lm(t)){return op(t.rhs)}return!1}function LP(t){let e=t;const r=[];for(;f(e);){if(!Up(e)){if($P(e)){const t=e.lhs,n=e.rhs;r.push(u(Ue,t,n.pred())),e=t}break}r.push(e.rhs),e=e.lhs}for(;r.length>1;){const t=r.pop(),e=r.pop(),n=u(Pe,t,e);r.push(n)}return r.length>0?[e,r[0],!0]:[e,Dt,!1]}function kP(t,e){if(Q(t.rhs)&&Q(e.rhs))switch(wh(t.rhs,e.rhs)){case E:return E;case b:return b;default:return QP(t.lhs,e.lhs)}const[r,n,s]=LP(t),[i,o,a]=LP(e);if(!s&&!a)return O;switch(QP(r,i)){case E:return E;case b:return b;default:return QP(n,o)}}function RP(t,e){if(ue(t)){if(ue(e))return Fh(t,e);throw h(e),new Error}throw h(t)?(ue(e)||h(e),new Error):new Error}const IP=0,PP=1,FP=2,UP=3,CP=4,DP=5,BP=6,KP=7,zP=8;function QP(t,e){if(t.equals(e))return O;if(f(t)){if(Up(t)){if(f(e))return Up(e)?kP(t,e):(Nb(e),RP(t.car,e.car));if(re(e))return E;if(ue(e))return O;throw new Error(`lhs: Multiply = ${t}, rhs = ${e}`)}if(Lm(t)){if(f(e))return Up(e)||Lm(e)?kP(t,e):Nb(e)?E:O;if(ue(e))return E;throw new Error(`lhs: Power = ${t}, rhs = ${e}`)}if(Nb(t)){if(f(e)){if(Up(e))return b;if(NP(e))return b;if(Nb(e))return O;if(Lm(e))return b;throw it(e)?new Error(`lhs: Inner = ${t}, rhs: Flt = ${e}`):new Error(`lhs: Inner = ${t}, rhs: Cons = ${e}`)}return O}if(NP(t)){if(f(e)){if(Nb(e))return E;throw new Error(`lhs: Outer = ${t}, rhs: Cons = ${e}`)}if(re(e))return E;throw new Error(`lhs: Outer = ${t}, rhs = ${e}`)}if(f(e))return QP(t.opr,e.opr);if(ue(e))return E;throw new Error(`lhs: Cons = ${t}, rhs = ${e}`)}if(re(t)){if(f(e)){if(NP(e))return b;if(Up(e))return b}if(re(e))return t.compare(e);if(ue(e))return b;throw new Error(`lhs: Rat = ${t}, rhs = ${e}`)}if(it(t)){if(f(e))return b;if(it(e))return t.compare(e);throw new Error(`lhs: Flt = ${t}, rhs = ${e}`)}if(ue(t)){if(re(e))return E;if(ue(e))return Fh(t,e);if(lt(e))return b;if(Q(e))return b;if(f(e)){if(Up(e))return function(t){const[e,r]=LP(t);pt(e)}(e),b;if(Lm(e)){if(pt(e))return b;throw new Error(`lhs: Sym = ${t}, rhs: Power = ${e}`)}return b}throw new Error(`lhs: Sym = ${t}, rhs = ${e}`)}if(lt(t)){if(ue(e))return E;throw new Error(`lhs: Hyp = ${t}, rhs = ${e} group(rhs)=${function(t){if(re(t))return PP;if(it(t))return PP;if(ue(t))return FP;if(f(t))return DP;if(lt(t))return CP;if(pt(t))return BP;if(Q(t))return KP;if(y(t))return UP;if(Le(t))return zP;if(h(t))return IP;throw new Error(`group() of ${t}`)}(e)}`)}throw new Error(`lhs = ${t}, rhs = ${e}`)}const ZP=O_(f,ox(Pe,O_(f,uP(km)),O_(f,uP(Im)))),GP=O_(f,ox(Pe,O_(f,uP(km)),O_(f,uP(Im))));function HP(t,e){const r=t.rhs.arg,n=t.lhs.arg,s=e.lhs.arg,i=e.rhs.arg;return r.equals(s)&&n.equals(i)&&QP(n,r)>0}let VP=class extends S_{constructor(t){super("add_2_mul_2_cos_sin_mul_2_cos_sin_ordering",Re,ZP,GP,HP,t),this.phases=I,this.hash=_i(Re,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=u(t,n.rhs,n.lhs),o=s.valueOf(i);return[q,o]}};const jP=new class{create(t){return new VP(t)}};const WP=O_(f,uP(km)),JP=O_(f,uP(Im)),XP=O_(f,ox(Pe,WP,JP)),YP=re,tF=O_(f,uP(km)),eF=O_(f,ox(Pe,YP,tF)),rF=O_(f,uP(Im)),nF=O_(f,ox(Pe,eF,rF));function sF(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.lhs,i=e.lhs.rhs.arg,o=e.rhs.arg;return s.isMinusOne()&&n.equals(i)&&r.equals(o)}let iF=class extends S_{constructor(t){super("add_2_mul_2_cos_sin_mul_2_mul_2_rat_cos_sin_factoring",Re,XP,nF,sF,t),this.phases=L,this.hash=_i(Re,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=n.lhs.rhs.arg,o=n.lhs.lhs.arg,a=s.valueOf(u(Re,i,s.negate(o))),c=s.valueOf(u(Im,a));return[q,c]}};const oF=new class{create(t){return new iF(t)}};const aF=O_(f,uP(km)),uF=O_(f,uP(Im)),cF=O_(f,ox(Pe,aF,uF)),lF=re,fF=O_(f,uP(km)),hF=O_(f,ox(Pe,lF,fF)),pF=O_(f,uP(Im)),dF=O_(f,ox(Pe,hF,pF));function mF(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.lhs,i=e.lhs.rhs.arg,o=e.rhs.arg;return s.isMinusOne()&&n.equals(i)&&r.equals(o)&&QP(r,n)>0}let gF=class extends S_{constructor(t){super("add_2_mul_2_cos_sin_mul_2_mul_2_rat_cos_sin_ordering",Re,cF,dF,mF,t),this.phases=I,this.hash=_i(Re,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=u(t,n.rhs,n.lhs),o=s.valueOf(i);return[q,o]}};const wF=new class{create(t){return new gF(t)}};const _F=O_(f,uP(km)),xF=O_(f,uP(Im)),yF=O_(f,ox(Pe,_F,xF)),vF=re,bF=O_(f,uP(Im)),OF=O_(f,ox(Pe,vF,bF)),EF=O_(f,uP(km)),SF=O_(f,ox(Pe,OF,EF));function qF(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.lhs,i=e.lhs.rhs.arg,o=e.rhs.arg;return s.isMinusOne()&&r.equals(i)&&n.equals(o)}let TF=class extends S_{constructor(t){super("add_2_mul_2_cos_sin_mul_2_mul_2_rat_sin_cos",Re,yF,SF,qF,t),this.phases=L,this.hash=_i(Re,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=n.lhs.rhs.arg,a=s.valueOf(u(Re,o,s.negate(i))),c=s.valueOf(u(Im,a));return[q,c]}};const MF=new class{create(t){return new TF(t)}};const AF=re,NF=O_(f,uP(km)),$F=O_(f,ox(Pe,AF,NF)),LF=O_(f,uP(Im)),kF=O_(f,ox(Pe,$F,LF)),RF=O_(f,uP(km)),IF=O_(f,uP(Im)),PF=O_(f,ox(Pe,RF,IF));function FF(t,e){const r=t.lhs.lhs,n=t.lhs.rhs.arg,s=t.rhs.arg,i=e.rhs.arg,o=e.lhs.arg;return r.isMinusOne()&&n.equals(i)&&s.equals(o)}let UF=class extends S_{constructor(t){super("add_2_mul_2_rat_cos_sin_mul_2_mul_2_cos_sin_factoring",Re,kF,PF,FF,t),this.phases=L,this.hash=_i(Re,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=n.rhs.rhs.arg,o=n.rhs.lhs.arg,a=s.valueOf(u(Re,i,s.negate(o))),c=s.valueOf(u(Im,a));return[q,c]}};const CF=new class{create(t){return new UF(t)}};const DF=O_(f,ox(Pe,O_(f,uP(Im)),O_(f,uP(km)))),BF=O_(f,ox(Pe,O_(f,uP(km)),O_(f,uP(Im))));function KF(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.arg,i=e.rhs.arg;return r.equals(s)&&n.equals(i)}let zF=class extends S_{constructor(t){super("add_2_mul_2_sin_cos_mul_2_cos_sin",Re,DF,BF,KF,t),this.phases=L,this.hash=_i(Re,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=n.lhs.rhs.arg,a=s.valueOf(u(Re,i,o)),c=s.valueOf(u(Im,a));return[q,c]}};const QF=new class{create(t){return new zF(t)}};const ZF=O_(f,uP(Im)),GF=O_(f,uP(km)),HF=O_(f,ox(Pe,ZF,GF)),VF=re,jF=O_(f,uP(km)),WF=O_(f,ox(Pe,VF,jF)),JF=O_(f,uP(Im)),XF=O_(f,ox(Pe,WF,JF));function YF(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs.lhs,i=e.lhs.rhs.arg,o=e.rhs.arg;return s.isMinusOne()&&r.equals(i)&&n.equals(o)}let tU=class extends S_{constructor(t){super("add_2_mul_2_sin_cos_mul_2_mul_2_rat_cos_sin",Re,HF,XF,YF,t),this.phases=L,this.hash=_i(Re,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=s.negate(n.lhs.rhs.arg),a=s.valueOf(u(Re,i,o)),c=s.valueOf(u(Im,a));return[q,c]}};const eU=new class{create(t){return new tU(t)}};const rU=O_(f,uP(Im)),nU=O_(f,uP(km)),sU=O_(f,ox(Pe,rU,nU)),iU=O_(f,uP(km)),oU=O_(f,uP(Im)),aU=O_(f,ox(Pe,iU,oU)),uU=O_(f,ox(Pe,re,aU));function cU(t,e){const r=t.lhs.arg,n=t.rhs.arg,s=e.lhs,i=e.rhs.lhs.arg,o=e.rhs.rhs.arg;return s.isMinusOne()&&r.equals(i)&&n.equals(o)}let lU=class extends S_{constructor(t){super("add_2_mul_2_sin_cos_mul_2_rat_mul_2_cos_sin",Re,sU,uU,cU,t),this.phases=L,this.hash=_i(Re,Pe,Pe)}transform2(t,e,r,n){const s=this.$,i=n.lhs.lhs.arg,o=s.negate(n.lhs.rhs.arg),a=s.valueOf(u(Re,i,o)),c=s.valueOf(u(Im,a));return[q,c]}};const fU=new class{create(t){return new lU(t)}};const hU=O_(f,ox(Ue,O_(f,uP(km)),re)),pU=O_(f,ox(Ue,O_(f,uP(Im)),re));function dU(t,e){const r=t.lhs.arg,n=t.rhs,s=e.lhs.arg,i=e.rhs;return r.equals(s)&&n.isTwo()&&i.isTwo()}let mU=class extends S_{constructor(t){super("add_2_pow_2_cos_rat_pow_2_sin_rat",Re,hU,pU,dU,t),this.phases=L,this.hash=_i(Re,Ue,Ue)}transform2(t,e,r,n){return[q,Dt]}};const gU=new class{create(t){return new mU(t)}};let wU=class extends E_{constructor(t,e,r,n,s){super(t,e,O_(f,uP(r)),O_(f,uP(n)),s),this.hash=_i(e,r,n)}transform2(t,e,r,n){const s=this.$;return[q,s.valueOf(Rd(t,n.rhs,n.lhs))]}};const _U=new class{constructor(t,e,r,n){this.name=t,this.opr=e,this.lhs=r,this.rhs=n}create(t){return new wU(this.name,this.opr,this.lhs,this.rhs,t)}}("mul_2_sin_cos",Pe,Im,km);let xU=class extends Kw{constructor(t){super("typeof_any",D("typeof"),Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){return[S,r]}};const yU=new class{create(t){return new xU(t)}},vU=D("Blade");let bU=class extends Kw{constructor(t){super("typeof_blade",D("typeof"),mg,t),this.dependencies=["Blade"],this.hash=xi(this.opr,ri)}transform1(t,e,r){return[q,vU]}};const OU=new class{create(t){return new bU(t)}},EU=D("Tensor");class SU extends Kw{constructor(t){super("typeof_tensor",D("typeof"),y,t),this.dependencies=[],this.hash=xi(this.opr,fi)}transform1(t,e,r){return[q,EU]}}const qU=new class{create(t){return new SU(t)}};let TU=class extends Kw{constructor(t){super("unit",us,Vw,t),this.hash=xi(this.opr,pi)}transform1(t,e,r){return function(t,e,r){const n=xy(eh(e),r);if(isNaN(n))return[S,e];if(n<1)return[S,e];const s=[n,n],i=Np(n,Dt,Yt),o=new x(s,i);return[q,o]}(0,r,this.$)}};const MU=new class{create(t){return new TU(t)}};class AU extends Kw{constructor(t){super("uom_1_str",D("uom"),Ah,t),this.hash=xi(D("uom"),ci)}transform1(t,e){return[q,ke(e.str)]}}const NU=new class{create(t){return new AU(t)}};function $U(t,e){return function(t,e){const r=Array(Ks).fill(0);let n=1,s=0;for(const i of t.tail()){const t=xy(i,e);if(t<1||isNaN(t))return Yt;n*=t,r[s++]=t}if(0===s)return Yt;const i=new Array(s);for(let t=0;t<s;t++)i[t]=r[t];const o=Ap(n,Yt);return new x(i,o)}(t,e)}let LU=class extends Bw{constructor(t){super("zero",cs,t),this.hash=vi(this.opr)}transform(t){const e=$U(t,this.$);return[!e.equals(t)?q:T,e]}};const kU=new class{create(t){return new LU(t)}};function RU(t,e){let r=0;if(!zf(t))return 0;if(e.equals(eh(t),ht))return lh(sh(t))?3!==Yh(t)?0:2:0;if(!ne(eh(t)))return 0;if(!e.equals(sh(t),ht))return 0;if(!lh(uh(t)))return 0;if(4!==Yh(t))return 0;let n=Sf(e.multiply(eh(t),Bt));if(isNaN(n))return 0;switch(n<1&&(r=1,n=-n),n%4){case 0:n=1;break;case 1:n=r?4:3;break;case 2:n=2;break;case 3:n=r?3:4}return n}function IU(t,e,r){const n=Yh(e)-1,s=[];let i=d(e);for(let e=0;e<n;e++){for(let n=0;n<=t;n++)s[e*(t+1)+n]=r.power(p(i),Ut(n));i=d(i)}const o=[];for(let t=0;t<n;t++)o[t]=0;return PU(n,t,o,0,t,s,cm(Ut(t)),Yt,r)}function PU(t,e,r,n,s,i,o,a,u){if(n<t-1){for(let c=0;c<=s;c++)r[n]=c,a=PU(t,e,r,n+1,s-c,i,o,a,u);return a}r[n]=s;let c=o;for(let e=0;e<t;e++)c=kp(c,cm(Ut(r[e])),u);for(let n=0;n<t;n++)c=u.multiply(c,i[n*(e+1)+r[n]]);return u.add(a,c)}function FU(t,e,r){const n=kf(e),s=r.subtract(e,n);let i;r.is_zero(s)||(i=Rd($n,t,s));const o=Sf(n);if(isNaN(o)){const e=Rd($n,t,n);return i?[i,e]:[e]}if(0===o)return[i];const a=function(t,e){let r=bf(t.a,Math.abs(e)),n=bf(t.b,Math.abs(e));if(e<0){const t=r;r=n,n=t,r=$f(r,n),n=Lf(n,1)}return new kt(r,n)}(t,o);return i?[i,a]:[a]}function UU(t,e,r){const n=function(t,e){return t};if(t.isOne()||e.isZero())return n(Dt);if(t.isMinusOne()&&e.isHalf())return n(ht);if(r.is_zero(t)){if(tp(e))throw new Error(`divide by zero for base => ${t} and exponent => ${e}`);return n(Yt)}if(e.isOne())return n(t);let s,i,o=0;if(Ef(e)){if(o=Sf(e),isNaN(o))return n(Rd($n,t,e));if(s=bf(t.a,Math.abs(o)),i=bf(t.b,Math.abs(o)),o<0){const t=s;s=i,i=t,s=$f(s,i),i=function(t){return t.isNegative()?t.multiply(gt(-1)):t}(i)}return n(new kt(s,i))}if(np(t))return n(function(t,e){if(Ef(t))return t.a.isOdd()?Jt:Dt;let r=kf(t);tp(t)&&(r=r.add(Jt));const n=e.subtract(t,r);let s=Rd($n,Jt,n);r.a.isOdd()&&(s=e.negate(s));return s}(e,r));if(tp(t))return n(r.multiply(UU(r.negate(t),e,r),UU(Jt,e,r)));if(!Ef(t)){const s=t.numer(),i=t.denom(),o=e,a=UU(s,o,r),u=UU(i,o.neg(),r);return n(r.multiply(a,u))}if(Of(t.a))return n(function(t,e,r){const n=Mm(Sf(t)),s=n,i=s.length;for(let t=0;t<i;t+=2)s.push(...FU(n[t],r.multiply(s[t+1],e),r));return Qd(s.slice(i),r)}(t,e,r));if(!Of(e.a)||!Of(e.b))return n(Rd($n,t,e));const{a:a,b:u}=e;return s=function(t,e){t=t.abs(),0===e&&sr("root index is zero");let r=0;for(;t.shiftRight(r).toJSNumber()>0;)r++;if(0===r)return Nf(0);r=Math.floor((r-1)/e);const n=Math.floor(r/32+1);let s=gt(n);for(let t=0;t<n;t++)s=s.and(gt(1).shiftLeft(t).not());for(;r>=0;){switch(s=s.or(gt(1).shiftLeft(r)),vm(bf(s,e),t)){case 0:return s;case 1:s=s.and(gt(1).shiftLeft(r).not())}r--}return 0}(t.a,u.toJSNumber()),0===s?n(Rd($n,t,e)):(i=bf(s,a),n(e.a.isNegative()?new kt(gt.one,i):new kt(i,gt.one)))}function CU(t,e,r){if(void 0===t)throw new Error("base must be defined.");if(void 0===e)throw new Error("expo must be defined.");const n=function(t,e){return t};if(r.equals(t,Dt)||r.is_zero(e)){return n(r.getNativeDirective(N.evaluatingAsFloat)?Y:Dt)}if(r.equals(e,Dt))return n(t);if(np(t)&&np(e)){return n(r.negate(r.getNativeDirective(N.evaluatingAsFloat)?Y:Dt))}if(np(t)&&vp(e))return r.getNativeDirective(N.evaluatingAsClock)?u($n,t,e):n(ht);if(np(t)&&bp(e)){if(r.getNativeDirective(N.evaluatingAsClock))return u($n,t,e);return n(r.negate(ht))}if(np(t)&&!it(t)&&re(e)&&!Ef(e)&&ep(e)&&!r.getNativeDirective(N.evaluatingAsFloat)){if(e.numer().compare(e.denom())<0)return n(u($n,t,e));{const s=u(bn,t,u($n,t,Pf(e.a.mod(e.b),e.b)));return n(r.valueOf(s))}}if(re(t)&&re(e)){return n(UU(t,e,r))}if(ne(t)&&ne(e)){const s=function(t,e,r){if(0===t&&e<0)throw new Error("divide by zero");if(t>=0||e%1==0)return W(Math.pow(t,e));const n=Math.pow(Math.abs(t),e),s=Math.PI*e;let i=0,o=0;return e%.5==0?(i=0,o=Math.sin(s)):(i=Math.cos(s),o=Math.sin(s)),r.add(W(i*n),r.multiply(W(o*n),ht))}(Ff(t),Ff(e),r);return n(s)}if(y(t)){const s=function(t,e,r){const n=t.ndim-1;if(t.dim(0)!==t.dim(n))return Rd($n,t,e);let s=Sf(e);if(isNaN(s))return Rd($n,t,e);if(0===s){if(2!==t.ndim)throw new Error("power(tensor,0) with tensor rank not equal to 2");s=t.dim(0);const e=[s,s],r=Np(s,Dt,Yt);return new x(e,r)}let i=t;s<0&&(s=-s,i=ey(i,r));let o=i;for(let t=1;t<s&&(o=r.inner(o,i),!r.is_zero(o));t++);return o}(t,e,r);return n(s)}if(X_(t)){if(re(e)){const r=xe.valueOf(e.a.toJSNumber(),e.b.toJSNumber());return n(t.pow(r))}if(it(e)){const r=xe.valueOf(e.d,1);return n(t.pow(r))}}if(f(t)&&Bf(t)&&wp(e)&&!r.is_zero(r.getSymbolValue(_s))){return n(r.power(eh(t),e))}if(Yf(t)&&p(e).equals(vn)){return n(eh(e))}if(Yf(t)&&it(e)){return n(W(Math.exp(e.d)))}if(Yf(t)&&e.contains(ht)&&e.contains(qs)&&!r.getNativeDirective(N.evaluatingAsPolar)){const s=Um(u($n,t,e),r);if(!s.contains(qs))return n(s)}if(r.isExpanding()&&zf(t)&&Ef(e)){const s=t.cdr;if(f(s)){const t=s.car;let i=r.power(t,e);if(f(s)){i=s.tail().reduce(((t,n)=>r.multiply(t,r.power(n,e))),i)}return n(i)}if(h(s))return n(Dt)}let s=!1;const i=eh(t);if(ne(i)&&(s=Ph(i,Yt)===E),Qf(t)&&(Ef(e)||s)){return n(r.power(eh(t),r.multiply(sh(t),e)))}let o=!1;if(wp(sh(t))){sp(r.multiply(sh(t),e),r)&&(o=!0)}if(Qf(t)&&o){if(r.isFactoring()){return n(Hm(eh(t),r))}return n(u($n,t,e))}if(r.isExpanding()&&Kf(t)&&ne(e)){const s=function(t){const e=Yh(t)-1,r=[];let n=d(t);for(let t=0;t<e;t++)r.push(p(n)),n=d(n);return r}(t).every((function(t){return r.is_real(t)})),i=Sf(e);if(i>1&&!isNaN(i)&&s){return n(IU(i,t,r))}}if(1===nr.trigmode&&p(t).equals(Hn)&&wp(e)){return n(r.power(r.subtract(Dt,r.power(Rm(eh(t),r),Bt)),r.multiply(e,te)))}if(2===nr.trigmode&&p(t).equals(Ir)&&wp(e)){return n(r.power(r.subtract(Dt,r.power(Pm(eh(t),r),Bt)),r.multiply(e,te)))}if(gp(t)){if(Ef(e)){const s=zp(t,r);let i=kp(s,r.multiply(s,t),r);return sp(e,r)||(i=r.power(i,r.negate(e))),n(i)}if(ne(e)){const s=r.getNativeDirective(N.evaluatingAsFloat)||function(t,e){return Kf(t)&&3===Yh(t)&&it(eh(t))&&dp(sh(t),e)||dp(t,e)}(t,r)&&it(e)?W(Math.PI):qs;let i=r.multiply(r.power(Hm(t,r),e),r.power(Jt,r.divide(r.multiply(r.arg(t),e),s)));return i.contains(xr)&&(i=u($n,t,e)),n(i)}}const a=function(t,e){let r=RU(t,e);switch(r){case 0:break;case 1:return Dt;case 2:return Jt;case 3:return ht;case 4:return e.negate(ht)}if(Kf(t)){let n,s=d(t);for(;f(s)&&(r=RU(p(s),e),!r);)s=d(s);switch(r){case 0:return;case 1:n=Dt;break;case 2:n=Jt;break;case 3:n=ht;break;case 4:n=e.negate(ht)}return e.multiply(n,Ad(e.subtract(t,p(s)),e))}}(e,r);return n(void 0!==a?a:u($n,t,e))}function DU(t,e){const r=t.argList,n=r.car,s=r.cdr.car,i=e.valueOf(n),o=e.valueOf(s);return i.equals(n)&&o.equals(s)?CU(i,o,e):e.valueOf(u(Ue,i,o))}function BU(t){const e=z(P.add),r=z(P.test_eq);t.setSymbolOrder(e,new zh),t.setSymbolOrder(Pe,new Gh),t.defineOperator(uE(Pe,e)),t.defineOperator(cE(Pe,e)),t.defineOperator(uE(De,e)),t.defineOperator(cE(De,e)),t.defineOperator(k_),t.defineOperator(j_),t.defineOperator(J_),t.defineOperator(rx),t.defineOperator(H_),t.defineOperator(xx),t.defineOperator(Tx),t.defineOperator(vx),t.defineOperator(Ox),t.defineOperator(Sx),t.defineOperator(Fx),t.defineOperator(Cx),t.defineOperator(Bx),t.defineOperator(Ax),t.defineOperator(Qx),t.defineOperator(Z_),t.defineOperator(M_),t.defineOperator(hx),t.defineOperator(mx),t.defineOperator(ux),t.defineOperator(QF),t.defineOperator(jP),t.defineOperator(AP),t.defineOperator(eU),t.defineOperator(fU),t.defineOperator(xP),t.defineOperator(EP),t.defineOperator(MF),t.defineOperator(wF),t.defineOperator(oF),t.defineOperator(CF),t.defineOperator(gU),t.defineOperator(wx),t.defineOperator($x),t.defineOperator(K_),t.defineOperator(sx),t.defineOperator(U_),t.defineOperator(I_),t.defineOperator(Wx),t.defineAssociative(e,Yt),t.defineAssociative(Pe,Dt),t.defineOperator(yL),t.defineOperator(pL),t.defineOperator(lL),t.defineOperator(iL),t.defineOperator(mL),t.defineLegacyTransformer(Ue,DU),t.defineOperator(jN),t.defineOperator(OA),t.defineOperator(SA),t.defineOperator(LA),t.defineOperator(DA),t.defineOperator(IA),t.defineOperator(KA),t.defineOperator(UA),t.defineOperator($A),t.defineOperator(VA),t.defineOperator(WA),t.defineOperator(CN),t.defineOperator(BN),t.defineOperator(zN),t.defineOperator(ZN),t.defineOperator(HN),t.defineOperator(FN),t.defineOperator(ON),t.defineOperator(SR),t.defineOperator(SN),t.defineOperator(YA),t.defineOperator(cN),t.defineOperator(hN),t.defineOperator(RS("HCOLA Flt * Uom",wi(Pe,Pe,ii),Pe,kh,X_)),t.defineOperator(RS("HCOLA Rat * Uom",wi(Pe,Pe,ui),Pe,kh,X_)),t.defineOperator(RS("HCOLA Sym * Blade",wi(Pe,Pe,li),Pe,ue,Q)),t.defineOperator(RS("HCOLA Sym * Uom",wi(Pe,Pe,li),Pe,ue,X_)),t.defineOperator(RS("HCOLA Blade * Uom",wi(Pe,Pe,ri),Pe,Q,X_)),t.defineOperator(IN),t.defineOperator(b$),t.defineOperator(XN),t.defineOperator(QA),t.defineOperator(n$),t.defineOperator(e$),t.defineOperator(JN),t.defineOperator(i$),t.defineOperator(c$),t.defineOperator(a$),t.defineOperator(h$),t.defineOperator(wN),t.defineOperator(vN),t.defineOperator($N),t.defineOperator(oN),t.defineOperator(GA),t.defineOperator(g$),t.defineOperator(d$),t.defineOperator(_$),t.defineOperator(AA),t.defineOperator(TA),t.defineOperator(_U),t.defineOperator($$),t.defineLegacyTransformer(dr,dh),t.defineOperator(Dv),t.defineLegacyTransformer(Sr,Xv),t.defineOperator(eb),t.defineLegacyTransformer(Mr,Jh),t.defineKeyword(Ar,Wh),t.defineOperator(yb),t.defineOperator(Lb),t.defineOperator(Ub),t.defineOperator(Pb),t.defineOperator(Tb),t.defineOperator(Ab),t.defineOperator(Sb),t.defineOperator(Rb),t.defineOperator(Ob),t.defineOperator(DO),t.defineOperator(AS),t.defineOperator($S),t.defineOperator(PS),t.defineOperator(xT),t.defineOperator(OT),t.defineOperator(ST),t.defineOperator(vT),t.defineOperator(wT),t.defineOperator(mT),t.defineOperator(pT),t.defineOperator(AT),t.defineOperator(LT),t.defineOperator(fT),t.defineOperator(TT),t.defineOperator(cT),t.defineOperator(aT),t.defineOperator(iT),t.defineOperator(nT),t.defineOperator(eA),t.defineOperator(iA),t.defineOperator(cA),t.defineOperator(uE(Ke,e)),t.defineOperator(cE(Ke,e)),t.defineOperator(aA),t.defineOperator(dA),t.defineOperator(gA),t.defineOperator(vA),t.defineOperator(V$),t.defineOperator(eL),t.defineOperator(uE(Ce,e)),t.defineOperator(cE(Ce,e)),t.defineOperator(W$),t.defineOperator(X$),t.defineOperator(G$),t.defineOperator(z$),t.defineOperator(DL),t.defineOperator(VL),t.defineOperator(uE(ze,e)),t.defineOperator(cE(ze,e)),t.defineOperator(WL),t.defineOperator(GL),t.defineOperator(QL),t.defineOperator(Kv),t.defineOperator(Ni),t.defineOperator(Ih),t.defineOperator($h),t.defineOperator(Hw),t.defineOperator(n_),t.defineOperator(f_),t.defineOperator(i_),t.defineOperator(a_),t.defineOperator(p_),t.defineOperator(g_),t.defineOperator(y_),t.defineOperator(Xw),t.defineOperator(Oy),t.defineOperator(My),t.defineLegacyTransformer(pr,Gb),t.defineOperator($y),t.defineOperator(Ry),t.defineOperator(Fy),t.defineOperator(Cy),t.defineOperator(Ky),t.defineOperator(Zy),t.defineOperator(Wy),t.defineOperator(rv),t.defineOperator(ov),t.defineOperator(dv),t.defineOperator(_v),t.defineOperator(bv),t.defineOperator(Tv),t.defineOperator(Yy),t.defineOperator(kv),t.defineOperator($v),t.defineOperator(Iv),t.defineOperator(Fv),t.defineOperator(Gv),t.defineOperator(Vv),t.defineOperator(Qv),t.defineOperator(ub),t.defineOperator(lb),t.defineOperator(hb),t.defineOperator(db),t.defineOperator(gb),t.defineOperator(Xb),t.defineOperator(eO),t.defineOperator(fO),t.defineOperator(pO),t.defineOperator(uO),t.defineOperator(oO),t.defineOperator(mO),t.defineOperator(wO),t.defineOperator(bO),t.defineOperator(uE(_O,e)),t.defineOperator(cE(_O,e)),t.defineOperator(yO),t.defineOperator(UO),t.defineOperator(KO),t.defineOperator(JO),t.defineOperator(QO),t.defineOperator(GO),t.defineOperator(jO),t.defineOperator(YO),t.defineOperator(eE),t.defineOperator(nE),t.defineOperator(dE),t.defineOperator(gE),t.defineOperator($E),t.defineOperator(TE),t.defineOperator(AE),t.defineOperator(RE),t.defineOperator(PE),t.defineOperator(BE),t.defineOperator(JE),t.defineOperator(YE),t.defineOperator(eS),t.defineOperator(GE),t.defineOperator(lS),t.defineOperator(hS),t.defineOperator(dS),t.defineOperator(wS),t.defineOperator(xS),t.defineOperator(vS),t.defineOperator(ES),t.defineOperator(qS),t.defineOperator(CS),t.defineOperator(ZS),t.defineOperator(WS),t.defineOperator(tq),t.defineOperator(sq),t.defineOperator(aq),t.defineOperator(lq),t.defineOperator(dq),t.defineOperator(Bq),t.defineOperator(Zq),t.defineOperator(Vq),t.defineOperator(Eq),t.defineOperator(_q),t.defineOperator(Mq),t.defineOperator(Lq),t.defineOperator(Uq),t.defineOperator(HS),t.defineOperator(eT),t.defineOperator(RT),t.defineOperator(CT),t.defineOperator(PT),t.defineOperator(VT),t.defineOperator(JM),t.defineOperator(VM),t.defineOperator(I$),t.defineOperator(F$),t.defineOperator(C$),t.defineLegacyTransformer(En,Od),t.defineOperator(B$),t.defineOperator(EL),t.defineOperator(bL),t.defineLegacyTransformer(Nn,Nm),t.defineOperator(kL("print",(()=>nr.printMode))),t.defineOperator(kL("printascii",(()=>Ye))),t.defineOperator(kL("printhuman",(()=>er))),t.defineOperator(kL("printinfix",(()=>tr))),t.defineOperator(kL("printlatex",(()=>Xe))),t.defineOperator(kL("printsexpr",(()=>rr))),t.defineOperator(NL("print",(()=>nr.printMode))),t.defineOperator(NL("printascii",(()=>Ye))),t.defineOperator(NL("printhuman",(()=>er))),t.defineOperator(NL("printinfix",(()=>tr))),t.defineOperator(NL("printlatex",(()=>Xe))),t.defineOperator(NL("printsexpr",(()=>rr))),t.defineOperator(IL),t.defineLegacyTransformer(In,PL),t.defineOperator(UL),t.defineOperator(KL),t.defineOperator(tk),t.defineOperator(ok),t.defineOperator(lk),t.defineOperator(pk),t.defineOperator(wk),t.defineOperator(xk),t.defineOperator(Ok),t.defineOperator(Tk),t.defineOperator(Pk),t.defineOperator(Bk),t.defineOperator(zk),t.defineOperator(Gk),t.defineOperator(Vk),t.defineOperator(rk),t.defineOperator(ZT),t.defineOperator(KT),t.defineOperator(rM),t.defineOperator(oM),t.defineOperator(hM),t.defineOperator(dM),t.defineOperator(gM),t.defineOperator(_M),t.defineOperator(yM),t.defineOperator(EM),t.defineOperator(kM),t.defineOperator(FM),t.defineOperator(MM),t.defineOperator(XT),t.defineOperator(CM),t.defineOperator(BM),t.defineOperator(zM),t.defineOperator(new QM(Dn)),t.defineOperator(uM),t.defineOperator(Yk),t.defineOperator(nR),t.defineLegacyTransformer(Kn,Fm),t.defineOperator(iR),t.defineOperator(uR),t.defineOperator(lR),t.defineOperator(hR),t.defineOperator(mR),t.defineOperator(cy),t.defineOperator(xR),t.defineOperator(bR),t.defineOperator(BR),t.defineOperator(zR),t.defineOperator(ZR),t.defineOperator(CR),t.defineOperator(dI),t.defineOperator(hI),t.defineOperator(TR),t.defineOperator(FR),t.defineOperator(kR),t.defineOperator(IR),t.defineOperator($R),t.defineOperator(jR),t.defineOperator(HR),t.defineOperator(YR),t.defineOperator(sI),t.defineOperator(oI),t.defineOperator(uI),t.defineOperator(eI),t.defineOperator(lI),t.defineOperator(wI),t.defineOperator(KI),t.defineOperator(LI),t.defineOperator(II),t.defineOperator(CI),t.defineOperator(qU),t.defineOperator(OU),t.defineOperator(yU),t.defineOperator(ZI),t.defineLegacyTransformer(r,Bb),t.defineLegacyTransformer(is,Qb),t.defineOperator(YI),t.defineOperator(nP),t.defineOperator(iP),t.defineOperator(eP),t.defineLegacyTransformer(os,Zb),t.defineLegacyTransformer(ns,Kb),t.defineOperator(jI),t.defineOperator(JI),t.defineOperator(HI),t.defineLegacyTransformer(ss,zb),t.defineOperator(aP),t.defineOperator(vI),t.defineOperator(OI),t.defineOperator(MI),t.defineOperator(SI),t.defineOperator(xI),t.defineOperator(Ix),t.defineOperator(xh),t.defineOperator(tx),t.defineOperator(BS),t.defineOperator(CE),t.defineOperator(Wq),t.defineOperator(MU),t.defineOperator(NU),t.defineOperator(kU),t.defineOperator(k$),t.defineOperator(jb)}function KU(t,e,r){Mp(t)&&sr("floating point numbers in polynomial");const n=Dp(t,e,r);n.forEach((function(t){}));let s=function(t,e){let r=Dt;for(const n of t)r=rA(_m(n,e),r,e);for(let n=0;n<t.length;n++)t[n]=e.multiply(r,t[n]);const n=Lp(r,e);return n}(n,r);n.forEach((function(t){}));let i,o,a,u="real",c=null,l=n.length-1;for(;l>0;){let t=!1,f=!1;if(r.is_zero(n[0])?(i=Dt,o=Yt):"real"===u?[f,i,o]=zU(n,l,e,i,o,r):"complex"===u&&([t,i]=QU(c,n,l,r)),"real"===u){if(!1===f){u="complex";continue}{for(a=r.add(r.multiply(i,e),o),s=zd(s,a,r),ZU(i,o,n,l,r);l&&r.is_zero(n[l]);)l--;let t=Yt;for(let s=0;s<=l;s++)t=r.add(t,r.multiply(n[s],r.power(e,Ut(s))));c=t}}else if("complex"===u){if(!1===t)break;{const t=r.subtract(i,e),o=r.subtract(zp(i,r),e);a=r.multiply(t,o);const u=s;if(s=zd(s,a,r),null==c){let t=Yt;for(let s=0;s<=l;s++)t=r.add(t,r.multiply(n[s],r.power(e,Ut(s))));c=t}const f=c;c=sS(f,a,e,r);const h=r.multiply(c,a);if(!r.equals(h,f)){qf(u);const t=ar(Yd,f,r);return zd(Tf(),t,r)}for(let t=0;t<=l;t++)n.pop();n.push(...Dp(c,e,r)),l-=2}}}let f=Yt;for(let t=0;t<=l;t++)f=r.add(f,r.multiply(n[t],r.power(e,Ut(t))));const h=ar(Yd,f,r);return l>0&&$d(n[l])?zd(function(t,e){return ar((function(t,e){return e.negate(t)}),t,e)}(s,r),r.negate(h),r):zd(s,h,r)}function zU(t,e,r,n,s,i){const o=nr.tos,a=nr.tos;Mf(fE(t[e],i));const u=nr.tos-a,c=nr.tos;Mf(fE(t[0],i));const l=nr.tos-c;for(let r=0;r<u;r++)for(let u=0;u<l;u++){n=nr.stack[a+r],s=nr.stack[c+u];const l=i.negate(kp(s,n,i)),[f]=GU(l,t,e,i);if(i.is_zero(f))return ir(o),[!0,n,s];s=i.negate(s);const h=i.negate(l),[p]=GU(h,t,e,i);if(i.is_zero(p))return ir(o),[!0,n,s]}return ir(o),[!1,n,s]}function QU(t,e,r,n){let s,i,o;if(r<=2)return[!1,s];const a=nr.tos;if(s=Um(n.power(Jt,Pf(2,3)),n),i=s,qf(i),[o]=GU(i,e,r,n),n.is_zero(o))return ir(a),[!0,s];if(s=Um(n.power(Dt,Pf(2,3)),n),i=s,qf(i),[o]=GU(i,e,r,n),n.is_zero(o))return ir(a),[!0,s];for(let t=-10;t<=10;t++)for(let i=1;i<=5;i++){s=Um(n.add(Ut(t),n.multiply(Ut(i),ht)),n);const o=s;qf(o);const[u]=GU(o,e,r,n);if(n.is_zero(u))return ir(a),[!0,s]}return ir(a),[!1,s]}function ZU(t,e,r,n,s){let i=Yt;for(let o=n;o>0;o--){const n=kp(r[o],t,s);r[o]=i,i=n,r[o-1]=s.subtract(r[o-1],s.multiply(i,e))}r[0]=i}function GU(t,e,r,n){let s=Yt;for(let i=r;i>=0;i--)s=n.add(n.multiply(s,t),e[i]);return[s]}var HU,VU;class jU extends _{constructor(t,r,n,s){super("Lambda",n,s),HU.set(this,void 0),VU.set(this,void 0),e(this,VU,t,"f"),e(this,HU,r,"f")}get hash(){return t(this,HU,"f")}evaluate(e,r){return t(this,VU,"f").call(this,e,r)}equals(t){return this===t||t instanceof jU}toString(){return"(lambda ...)"}}HU=new WeakMap,VU=new WeakMap;const WU=Object.freeze({antihermitian:!1,algebraic:!0,commutative:!0,complex:!0,extended_negative:!1,extended_nonnegative:!0,extended_nonpositive:!1,extended_nonzero:!0,extended_positive:!0,extended_real:!0,finite:!0,hermitian:!0,imaginary:!1,infinite:!1,integer:!1,irrational:!1,negative:!1,noninteger:!1,nonnegative:!0,nonpositive:!1,nonzero:!0,positive:!0,rational:!0,real:!0,transcendental:!1,zero:!1});function JU(t,e){if(p(t).equals(Ts)&&e.getSymbolValue(Ts).equals(Ts)){return HO(t,e)}const r=e.valueOf(p(t));ne(r)?sr("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):y(r)?sr("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):ae(r)&&sr("expected function, found string instead.");const n=p(d(r)),s=p(d(d(r))),i=d(t);if(!p(r).equals(un)||r.equals(p(t))){const t=nr.tos;qf(r);let n=i;for(;f(n);)qf(e.valueOf(p(n))),n=d(n);return Af(nr.tos-t),Tf()}let o=s,a=i;const u=nr.tos;for(;f(o)&&f(a);)qf(p(o)),qf(p(a)),o=d(o),a=d(a);Af(nr.tos-u);const c=Tf();return qf(n),f(c)&&(qf(c),XU(e)),e.valueOf(Tf())}function XU(t){let e=0;const r=Tf();let n=Tf();if(y(n))return e=function(t,e,r){let n=0;const s=t.mapElements((t=>(qf(t),qf(e),n+=XU(r),Tf())));return qf(t.withElements(s)),n}(n,r,t),e;if(f(n)){const s=nr.tos;for(p(n).equals(p(r))?qf(Rd(Jr,p(d(r)))):qf(p(n)),n=d(n);f(n);)qf(p(n)),qf(r),e+=XU(t),n=d(n);return Af(nr.tos-s),e}if(!ue(n))return qf(n),0;let s=r;for(;f(s);){if(n.equals(p(s)))return qf(eh(s)),1;s=rh(s)}return s=t.getSymbolValue(n),qf(s),n!==s&&(qf(r),e=XU(t),0===e&&(Tf(),qf(n))),e}var YU,tC,eC,rC,nC,sC;class iC{constructor(){YU.set(this,[])}peek(){const e=t(this,YU,"f").length-1;return t(this,YU,"f")[e]}push(e){t(this,YU,"f").push(e)}pop(){const e=t(this,YU,"f").pop();if(e)return e;throw new Error}}YU=new WeakMap;class oC{constructor(){tC.set(this,new iC),t(this,tC,"f").push(function(){const t={};return aC(t,N.evaluatingAsClock,!1),aC(t,N.evaluatingAsFloat,!1),aC(t,N.evaluatingAsPolar,!1),aC(t,N.evaluatingTrigAsExp,!1),aC(t,N.expand,!0),aC(t,N.factor,!1),aC(t,N.keepZeroTermsInSums,!1),aC(t,N.renderFloatAsEcmaScript,!1),aC(t,N.useCaretForExponentiation,!1),Object.freeze(t)}())}push(e,r){const n=function(t){return{...t}}(t(this,tC,"f").peek());aC(n,e,r);const s=Object.freeze(n);t(this,tC,"f").push(s)}pop(){t(this,tC,"f").pop()}get(e){return t(this,tC,"f").peek()[e]}}function aC(t,e,r){switch(e){case N.expand:t[N.factor]=!r;break;case N.factor:t[N.expand]=!r}t[e]=r}tC=new WeakMap;class uC{print(...t){}}class cC{constructor(t,r){eC.set(this,void 0),rC.set(this,void 0),e(this,eC,t,"f"),e(this,rC,r,"f")}create(e){return new lC(t(this,eC,"f"),t(this,rC,"f"),e)}}eC=new WeakMap,rC=new WeakMap;class lC extends qL{constructor(t,r,n){super(t,n),nC.set(this,void 0),e(this,nC,r,"f")}get key(){return TL.name}get hash(){return li}get name(){return this.keyword.text}transform(e){if(ue(e)&&e.equalsSym(this.keyword)){const e=this.$;return t(this,nC,"f").call(this,e),[q,c]}return[S,e]}}nC=new WeakMap;class fC{constructor(t,e,r){this.opr=t,this.hash=e,this.evaluator=r}create(t){return new hC(this.opr,this.hash,this.evaluator,t)}}class hC extends Bw{constructor(t,r,n,s){super(t.text,t,s),this.evaluator=n,sC.set(this,void 0),e(this,sC,r,"f")}get hash(){return t(this,sC,"f")}transform(t){const e=this.$,r=this.evaluator(t,e);return[r.equals(t)?S:q,((t,e)=>e)(0,r)]}}sC=new WeakMap;class pC{constructor(t,e){this.expr=t,this.$=e,this.name="unknown"}isImag(t){return!1}isKind(t){throw new Error("UnknownOperator.isKind Method not implemented.")}isMinusOne(t){throw new Error("UnknownOperator.isMinusOne Method not implemented.")}isOne(t){return!1}isReal(t){return!1}isScalar(t){throw new Error("UnknownOperator.isScalar Method not implemented.")}isZero(t){const e=uw(t,this.$);throw new Error(`UnknownOperator.isZero ${e} Method not implemented.`)}subst(t,e,r){throw new Error("UnknownOperator.subst Method not implemented.")}toInfixString(t){throw new Error(`${t.toString()} is not defined.`)}toLatexString(t){throw new Error(`${t.toString()} is not defined.`)}toListString(t){throw new Error(`${t.toString()} is not defined.`)}evaluate(t,e){throw new Error("UnknownOperator. Method not implemented.")}transform(t){throw new Error("UnknownOperator. Method not implemented.")}valueOf(t){throw new Error("UnknownOperator. Method not implemented.")}}const dC=z(P.add),mC=z(P.multiply),gC=z(P.pow),wC=z(P.is_complex),_C=z(P.is_real);class xC{constructor(t){this.opr=t}compare(t,e,r){throw new Error(`(compare ${this.opr} ${t} ${e})`)}}function yC(t){const e=function(t){if(t)return{assumes:t.assumes?t.assumes:{},dependencies:Array.isArray(t.dependencies)?t.dependencies:[],disable:Array.isArray(t.disable)?t.disable:[],noOptimize:"boolean"==typeof t.noOptimize&&t.noOptimize,useCaretForExponentiation:"boolean"==typeof t.useCaretForExponentiation&&t.useCaretForExponentiation,useDefinitions:"boolean"==typeof t.useDefinitions&&t.useDefinitions};return{assumes:{},dependencies:[],disable:[],noOptimize:!1,useCaretForExponentiation:!1,useDefinitions:!1}}(t),r=function(){const t=new Map,e=new Map,r=new Map;return{clear(){t.clear(),e.clear(),r.clear()},getProps(e){if("string"==typeof e){return t.get(e)||WU}return this.getProps(e.key())},setProps(e,n){const s=e.key();if(n){const i=Object.freeze(Object.assign({...this.getProps(e)},n));t.set(s,i),r.set(s,e)}else t.delete(s)},getValue(t){if("string"==typeof t){return e.get(t)||c}return this.getValue(t.key())},setValue(t,n){const s=t.key();h(n)?e.delete(s):(e.set(s,n),r.set(s,t))},entries(){const t=[];return e.forEach((function(e,n){const s=r.get(n);if(!s)throw new Error;h(e)||t.push({sym:s,value:e})})),t},delete(n){const s=n.key();t.delete(s),e.delete(s),r.delete(s)}}}(),n=[],s=[];for(const t of k)s[t]={};let i=new uC;const o=new oC,l={},p={},d={};function m(){if(o.get(N.expand)){const t=s[$];if(void 0===t)throw new Error(`currentOps(${$})`);return t}if(o.get(N.factor)){const t=s[L];if(void 0===t)throw new Error(`currentOps(${L})`);return t}return{}}const g={getPrintHandler:()=>i,setPrintHandler(t){i=t||new uC},add:(...t)=>g.evaluate(P.add,...t),arctan:t=>g.evaluate(P.arctan,t),arg:t=>g.evaluate(P.arg,t),clearOperators(){n.length=0;for(const t of k){const e=s[t];for(const t in e)e[t]=[]}},defineLegacyTransformer(t,e){g.defineOperator(function(t,e){const r=vi(t);return new fC(t,r,e)}(t,e))},defineFunction(t,e){const r=function(t){if(f(t)){const e=t.head;if(ue(e))return e;throw new Error}throw new Error}(t),n=function(t){if(f(t)){const e=t.head;if(ue(e))return vi(e);throw new Error}throw new Error}(t);g.setSymbolValue(r,new jU(e,n))},defineKeyword(t,e){g.defineOperator(function(t,e){return new cC(t,e)}(t,e))},defineOperator(t){n.push(t)},defineAssociative(t,e){},divide:(t,e)=>g.multiply(t,g.power(e,Jt)),clearBindings(){r.clear()},compareFn(t){const e=d[t.key()];return e?function(t,r){return e.compare(t,r,g)}:function(e,r){return new xC(t).compare(e,r,g)}},conj:t=>g.evaluate(P.conj,t),cos:t=>g.evaluate(P.cos,t),evaluate(t,...e){const r=u(...e),n=a(z(t),r);return g.valueOf(n)},exp:t=>g.evaluate(P.exp,t),getSymbolProps:t=>r.getProps(t),getSymbolValue:t=>r.getValue(t),getSymbolsInfo:()=>r.entries(),buildOperators(){for(const t of n){const r=t.create(g,e);if(!vC(r.dependencies,e.dependencies))continue;const n="number"==typeof r.phases?r.phases:R;for(const t of k)if(n&t){const e=s[t];if(r.hash)Array.isArray(e[r.hash])?e[r.hash].push(r):e[r.hash]=[r];else{if(!r.key)throw new $i(`${r.name} has no key and nohash`);Array.isArray(e[r.key])?e[r.key].push(r):e[r.key]=[r]}}}},isExpanding:()=>o.get(N.expand),isFactoring:()=>o.get(N.factor),is_imag:t=>g.operatorFor(t).isImag(t),isMinusOne:t=>g.operatorFor(t).isMinusOne(t),isOne:t=>g.operatorFor(t).isOne(t),is(t,e){const r=u(t,e),n=g.valueOf(r);if(j(n))return n.isTrue();throw new Error(`Unable to determine ${g.toInfixString(t)}(${g.toInfixString(e)})`)},is_complex:t=>g.is(wC,t),is_real:t=>g.is(_C,t),isScalar:t=>g.operatorFor(t).isScalar(t),is_zero:t=>g.operatorFor(t).isZero(t),equals:(t,e)=>t.equals(e),factorize:(t,e)=>t.contains(e)&&cp(t,e)&&ue(e)?KU(t,e,g):t,getCustomDirective:t=>!!l[t],getNativeDirective:t=>o.get(t),getSymbolPrintName(t){const e=p[t.key()];return"string"==typeof e?e:t.key()},imag:t=>g.evaluate(P.imag,t),inner(t,e){const r=g.valueOf(t),n=g.valueOf(e),s=u(z(P.inner),r,n);return g.valueOf(s)},multiply:(t,e)=>g.evaluate(P.multiply,t,e),negate:t=>g.multiply(Jt,t),operatorFor(t){if(f(t)){const e=bi(t);for(const r of e){const e=m()[r];if(Array.isArray(e))for(const r of e)if(r.isKind(t))return r}return new pC(t,g)}return function(t,e){const r=m()[t];if(Array.isArray(r)&&r.length>0){for(const t of r)if(t.isKind(e))return t;throw new $i(`No matching operator for key ${t}`)}throw console.warn("expand",o.get(N.expand)),console.warn("factor",o.get(N.factor)),new $i(`No operators for key ${t} in current mode}`)}(t.name,t)},outer:(t,e)=>g.evaluate(P.outer,t,e),power:(t,e)=>g.evaluate(P.pow,t,e),real:t=>g.evaluate(P.real,t),remove(t){r.delete(t)},setCustomDirective(t,e){l[t]=e},pushNativeDirective(t,e){o.push(t,e)},popNativeDirective(){o.pop()},setSymbolOrder(t,e){d[t.key()]=e},setSymbolProps(t,e){r.setProps(t,e)},setSymbolPrintName(t,e){p[t.key()]=e},setSymbolValue(t,e){r.setValue(t,e)},sin:t=>g.evaluate(P.sin,t),subtract:(t,e)=>g.add(t,g.negate(e)),toInfixString:t=>g.operatorFor(t).toInfixString(t),toLatexString:t=>g.operatorFor(t).toLatexString(t),toSExprString:t=>g.operatorFor(t).toListString(t),transform(t){if(t.meta===T)return[T,t];if(f(t)){const e=t.head;if(ue(e)){const r=g.getSymbolValue(e);if(function(t){return t instanceof jU}(r))return jw(r.evaluate(t.argList,g),t)}else if(re(e)){const r=m().Rat,n=bC(t.argList,r);if(n)return n.evaluate(e,t.argList);console.warn(`No unique operators found for Rat from ${r.length} choice(s).`)}const r=m(),n=bi(t);for(const e of n){const n=r[e];if(Array.isArray(n)){const e=bC(t,n);if(e){return e.transform(t)}}else if(f(t)){const e=t.opr;if(ue(e)){const r=g.getSymbolValue(e);if(!h(r)&&f(r)&&un.equals(r.opr)){const e=JU(t,g);return[q,e]}}}}return t.meta=T,[S,t]}if(h(t))return[S,t];return g.operatorFor(t).transform(t)},valueOf:t=>g.transform(t)[1]};return g.setSymbolPrintName(dC,"+"),g.setSymbolPrintName(mC,"*"),g.setSymbolPrintName(gC,"expt"),g.setSymbolPrintName(z(P.rco),">>"),g.setSymbolPrintName(z(P.lco),"<<"),g.setSymbolPrintName(z(P.inner),"|"),g.setSymbolPrintName(z(P.outer),"^"),g.setSymbolPrintName(z(P.abs),"abs"),g.setSymbolPrintName(z(P.E),"e"),g.setSymbolPrintName(z(P.PI),"pi"),g.setSymbolPrintName(z(P.NIL),"()"),g.setSymbolPrintName(z(P.IMU),"i"),g.setSymbolPrintName(z(P.exp),"exp"),g.pushNativeDirective(N.useCaretForExponentiation,e.useCaretForExponentiation),g}function vC(t,e){if(Array.isArray(t)){for(const r of t)if(r.startsWith("~")){const t=r.substring(1);if(e.indexOf(t)>=0)return!1}else if(e.indexOf(r)<0)return!1;return!0}return!0}function bC(t,e,r){const n=[];for(const r of e)r.isKind(t)&&n.push(r);if(1===n.length)return n[0];if(n.length>0){return n[0]}}var OC;class EC{constructor(e){OC.set(this,[]),t(this,OC,"f").push(e)}peek(){return t(this,OC,"f")[0]}pop(){return t(this,OC,"f").pop()}push(e){t(this,OC,"f").push(e)}}OC=new WeakMap;class SC{constructor(){this.prints=[]}print(...t){this.prints.push(...t)}}function qC(t,e){const r=[],n=[],s=e.getPrintHandler(),i=new SC;e.setPrintHandler(i);try{const s=function(t,e){ir(0);const r=new EC(t);if(nr.trigmode=0,TC(ms,e)){e.pushNativeDirective(N.expand,!0);try{r.push(MC(r.pop(),e,"expanding"))}finally{e.popNativeDirective()}}if(TC(gs,e)){e.pushNativeDirective(N.factor,!0);try{r.push(MC(r.pop(),e,"factoring"))}finally{e.popNativeDirective()}}const n=r.pop();if(c!==n){if(r.push(n),e.isOne(e.getSymbolValue(ws))){let t=OO(r.pop(),e);t=MC(t,e),r.push(t)}!function(t,e,r,n){if((Ms.equals(t)||As.equals(t))&&pt(e))return;const s=n.getSymbolsInfo();for(const t of s){const e=t.sym;if(pt(t.value)){const t=Cp(r.pop(),ht,e,n);return void r.push(t)}}}(t,r.peek(),r,e)}else r.push(c);return function(t,e){h(t)||e.setSymbolValue(jm,t)}(r.peek(),e),r.pop()}(t,e);return r.push(...i.prints),{value:s,prints:r,errors:n}}finally{e.setPrintHandler(s)}}function TC(t,e){const r=e.getSymbolValue(t);return!!h(r)||(!re(r)||!r.isZero())}function MC(t,e,r){const n=function(t,e){t.reset(q),t.reset(T);const[,r]=e.transform(t);return r}(t,e);return n}function AC(t){let e=1;const r=yC(function(t){const e=function(t,e){return t};if(t)return e({assumes:t.assumes,dependencies:["Blade","Flt","Imu","Uom","Vector"],disable:t.disable,noOptimize:!1,useCaretForExponentiation:t.useCaretForExponentiation,useDefinitions:t.useDefinitions});return e({assumes:{},dependencies:["Blade","Flt","Imu","Uom","Vector"],disable:[],noOptimize:!1,useCaretForExponentiation:!1,useDefinitions:!1})}(t));!function(t,e){if(or(),t.clearBindings(),t.clearOperators(),e&&e.assumes){const r=Object.keys(e.assumes);for(const n of r){const r=e.assumes[n];t.setSymbolProps(D(n),r)}}BU(t),t.buildOperators(),jh(`${ys.text}=${vs}`,t),e&&e.useDefinitions&&Vh(t)}(r,t);const n={clearBindings(){r.clearBindings()},defineFunction(t,e){return r.defineFunction(t,e),this},getSymbolProps:t=>r.getSymbolProps(t),getSymbolValue:t=>r.getSymbolValue(t),getSymbolsInfo:()=>r.getSymbolsInfo(),evaluate:t=>qC(t,r),useStandardDefinitions(){Vh(r)},executeScript(e,n){const s={syntaxKind:hf.Native};return t&&(t.syntaxKind&&(s.syntaxKind=t.syntaxKind),t.disable),n&&n.syntaxKind&&(s.syntaxKind=n.syntaxKind),function(t,e,r,n){const{trees:s,errors:i}=gf(0,e,r);if(i.length>0)return{values:[],prints:[],errors:i};const o=[],a=[];try{for(const t of s){const e=qC(t,n);e.value&&(h(e.value)||o.push(e.value));for(const t of e.prints)a.push(t);for(const t of e.errors)i.push(t)}}catch(t){t instanceof Error?i.push(t):i.push(new Error(`${t}`))}return{values:o,prints:a,errors:i}}(0,e,function(t,e){return t?{syntaxKind:t.syntaxKind,useCaretForExponentiation:e.getNativeDirective(N.useCaretForExponentiation),explicitAssocAdd:!1,explicitAssocMul:!1}:{syntaxKind:hf.Native,useCaretForExponentiation:!1,explicitAssocAdd:!1,explicitAssocMul:!1}}(s,r),r)},renderAsAscii:t=>Ig(t,r),renderAsInfix:t=>Uw(t,r),renderAsHuman:t=>SL(t,r),renderAsLaTeX:t=>Cw(t,r),renderAsSExpr:t=>uw(t,r),addRef(){e++},release(){e--,0===e&&function(t){t.clearBindings(),t.clearOperators()}(r)}};return n}export{_ as Atom,Z as Boo,o as Cons,Se as Dimensions,N as Directive,J as Flt,ot as Hyp,ft as Imu,P as Native,xe as QQ,kt as Rat,se as Str,B as Sym,hf as SyntaxKind,x as Tensor,$e as Uom,V as booF,H as booT,p as car,d as cdr,a as cons,G as create_boo,W as create_flt,at as create_hyp,Ut as create_int,Ct as create_rat,AC as create_script_context,oe as create_str,D as create_sym,v as create_tensor,ke as create_uom,ct as delta,ut as epsilon,pf as human_readable_syntax_kind,ht as imu,l as is_atom,Q as is_blade,j as is_boo,f as is_cons,it as is_flt,lt as is_hyp,pt as is_imu,h as is_nil,ne as is_num,re as is_rat,ae as is_str,ue as is_sym,y as is_tensor,Le as is_uom,u as items_to_cons,z as native_sym,c as nil,Dt as one,Y as oneAsFlt,mf as parse_expr,gf as parse_script,df as syntaxKinds,Yt as zero,X as zeroAsFlt};
//# sourceMappingURL=index.min.js.map
